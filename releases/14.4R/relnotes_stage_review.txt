[commit 5c6949e12ee6143505a200b37f2d0bbaf2611656]

[commit 04911babef1b22cb4ff9cff08a34ec1e6bf80d45]

[commit 666599639cf6bd1c4ae1ff4adad8150a44d7a8d4]

[commit 57865e505aef2dafb548039619de5d5322dd7157]

[commit 23cda744e4dae48ee3857f33158e30d241868d2a]

[commit af51f41346ad885e1ffe0d14b325c88cc65ac0cc]

[commit 58f55afb301ba781f87991b0298a6a6545771376]

[commit 220584471931fef807a6f59ce0397cfd6ac0f6fe]

[commit 02f70f6633fd4a96a0dad69f97a855867caea491]

[commit 8d2d6647d65a6a104551ca7a9ddd9a9563eccf21]

[commit 527027da391d9ab75530927076f336330834dc11]

[commit 62947e5081616bff1e9623a0e4292e92b49c3910]

[commit d149be3a0cbe27599921b0952bd8de18413fceaf]

[commit 0c91fa982437417e09218ad8c2428aff29d9c5bd]

[commit d350c18f98fd41e773a4856bff268f4f8060b21e]

[commit 9d80d681ee9ddfb7a403924c877eac26d12e9077]

[commit 65808459e21b92c38daee8160c736dd305ff82b7]

[commit 0e80562f15e3a634a2039cd88784957cb0f682c3]

[commit 6741fb1bd4f473f3bc46e46841d2e53a9629907c]

[commit 4c0dc30b761a428c81006fbc454c990363736923]

[commit 001a73c78b386735d36521d9c414cc6718e114a1]

[commit 018c097a4fa7b97132746e07e4e0c21eac180c02]

[commit 21f206bb330f769afb82d7b6e8f3762478ee74b3]

[commit e9e97eda0b1b8ab23db532e90b43301b51ab1f4f]

[commit 85e0cdeeb75a8fffc7910032d409417124dfee26]

[commit 4ff445d3723a58ef8a5d34e4e33c4f40d217e1ab]

[commit d1f275606d9fa2560606c4b6e515bc35d82699fc]

[commit 2bf082df4931fa0a2c557c428e7e7a333fd95ae5]

[commit a93e1b731ae440ac3471792c52db8fb07b93d265]

[commit 586183128f2f04b84a9a564f83289963671f0ff2]

[commit a16c7286b5c4c63867626fa9fcfba82d8edec4ba]

[commit d350c18f98fd41e773a4856bff268f4f8060b21e]

[commit d0b23791c6677c3cc03d9e315beb66e8b4de717a]

[commit 9819cc22df7c49e2a9631c1afdec8bbe988e00b0]

[commit ccdd6285df5dfa81c22e36685bab9be184a4e733]

[commit ab9c9443eec582265c288dc46d2c2144f0f81188]

[commit d300875d011c056f10dd7ef6915d041c7b559fff]

[commit 6c912470030ba958f2e41a00b44f6430919b1389]

[commit 5d7d22588dada885d7d8e2db306aa6e0ac030ef1]

[commit 7fa4ccb8e4e74100583dbddafcb0e1a054963d6e]

[commit e261ea91050c6955a00d3428c3a3522971789aa1]

[commit 8039d22f6afde8c6913b2dc48f407fc9fc0752ee]

[commit c44ec96b471e1c5dc6b0d12c7db693c58527522e]

[commit b5a7c25c4e19ad57a0b0b23c16ba8523ec60f923]

[commit 9a64f277bf5b422d1ebb3d960f8f6a5920dc3131]

[commit aed5a47b3a8a105f1452554a176a7d6c0a750854]

[commit 7752bb84c45d39a266910f98f5cc097aa017a19c]

[commit 913d1916e3e265098fdd87d9b9f6c12a930c71bc]

[commit 026e3d12ba24188fbe84207e55195defb31bf81a]

[commit 79f62601c73d875123b9c800e688f3c4b70e0b73]

[commit d03be8cf3346dae1e438ded3aae4453045b77486]

[commit afedf568e111b5b6093e8465c1e22ab3895c6162]

[commit d203bd96bb253981ca8767caf36ee9d7771bbce3]

[commit 52864a411a6fb5bbb599ef6d15d727b782abf104]

[commit 7a1a4f10a64d51f877422da6d4833cc4e2a95265]

[commit 1b3972ac0f75c659afcd05574878cadaab4d61da]

[commit ee8d50bfd59e7619db618bf63e48e108997db8bd]

[commit ac930fe19978684a99f1f077d93ea71e0a1c9513]

[commit 5118ca75f3c4b9d6aa279575313dc3a74efc336f]

[commit 7ca599aa613955a939284292f0993b59b0d9fef3]

[commit 3b44f04225bc3f2ca33cff90273b8cdfea67774e]

[commit f957857c48351396dbd0127bc0fdd47f69e82f6d]

[commit 3fc5eb05910f0377e661c0ed57842baa1642b237]

[commit 9c54475b16dddeaf50510418c98a6e69ff635035]

[commit 95f0e1e425a6847c58aad97b8d65b2a386e5b300]

[commit 443e07f7980f8e777b7513e72769da639dd4e0e9]

[commit 39fd1181e5b21823f8fe31006d125963ecdf3492]

[commit d39dd181c8ab36264a60ad0b329e80929a0db7f8]

[commit eb042d5e8de37eacbed5aa94ba64d7d95995a266]

[commit f21385688f528adcee8f8293e0117cf4b066f393]

[commit 23a18b79bd8bac5ab770c357f0e1c6db0fc290f7]

[commit d565a5e904ed15cffb480088b908063c9cfc8847]

[commit 0e80562f15e3a634a2039cd88784957cb0f682c3]

[commit c95f96dea30a26b7d3543961db6e25e677c02c5a]

[commit 06366a2188a13fc22b88a502fd7f9c4d17d91d2e]

[commit 44ad87f77a847b1fcdc9bc0ee8d5532cc889b800]

[commit eb560911563f13e56a74167e323fda1cf111e008]

[commit 8a4277b9667c5eb3bd0ab40513df1daa6985c679]

[commit a9319c35e816e0fab5de5d6b6e814667a14d3e7a]

[commit 812d0cb17de0da39e3eb2fa0c3a365f4ea1cb71a]

[commit fa86ef7f23aee51a6d7dac33d89d657df50aae3c]

[commit ba508f1da16dd58684f03f06805b0f668e4c87b2]

[commit 5d3c3f73b69c61cd2630be56642292a676363dd0]

[commit 1d00ba4aaacfb001f17887529ebd6a7552a3f55a]

[commit 1166b90143dafc2e7f19140cd2492be74ed94348]

[commit 72f01a763131bfba351beaa0786bd910d53ca589]

[commit f580ef8a75c133ac75407ee1583cdb9cdb1f98c3]

[commit 3690911c355a85177d534ae19c679d8e5d259f4f]

[commit 1a0377015e78f6ed4b444133a8b5139a18737f42]

[commit a7805f3341705323f80c579173777f947bd8aae3]

[commit 07700b0107dc642b47c78917102b1f059e2af645]

[commit 4ff445d3723a58ef8a5d34e4e33c4f40d217e1ab]

[commit f9d671f726ac2199b906fc406b46b57cd2a11cf7]

[commit ecc2e2e2c5b9f1e88282533348229bbb8d36d5f0]

[commit f60a41543430c764a276af5dc30b9bcf2b8c25d5]

[commit bed9eb6af70a8afb922089239ec892c6b73e72cd]

[commit f2164d231f4f33f93cea9cd13b80a444a69c8f6f]

[commit 2bf082df4931fa0a2c557c428e7e7a333fd95ae5]

[commit 52a61478e5589be242a3b4a889da71ce533c8daf]

[commit 9848c2085511796ebf306e2b504c12e7e6c8cccb]

[commit f6578a0ec7cb954059da580c22dee5bc331ee68a]

[commit 68e2f4cc5e4ef17e64da2a25fb9918a0e1074b03]

[commit 20133eccbdd854915e88c6f720212814f2f5313b]

[commit 58be4610c91f4ed1a6c29482ca555b2798f70b05]

[commit ef55f6b8662640ef611e78e09dbda56ec5a1532f]

[commit 1630af436a6145e90f7b1aac1a91fbbfe9b22f57]

[commit 1fbba4fbf0f88e551ca8d3bf759d29b0867ce03e]

[commit cd40a23fb249bba461e38ca0c3d243a20a12eef4]

[commit e4e5e7da092eef1f0e1af70dd596a4ab9b75cb7a]

[commit d4ada3b1f8d59835284635f470656f029bdc4345]

[commit 709465f2c4f12fe9b820ca8097de9021bff0c84b]

[commit 054ae5e7b465a32079a5ec8a9b943150b8da3212]

[commit 0cfd940b6c24d78a821afdcf50659c98a1203562]

[commit 4fbf901a2925ec2598167c1c4f04e78c06960869]

[commit 9b4c38bb8948557fe1983280ac0e78db4209eb8d]

[commit d96e139c060cb26789228e6fb3ec7194f4722a8e]

[commit 1955c8f6293fd8188c208bf03debc67b0ad7c615]

[commit 3264445f8826781513c2b9d4fd6210c1888b10b8]

[commit 24633d1cfd1345889e0373a9dc2cc55afe716624]

[commit 28290a18e217ed5837549e1ee022766403d63133]

[commit a93e1b731ae440ac3471792c52db8fb07b93d265]

[commit eeb41dca070f45f9ebb2b2831f81da65786ba820]

[commit 49ed9e4acb6e66143ce36369c2816efa248bf18c]

[commit fe7bb59bb014734f95af7c71f10825535a3a2a19]

[commit b4871be3490de56975777079c1767d1fd346ac7a]

[commit fb994a3cdec32730eab58544a30f992de36b0d09]

[commit a1b0fae4182c3455ee24a5f3dcfc1a69553f2c93]

[commit fdf8dc1a01a603cbd1f9349068e43c7d8c609969]

[commit 7a2a874a0b46db3c3829151b207f738852bd77c0]

[commit f3421697d0863b0183b30368f592ee85f191aefe]

[commit e72a630c90cde38ee37ad75f4caf9e6074119911]

[commit 4712c76c9f21a71425e39596bf1f47cc12bbbb8e]

[commit 613eb8ee9cb269205cdf168e02b4b093ae1c9a62]

[commit 5660178fd14b9d45743231358f25dcbe801d090f]

[commit e3df9a78da6be1dc9f0f43cd8ca8e252b451f762]

[commit ab36487a79cd0093d76ec3cdc8eb8c0e114835db]

[commit a85cfcb61efdb5ef11dd494eb82c29627d9a1ec7]

[commit 0a8d8b0c878f85462f52fe5faebfb07678fc2c34]

[commit 80ef1216d773b09a6905dbb7cfdeac9844e2a084]

[commit 2814da5d5dc9d0e29a7ad4b9d10f452c1bd63ca5]

[commit 270158508d7c55a0737c2a9915cd4afc8fabdaf0]

[commit 4b286fc6d5f1762a17180ab86b5cf7debf78d020]

[commit 78f39a55b205eace7f0a308066864aef1ec925ea]

[commit c73d38aef1407362b8987e6badcb7fb555a12774]

[commit 30e3f9665eb033f923f81703cd7c6feeabe327c4]

[commit 220584471931fef807a6f59ce0397cfd6ac0f6fe]

[commit a2058a619c6b60c2f22ae2fa7e91a3e9b99669d9]

[commit c065db9f83ff7c9fa9ce59d095c7e0f966f1df77]

[commit 3fd185fffa0dfcccd4cd3b898da038f67035ec3c]

[commit 4558fc4f91dc1d3909083ea664b384595f66c3ae]

[commit 99ea229c697a6b96c689ed6d9031527c4d229b06]

[commit 15f637f65c22cc608d18f6155ffd2f6b2171b46a]

[commit f88108c7963c1aa3c83a2c053f43dfcddb5cf4bc]

[commit 30e9075a5439e7b3da6a19a4903aee2bc5d889fd]

[commit 84df9c02785ba3ca6bbf9d83fa043a640d8d9b97]

[commit 7f41c76b84d0f24feb7d60bc566630735dbc78e3]

[commit 185bd9cf219999a38093e853bfda8ed1ca21fc5b]

[commit 0c91fa982437417e09218ad8c2428aff29d9c5bd]

[commit 414a01b9e62bdd6b10bbae87b0df52983bf4ca14]

[commit 677465720ad10f24de178c8bba0285cb3f3c23fe]

[commit ae7fdd715466490d91813179475ea103c8c8e30d]

[commit 9a9e93f386421270b721392183fc3c5088f0055f]

[commit 785abf57ab46cd890e5f5efc05d897b27edb2f35]

[commit d0b23791c6677c3cc03d9e315beb66e8b4de717a]

[commit a271d8fd33b5356a06b0d18b16a7a1eb9d5af980]

[commit 9819cc22df7c49e2a9631c1afdec8bbe988e00b0]

[commit dd276946d56197947c47fa7a37255859aea6e942]

[commit e912101db10b45e8f440da44ae06e0f0383d24ad]

[commit 106294d5801f6c617812534f773ea101bfbc7655]

[commit 823f1076c7cd28f4eebe18aeb576d719a0148fee]

[commit c508393e49fc4d18cf40fa439a9e625bde93a68f]

[commit e52f11f4bbc89df8114715a210adf2411ca4936d]

[commit 669b52503298fc3f2ea822e7e1b99d98a9b0d9a6]

[commit ec70e1177b2004a5990222dbe3bd6130d9566822]

[commit 257b9d0755b29fc06d00900efb47f5f90f7fbd61]

[commit a443333f9bb4c342d7dcf07332aba8e785b0bc47]

[commit 97e2915ab98e786f7310d8477aa48d71a5485e44]

[commit 6abe6a8a0d54a28e8bc35bd6cd5cb1c23b94cc03]

[commit 6dad4525a2910496ecf3c41de659aac906f6c1f4]

[commit 5e5832bdc440b130a549fcad8cf266fd6e054b1b]

[commit 7ea73ff25c587884e48e2fe00e26f81130eaacfd]

[commit 0fe58344e8290637c91d70142578e92bd3d1e8f7]

[commit 023a43253c3b01c6a4c1fa2960c834f50bca76d9]

[commit 79cbdb3703056a0b34b23a5a0bda8c4ce1999250]

[commit 8da379e2149f114b071346ea5bf44ac7a2657861]

[commit dd60e309af24409f0f756b13814926ea7570ce17]

[commit 4003f5d4c12e0b753e2d8c34fbbcbd13ef4be257]

[commit 692553df59d92558e5b65dc6e3f8b35c88817fa1]

[commit 5cf27a49a2de91ae1f369912a7bf3859fbc79355]

[commit bf2ccfcbac03765c682960e85fecdd6164f92c6f]

[commit 5bc4143b95acc8a2b757cb287d15431f333bb53b]

[commit 11b616d9de3f1d106cd9f2bfe4c45013f3b1528f]
Date: 2025-12-26
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: sockstat: Surround explicit IPv6 addresses with brackets
Review: The sockstat utility now surrounds explicit IPv6 addresses with brackets in its output, improving readability and consistency with standard IPv6 notation.
Body:

  Approved by:	re (cperciva)
  PR:		254611
  Approved by:	otis, tuexen, des
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54375

  (cherry picked from commit fe81e3944c085e765c83c4f78941d7529ceb556e)
  (cherry picked from commit 03c8e3e77114530f61e0dd9f2b1757eeea033d0e)


   usr.bin/sockstat/sockstat.c | 9 +++++++++
   1 file changed, 9 insertions(+)

[commit df3c9a8a5febf3457c96238c2e9212dc369d377a]
Date: 2026-02-06
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Ports.packaging
Subject: Revert "release: Ship firmware from kmods repo on DVD"
Review: The commit reverts a change that would have shipped firmware from kmods repo on DVD, because the metapackage is missing from the kmod repository causing DVD build failures. This affects users building DVD images, as firmware packages will not be included on the DVD by default.
Body:

  While all of the net/wifi-firmware-*-kmod packages are in the "kmod" pkg
  repository, the net/wifi-firmware-kmod metapackage itself is not; this
  results in the DVD build failing when it can't fetch that.

  I'm not sure if the correct fix here is to add kmod-related metapackages
  to the kmod repository (even if they themselves do not contain kmods) or
  something else; but this needs to be backed out at least temporarily so
  that 14.4-BETA1 can happen.

  This reverts commit 8c1de31097763ce1d918a3f82c61fd8d30edbe75.

  This is a direct commit to releng/14.4 since it is not yet clear whether
  this should be permanently removed from other branches and there is no
  urgency to do so (since DVD builds are disabled by default).

  With hat:	re
  Approved by:	re (cperciva)


   release/pkg_repos/release-dvd.conf |  7 -------
   release/scripts/pkg-stage.sh       | 25 +++++++------------------
   2 files changed, 7 insertions(+), 25 deletions(-)

[commit 9bbe9bfc66333ef134d3a7591f47c528e23c8b89]
Date: 2026-02-06
Score: 5
Status: proposed(include=yes,score=90)
Sponsor: OpenSats Initiative
Section: Ports.packaging
Subject: 14.4: create releng/14.4 branch
Review: The commit marks the creation of the releng/14.4 branch, updates the release stage to BETA1, and switches pkg(8) configuration to use the quarterly repository. This affects users by changing the default package repository for the release branch.
Body:

  Update from PRERELEASE to BETA1
  Switch pkg(8) configuration to use the quarterly repository
  Bump __FreeBSD_version

  Approved by:	re (implicit)
  Sponsored by:	OpenSats Initiative


   release/pkg_repos/release-dvd.conf | 4 ++--
   sys/conf/newvers.sh                | 2 +-
   sys/sys/param.h                    | 2 +-
   3 files changed, 4 insertions(+), 4 deletions(-)

[commit 2f5bea924d08a6528dc6c25b2932105f7f235a3a]
Date: 2025-09-18
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: stand/man: Fix mdoc typos for emails, tag spdx
Review: Fixes typographical errors in man pages for boot loaders, improving documentation clarity.
Body:

  MFC after:	3 days

  (cherry picked from commit a37825313f624121c6f07bc03f9cf655c300885b)


   stand/man/boot1.efi.8   | 2 ++
   stand/man/loader.8      | 9 ++++++---
   stand/man/loader_4th.8  | 7 +++++--
   stand/man/loader_lua.8  | 3 +++
   stand/man/loader_simp.8 | 5 ++++-
   5 files changed, 20 insertions(+), 6 deletions(-)

[commit 9bdba7081f83ee25a00f5f1216306b40be29636c]
Date: 2025-09-24
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: kerneldocs: Update latex package
Review: Updates the LaTeX package used by kerneldoc, affecting the formatting of generated kernel documentation.
Body:

  MFC after:	3 days
  Reviewed by:	ziaee
  Signed-off-by:	Minsoo Choo <minsoochoo0122@proton.me>
  Closes:		https://github.com/freebsd/freebsd-src/pull/1853

  (cherry picked from commit cd813380ad832a0bfa5b99f22012092cc9d373b1)


   tools/kerneldoc/subsys/README | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit e829846c2f59fd7c7aa7652cb6ca9d9303e0d382]
Date: 2025-09-24
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: blackhole.4: Describe even better, take two
Review: The man:blackhole[4] manual page is updated with improved wording.
Body:

  I meant to change this to tuexen's suggestion upon commit but failed.

  MFC after:	3 days
  Fixes:		9e02de4ad6c3 (blackhole.4: Describe even better)

  (cherry picked from commit 1a9ec72022ddce0cacb9aedda3d69aa95cd45ed0)


   share/man/man4/blackhole.4 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit e5f941466b58ea05d703bab940e3ae85eb3f0f98]
Date: 2025-09-24
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: blackhole.4: Describe even better
Review: The commit updates the man:blackhole[4] manual page to correct the description, removing a reference to fictitious UDP connections.
Body:

  Rewrite the document description to omit ficticious "UDP connections".

  Fixes:			38f6a4467419 (blackhole.4: Describe better)
  MFC after:		3 days
  Reviewed by:		tuexen
  Reported by:		tuexen, zi
  Differential Revision:	https://reviews.freebsd.org/D52696

  (cherry picked from commit f9a71840d8ee0cfff4ec983a589be53648e7017d)


   share/man/man4/blackhole.4 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 1a7efb781f9d6e40ab266ca3722242cd143f4aaf]
Date: 2025-09-23
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: blackhole.4: Describe better
Review: The man:blackhole[4] description is updated to fit on one line, improving apropos output readability.
Body:

  Rewrite the document description to fit cleanly on one line and omit
  crossreferences, to clean up apropos results.

  MFC after:		3 days
  Reviewed by:		tuexen, cperciva
  Differential Revision:	https://reviews.freebsd.org/D52695

  (cherry picked from commit 38f6a4467419f5b2344d184baa454c126e2919a9)


   share/man/man4/blackhole.4 | 7 ++-----
   1 file changed, 2 insertions(+), 5 deletions(-)

[commit a0cb72d141ff4d2aada1620c898a9236535a945c]
Date: 2025-12-17
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: examples/mdoc: Remove document description quotes
Review: Removes misleading quotes from mdoc example files to prevent confusion about roff quoting behavior.
Body:

  Quotes in roff do not work the way quotes in shell do,
  remove them from the examples to hopefully lead less people astray.

  MFC after:	3 days

  (cherry picked from commit 067b62bd5834484c927038aff28d36da6c5d6cca)


   share/examples/mdoc/example.1 | 2 +-
   share/examples/mdoc/example.3 | 2 +-
   share/examples/mdoc/example.4 | 2 +-
   share/examples/mdoc/example.9 | 2 +-
   4 files changed, 4 insertions(+), 4 deletions(-)

[commit aad7091822965f8a23f7922a5ab3ce2ef1881f55]
Date: 2026-01-31
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: INDEX.fonts: Minor maintenance
Review: The commit updates manual page references and removes a blank line in font index files, but these changes are minor documentation and maintenance without user-visible impact.
Body:

  + Mention relevance of this file in the vt manual screen.font entry
  + The vidfont manual is in section one, not eight
  + Remove leftover blank line from freebsd tag removal

  MFC after:	3 days

  (cherry picked from commit 1f5795b6422a1c6e4b71fd7e93717522ccb822f9)


   share/man/man4/vt.4             | 3 +++
   share/syscons/fonts/INDEX.fonts | 3 +--
   share/vt/fonts/INDEX.fonts      | 3 +--
   stand/fonts/INDEX.fonts         | 3 +--
   4 files changed, 6 insertions(+), 6 deletions(-)

[commit 1eb2efcdd5524b4cb993794124299bd15f4dd65d]
Date: 2025-05-25
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: ata.4: Cleanup HARDWARE for HW Relnotes
Review: The commit updates the ata.4 man page to clarify hardware compatibility notes, which may affect user understanding of supported IDE interfaces.
Body:

  MFC after:	3 days
  Reported by:	ivy (ata is for ide interface)

  (cherry picked from commit b03f765f076c6b6170f01681bfcc4dbc3df846c3)


   share/man/man4/ata.4 | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit 822afa2bc93c715f5b7d16c2d465762bcf04d634]
Date: 2025-08-15
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: hv_netvsc.4: Fix hn(4) mlink typo
Review: The commit fixes a typo in the man:hn[4] mlink in the man:hv_netvsc[4] man page.
Body:

  MFC after:	3 days
  Fixes:		e47939b3b1106 (hn: fix build on !x86)

  (cherry picked from commit 429152cb04e4efdb37437fb2b76fbcfd1ad043ab)


   share/man/man4/Makefile | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit bfa2d8e6ba22870dc2f0363962c7788e43bdb497]
Date: 2025-08-06
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: man bluetooth/fwdownloaders: Clarify descriptions
Review: The commit updates man page descriptions for Bluetooth firmware download utilities to clarify their purpose and differentiate them from fwget. This improves apropos search results and documentation clarity.
Body:

  s/download/load/ to clarify the difference between these and fwget, our
  utility to install firmware packages, in apropos results. Also, include
  rtlbtfw, I missed that one last time.

  MFC after:		3 days
  Reviewed by:		bz, pauamma
  Fixes:			2c901189bb65 (terse descriptions)
  Differential Revision:	https://reviews.freebsd.org/D51333

  (cherry picked from commit 0790d99e0b951cfee5be0e1db4bc6fae972aeacb)


   usr.sbin/bluetooth/ath3kfw/ath3kfw.8 | 4 ++--
   usr.sbin/bluetooth/bcmfw/bcmfw.8     | 4 ++--
   usr.sbin/bluetooth/iwmbtfw/iwmbtfw.8 | 4 ++--
   usr.sbin/bluetooth/rtlbtfw/rtlbtfw.8 | 4 ++--
   usr.sbin/uathload/uathload.8         | 4 ++--
   5 files changed, 10 insertions(+), 10 deletions(-)

[commit a15c821b8416cd7103fb25632eff0e6f28c345a2]
Date: 2025-07-14
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: nanobsd.8: Shorten title for apropos, tag SPDX
Review: The man:nanobsd[8] manual page title is shortened for apropos display and includes an SPDX license tag.
Body:

  MFC after:	3 days

  (cherry picked from commit fbc4e90c5ca6186ade53d29bf3e69aab6ad1cbc3)


   share/man/man8/nanobsd.8 | 8 +++++---
   1 file changed, 5 insertions(+), 3 deletions(-)

[commit 79da80d56a427c4c6fe7e35f2d866b84db979a25]
Date: 2026-02-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: sym(4): Map HCB memory as uncacheable also on x86
Review: The sym(4) driver now maps HCB memory as uncacheable on x86, which prevents data reordering and fixes panics with FreeBSD VMs on OpenStack using lsiLogic HBAs.
Body:

  As part of making the chip-specific mix and match of different accesses
  (DMA/bus space) work as desired, the intent is to map the HCB memory as
  uncacheable. Prior to VM_MEMATTR_*, the !x86 way of indicating this to
  bus_dmamem_alloc(9) was BUS_DMA_COHERENT. Then later on in 2db99100a4,
  BUS_DMA_NOCACHE was hooked up to VM_MEMATTR_UNCACHEABLE for x86. As it
  turns out, still as of today bus_dmamem_alloc(9) differs in this regard
  across architectures. On arm, it still supports BUS_DMA_COHERENT only
  for requesting uncacheable DMA and x86 still uses BUS_DMA_NOCACHE only.
  On arm64 and riscv, BUS_DMA_COHERENT seems to effectively be an alias
  for BUS_DMA_NOCACHE.

  Thus, allocate the HCB memory with BUS_DMA_COHERENT | BUS_DMA_NOCACHE,
  so we get uncacheable memory on all architectures including x86 and so
  loads and stores from/to HCB won't get reordered. However, even on x86
  we still need to use at least compiler barriers to achieve the desired
  program order.

  This change should also fix panics due to out-of-sync data seen with
  FreeBSD VMs on top of OpenStack and HBAs of type lsiLogic as a result
  of loads and stores getting reordered. [1]

  While at it:
  - Nuke the unused SYM_DRIVER_NAME macro.
  - Remove unused/redundant HCB members and correct a comment typo.

  PR:		270816 [1]
  MFC after:	3 days

  (cherry picked from commit b941d1c64e58708c93621cc07ed1c8e5e709cd48)


   sys/dev/sym/sym_hipd.c | 46 +++++++++++++++++++---------------------------
   1 file changed, 19 insertions(+), 27 deletions(-)

[commit 5d546e86517d8052ffb33fccf55f9c5f7438153f]
Date: 2026-01-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: sym(4): Provide a DEVICE_DETACH(9) method
Review: The sym(4) driver now provides a DEVICE_DETACH(9) method, ensuring proper teardown order and preventing double-free errors during attach failures.
Body:

  This also fixes sym_cam_free() to tear things down correctly, i. e. in
  opposite order of setup, as well as sym_cam_attach() to not free devq
  and SIM twice in the failure case.

  (cherry picked from commit 518c01b31e96bbe8353a551885a61e7da6aed5f6)


   sys/dev/sym/sym_hipd.c | 34 +++++++++++++++++++---------------
   1 file changed, 19 insertions(+), 15 deletions(-)

[commit b56ce48c0f7ff675f9a09ef98e13dc2bcdea1ce3]
Date: 2026-01-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: sym(4): Consistently use device_printf(9) where applicable
Review: The sym(4) driver now uses device_printf(9) consistently for logging, which may affect kernel message formatting but does not introduce new user-visible features or changes.
Body:

  (cherry picked from commit 48eee744b540ef0413fa1cb543dde6e49e7f2ac4)


   sys/dev/sym/sym_hipd.c | 222 +++++++++++++++++++++++++------------------------
   1 file changed, 114 insertions(+), 108 deletions(-)

[commit b149250d344eed15178ad9a151425426823d5bd1]
Date: 2025-10-14
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: style(9): white space after ; and around binary operators
Review: The commit only contains style and whitespace fixes, with no user-visible impact.
Body:

  in for() loops.  Also, use 'while', where only the
  conditional test of 'for' was used.

  Reviewed by: sjg

  (cherry picked from commit 0050289464fa56ec79e060b8d8378b9ff7145a0e)


   sys/arm/allwinner/aw_sid.c        |  2 +-
   sys/cam/scsi/scsi_all.c           |  2 +-
   sys/cam/scsi/scsi_enc_ses.c       |  6 +++---
   sys/crypto/chacha20/chacha.c      |  6 +++---
   sys/crypto/openssl/ossl_sha256.c  |  4 ++--
   sys/dev/aic7xxx/aic79xx.c         |  4 ++--
   sys/dev/aic7xxx/aic7xxx.c         |  4 ++--
   sys/dev/enetc/if_enetc.c          |  6 +++---
   sys/dev/hptmv/entry.c             | 33 ++++++++++++++++-----------------
   sys/dev/hptmv/gui_lib.c           | 12 +++++-------
   sys/dev/hptmv/hptproc.c           |  2 +-
   sys/dev/mps/mps_sas.c             |  4 ++--
   sys/dev/mpt/mpt_raid.c            |  4 ++--
   sys/dev/nfe/if_nfe.c              |  4 ++--
   sys/dev/ocs_fc/ocs_mgmt.c         | 14 +++++++-------
   sys/dev/ppc/ppc.c                 |  2 +-
   sys/dev/smartpqi/smartpqi_event.c |  6 +++---
   sys/dev/smartpqi/smartpqi_queue.c |  4 ++--
   sys/dev/sym/sym_hipd.c            | 12 ++++++------
   sys/dev/tws/tws.c                 | 13 ++++++-------
   sys/dev/tws/tws_services.c        |  2 +-
   sys/fs/devfs/devfs_dir.c          |  2 +-
   sys/fs/udf/osta.c                 |  4 ++--
   sys/i386/i386/in_cksum_machdep.c  |  2 +-
   sys/kern/kern_exit.c              |  2 +-
   sys/kern/kern_malloc.c            |  2 +-
   sys/kern/subr_devstat.c           |  2 +-
   sys/kern/subr_prf.c               |  2 +-
   sys/netinet/siftr.c               |  2 +-
   sys/netpfil/ipfw/ip_dummynet.c    |  4 ++--
   30 files changed, 82 insertions(+), 86 deletions(-)

[commit 81f577d79d8dff70428ec1719b440da90f119cf1]
Date: 2023-11-22
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Replace random sbuf_printf() with cheaper cat/putc.
Review: Internal optimizations to sbuf_printf() usage in kernel subsystems; no user-visible changes.
Body:

  (cherry picked from commit 0a7139485ccb8192e7c7c6d93653da92bfcdc196)


   sys/kern/kern_cons.c       |  2 +-
   sys/kern/kern_exit.c       |  8 ++++----
   sys/kern/kern_fail.c       | 12 ++++++------
   sys/kern/kern_rctl.c       | 16 ++++++++--------
   sys/kern/kern_sig.c        | 12 ++++++------
   sys/kern/kern_sysctl.c     |  4 ++--
   sys/kern/kern_tslog.c      | 12 ++++++------
   sys/kern/sched_ule.c       | 18 +++++++++---------
   sys/kern/subr_blist.c      |  6 +++---
   sys/kern/subr_bus.c        |  2 +-
   sys/kern/subr_prf.c        | 14 +++++++-------
   sys/kern/subr_sleepqueue.c |  4 ++--
   sys/kern/subr_stats.c      |  6 +++---
   sys/kern/subr_witness.c    |  6 +++---
   sys/kern/tty_info.c        |  6 +++---
   sys/kern/vfs_mountroot.c   | 12 ++++++------
   16 files changed, 70 insertions(+), 70 deletions(-)

[commit 55204a088b3b23a19b008780d8f9c3cbb1b09721]
Date: 2023-12-07
Score: 5
Status: proposed(include=no,score=10)
Sponsor: NetApp, Inc.
Section: undecided
Subject: siftr: refactor batch log processing
Review: Internal refactoring of siftr batch log processing to avoid freeing packets in a critical section. No user-visible changes.
Body:

  Refactoring to perform the batch processing of
  log messaged in two phases. First cycling through a limited
  number of collected packets, and only thereafter freeing
  the processed packets. This prevents any chance of calling
  free while in a critical / spinlocked section.

  Reviewed By:           tuexen
  Sponsored by:          NetApp, Inc.
  Differential Revision: https://reviews.freebsd.org/D42949

  (cherry picked from commit a95cd6e4870b79178860e03366c4327e533ecf1e)


   sys/netinet/siftr.c | 39 ++++++++++++++++-----------------------
   1 file changed, 16 insertions(+), 23 deletions(-)

[commit a327d997f5a106d8ec2fe5255aaf63127bfe6a69]
Date: 2023-07-25
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Network.general
Subject: siftr: flush pkt_nodes to the log file in batch
Review: The siftr packet logging module now flushes packet nodes to the log file in batches, improving logging performance and reducing potential data loss during high traffic.
Body:

  Reviewed by: rscheff, tuexen
  Differential Revision: https://reviews.freebsd.org/D41175

  (cherry picked from commit fafb03ab4254ab0d3927bc8ec22e4ba432efdbeb)


   sys/netinet/siftr.c | 73 ++++++++++++++++++++++++++++++++++++++++-------------
   1 file changed, 55 insertions(+), 18 deletions(-)

[commit e1eb82fb18446995359cffcb66162ec1f462ed88]
Date: 2026-01-12
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Userland.programs
Subject: wc: Fix usage and manual SYNOPSIS + nits
Review: The man:wc[1] utility now correctly documents that the -c and -m flags are mutually exclusive, and the manual page receives minor formatting fixes.
Body:

  The -c and -m flags are mututally exclusive. Also minor manual fixes:

  + Angle quotes do not work in prose, use double quote matching extant
  + Align manual page options list
  + Tag SPDX license identifier for manual

  PR:		292408
  MFC after:	3 days

  (cherry picked from commit 4cb65fde79a2412558d10fdbf3427fc0e4536d80)


   usr.bin/wc/wc.1 | 12 ++++++++----
   usr.bin/wc/wc.c |  2 +-
   2 files changed, 9 insertions(+), 5 deletions(-)

[commit 0ff1f587ffcde595010dcab31fbbd6bb4a4e6563]
Date: 2026-01-27
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: ip_mroute: EVENTHANDLER_REGISTER does not fail
Review: The commit removes EVENTHANDLER_REGISTER error handling in ip_mroute, but the message states 'No functional change intended', indicating no user-visible impact.
Body:

  No functional change intended.

  MFC after:	1 week
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.

  (cherry picked from commit 0f1e1350704af555a4b30136f5f3d16db6f2dc51)


   sys/netinet/ip_mroute.c | 6 ------
   1 file changed, 6 deletions(-)

[commit b0037260b73f405d7ae5140f50cd279c0a9a30cd]
Date: 2026-01-12
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: OPNsense | Klara, Inc.
Section: Network.general
Subject: in6: Modify address prefix lifetimes when updating address lifetimes
Review: The man:SIOCAIFADDR_IN6[4] ioctl now updates the prefix lifetime when modifying an existing IPv6 address's preferred and valid lifetimes. This ensures that the associated route remains consistent with the updated address lifetime.
Body:

  When one uses SIOCAIFADDR_IN6 to add a v6 address, it's possible to set
  the preferred and valid lifetimes of the address.  If the address
  already exists, this ioctl will recalculate and update the expiry times
  based on the provided timestamps.

  When adding a new address, the lifetimes are inherited by the prefix as
  well, but only if we create a new prefix.  If the prefix already exists,
  as it will in the case where an address is being updated rather than
  being added, we do not touch the prefix lifetimes at all.  This means
  that the original address lifetime still applies to the route associated
  with that prefix, so when the prefix expires, the route goes away.

  This behaviour doesn't make a lot of sense: if the admin updates an
  address lifetime, we should ensure that the prefix lifetime is updated
  too.  Make that change, ensuring that we do not shorten the prefix
  lifetime, as the prefix might be shared among multiple interface
  addresses.

  Add a regression test.

  Co-authored by:	Franco Fichtner <franco@opnsense.org>
  Reviewed by:	pouria, zlei, ae
  MFC after:	2 weeks
  Sponsored by:	OPNsense
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D54562

  (cherry picked from commit 74999aac5effb9b32d12f413ef51e87b15c8a0d8)


   sys/netinet6/in6.c        | 22 ++++++++++++++
   tests/sys/netinet6/ndp.sh | 76 +++++++++++++++++++++++++++++++++++++++++++++++
   2 files changed, 98 insertions(+)

[commit e676efa58239aee11cac81f041afed2f9e9ee928]
Date: 2026-01-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: OPNsense | Klara, Inc.
Section: undecided
Subject: in6: Add a helper function to compute expiry times
Review: No functional change; internal refactoring only.
Body:

  Tidy up a bunch of places that have the same duplicated logic.  Simplify
  callers of in6_init_prefix_ltimes().  No functional change intended.

  Reviewed by:	pouria, zlei, tuexen, glebius
  MFC after:	2 weeks
  Sponsored by:	OPNsense
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D54561

  (cherry picked from commit fb08f80eaf90eb7ace202d8604634fc181be8980)


   sys/netinet6/in6.c     | 23 +++++++++++++----------
   sys/netinet6/in6.h     |  2 ++
   sys/netinet6/nd6_rtr.c | 38 +++++++-------------------------------
   3 files changed, 22 insertions(+), 41 deletions(-)

[commit 8c1de31097763ce1d918a3f82c61fd8d30edbe75]
Date: 2025-09-16
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: https://www.patreon.com/cperciva
Section: Ports.packaging
Subject: release: Ship firmware from kmods repo on DVD
Review: Firmware packages from the kmods repository are now included on the release DVD, ensuring that firmware modules are compatible with the release kernel.
Body:

  The packages for X.Y-RELEASE are a snapshot of the quarterly branch
  for stable/X, i.e. typically built on X.(Y-1)-RELEASE.  (The case of
  Y=0 is an exception for obvious reasons.)  This works for most ports
  but not for kernel modules, which may need to be built on the release
  in question; this is why we have a separate "kmods" repository.

  Make sure that we put the packages from the kmods repository onto the
  mini-pkg-repo on the DVD rather than shipping unusable firmware.

  Reviewed by:	bz
  MFC after:	1 week
  Sponsored by:	https://www.patreon.com/cperciva
  Differential Revision:	https://reviews.freebsd.org/D52581

  (cherry picked from commit bda8028146694ee490543b35e3349e060936fde4)


   release/pkg_repos/release-dvd.conf |  7 +++++++
   release/scripts/pkg-stage.sh       | 25 ++++++++++++++++++-------
   2 files changed, 25 insertions(+), 7 deletions(-)

[commit 0e82cd099e2ab5ad8aa67f98fa4b8b430c23947c]
Date: 2025-07-29
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Network.general
Subject: ifconfig: fix removing IPv6 addresses
Review: The man:ifconfig[8] command now correctly removes IPv6 addresses when requested, fixing a previous bug that could leave addresses configured after removal.
Body:

  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit da50f49977cc4e6aae55cb2379313599249a8dd2)


   sbin/ifconfig/af_inet6.c     |  2 +-
   sbin/ifconfig/tests/inet6.sh | 30 ++++++++++++++++++++++++++++++
   2 files changed, 31 insertions(+), 1 deletion(-)

[commit 52ebb8a7d4f8c77b9dacdeef1dff3caec1394bea]
Date: 2023-08-25
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: ifconfig: fix 'ifconfig -l link'
Review: The ifconfig -l link command now correctly lists interfaces with link-level addresses when using rtnetlink(4).
Body:

  The rtnetlink(4) RTM_GETADDR does not list link level addresses, thus
  the correct match for interfaces that have a link level address should
  be based on what was returned by RTM_GETLINK.

  Reviewed by:		melifaro
  Differential Revision:	https://reviews.freebsd.org/D41586

  (cherry picked from commit 6f3947be2aff9350514b5a414104d0afaeb53cdf)


   sbin/ifconfig/ifconfig_netlink.c | 8 +++++++-
   1 file changed, 7 insertions(+), 1 deletion(-)

[commit 151dcad51394e841f1cf3e798e5cdb4dd8131949]
Date: 2023-08-25
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: ifconfig: fix 'ifconfig -l ether'
Review: The man:ifconfig[8] -l ether command now correctly lists lagg(4) ports as Ethernet interfaces, restoring historical behavior.
Body:

  When matching interfaces for being Ethernet, use same trick that
  the link module does - pass if_type through convert_iftype().
  That restores historicaly behaviour of listing lagg(4) ports.

  Reviewed by:		melifaro
  Differential Revision:	https://reviews.freebsd.org/D41585

  (cherry picked from commit 31016aa0be6dbf7556a91dda14cfe1ff0dcf933b)


   sbin/ifconfig/af_link.c          | 11 -----------
   sbin/ifconfig/ifconfig.h         |  2 ++
   sbin/ifconfig/ifconfig_netlink.c | 15 ++++++++++++++-
   3 files changed, 16 insertions(+), 12 deletions(-)

[commit 7bdf066ad2123709cd190dc7610c21c8bb4df5e4]
Date: 2023-08-25
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: ifconfig: fix logical error in interface matching for '-l ether'
Review: ifconfig(8) compiled without NETLINK support now correctly matches interfaces with the '-l ether' option.
Body:

  This affects only ifconfig(8) compiled WITHOUT_NETLINK_SUPPORT, which
  is not the default.

  Reviewed by:		melifaro
  Differential Revision:	https://reviews.freebsd.org/D41584
  Fixes:			d1cd0344f7b7d81beda04c3cb8cfee99351c3eb8

  (cherry picked from commit 24a81a968d21b3eef1a0a2d786859b274546bd34)


   sbin/ifconfig/ifconfig.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 0018cfdb91c399342a0facd04dfe72cb689d86ea]
Date: 2026-02-03
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Klara, Inc.
Section: undecided
Subject: libc/tests: Clean up *dir() tests
Review: Internal test cleanup with no user-visible impact.
Body:

  Mainly, avoid reusing the name of one of the functions we should be
  testing (but aren't) for local variables.

  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D55054

  (cherry picked from commit d70b9eb74fc4aa430bd2ff4bca37e6a9b6c8004f)


   lib/libc/tests/gen/dir2_test.c | 28 +++++++++++++---------------
   1 file changed, 13 insertions(+), 15 deletions(-)

[commit 77dedead8539c76d1f452c2c0073ee13ed7cf54a]
Date: 2026-02-02
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Klara, Inc.
Section: Userland.libraries
Subject: libc: Improve POSIX conformance of dirfd()
Review: The man:dirfd[3] function now sets errno to EINVAL and returns -1 when passed a null pointer or a directory stream with a negative file descriptor, improving POSIX conformance.
Body:

  POSIX states that dirfd() should set errno to EINVAL and return -1 if
  dirp does not refer to a valid directory stream.  Our interpretation is
  that this applies if dirp is null or the file descriptor associated
  with it is negative.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D55025

  (cherry picked from commit 5074d5c9845e142883cdbb9ad212be66e57615d0)

  libc: Fix missing include

  Although not needed on FreeBSD due to namespace pollution, we should
  technically #include <stddef.h> to secure a definition of NULL.

  Fixes:		5074d5c9845e ("libc: Improve POSIX conformance of dirfd()")
  (cherry picked from commit 1c00d5a3b234ef937d848956027e9de5ea8010f9)


   lib/libc/gen/directory.3 | 14 +++++++++++++-
   lib/libc/gen/dirfd.c     |  6 ++++++
   2 files changed, 19 insertions(+), 1 deletion(-)

[commit b614c9893fa38771075d1f329763a0151b53b86d]
Date: 2026-02-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Klara, Inc.
Section: undecided
Subject: libc: Clean up *dir() code
Review: Style fixes and manual page cleanup for directory-related functions; no user-visible changes.
Body:

  Fix style nits (mostly whitespace issues) and clean up the manual page.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D55024

  (cherry picked from commit 387ae6390534b6e9b48931840e7bc76eeb0b258d)


   lib/libc/gen/closedir.c  |  1 -
   lib/libc/gen/directory.3 | 78 +++++++++++++++++++++++++-----------------------
   lib/libc/gen/dirfd.c     |  3 --
   lib/libc/gen/fdopendir.c |  1 +
   lib/libc/gen/opendir.c   |  1 -
   lib/libc/gen/opendir2.c  |  1 -
   lib/libc/gen/rewinddir.c |  1 -
   lib/libc/gen/scandir.c   |  2 --
   lib/libc/gen/telldir.c   |  4 +--
   9 files changed, 43 insertions(+), 49 deletions(-)

[commit 98b041239c252d0c2433e5d412d74f90a235d0f2]
Date: 2025-07-09
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Klara, Inc. | Klara, Inc.
Section: Userland.libraries
Subject: opendir, readdir, telldir: Use the correct types.
Review: The opendir, readdir, and telldir functions now use correct types (size_t and off_t) instead of long, fixing potential issues on platforms where long differs from these types. This ensures consistent behavior and correct error handling in directory operations.
Body:

  Use either size_t or off_t (as appropriate) instead of long.

  Sponsored by:	Klara, Inc.
  Reviewed by:	kevans
  Differential Revision:	https://reviews.freebsd.org/D51210

  (cherry picked from commit 42e613018da50ee6877d24815c7626d79629e707)

  readdir: Fix error check.

  Now that dd_size is unsigned, we need to check if the return value from
  getdirentries() was negative before assigning it to dd_size.

  While here, simplify the scandir_error test case slightly, and verify
  that calling readdir() again after EOF still returns NULL.

  Fixes:		42e613018da5
  Sponsored by:	Klara, Inc.
  Reviewed by:	kevans
  Differential Revision:	https://reviews.freebsd.org/D51266

  (cherry picked from commit 920b2183919e430cf85c4aa1fa337bfded12aee5)


   lib/libc/gen/gen-private.h        |  4 ++--
   lib/libc/gen/opendir2.c           |  6 ++++--
   lib/libc/gen/readdir.c            | 11 +++++++----
   lib/libc/gen/telldir.c            |  4 ++--
   lib/libc/gen/telldir.h            |  6 +++---
   lib/libc/tests/gen/opendir_test.c |  1 +
   lib/libc/tests/gen/scandir_test.c | 12 +++++-------
   7 files changed, 24 insertions(+), 20 deletions(-)

[commit 9d7a0f817cef4c7d94fe584f3f85754996678ed4]
Date: 2025-07-08
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Klara, Inc.
Section: Userland.libraries
Subject: opendir, fdopendir: Add tests, clean up.
Review: The opendir() function no longer sets O_NONBLOCK, which may affect behavior when opening named pipes, but O_DIRECTORY ensures ENOTDIR is returned for non-directories.
Body:

  * Add test cases for opendir() and fdopendir().
  * Drop O_NONBLOCK from opendir(); it was added a long time ago to avoid
    blocking if given a closed named pipe, but now we use O_DIRECTORY,
    which ensures that we get ENOTDIR in that case.
  * While here, remove unused #includes left over from the split.

  Sponsored by:	Klara, Inc.
  Reviewed by:	kevans, markj
  Differential Revision:	https://reviews.freebsd.org/D51126

  (cherry picked from commit c08e019c6ce4fc637b195f1bb0878763c3fefe9e)


   lib/libc/gen/fdopendir.c          |   7 +-
   lib/libc/gen/opendir.c            |   7 --
   lib/libc/gen/opendir2.c           |   6 +-
   lib/libc/tests/gen/Makefile       |   1 +
   lib/libc/tests/gen/opendir_test.c | 144 ++++++++++++++++++++++++++++++++++++++
   5 files changed, 151 insertions(+), 14 deletions(-)

[commit b10a31f4e0f43857f63390a451857fb3c733e26f]
Date: 2025-07-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc.
Section: undecided
Subject: opendir: Simplify is_unionstack().
Review: Internal refactoring of opendir(3) implementation with no user-visible changes.
Body:

  Sponsored by:	Klara, Inc.
  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D51118

  (cherry picked from commit 5e96f4006d2e5f165531a53b6c1393a1c7604f42)


   lib/libc/gen/opendir2.c | 16 +++++++---------
   1 file changed, 7 insertions(+), 9 deletions(-)

[commit d2f8f53385b3f2b42e38c387cb1ccba4518167e9]
Date: 2025-06-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc.
Section: undecided
Subject: scandir: Code cleanup.
Review: Code cleanup with no user-visible impact.
Body:

  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D51050

  (cherry picked from commit 8ebc0768663b0ea9f78a0b8cffb93ee1684a9b08)


   lib/libc/gen/scandir.c | 24 +++++++++++++-----------
   1 file changed, 13 insertions(+), 11 deletions(-)

[commit 1a3c32bac0f029b0186bb856373fe3bcd2d5e18f]
Date: 2025-06-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Klara, Inc.
Section: Userland.libraries
Subject: scandir: Propagate errors from readdir().
Review: The man:scandir[3] function now returns an error if readdir() fails during directory scanning, discarding any partial results. This provides consistent error handling and prevents silent partial results.
Body:

  Currently, if `readdir()` fails, `scandir()` simply returns a partial
  result (or a null result if it fails before any entries were selected).
  There is no way within the current API design to return both a partial
  result and an error indicator, so err on the side of caution: if an
  error occurs, discard any partial result and return the error instead.

  MFC after:	1 week
  Reported by:	Maxim Suhanov <dfirblog@gmail.com>
  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D51046

  (cherry picked from commit 62e0f12f5104585b7346fee183e5c667b39ddbad)


   lib/libc/gen/scandir.3            | 32 +++++++++++++++++++-
   lib/libc/gen/scandir.c            | 12 ++++++--
   lib/libc/tests/gen/scandir_test.c | 63 +++++++++++++++++++++++++++++++++++++++
   3 files changed, 104 insertions(+), 3 deletions(-)

[commit 35f8b56a41230f5c0853c2e096af72e9e65fa0e5]
Date: 2025-06-23
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Klara, Inc. | Klara, Inc.
Section: Userland.libraries
Subject: libc: Rename fscandir{,_b}() to fdscandir{,_b}().
Review: The fscandir() and fscandir_b() functions are renamed to fdscandir() and fdscandir_b() to align with naming conventions like fdopendir(). The old names are removed without compatibility shims, affecting any code using the recently introduced functions.
Body:

  This seems to fit the pattern better (e.g. fdopendir()).

  I've added weak references to ease the transition, but since it's only
  been a few days, we can remove them (and the ObsoleteFiles entries for
  the manual pages) before we branch stable/15.

  Fixes:		deeebfdecab5
  Sponsored by:	Klara, Inc.
  Reviewed by:	kevans
  Differential Revision:	https://reviews.freebsd.org/D50980

  (cherry picked from commit 0a5b763d98b921f921243525ff25a70bbe00cfaa)

  libc: Finish removing fscandir{,_b}().

  These only existed for a few days before being renamed, so there's no
  reason to continue to carry compatibility shims for them.

  Fixes:		deeebfdecab5
  Sponsored by:	Klara, Inc.
  Reviewed by:	kevans
  Differential Revision:	https://reviews.freebsd.org/D50981

  (cherry picked from commit ccf937320a1a7383a2c33698007b7244f66dc022)


   include/dirent.h                         |  4 ++--
   lib/libc/gen/Makefile.inc                |  4 ++--
   lib/libc/gen/Symbol.map                  |  4 ++--
   lib/libc/gen/scandir.3                   | 28 ++++++++++++++--------------
   lib/libc/gen/scandir.c                   |  8 ++++----
   lib/libc/tests/gen/scandir_blocks_test.c | 12 ++++++------
   lib/libc/tests/gen/scandir_test.c        | 12 ++++++------
   usr.bin/diff/diffdir.c                   |  2 +-
   8 files changed, 37 insertions(+), 37 deletions(-)

[commit c7582d56d29f072b4b18c90569b596d2b37f6b12]
Date: 2025-06-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc.
Section: undecided
Subject: diff: Fix gcc build.
Review: The commit fixes a build issue with gcc, which is an internal development change without direct user-visible impact.
Body:

  Sponsored by:	Klara, Inc.

  (cherry picked from commit 28d9586cde8dc783f7b698b10c2b564fde14ae74)


   usr.bin/diff/diffdir.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit e8009e02e967618c58a033ace838561ba3400d38]
Date: 2025-06-20
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Klara, Inc.
Section: Userland.programs
Subject: diff: Detect loops when diffing directories.
Review: The diff utility now detects and reports loops when comparing directories, preventing infinite recursion.
Body:

  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D50936

  (cherry picked from commit 42092e1b6625b8226de5f34d22b9a96c713626cb)


   usr.bin/diff/diffdir.c          | 85 ++++++++++++++++++++++++++++++++++++-----
   usr.bin/diff/tests/diff_test.sh | 17 +++++++++
   2 files changed, 92 insertions(+), 10 deletions(-)

[commit 90c5d1b5f4238823414a82b72e7f80d9e83a3de6]
Date: 2025-06-20
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: Klara, Inc.
Section: Userland.libraries
Subject: scandir: Fix behavior when no entries match.
Review: The scandir(3) function now returns a non-null pointer to an empty array when no directory entries match the filter, restoring historical behavior.
Body:

  In the previous commit, I removed the initial initialization of the
  `names` array, not realizing that `scandir()` is expected to return
  a non-null (but empty) array of entries if no entries matched.
  Restore the historical behavior, document it, and add a test.

  Fixes:		deeebfdecab5
  Sponsored by:	Klara, Inc.
  Reviewed by:	kevans, allanjude, markj
  Differential Revision:	https://reviews.freebsd.org/D50949

  (cherry picked from commit c187b673bb79905b5d5db1eb34d5a893c4464eeb)


   lib/libc/gen/scandir.3            |  5 +++--
   lib/libc/gen/scandir.c            |  6 +++++-
   lib/libc/tests/gen/scandir_test.c | 22 ++++++++++++++++++++++
   3 files changed, 30 insertions(+), 3 deletions(-)

[commit 8b2062419c33c0f5b9b5d83f831bc7f54aff42a7]
Date: 2025-06-20
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Klara, Inc.
Section: Userland.libraries
Subject: libc: Add fscandir(), fscandir_b(), scandirat_b().
Review: Adds fscandir(), fscandir_b(), and scandirat_b() functions to libc, providing more flexible directory scanning with explicit memory allocation control. Updates the man:scandir[3] manual page accordingly.
Body:

  While here, clean up scandir() a bit and improve the documentation.

  MFC after:	never
  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D50935

  (cherry picked from commit deeebfdecab56729fa898271ae53d01c8e156302)


   include/dirent.h                         |  13 ++++
   lib/libc/gen/Makefile.inc                |   5 +-
   lib/libc/gen/Symbol.map                  |   3 +
   lib/libc/gen/scandir.3                   |  94 ++++++++++++++++++++++--
   lib/libc/gen/scandir.c                   | 101 +++++++++++++++++---------
   lib/libc/tests/gen/Makefile              |  10 +++
   lib/libc/tests/gen/scandir_blocks_test.c | 118 +++++++++++++++++++++++++++++++
   lib/libc/tests/gen/scandir_test.c        | 112 +++++++++++++++++++++++++++++
   8 files changed, 415 insertions(+), 41 deletions(-)

[commit 6b0a4d67a952e999c39ee21a5e50122b13a6d391]
Date: 2026-01-31
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: libc/resolv: Switch default to loopback address
Review: The default fallback resolver address changes from INADDR_ANY/IN6ADDR_ANY to the loopback address when no resolver configuration is found. This ensures that systems without a resolver configuration can still perform DNS lookups using a local resolver if one is running.
Body:

  If no resolver configuration was found, we would fall back to INADDR_ANY
  and IN6ADDR_ANY.  This made sense when it was first written thirty or
  forty years ago but not today, especially since connecting to INADDR_ANY
  or IN6ADDR_ANY is no longer supported.  Switch to the loopback address
  and simplify the code.

  Note that (as the pre-existing comment in the code states) running
  without a resolver configuration is not really supported.  Still, if
  we're going to have a hardcoded fallback, it might as well work.

  PR:		291790
  MFC after:	1 week
  Reviewed by:	kevans
  Differential Revision:	https://reviews.freebsd.org/D55011

  (cherry picked from commit 1538284a5fddfce546db678cb873b7edc6adb9ed)


   lib/libc/resolv/res_init.c | 67 ++++++++++++++++++----------------------------
   1 file changed, 26 insertions(+), 41 deletions(-)

[commit f2f6f1467b8530cb6fa454e86f94277bb18a7829]
Date: 2026-01-29
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: OVHcloud
Section: Userland.config
Subject: nuageinit: support fetching configuration on multiple iface
Review: The nuageinit script now attempts DHCP configuration on all available interfaces in parallel, allowing metadata fetching to proceed as soon as any interface succeeds. This improves reliability in environments where a VM has multiple network interfaces but only one provides DHCP and metadata access.
Body:

  On some environement a VM can be connected to multiple ifaces but only
  one will respond to dhcp and able to fetch the metadata.

  Launch the early dhclient on all available ifaces and as soon as one
  dhcp has successfully configured an iface, proceed with fetching the
  metadata.

  MFC After:	1 week
  Reported by:	mateusz.klejn@ovhcloud.com
  Tested by:	mateusz.klejn@ovhcloud.com
  Sponsored by:	OVHcloud

  (cherry picked from commit 90a7728cd8905cd26b90d06f7873df8bad43ae9a)


   libexec/rc/rc.d/nuageinit | 11 ++++++++---
   1 file changed, 8 insertions(+), 3 deletions(-)

[commit 6415be5503dbfae1dbd8a954c6a52a225fbfc284]
Date: 2026-01-31
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: cpufreq(4): Fix a typo in a source code comment
Review: Only a typo in a source code comment is fixed, with no user-visible impact.
Body:

  - s/transcation/transaction/

  (cherry picked from commit 0a3e7ba466376b46672b56c991c09cde528b9729)


   sys/powerpc/cpufreq/pcr.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c36e2278f4caaf22e55946f908927dcd46c479e4]
Date: 2026-01-31
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: ath_hal(4): Fix a typo in a source code comment
Review: Typo fix in a source code comment only; no user-visible impact.
Body:

  - s/arithmatic/arithmetic/

  (cherry picked from commit a17659fe260ce16c1e373b543ca9f13cc14340ea)


   sys/dev/ath/ath_hal/ar5211/ar5211_reset.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 484bf5a664c40a92b4f3acf9c81c57c62624c0c0]
Date: 2026-02-04
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: ifconfig: fix gre(4) status
Review: The man:ifconfig[8] utility now correctly displays GRE interface options.
Body:

  Set `ifr->ifr_name` to display gre options
  for the interface.

  Reviewed by: glebius, zlei
  Approved by: glebius (mentor)
  MFC after: 1 day
  Differential Revision: https://reviews.freebsd.org/D55099

  (cherry picked from commit c2ba906fa63982d7aa799466d83716d39fe91d2b)


   sbin/ifconfig/ifgre.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit edde7a7a9313c0590d8a371d9336ae2cc7369e62]
Date: 2026-01-28
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Bootloader.general
Subject: loader: Prefer comma-separated list of values for "console"
Review: The boot loader now uses a comma-separated list for the console variable, affecting configuration files in release tools.
Body:

  PR:		292595
  Reviewed by:	imp
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54923

  (cherry picked from commit 56970c3c4b0bc61d972837661a31cc2b9e8e8d7c)


   release/tools/azure.conf     | 2 +-
   release/tools/openstack.conf | 2 +-
   stand/efi/loader/main.c      | 4 ++--
   stand/i386/loader/main.c     | 4 ++--
   4 files changed, 6 insertions(+), 6 deletions(-)

[commit 3cfe90545f016fa190158aa4830f3256e01a7cb2]
Date: 2026-02-02
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: e1000: Fix setting the promiscuous mode
Review: The e1000 driver now correctly disables VLAN hardware filtering when promiscuous mode is enabled, ensuring all tagged and untagged packets are accepted as expected.
Body:

  The variable reg_rctl stores the value read from reg E1000_RCTL. It
  may contain bits E1000_RCTL_VFE and E1000_RCTL_CFIEN which control
  VLAN hardware filter feature. The promiscuous mode implies all tagged
  or untagged packets should be accepted, so the VLAN hardware filter
  feature should be disabled when enabling the promiscuous mode.
  Calling em_if_vlan_filter_disable() did the task, but later writing
  the value of reg_rctl back to the reg E1000_RCTL may restore the
  feature.

  Move the calling of em_if_vlan_filter_disable() after writing the reg
  to fix that.

  PR:		292759
  Reviewed by:	kbowling
  Tested by:	vova@zote.me
  Fixes:		2796f7cab107 e1000: Fix up HW vlan ops
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D54973

  (cherry picked from commit e63ee5fedb8dab51f1bd6d24cc650b68d9663db5)
  (cherry picked from commit 8880678b7a47ccfdcc14d3e7cad7f137862dccea)


   sys/dev/e1000/if_em.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b5e328b194561a50a6991e0a506a2532eec32ecc]
Date: 2025-12-29
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Userland.programs
Subject: cron: Implement full PAM session lifecycle for user jobs
Review: cron now implements full PAM session lifecycle for user jobs, allowing PAM modules to establish credentials and export environment variables before job execution. Administrators can configure session modules in /etc/pam.d/cron to customize the environment.
Body:

  Extend PAM integration beyond account checks to include credential
  establishment and session management, allowing PAM modules to configure
  the execution environment for user cron jobs.

  Previously, cron only called pam_acct_mgmt() to verify account validity
  but immediately terminated the PAM handle before job execution. This
  prevented PAM modules from establishing sessions, setting credentials
  (e.g., Kerberos tickets), or exporting environment variables needed by
  jobs.

  The PAM handle now persists in the intermediate process throughout the
  job execution, enabling proper session open/close pairing. Credentials
  are established and sessions opened while still running as root, before
  dropping privileges in the grandchild. PAM environment variables are
  exported in the job process with user crontab variables taking precedence.

  A session rule (pam_permit.so) is added to /etc/pam.d/cron to enable
  session support without changing default behavior. Administrators can
  replace this with other modules as needed.

  System crontab entries continue to bypass all PAM operations.

  PR:		bin/244844
  Reviewed by:	des
  Differential Revision: https://reviews.freebsd.org/D54415

  (cherry picked from commit 12444a4da514e91fdf984b31e1691d042d5f88d2)


   lib/libpam/pam.d/cron           |   3 +
   usr.sbin/cron/cron/do_command.c | 144 ++++++++++++++++++++++++++++++++++++++--
   2 files changed, 142 insertions(+), 5 deletions(-)

[commit 2255b09a75b73d32a8ef27d3935e8fa2c492d872]
Date: 2026-01-31
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: heimdal: Add missing function prototypes
Review: The commit adds missing function prototypes to fix build failures with GCC 14, which affects users compiling Heimdal on stable/14.
Body:

  This fixes the build with GCC 14 on stable/14 which raises fatal
  -Wimplicit-function-declaration warnings.

  Reviewed by:	rmacklem, cy
  Fixes:		5000d023a446 ("heimdal-kadmin: Add support for the -f dump option")
  Differential Revision:	https://reviews.freebsd.org/D54931

  (cherry picked from commit 8a8dc73ef87b538c369abc1b642e2a40b52c53c2)


   crypto/heimdal/lib/hdb/hdb-private.h | 12 ++++++++++++
   1 file changed, 12 insertions(+)

[commit 56b9de5484bc035304290d83fb2dc92d55b98eb4]
Date: 2026-02-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: jail: separate "statically valid allow flags" from "prison0 allow flags"
Review: The commit refactors internal flag definitions for jails to separate static validation from default prison0 flags, but does not introduce any user-visible changes, new features, or configuration impacts.
Body:

  The current setup means that we can't add an allow flag in sys/jail.h
  that's disabled by default without removing it from the pr_flags
  assignment in kern_jail.c.  That's technically fine, but I think it's
  better to make it more prevalent at the PR_ALLOW_* definition site so
  that it's top-of-mind when adding a new flag.

  This is a preparatory change for adding an allow flag that prison0 will
  also have disabled by default, but with an allow.* knob and sysctl to
  enable it.

  Reviewed by:	jamie

  (cherry picked from commit 58c92776d1580717934e29ca2c0ef9bf2fbb7397)


   sys/kern/kern_jail.c | 5 ++++-
   sys/sys/jail.h       | 8 ++++++++
   2 files changed, 12 insertions(+), 1 deletion(-)

[commit 1cd151e7bdff43a5fcf560aeb8ec66b1793de4ce]
Date: 2026-01-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: METALOG: Order keyword entries
Review: No user-visible change; internal build system ordering only.
Body:

  To facilitate comparison with mtree -C generated output, keep the
  keywords ordered.

  No functional change intended.

  Reviewed by:	imp
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54872

  (cherry picked from commit fe962e33d86f888b496b17251c8bedebf92be8ee)


   lib/libc/gen/Makefile.inc       | 6 +++---
   sys/conf/kmod.mk                | 2 +-
   sys/modules/Makefile            | 2 +-
   usr.sbin/services_mkdb/Makefile | 2 +-
   4 files changed, 6 insertions(+), 6 deletions(-)

[commit 7621b6eded126daae08d356a19457a069fc274e2]
Date: 2025-10-20
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: mrsas: Migrate to use macro LINUX_IOCTL_SET to register linux ioctl handler
Review: The mrsas driver now uses a macro for registering its Linux ioctl handler, which is an internal refactoring without user-visible impact.
Body:

  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D53158

  (cherry picked from commit 0a2fb63b4954c540686d387254b65cc6878bd19e)
  (cherry picked from commit 3aa4ae2006b50018d9dfa660bcbba1041c104ee1)


   sys/dev/mrsas/mrsas_linux.c | 10 +---------
   1 file changed, 1 insertion(+), 9 deletions(-)

[commit 44dfede815d802a7cda74939719263da31c35bf1]
Date: 2025-10-20
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: mfi: Migrate to use macro LINUX_IOCTL_SET to register linux ioctl handler
Review: The commit refactors internal ioctl registration to use a macro, which is an implementation detail with no user-visible impact.
Body:

  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D53158

  (cherry picked from commit d12ce84b0d338958b26f6eec86b4967fca8d3bd6)
  (cherry picked from commit 270b9f2a4888b19b8434a831effa3c8426dbb934)


   sys/dev/mfi/mfi_linux.c | 10 +---------
   1 file changed, 1 insertion(+), 9 deletions(-)

[commit 9280324325f3a84d66257b8a43141b3db515d071]
Date: 2025-10-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ipmi: Migrate to use macro LINUX_IOCTL_SET to register linux ioctl handler
Review: The commit refactors internal ioctl registration using a macro, which is an internal implementation detail without user-visible impact.
Body:

  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D53158

  (cherry picked from commit cb0116af7ac794238b0fa569f2722607924fcad6)
  (cherry picked from commit 0b0ddadf39f6499e4b8ef250023b6d7e68c7e2b0)


   sys/dev/ipmi/ipmi_linux.c | 10 +---------
   1 file changed, 1 insertion(+), 9 deletions(-)

[commit 352c1e0f172a4393fa56733e15f7be2ad62c1a84]
Date: 2025-10-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: aacraid: Migrate to use macro LINUX_IOCTL_SET to register linux ioctl handler
Review: The aacraid driver's Linux ioctl handler registration is updated to use a common macro, which is an internal refactoring with no user-visible impact.
Body:

  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D53158

  (cherry picked from commit ff29e5bc53e6fafc49d1caceed88cbc9e9223189)
  (cherry picked from commit e5d4314fce5a8c1dcc8a01f41858fa115d4f2fb6)


   sys/dev/aacraid/aacraid_linux.c | 10 +---------
   1 file changed, 1 insertion(+), 9 deletions(-)

[commit d6bc614eac5a10b7e157892d84f52599b373db38]
Date: 2025-10-20
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: aac: Migrate to use macro LINUX_IOCTL_SET to register linux ioctl handler
Review: The aac driver's Linux ioctl handler registration now uses a common macro, which is an internal refactoring without user-visible impact.
Body:

  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D53158

  (cherry picked from commit db1844a0e1bcafeb974215033ed682e7fa18cac8)
  (cherry picked from commit 7e9fe8e6a1966f559b7985caca7e7c0e19a3f10e)


   sys/dev/aac/aac_linux.c | 10 +---------
   1 file changed, 1 insertion(+), 9 deletions(-)

[commit e36e17552cdf374353b0c09c0ccdece2a7f614e0]
Date: 2025-10-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sgx: Migrate to use macro LINUX_IOCTL_SET to register linux ioctl handler
Review: The commit refactors internal ioctl registration for the SGX subsystem to use a macro, which is an implementation detail with no user-visible impact.
Body:

  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D53158

  (cherry picked from commit 8350f46d9808e6183d5f6bd4aa73d4d4e563b574)
  (cherry picked from commit 957babc65d9f9a5d44fefb0c1169682ae599954b)


   sys/amd64/sgx/sgx_linux.c | 11 +----------
   1 file changed, 1 insertion(+), 10 deletions(-)

[commit 5004b384a6571c7abbcd0bc64bbc60a08ac72557]
Date: 2025-10-20
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: linux: Make the macro LINUX_IOCTL_SET public
Review: The commit moves a macro and renames a declaration for internal driver consistency, with no direct user-visible impact.
Body:

  There're some other drivers want to register and unregister linux
  ioctl handler. Move the macro LINUX_IOCTL_SET from tdfx_linux.h to
  linux_ioctl.h so that they can also benefit it.

  While here, rename the declaration of linux ioctl function to be
  consistent with the name of the handler.

  Meanwhile, drop a comment about the macro, since its function is
  obvious.

  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D53158

  (cherry picked from commit 790c27317ec1a997a4e5c2bdee9e4acc610c8e3c)
  (cherry picked from commit 087e77b52399b8a64bb7a12979322d6027bf550b)


   sys/compat/linux/linux_ioctl.h | 12 ++++++++++++
   sys/dev/tdfx/tdfx_linux.c      |  2 +-
   sys/dev/tdfx/tdfx_linux.h      | 12 ------------
   3 files changed, 13 insertions(+), 13 deletions(-)

[commit ea2d344362867b22a1a13b2af984570d93a49687]
Date: 2026-01-26
Score: 5
Status: proposed(include=no,score=20)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: native-xtools: use static LLVM libraries
Review: The native-xtools target now uses static LLVM libraries to avoid a build failure during cross-compilation.
Body:

  Set the MK_LLVM_LINK_STATIC_LIBRARIES knob to "yes" when building the
  native-xtools target. This reverts to the behaviour prior to
  2e47f35be5dc.

  This avoids a build failure that occurs otherwise, where compilation
  fails looking for a libllvmprivate.so that was not built.

  It is unclear if this addresses the issue in all instances---some
  replies in the PRs indicate otherwise. Still, some report success, and
  in my own testing this fixed creation of a cross-compiled poudriere
  jail. Commit this while we continue to investigate...

  PR:		286710, 291409
  Tested by:	marck, rdunkle@smallcatbrain.com
  Reviewed by:	emaste
  MFC after:	3 days
  Fixes:	2e47f35be5dc ("Convert libllvm, libclang and liblldb into private shared libraries").
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D54815

  (cherry picked from commit 38e5564ecef53064c984d086a040c01100023f40)


   Makefile.inc1 | 1 +
   1 file changed, 1 insertion(+)

[commit 201f968de84dad8c28bfa5262854608e7001f49d]
Date: 2026-01-31
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: timer KPI *_timer -> timer_* (restore symbols)
Review: The commit restores missing symbols for the LinuxKPI timer KPI to fix kernel module compatibility, affecting modules like drm-kmod that rely on these symbols.
Body:

  In c84bfaa2531870a023fa9b267a765b9518ed3350 the symbols for the old
  timer KPI were removed and replaced by inline functions as backup.

  This breaks kernel modules (such as drm-kmod, though for that there
  should be a rebuild in the package repo given a __FreeBSD_version
  bump) as symbols are missing now.  Restore the symbols for the stable
  branch.

  This is a direct commit for the fix.

  Reported by:	nyan
  Reviewed by:	nyan
  Fixes:		c84bfaa25318
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D55027


   sys/compat/linuxkpi/common/include/linux/timer.h | 14 ++------------
   sys/compat/linuxkpi/common/src/linux_compat.c    | 12 ++++++++++++
   2 files changed, 14 insertions(+), 12 deletions(-)

[commit 21d665d7dd9e50e3975b117a4f3c0f50ed7bd642]
Date: 2025-11-17
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Userland.programs
Subject: sh: Fix job pointer invalidation with trapsasync
Review: Fixes a race condition in the shell's job control that could cause a crash when asynchronous traps are triggered.
Body:

  Calling dotrap() can do almost anything, including reallocating the
  jobtab array. Convert the job pointer to an index before calling
  dotrap() and then restore a proper job pointer afterwards.

  PR:		290330
  Reported by:	bdrewery
  Reviewed by:	bdrewery
  Differential Revision:	https://reviews.freebsd.org/D53793

  (cherry picked from commit f44ac8cc9c10d7305223a10b8dbd8e234388cc73)


   bin/sh/jobs.c                   | 6 +++++-
   bin/sh/tests/execution/Makefile | 1 +
   bin/sh/tests/execution/bg14.0   | 9 +++++++++
   3 files changed, 15 insertions(+), 1 deletion(-)

[commit c0dcdc3decb413af6188da624b22aa6b45126317]
Date: 2025-11-15
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: sh: Fix a double free in a rare scenario with pipes
Review: Fixes a double-free crash in man:sh[1] when waiting for a pipeline job identified by % syntax under specific background job conditions.
Body:

  The command
    sh -c 'sleep 3 | sleep 2 & sleep 3 & kill %1; wait %1'
  crashes (with appropriate sanitization such as putting
  MALLOC_CONF=abort:true,junk:true in the environment or compiling with
  -fsanitize=address).

  What happens here is that waitcmdloop() calls dowait() with a NULL job
  pointer, instructing dowait() to freejob() if it's a non-interactive
  shell and $! was not and cannot be referenced for it. However,
  waitcmdloop() then uses fields possibly freed by freejob() and calls
  freejob() again.

  This only occurs if the job being waited for is identified via % syntax
  ($! has never been referenced for it), it is a pipeline with two or more
  elements and another background job has been started before the wait
  command. That seems special enough for a bug to remain. Test scripts
  written by Jilles would almost always use $! and not % syntax.

  We can instead make waitcmdloop() pass its job pointer to dowait(),
  fixing up things for that (waitcmdloop() will have to call deljob() if
  it does not call freejob()).

  The crash from
  https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=290330#c2 appears to
  be the same bug.

  PR:		290330
  Reported by:	bdrewery
  Reviewed by:	bdrewery
  Differential Revision:	https://reviews.freebsd.org/D53773

  (cherry picked from commit 75a6c38e4d5c651b7398bf2bea5baa41a0939e92)


   bin/sh/jobs.c                  | 3 ++-
   bin/sh/tests/builtins/Makefile | 1 +
   bin/sh/tests/builtins/wait11.0 | 6 ++++++
   3 files changed, 9 insertions(+), 1 deletion(-)

[commit fdbb6759aa4f45e884f4c8af7c965ab8f33cf4d3]
Date: 2026-01-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Account for the ctl test needing the ctl(4) module
Review: The commit adds a module requirement for a test case, which is an internal test infrastructure change with no user-visible impact.
Body:

  This testcase does not function unless the /dev/ctl/... node exists,
  which is created by the ctl(4) module. Require the ctl(4) module to be
  loaded so the test can be executed.

  MFC after: 1 week
  Differential Revision:	https://reviews.freebsd.org/D54518

  (cherry picked from commit da59b3147b01203bb18bcd03cce7a6d5916e87c3)


   tests/sys/fs/fusefs/Makefile | 3 +++
   1 file changed, 3 insertions(+)

[commit 490474e84f7d9b1e190b6dc60ad0bb8b030d6caf]
Date: 2025-09-09
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: freebsd-update: sort options alphabetically
Review: Sorts command-line options alphabetically in the freebsd-update script, which does not affect user-visible behavior.
Body:

  This helps future developers when adding additional options handlers in the
  surrounding blocks.

  This is effectively a no-op.

  MFC after:	1 month

  (cherry picked from commit 0adec3d7ec96105c402ff2286e402ad63c845066)


   usr.sbin/freebsd-update/freebsd-update.sh | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 58cf2a2840532208ab1442fc421ca6c985274c2c]
Date: 2025-11-06
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: sys/net/sff8436.h: Fix the register address of link length of copper or active cable
Review: Fixes the register address for link length of copper or active cable in the SFF-8436 header to match the specification.
Body:

  The register address of link length of copper or active cable is 146 as
  per the SFF-8436 specification [1].

  [1] 7.6.2 Upper Memory Map Page 00h SFF-8436 Specification (pdf): https://members.snia.org/document/dl/25896

  Reviewed by:	imp, zlei
  MFC after:	1 week
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1885
  Closes:		https://github.com/freebsd/freebsd-src/pull/1885

  (cherry picked from commit a537694b49f719d84e3a69a2b8a3098f603da7d7)
  (cherry picked from commit fdd23fc3d0aacd1c80d0565d736591521b2421fc)


   sys/net/sff8436.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a1828b1226fe8de1325a0e46ec5732268ba4525a]
Date: 2025-12-29
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: qlnxe: Avoid out-of-bounds reading the multicast ethernet address
Review: The qlnx driver no longer reads beyond the multicast Ethernet address buffer, preventing potential kernel instability.
Body:

  The correct length of an ethernet address is ETHER_ADDR_LEN but not
  ETHER_HDR_LEN.

  MFC after:	1 week

  (cherry picked from commit 85f499be90c15a3de02d1c62ce03b99fab52f925)
  (cherry picked from commit 2b01cc15447251862f5e25332fcbf41516f22a3e)


   sys/dev/qlnx/qlnxe/qlnx_os.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit c4e33387d079266cd6cd8ba03047579da536330a]
Date: 2025-12-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: locking.9: Tweak the table column width to fit 80 characters
Review: Minor formatting adjustments to the man:locking[9] manual page do not constitute a user-visible change.
Body:

  While here, add some white spaces to improve the readability of source
  code.

  Reviewed by:	ziaee, #manpages
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54121

  (cherry picked from commit 176075e661fc657845d788ab3451e690c4e9bac6)
  (cherry picked from commit 14484cdb997c152def089c64a012b5a4596e1bfa)


   share/man/man9/locking.9 | 14 +++++++-------
   1 file changed, 7 insertions(+), 7 deletions(-)

[commit e8de565f6bb8d91e2882ae5422b8a4a0337e4ca4]
Date: 2025-12-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: lio: Avoid out-of-bounds read or write MAC address
Review: The commit fixes a potential out-of-bounds read or write of a MAC address in the liquidio driver, which could affect system stability or security for users of this hardware.
Body:

  While here, replace loop copying the MAC address with memcpy() for
  better readability.

  Reviewed by:	markj
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54177

  (cherry picked from commit 094626d3a5009a56bf1b763dbdfc681ce371dc99)
  (cherry picked from commit c162d7febbc83c1d877876b18ee864213dceca51)


   sys/dev/liquidio/lio_ioctl.c |  4 ++--
   sys/dev/liquidio/lio_main.c  | 10 ++++------
   2 files changed, 6 insertions(+), 8 deletions(-)

[commit d88ccbddc7c7426b8956b27d9335ce503815d24e]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: x86/xen: Use proper prototype for SYSINIT functions
Review: The commit fixes a prototype mismatch in SYSINIT functions for Xen APIC support, which resolves a compiler warning but does not introduce user-visible changes.
Body:

  MFC after:	1 week

  (cherry picked from commit c8e077e57b2535b840d391f3217d00465b0514c4)
  (cherry picked from commit 871a335f3e7dcc8edcada353664ca6b40ae491a1)


   sys/x86/xen/xen_apic.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit db22431755f73cfd8597a929a04e3b9301170bfa]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: tsc: Use proper prototype for SYSINIT functions
Review: The commit changes a function prototype for internal consistency but does not introduce any user-visible changes.
Body:

  MFC after:	1 week

  (cherry picked from commit bf8f6545f6ca41e080cc3bc42009bdf253f596b4)
  (cherry picked from commit 81676635bad7e4cec1fee8ab52f1401f37de3d69)


   sys/x86/x86/tsc.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit db80c07267892c7d74e395c171ccfb64f61963e5]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: powerpc: Use proper prototype for SYSINIT functions
Review: The commit fixes function prototypes for SYSINIT functions on powerpc, which is an internal change with no direct user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 9caa16bd028746af7bee01c6bcc6394de91265db)
  (cherry picked from commit 4ccfafac43d398653574e36082fef15083ba6a35)


   sys/powerpc/aim/mmu_oea64.c | 4 ++--
   sys/powerpc/cpufreq/pmcr.c  | 3 ++-
   2 files changed, 4 insertions(+), 3 deletions(-)

[commit 8b07da3ba41d71fece01e2ef5d578b2a1bc078f9]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: i386: Use proper prototype for SYSINIT functions
Review: The commit fixes function prototypes in i386-specific kernel code, which is an internal change with no user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 0039721e3bab22446413fb62532e622345770ffb)
  (cherry picked from commit adc937e06f69b2fd21c44e27b5c33bf2c96e7c4d)


   sys/i386/i386/machdep.c | 2 +-
   sys/i386/i386/pmap.c    | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit 13a9caf59ac385a8f465c32437dd981af18bf076]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: arm64 coresight: Use proper prototype for SYSINIT functions
Review: The commit fixes a prototype mismatch in SYSINIT functions for the arm64 coresight driver, which is an internal kernel implementation detail with no direct user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 5d5ba0c0fa9e2eaeda9d41508bb0f83d5a55f367)
  (cherry picked from commit bac2bad0615ac64960f1ae93c0e7c3d9277b1a6b)


   sys/arm64/coresight/coresight.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 9ddec7bde2b1f65e8347d8b1b550d4e7f80037ba]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: arm: Use proper prototype for SYSINIT functions
Review: This commit changes internal function prototypes to match SYSINIT expectations, which is a code cleanup with no user-visible impact.
Body:

  The only possible return value of function module_info_init() is 0. Make
  it return void to match the prototype of SYSINIT.

  MFC after:	1 week

  (cherry picked from commit 0b9c12fa976446705635a94984f45232f034eecf)
  (cherry picked from commit fcdc37febbb6b6c4efb7f4f42162466992f90523)


   sys/arm/arm/pmap-v6.c | 2 +-
   sys/arm/arm/unwind.c  | 4 +---
   2 files changed, 2 insertions(+), 4 deletions(-)

[commit 2a87a2c911e1f1e8c4d94f929a662bf93979d587]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vm: Use proper prototype for SYSINIT functions
Review: The commit only changes function prototypes for internal SYSINIT functions with no user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit a5d5851c86ebba87f580e4f9bada495ebeedc465)
  (cherry picked from commit 27b24359656a3d30828595ade1b824be3fac4f83)


   sys/vm/vm_meter.c   | 2 +-
   sys/vm/vm_pageout.c | 4 ++--
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 8f6cd5b69a10df72b7749531bc9bcb684931233c]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sys/sysent.h: Remove an unneeded type cast
Review: Internal kernel header cleanup with no user-visible impact.
Body:

  The function exec_sysvec_init() already has the right prototype.

  While here, remove an extra semicolon from the macro INIT_SYSENTVEC.

  MFC after:	1 week

  (cherry picked from commit 296db8c72dca1c17d9a4ce94cc8881e48df8187b)
  (cherry picked from commit 64771eeaf82f06c2af4e0f20f40baa9d5103f0dd)


   sys/sys/sysent.h | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit bddd70611a0fceb6a89acaa7955cb46755107a33]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: MAC: Use proper prototype for SYSINIT functions
Review: The commit updates function prototypes for internal SYSINIT functions in the MAC framework, which is a code style fix with no user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 12ac59a0d1f6ae2065e8e2cb36c53c00771bfc74)
  (cherry picked from commit 2e5a55c7af56022fb38e3d528b2e8b1257de891d)


   sys/security/mac/mac_framework.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 139a9451b9105cad9ccb0b8e4eda91d9cbc40b69]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: audit: Use proper prototype for SYSINIT functions
Review: The commit fixes a prototype for internal SYSINIT functions, which is a code style or internal build fix without any user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 32c1e940e07c48ab80427efd3d6ff2091407d577)
  (cherry picked from commit c48a31e3508555606b4399d33000cf60fe98e207)


   sys/security/audit/audit.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 01af376bd00cb7d367e1c1ec8fc45a6fb8a6f812]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: nfs: Use proper prototype for SYSINIT functions
Review: The commit fixes a prototype for internal SYSINIT functions, which is a code cleanup without user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit a06ecc4f70c296f62f666421c3cf9643d40bdca2)
  (cherry picked from commit 0e001bef1593c1bcc6c020b0f7a31ce9589ba59e)


   sys/nfs/nfs_diskless.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a60c8710de4f7e1f752b8640734871efe3fde65a]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: pf: Use proper prototype for SYSINIT functions
Review: The commit changes function prototypes for internal SYSINIT functions in the pf subsystem, which is an internal code cleanup with no user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 0ce8c20fcd44c1595b42fcb540913d3802edd438)
  (cherry picked from commit 34462748d79a6e2ea8215564286f97e93670dfbb)


   sys/netpfil/pf/pf_ioctl.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 846393be8cf83081b56ca77dd6c4a3c3ddbbe5c5]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ipfw: Use proper prototype for SYSINIT functions
Review: The commit changes internal function prototypes for SYSINIT to match the expected signature, which is a code cleanup without any user-visible impact.
Body:

  The only possible return value of function ipfw_init() is 0. Make it
  return void to match the prototype of SYSINIT.

  MFC after:	1 week

  (cherry picked from commit 1bba2194c8a960235f8eae36e7d3e96f347ce779)
  (cherry picked from commit 745b6ca4ed933f9f4c1d314dc7b0aa31e8e9e0de)


   sys/netpfil/ipfw/ip_fw2.c    | 9 +++------
   sys/netpfil/ipfw/ip_fw_nat.c | 4 ++--
   2 files changed, 5 insertions(+), 8 deletions(-)

[commit db75edf2b61e76425b69a997b8d0445a92cb76f1]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: netipsec: Use proper prototype for SYSINIT functions
Review: The commit changes function prototypes for internal SYSINIT functions in the IPsec IPCOMP module, which is an internal kernel implementation detail with no direct user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 360bb45690d918fac5bae78ab44f45d11327067a)
  (cherry picked from commit a32ee2897f8eed4a03976be65020912f03f7228e)


   sys/netipsec/xform_ipcomp.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 0871d691e3894bc8862ce8a8e94cc8b878bed77d]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: netinet6: Use proper prototype for SYSINIT functions
Review: The commit fixes a function prototype mismatch in the IPv6 routing algorithm initialization, which may affect kernel compilation and stability for users building custom kernels.
Body:

  MFC after:	1 week

  (cherry picked from commit d4a80fa271b148b269869e5ca34e1861d9fcdfb0)
  (cherry picked from commit cfc237162c248d0488e264bf1fdae0186c5a13c1)


   sys/netinet6/in6_fib_algo.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 72bf99e08beaade47ff4a748c8c54644446cb979]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: netinet: Use proper prototype for SYSINIT functions
Review: The commit fixes function prototypes for SYSINIT functions in the networking stack, which is an internal change with no direct user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 6613b6ad1ecc5384c119018b9b27c18bd7516e3f)
  (cherry picked from commit 5b41be5cc0666372840d798507e85544d8a3e7c3)


   sys/netinet/cc/cc.c       | 2 +-
   sys/netinet/in_fib_algo.c | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit a7334aec0762c349fdab7e74ffd4b9ba25d4095d]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: net80211: Use proper prototype for SYSINIT functions
Review: The commit fixes internal function prototypes in the net80211 subsystem, which is a code cleanup without user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 7449e59110b8abbb3d647c3565ca3de1d21b2c84)
  (cherry picked from commit 0270d3dfa75a462019d7d8555c4249b3e8790604)


   sys/net80211/ieee80211_ht.c    | 2 +-
   sys/net80211/ieee80211_hwmp.c  | 2 +-
   sys/net80211/ieee80211_mesh.c  | 2 +-
   sys/net80211/ieee80211_phy.c   | 2 +-
   sys/net80211/ieee80211_proto.c | 2 +-
   sys/net80211/ieee80211_vht.c   | 2 +-
   6 files changed, 6 insertions(+), 6 deletions(-)

[commit ea3567e3bf79a859418b8127db8707a6e8c6130c]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: net: Use proper prototype for SYSINIT functions
Review: The commit fixes function prototypes for SYSINIT functions in the networking subsystem, which is an internal change with no direct user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 6f8259eae61981d7e5d049be7eed9235f0e8172e)
  (cherry picked from commit fa80382b99f934ab46b9365d1081c6425ed58026)


   sys/net/route.c              | 2 +-
   sys/net/route/route_tables.c | 2 +-
   sys/net/rtsock.c             | 2 +-
   3 files changed, 3 insertions(+), 3 deletions(-)

[commit 5d1cf19810bb46afe3ed487a71971a2163f710d8]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libkern: Use proper prototype for SYSINIT functions
Review: The commit changes internal function prototypes in libkern without any user-visible impact, such as behavior changes, new features, or configuration adjustments.
Body:

  MFC after:	1 week

  (cherry picked from commit 850a88e8db761c55b9aa56c2cf4da258dc61dec5)
  (cherry picked from commit 2b27541988072b3c1e5f2f901e622f38af0be4c9)


   sys/libkern/arc4random.c      | 4 ++--
   sys/libkern/x86/crc32_sse42.c | 4 +++-
   2 files changed, 5 insertions(+), 3 deletions(-)

[commit 5f6c2ab28f6c3aa2fde2f77e3769e28e2a40e5ed]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: jail: Use proper prototype for SYSINIT functions
Review: The commit changes internal function prototypes for jail sysinit functions to return void, which is an implementation detail with no user-visible impact.
Body:

  The only possible return value of function jm_sysinit() and jm_sysuninit()
  is 0. Make them return void to match the prototype of SYSINIT.

  MFC after:	1 week

  (cherry picked from commit a988393b469be58ff87f4d044af61fd2251b490c)
  (cherry picked from commit 20af9193776df39331d5287a4a8b22de6d665c8f)


   sys/kern/kern_jailmeta.c | 8 ++------
   1 file changed, 2 insertions(+), 6 deletions(-)

[commit cc6e893745521279e09356cf517a3f57f7125b53]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kern_sharedpage.c: Remove an unneeded type cast
Review: Internal kernel cleanup with no user-visible impact.
Body:

  The function shared_page_init() already has the right prototype.

  MFC after:	1 week

  (cherry picked from commit 141b44e0afc2912a0a1c7bbb4116921ead1d58d4)
  (cherry picked from commit 6e8b07298065f0f6354779de9b787e7a5ecb09cd)


   sys/kern/kern_sharedpage.c | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit bec38564142e5a3d357c7405831c1145ff610842]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kern: Use proper prototype for SYSINIT functions
Review: The commit changes function prototypes for SYSINIT functions across several kernel files, which is an internal refactoring without user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 9c35c4470ad131c748efba7f64ad2fff7d21060f)
  (cherry picked from commit 5b8848866f2f709a6bda8c50306a663100157b42)


   sys/kern/kern_boottrace.c | 2 +-
   sys/kern/kern_devctl.c    | 2 +-
   sys/kern/kern_event.c     | 4 ++--
   sys/kern/kern_linker.c    | 2 +-
   sys/kern/kern_malloc.c    | 2 +-
   sys/kern/kern_racct.c     | 4 ++--
   sys/kern/kern_rangelock.c | 2 +-
   sys/kern/kern_rctl.c      | 4 ++--
   sys/kern/kern_sig.c       | 4 ++--
   sys/kern/kern_time.c      | 4 ++--
   sys/kern/subr_pcpu.c      | 2 +-
   sys/kern/sys_socket.c     | 2 +-
   12 files changed, 17 insertions(+), 17 deletions(-)

[commit 70150f0cb7b2e5f8fdcf39338c160cd2aa95f979]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: p9fs: Use proper prototype for SYSINIT functions
Review: The commit changes a function prototype for SYSINIT functions in the p9fs filesystem, which is an internal kernel implementation detail without user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 11cfa861e3ff83649c54e5781b541166dc73e80b)
  (cherry picked from commit 618c7cffeb28a89475ee001827e53049e45715ed)


   sys/fs/p9fs/p9_transport.c | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit 65b07ecacc58b69a32d6421caa138daead009eaf]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: xen: Use proper prototype for SYSINIT functions
Review: The commit changes a function prototype to match SYSINIT, which is an internal refactoring with no user-visible impact.
Body:

  The only possible return value of function xen_intr_init() is 0. Make
  it return void to match the prototype of SYSINIT.

  MFC after:	1 week

  (cherry picked from commit 19061a898ac809c8e9a30839b7200ff13a6eb9c0)
  (cherry picked from commit a1efb352f24f2e86c99a4ca94b64384cd991bc09)


   sys/dev/xen/bus/xen_intr.c | 6 ++----
   1 file changed, 2 insertions(+), 4 deletions(-)

[commit f67ece8b30cf86493649796a07e3304873050553]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: xdma: Use proper prototype for SYSINIT functions
Review: The commit fixes a prototype mismatch in SYSINIT functions for the xdma driver, which is an internal code correction without user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit ef56b9188937eec1ceef458d02c71c6b890b398a)
  (cherry picked from commit 0a30ce95a74e753c6963bc11a461f66ded536d50)


   sys/dev/xdma/xdma.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3b697f765d11535783f01c4e325c822374dce76d]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: nvme: Use proper prototype for SYSINIT functions
Review: The commit fixes a prototype mismatch for SYSINIT functions in the NVMe driver, which is an internal code cleanup with no user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit dd256c3fa738b6941f58355c077224c9a227b169)
  (cherry picked from commit 6edef6b6364162932379bd172930d82b067177cf)


   sys/dev/nvme/nvme.c     | 4 ++--
   sys/dev/nvme/nvme_sim.c | 4 ++--
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit 8c800d39080a217b410a44f9b04e3ea1e7154689]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: iommu_gas: Use proper prototype for SYSINIT functions
Review: The commit changes a function prototype for SYSINIT functions in the iommu_gas.c driver file. This is a minor internal fix with no user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 05c313cd2cbcc6c0a6ffa97363b70232d02542f3)
  (cherry picked from commit 9336f20f89e8b819c8f07125fd6d305d78afd546)


   sys/dev/iommu/iommu_gas.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e40461251825f961702a05eb0eacd72f4d335a09]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: dev/fdt: Use proper prototype for SYSINIT functions
Review: The commit changes function prototypes for SYSINIT functions in the fdt_slicer driver, which is an internal kernel implementation detail with no direct user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit d82653aee7e357916403147dc21d342e6b543106)
  (cherry picked from commit d23e3b6e562faee8035f86f099e3319a167daa91)


   sys/dev/fdt/fdt_slicer.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 93da73e85a719625b1c3f99d89e05a1d56f1f4df]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: opensolaris: Use proper prototype for SYSINIT functions
Review: The commit fixes a function prototype in the OpenSolaris compatibility layer, which is an internal implementation detail with no direct user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 41c0b64f021ecda09c0d42bfc539dba69ec51e4c)
  (cherry picked from commit 198d5a629706742a82e35b44f982f37aaa028e21)


   sys/cddl/compat/opensolaris/kern/opensolaris.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a0d353904a7e1e2f1c6e633cc8b12d2ec4789b1e]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: scsi: Use proper prototype for SYSINIT functions
Review: The commit fixes a prototype mismatch in SYSINIT functions for SCSI, which is an internal kernel build fix with no direct user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit f94b1a8ca6e016aeff09e2053dc293b83c3aa912)
  (cherry picked from commit 52b3cb8918e38ccd0f2e763fe3120bfb7858b6e1)


   sys/cam/scsi/scsi_all.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 8a3223b62a15016ad9d17baed393b5c2e8d4bdd4]
Date: 2026-01-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: Userland.programs
Subject: mdmfs: Fix soft updates logic
Review: mdmfs now uses newfs(8) command-line arguments to disable soft updates instead of running tunefs(8) after filesystem creation, simplifying the initialization process.
Body:

  Now that newfs(8) has a command-line argument to disable soft updates,
  use that instead of running tunefs(8) after the fact to turn them off.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.
  Reviewed by:	mckusick, imp
  Differential Revision:	https://reviews.freebsd.org/D54783

  (cherry picked from commit 4b9620433855b75989164c1a8a8a2e1a9b5fbff2)


   sbin/mdmfs/mdmfs.c | 12 ++----------
   1 file changed, 2 insertions(+), 10 deletions(-)

[commit 929ef0d36c6c80981c11dae0f51f6ab839a58c06]
Date: 2026-01-11
Score: 5
Status: added(include=yes,score=85)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: Userland.programs
Subject: newfs: Add an option to disable soft updates
Review: The man:newfs[8] utility gains a -u flag to disable soft updates and soft updates journaling, providing a way to turn off the default soft updates for UFS2 filesystems.
Body:

  A previous commit turned soft updates on by default for UFS2 without
  providing a way to turn them off.  This corrects that by adding a new -u
  flag which forces soft updates (and soft updates journaling) off.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.
  Fixes:		61dece6d27fb ("Enable soft updates by default for UFS2 filesystems.")
  Reviewed by:	mckusick
  Differential Revision:	https://reviews.freebsd.org/D54576

  (cherry picked from commit 68562f8145e8154e7e276897a546995f0d8f3428)

  newfs: Add -u to getopt string

  Fixes:		68562f8145e8 ("newfs: Add an option to disable soft updates")
  (cherry picked from commit 717ae163919e48f000b94f85dc188e0d92261929)


   sbin/newfs/newfs.8 | 24 ++++++++++++++++++------
   sbin/newfs/newfs.c | 11 +++++++----
   2 files changed, 25 insertions(+), 10 deletions(-)

[commit e58f90157c9b947c13e205fb0062411168fdab11]
Date: 2026-01-23
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: loader.conf.5: "console" setting does not document multi-value possiblity
Review: The man:loader.conf[5] documentation now mentions that the "console" setting can accept multiple values.
Body:

  PR:		292595
  Approved by:	ziaee, dab, imp, tsoome
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D54843

  (cherry picked from commit 240c614d48cb0484bfe7876decdf6bbdcc99ba73)


   stand/defaults/loader.conf   | 2 +-
   stand/defaults/loader.conf.5 | 1 +
   2 files changed, 2 insertions(+), 1 deletion(-)

[commit 139f620c0c9056ddec81fce3738396b145bd69b7]
Date: 2026-01-26
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Hardware.virtualization
Subject: bhyve: make BHYVE_SNAPSHOT amd64-only
Review: The BHYVE_SNAPSHOT option is now restricted to amd64 architectures, preventing build failures on non-amd64 systems.
Body:

  Build fails with BHYVE_SNAPSHOT enabled on non-amd64,
  so add it to BROKEN_OPTIONS for these arches.

  PR:			292686
  Reviewed by:		emaste, markj
  MFC after:		3 days
  Sponsored by:		The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D54873

  (cherry picked from commit b01763b2b2ab2d87f7d3c6ae57783c731ce548dd)


   share/mk/src.opts.mk | 4 ++++
   1 file changed, 4 insertions(+)

[commit 3ab15ea66043b7be87914c151ced6c3ccf7d7c0b]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=10)
Sponsor: https://www.patreon.com/cperciva
Section: undecided
Subject: Ping: Make build reproducible
Review: The commit addresses a build race condition in the ping test suite, which may affect developers building from source but does not impact end users or change runtime behavior.
Body:

  As recently fixed in sockstat (9934558460e4), having tests/Makefile
  include files from the parent directory with SRCS= ../foo.c results
  in a race condition as the parent build and the tests build try to
  produce the same object file but contain different paths.

  Use .PATH to tell make to find sockstat.c in the parent directory
  but place the object file in the current object directory.

  Reviewed by:	emaste, jrtc27, kevans
  MFC after:	3 days
  Sponsored by:	https://www.patreon.com/cperciva
  Differential Revision:	https://reviews.freebsd.org/D53075

  (cherry picked from commit 3c9a2f383fc25cdffa80c1348cb5388290e0f283)


   sbin/ping/tests/Makefile | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit d76b8a928d6663501211fdb82b32c1403a81a48f]
Date: 2026-01-29
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Kernel.general
Subject: powerpc: explicitly cast the timebase printfs
Review: The commit fixes a compilation issue on powerpc:powerpc GENERIC by adding explicit casts in timebase printfs, which resolves build failures for users building kernels on that platform.
Body:

  This is causing compilation issues on powerpc:powerpc GENERIC.

  (cherry picked from commit 03e4cc9fdeb2a6445f13cd41b471927a0f722fff)


   sys/powerpc/powermac/platform_powermac.c | 16 ++++++++--------
   1 file changed, 8 insertions(+), 8 deletions(-)

[commit efd7c55bade8654ab894669e1ab46a4cc54d4676]
Date: 2026-01-23
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Hardware.virtualization
Subject: powerpc: disable the TLBIE lock, it's not needed for POWER8
Review: The TLBIE lock is disabled on POWER8 systems, improving performance by allowing lockless TLB invalidation operations as per the POWER8 architecture specification.
Body:

  According to POWER8_UM_v1.3_16MAR2016 3.8.3 Translation Lookaside
  Buffer (TLB), POWER8 supports lockless TLBIE operations.

  Locally Tested:

  * IBM POWER8 Revision 2.0, dual socket, 160 threads

  Differential Revision:	https://reviews.freebsd.org/D54855
  Approved by:	jhibbits

  (cherry picked from commit 9a5baa9c585652fb7bd4ccd45d567204caf349f2)


   sys/powerpc/aim/moea64_native.c | 5 +++++
   1 file changed, 5 insertions(+)

[commit f7358bc0363fc1860cea64da972e590c9053919d]
Date: 2026-01-19
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Hardware.virtualization
Subject: powerpc: add a best-effort SMP time base sync for G5's that need it
Review: The commit adds a best-effort SMP time base synchronization for PowerMac G5 systems lacking a timebase freeze platform routine. This enables correct SMP operation on dual-socket G5 devices, preventing boot failures.
Body:

  There's no timebase freeze platform routine registered on my dual 2.3GHz
  G5 PPC970FX Apple PowerMac.

  For platforms without an explicit timebase freeze/unfreeze, we'll have to
  make do with what we have - which for now is an explicit hand-crafted
  spinlock/rendezvous method.

  * For existing platforms, they'll still continue to clock freeze /
    rendezvous; albeit with some stronger atomic bits now (from jhibbits@.)
  * Instead of the fallback being "no timesync", implement a
    best-effort one which does a similar rendezvous barrier between
    BSP and APs, but instead of freeze/unfreeze the first instruction
    after the CPUs all register they're ready is to set the timebase.

  This has resulted in many reboots of my Powermac G5 dual-socket device
  correctly starting and running in SMP mode.

  Differential Revision:  https://reviews.freebsd.org/D54821
  Reviewed by:	jhibbits

  (cherry picked from commit 422c8719eab2b8a01b49f748a88dd372db25f888)


   sys/powerpc/powermac/platform_powermac.c | 99 +++++++++++++++++++++++++++++---
   1 file changed, 90 insertions(+), 9 deletions(-)

[commit 8baa4e9647192e476a0a14a796e36aef6ea4607e]
Date: 2026-01-10
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Bootloader.general
Subject: powerpc: fix release image building for Apple partitions
Review: The release image building script for powerpc Apple partitions no longer uses awk for hexadecimal calculations, preventing a broken boot block generation.
Body:

  awk changed somewhere between 14 and 15 and it stopped accepting
  a hexadecimal number as its input - it will always return 0.
  This results in a very badly written apple boot block.

  So just remove it; do the math in shell.

  PR:		kern/292341
  Differential Revision:	https://reviews.freebsd.org/D54639
  Reviewed by:	imp
  MFC after:	1 week

  (cherry picked from commit 7afa03963c448a14b1735a10eaf84941b0b74862)


   release/powerpc/mkisoimages.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d499239dc57b7faf34e02e874606ba0016ca07b5]
Date: 2026-01-27
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.libraries
Subject: libc: Don't use uninitialised string for getnetbyaddr[_r](0) DNS lookup
Review: Fixes a security issue where getnetbyaddr(0) with DNS lookups enabled could leak uninitialized stack memory to the DNS resolver. This only affects systems where nsswitch.conf is configured to use "dns" for networks, which is not the default.
Body:

  If net is all-zero, the loop to extract all leading non-zero octets will
  iterate zero times and leave nn with the value 4, which the following
  switch statement to initialise qbuf does not handle. As a result,
  _dns_getnetbyaddr will look up the PTR record for this uninitialised
  string, which will leak the pre-existing contents of that stack memory
  to the DNS resolver and, if remote and not otherwise protected, network.

  Note that _dns_getnetbyaddr is only used if nsswitch.conf is configured
  to enable the "dns" source for the "networks" database, which is not the
  default configuration in FreeBSD.

  For glibc this same bug, in code also derived from BIND's, was issued
  CVE-2026-0915. This commit adopts the same behaviour as glibc's fix,
  which is to regard a net of 0 as being for 0.0.0.0. Apparently NetBSD
  will return NS_UNAVAIL instead, which may or may not make more sense,
  but in general glibc compatibility tends to cause less friction when
  there's not a good reason to avoid it.

  Reviewed by:	markj (secteam)
  Fixes:		1363f04ce1b8 ("get* rework and new bind code")
  MFC after:	1 day
  Security:	Same bug as glibc's CVE-2026-0915

  (cherry picked from commit 331316b073505e4794754af1cd0c5ccc578a2bde)


   lib/libc/net/getnetbydns.c | 3 +++
   1 file changed, 3 insertions(+)

[commit 2fc26b2f3fefc6f4384a3ef2f5781b54ee81b8b7]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Chelsio Communications
Section: Drivers.device
Subject: cxgbe tom: Send auxiliary TLS work requests as raw WR mbufs
Review: The commit changes how TLS work requests are sent in the cxgbe driver, potentially improving handling of TLS offload transitions and edge cases with insufficient credits. This may affect performance and reliability of TLS connections on Chelsio hardware.
Body:

  In particular, the work request to update the TCB state when switching
  from plain TCP to TLS is now queued on the connection's offload
  transmit queue rather than over the per-port control queue.

  This also handles an unlikely edge case that a connection does not
  have sufficient credits to transmit other work requests synchronously
  such as programming the key in on-card memory or altering TCB fields.

  Reviewed by:	np
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D47763

  (cherry picked from commit d869395ac4bd248da7c5bdc67afb19ca89fbeeee)


   sys/dev/cxgbe/tom/t4_cpl_io.c | 36 +++++++++++++++++-----------
   sys/dev/cxgbe/tom/t4_tls.c    | 56 +++++++++++++++++++++----------------------
   sys/dev/cxgbe/tom/t4_tom.h    |  2 ++
   3 files changed, 51 insertions(+), 43 deletions(-)

[commit 507dc6c1c810c6cd038a11291571f3aabfcc6731]
Date: 2025-09-11
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: cxgbe tom: Export alloc_raw_mbuf for use in other TOE drivers
Review: The commit exports an internal function for use by other TOE drivers, which is a low-level kernel development change without direct user-visible impact.
Body:

  Reviewed by:	np
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D47762

  (cherry picked from commit a7aab22d2bf36191baa646fc136ca020dad209f3)


   sys/dev/cxgbe/tom/t4_ddp.c | 2 +-
   sys/dev/cxgbe/tom/t4_tom.h | 1 +
   2 files changed, 2 insertions(+), 1 deletion(-)

[commit bde291c654c21d58534cef5b49965901971708b8]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Chelsio Communications
Section: Drivers.device
Subject: cxgbe tom: Support sending "raw" WR mbufs on plain TCP and TLS sockets
Review: The cxgbe driver now supports sending raw work requests (WRs) on plain TCP and TLS sockets, enabling control operations that manipulate connection state without transmitting data. Raw WRs are prioritized over socket data transmission and are queued if credits are insufficient.
Body:

  This is intended to support control work requests that manipulate
  connection state but do not transmit data.  Raw WRs are transmitted
  immediately if possible, otherwise they are queued to an mbufq in the
  toe pcb until sufficient credits are available.  Raw WRs take
  precendence over transmitting socket data.

  Reviewed by:	np
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D47761

  (cherry picked from commit e2a2a7581c9663a08b8d92a34040d6fcdfc20816)


   sys/dev/cxgbe/tom/t4_cpl_io.c | 85 +++++++++++++++++++++++++++++++++++++++++++
   sys/dev/cxgbe/tom/t4_tls.c    | 13 +++++++
   sys/dev/cxgbe/tom/t4_tom.h    |  2 +
   3 files changed, 100 insertions(+)

[commit 4df8a30e54b6a0c5b27f3119429d2bb044cd3e27]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Chelsio Communications
Section: Drivers.device
Subject: cxgbe tom: Halve the size of offload transmit software descriptors
Review: The cxgbe driver reduces memory usage for offload transmit software descriptors by packing fields into a single 32-bit word.
Body:

  Use bitfields to pack tx_credits and plen into a single 32-bit word.

  Reviewed by:	np
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D47759

  (cherry picked from commit 5a38857684907c52982787dbac2c5e5c8abfd4f8)


   sys/dev/cxgbe/cxgbei/icl_cxgbei.c |  2 ++
   sys/dev/cxgbe/iw_cxgbe/qp.c       |  2 ++
   sys/dev/cxgbe/tom/t4_cpl_io.c     | 16 ++++++++++++++++
   sys/dev/cxgbe/tom/t4_tls.c        |  4 ++++
   sys/dev/cxgbe/tom/t4_tom.c        |  2 ++
   sys/dev/cxgbe/tom/t4_tom.h        |  7 +++++--
   6 files changed, 31 insertions(+), 2 deletions(-)

[commit 4af3e6cfd7c48b402d737f7a01835d2dc61ea567]
Date: 2025-08-06
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: cross-build make.py: Permit specifying cross toolchains by a package name
Review: The cross-build make.py script now supports specifying cross toolchains by package name, currently only with brew on macOS.
Body:

  Add a --cross-toolchain option whose value is a package name.  This is
  currently only supported with brew on macOS.  A sample invocation is
  `--cross-toolchain=llvm@19`.

  Differential Revision:	https://reviews.freebsd.org/D51741

  (cherry picked from commit 81fc74fd26da2f75c3010595db7a706c3e28d95b)


   tools/build/make.py | 40 ++++++++++++++++++++++++++++++----------
   1 file changed, 30 insertions(+), 10 deletions(-)

[commit 244f79497737cd358c832c849d2d98e01dc37fb7]
Date: 2025-08-06
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: cross-build make.py: Handle lld brew packages on macOS
Review: The cross-build script now automatically handles lld packages from Homebrew on macOS when using llvm19 or later, improving compatibility for cross-compilation setups.
Body:

  Homebrew uses separate packages for llvm and lld starting with llvm19.
  To handle this case automatically, pass the binary_name to
  default_cross_toolchain() and only use the automatic path for a given
  binary if the binary is found in the path (not just if the directory
  exists).  Add a second clause for ld.lld that looks for a lld package
  if lld wasn't found in the llvm directory.

  Note that manually specifying the path cannot use a single
  --cross-bindir option.  Instead, XLD must be manually set in addition
  to --cross-bindir when requesting a specific version.

  Reviewed by:	arichardson
  Differential Revision:	https://reviews.freebsd.org/D51653

  (cherry picked from commit e68d702b3a1fc52145e70d861db89a0f20bfc3a0)


   tools/build/make.py | 42 ++++++++++++++++++++++++++++++------------
   1 file changed, 30 insertions(+), 12 deletions(-)

[commit f3ab9690c2ffaed003a9e196d3501efb25890917]
Date: 2025-07-29
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: pci_iov: Support dynamic subordinate bus growth during VF creation
Review: The PCI I/O Virtualization subsystem now dynamically expands the subordinate bus range when creating Virtual Functions (VFs) for SR-IOV devices that enumerate VFs on a different PCIe bus. This prevents bus number exhaustion and allows all VFs to be properly initialized.
Body:

  Certain SR-IOV devices enumerate Virtual Functions (VFs) on a different
  PCIe bus than their parent Physical Function (PF).  In such cases, the
  default subordinate bus range assigned by BIOS may be insufficient to cover
  all VFs.

  This patch dynamically expands the subordinate bus range by:
  - Allocating additional bus numbers using bus_alloc_resource() when VFs are
    initialized
  - Releasing the reserved bus range during VF deletion via
    bus_release_resource()

  Reviewed by:	jhb

  (cherry picked from commit f7951799877c16cb901be1acc8d6643f0693cec4)


   sys/dev/pci/pci_iov.c         | 25 +++++++++++++++++++++----
   sys/dev/pci/pci_iov_private.h |  2 ++
   2 files changed, 23 insertions(+), 4 deletions(-)

[commit fa8f3d3053b6d84b284ca31296d276773a1de88c]
Date: 2025-07-28
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: tools/boot/rootgen: Remove stray zfsboot1 from ZFS + MBR + UEFI function
Review: The commit removes an unnecessary stray reference to zfsboot1 in the ZFS + MBR + UEFI boot generation script, which does not affect user-visible behavior as UEFI booting does not use BSD label boot blocks.
Body:

  This was copy-pasted from the ZFS + MBF + BIOS function, but without
  the corresponding code to extract zfsboot1 from /boot/zfsboot via
  dd(1).  It's also not necessary since UEFI booting doesn't make use of
  BSD label boot blocks (note the lack of any -b option to mkimg when
  generating the BSD partition in mk_nogeli_mbr_ufs_uefi()).

  Reviewed by:	imp, emaste
  Differential Revision:	https://reviews.freebsd.org/D51544

  (cherry picked from commit e958bc1c13377767d9b2cf87d072d923aa3d482a)


   tools/boot/rootgen.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5fce28c2f81d070c6321c9c5dc8d03831f32b242]
Date: 2025-05-30
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Chelsio Communications
Section: Drivers.device
Subject: cxgbe nic TLS: Correct IPv6 payload length
Review: The commit corrects the IPv6 payload length calculation for TLS offload on Chelsio cxgbe NICs, ensuring proper packet handling for encrypted IPv6 traffic.
Body:

  Sponsored by:	Chelsio Communications

  (cherry picked from commit 54f8c44ecf4a28a649d75ad6d0daaf3206ae9247)


   sys/dev/cxgbe/crypto/t6_kern_tls.c | 9 ++++++---
   1 file changed, 6 insertions(+), 3 deletions(-)

[commit aee8d42a37ac34e20af6b4b4a890e7221d200330]
Date: 2025-05-13
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Chelsio Communications
Section: Drivers.device
Subject: cxgbe nic TLS: Fix requests with 8 bytes of immediate data padding
Review: The cxgbe driver now correctly handles TLS requests with exactly 8 bytes of immediate data padding, preventing command misalignment.
Body:

  Requests whose immediate data do not end on a 16-byte boundary are
  padded with zeroes before the next WR command.  Since ULP commands are
  8 byte aligned, if there are more than 8 bytes of padding, the
  immediate data is padded with zeroes up to an 8 byte boundary and the
  last 8 bytes contain a ULP NOOP command.

  In the case of exactly 8 bytes of padding, the result should be that
  no zeroes are inserted, only the ULP NOOP.  However, the code was
  actually inserting 8 bytes of zero padding followed by the ULP NOOP
  causing the following real command to be misaligned.  Fix this by
  skipping the zero padding if there exactly 8 padding bytes.

  Reported by:	Sony Arpita Das @ Chelsio
  Sponsored by:	Chelsio Communications

  (cherry picked from commit 2befd06588325c541d400fcc4915a1adfd1c7d17)


   sys/dev/cxgbe/crypto/t6_kern_tls.c | 8 +++++---
   1 file changed, 5 insertions(+), 3 deletions(-)

[commit d0e6d7538189108a33c0ea84a502cff832f49fab]
Date: 2025-05-03
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: kyua: Don't pass NULL to std::unique_ptr<>::reset()
Review: No functional change; only internal code style improvements.
Body:

  No functional change, this is simply more idiomatic.

  Reviewed by:	olce, emaste
  Differential Revision:	https://reviews.freebsd.org/D50091

  (cherry picked from commit d61c8bca8648fa6dfa89bd5c7dc75726a2740c15)


   contrib/kyua/utils/fs/directory.cpp       |  2 +-
   contrib/kyua/utils/logging/operations.cpp |  2 +-
   contrib/kyua/utils/process/child.cpp      | 10 +++++-----
   contrib/kyua/utils/process/executor.cpp   |  4 ++--
   contrib/kyua/utils/signals/interrupts.cpp |  6 +++---
   contrib/kyua/utils/signals/timer.cpp      |  6 +++---
   6 files changed, 15 insertions(+), 15 deletions(-)

[commit 7982c36da11c94ac8ece46b23fadcf607d0e8396]
Date: 2025-05-03
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: kyua: Don't pass NULL to unique_ptr constructors
Review: Internal code style fix with no user-visible impact.
Body:

  This is ambiguous when NULL is defined to an integral constant.
  Instead, use the more iodiomatic pattern of {} to construct a default
  pointer.

  Reviewed by:	olce
  Differential Revision:	https://reviews.freebsd.org/D50090

  (cherry picked from commit 26d4ac7a2725c0ab2d536c402fc0185fe7afed85)


   contrib/kyua/utils/process/child.cpp | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 09d09e2a4b4393eb69ae09813ef3d086f657150c]
Date: 2025-04-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kyua: Switch from std::auto_ptr<> to std::unique_ptr<>
Review: Internal refactoring from std::auto_ptr to std::unique_ptr with no user-visible changes.
Body:

  A few places were assigning auto_ptr<>s depending on the ownership
  handoff.  These now use an explicit std::move() as required by
  unique_ptr<>.

  Reviewed by:	ngie, emaste
  Differential Revision:	https://reviews.freebsd.org/D49790

  (cherry picked from commit b392a90ba4e5ea07d8a88a834fd102191d1967bf)


   contrib/kyua/cli/cmd_report.cpp                    |  2 +-
   contrib/kyua/cli/cmd_report_junit.cpp              |  2 +-
   contrib/kyua/cli/common.hpp                        |  2 +-
   contrib/kyua/cli/main.cpp                          |  4 +-
   contrib/kyua/engine/config.cpp                     |  2 +-
   contrib/kyua/engine/scheduler.cpp                  |  4 +-
   contrib/kyua/model/metadata.cpp                    |  8 ++--
   contrib/kyua/model/metadata.hpp                    |  2 +-
   contrib/kyua/model/test_program.hpp                |  2 +-
   contrib/kyua/os/freebsd/utils/jail.cpp             |  4 +-
   contrib/kyua/utils/auto_array.hpp                  |  4 +-
   contrib/kyua/utils/cmdline/commands_map.hpp        |  2 +-
   contrib/kyua/utils/config/lua_module_test.cpp      |  2 +-
   contrib/kyua/utils/config/nodes.cpp                | 18 ++++-----
   contrib/kyua/utils/config/parser.hpp               |  2 +-
   contrib/kyua/utils/config/tree_test.cpp            |  2 +-
   contrib/kyua/utils/format/formatter.cpp            |  2 +-
   contrib/kyua/utils/fs/directory.cpp                |  2 +-
   contrib/kyua/utils/logging/operations.cpp          |  2 +-
   contrib/kyua/utils/process/child.cpp               | 26 ++++++-------
   contrib/kyua/utils/process/child.hpp               | 14 +++----
   contrib/kyua/utils/process/child.ipp               |  8 ++--
   contrib/kyua/utils/process/child_test.cpp          | 44 +++++++++++-----------
   .../kyua/utils/process/deadline_killer_test.cpp    |  4 +-
   contrib/kyua/utils/process/executor.cpp            |  8 ++--
   contrib/kyua/utils/process/executor.hpp            |  4 +-
   contrib/kyua/utils/process/executor.ipp            |  8 ++--
   contrib/kyua/utils/process/fdstream.hpp            |  2 +-
   contrib/kyua/utils/process/isolation_test.cpp      |  2 +-
   contrib/kyua/utils/process/operations_test.cpp     |  8 ++--
   contrib/kyua/utils/process/systembuf.hpp           |  2 +-
   contrib/kyua/utils/signals/interrupts.cpp          | 18 ++++-----
   contrib/kyua/utils/signals/interrupts_test.cpp     |  4 +-
   contrib/kyua/utils/signals/misc_test.cpp           |  4 +-
   contrib/kyua/utils/signals/programmer.hpp          |  2 +-
   contrib/kyua/utils/signals/timer.cpp               |  4 +-
   contrib/kyua/utils/signals/timer.hpp               |  2 +-
   contrib/kyua/utils/stream.cpp                      |  4 +-
   contrib/kyua/utils/stream.hpp                      |  2 +-
   contrib/kyua/utils/stream_test.cpp                 |  6 +--
   usr.bin/kyua/Makefile                              |  3 --
   41 files changed, 122 insertions(+), 125 deletions(-)

[commit f4973f97daab7222eedfb0a5f1d30e5d122d3d1d]
Date: 2025-04-16
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: atf: Switch from std::auto_ptr<> to std::unique_ptr<>
Review: ATF (Automated Test Framework) is updated to use std::unique_ptr instead of std::auto_ptr, aligning with upstream changes. This may affect developers building or modifying ATF tests in C++.
Body:

  This mirrors upstream commit f053ab687f6e27aa264f599ecbfc5ef27ad4e2d3.

  Reviewed by:	emaste
  Differential Revision:	https://reviews.freebsd.org/D49789

  (cherry picked from commit 5e6befdaca5194a8fb91b48d5f678942f22fa8f1)


   contrib/atf/atf-c++/check.cpp               |  4 ++--
   contrib/atf/atf-c++/check.hpp               |  4 ++--
   contrib/atf/atf-c++/check_test.cpp          | 22 +++++++++++-----------
   contrib/atf/atf-c++/detail/process_test.cpp |  8 ++++----
   contrib/atf/atf-sh/atf-check.cpp            |  8 ++++----
   lib/atf/Makefile.inc                        |  3 ---
   lib/atf/libatf-c++/Makefile                 |  3 ---
   libexec/atf/atf-check/Makefile              |  4 ----
   libexec/atf/atf-sh/Makefile                 |  3 ---
   share/mk/atf.test.mk                        |  2 --
   10 files changed, 23 insertions(+), 38 deletions(-)

[commit 82e034370621d7fdb52a6a282458474aa9af66c6]
Date: 2025-04-16
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: lutok: Switch from std::auto_ptr<> to std::unique_ptr<>
Review: Internal C++ library modernization from std::auto_ptr to std::unique_ptr with no user-visible changes.
Body:

  This mirrors upstream commit bd5904144c9778a07685f3e4efa6ef011a5480ec.

  Reviewed by:	igoro, imp, emaste
  Differential Revision:	https://reviews.freebsd.org/D49788

  (cherry picked from commit 25f2634a1f4b27c9804b705e85bc104a2eac67b9)


   contrib/lutok/stack_cleaner.hpp | 2 +-
   lib/liblutok/Makefile           | 4 ----
   2 files changed, 1 insertion(+), 5 deletions(-)

[commit 239fd18c6ce457d854f8c0739734820d439f1350]
Date: 2025-02-20
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctladm: portlist -i lists target and initiator names rather than addresses
Review: The man:ctladm[8] utility now lists target and initiator names instead of addresses when using the 'portlist -i' command.
Body:

  Sponsored by:	Chelsio Communications

  (cherry picked from commit 8206fcc5ef82a0e0518ed5e3a011ef38893b3eb6)


   usr.sbin/ctladm/ctladm.8 | 4 ++--
   usr.sbin/ctladm/ctladm.c | 2 +-
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 3b622bdf474bc2100be99f29fa1c69d96ec13c38]
Date: 2025-02-05
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctladm: Use nvlist instead of home-rolled name-value lists
Review: The commit replaces a custom name-value list implementation with the nvlist library in man:ctladm[8]. This change is internal refactoring with no user-visible impact on functionality, behavior, or configuration.
Body:

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48774

  (cherry picked from commit 4dfc2553c3732b142fd6122f223971419e359799)


   usr.sbin/ctladm/ctladm.c | 125 ++++++++++++++++++++---------------------------
   1 file changed, 54 insertions(+), 71 deletions(-)

[commit 18d4fcf53fa2df1923d664790db662e331ef04b2]
Date: 2026-01-20
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Ports.packaging
Subject: OptionalObsoleteFiles.inc: Treat compat runtime loaders as libraries
Review: The compat runtime loaders are now treated as libraries in the obsolete files list, preventing their premature removal during 'make delete-old' when corresponding shared libraries are still present.
Body:

  Binaries require the runtime loader to use shared libraries, and
  removing the runtime loader in `make delete-old` while leaving the
  libraries around makes it impossible to use those shared libraries.
  Treat rtld as a de facto dependency of shared libraries to ensure it
  is not removed until the corresponding shared libraries are removed.

  Differential Revision:	https://reviews.freebsd.org/D52210

  (cherry picked from commit 8e1c85f03260ff9d214fcd99c7ad1a848e3ac23b)


   tools/build/mk/OptionalObsoleteFiles.inc | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c8553cad48cb91e23a98865efa6336418b8a8130]
Date: 2026-01-16
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: smartpqi: Avoid declaring extern inline functions
Review: The commit fixes a compiler warning by moving inline function definitions to a single source file, which does not affect user-visible behavior.
Body:

  Each C file is compiled separately so these functions can't be inlined
  except in the file where they are defined.  Since these functions aren't
  used outside smartpqi_request.c, just do the simple thing and make them
  private to that file.

  Reported by:	gcc
  Reviewed by:	jrhall
  Fixes:		c558eca47970 ("smartpqi: update to version 4660.0.2002")
  Differential Revision:	https://reviews.freebsd.org/D54732
  (cherry picked from commit 75c591b26723711d7a38f2a5df7aecc28198cd83)


   sys/dev/smartpqi/smartpqi_prototypes.h | 4 ----
   sys/dev/smartpqi/smartpqi_request.c    | 4 ++--
   2 files changed, 2 insertions(+), 6 deletions(-)

[commit dfc0c1cdcfe7fdd25acacc4295b636a1f4dc1bc8]
Date: 2024-05-02
Score: 5
Status: proposed(include=no,score=30)
Sponsor: Chelsio Communications
Section: undecided
Subject: nvme: Add constants for the Fused Operation (FUSE) field in commands
Review: Adds constants for the Fused Operation (FUSE) field in NVMe commands, which may be used by driver or application developers for advanced NVMe command handling.
Body:

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D44845

  (cherry picked from commit 5e3e4442305d9e5af9862fac73feb0d7f37d4b56)


   sys/dev/nvme/nvme.h | 5 +++++
   1 file changed, 5 insertions(+)

[commit 8a2b0aa31beaaa01b33034551e6dbd5cd6dc9786]
Date: 2024-05-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctl: Add CTL_IO_ASSERT wrapper macro
Review: Adds a CTL_IO_ASSERT macro for internal type assertions in the CTL subsystem. This is an internal refactoring with no direct user-visible impact.
Body:

  Currently, this pattern is commonly used to assert that a union ctl_io
  is a SCSI request.  In the future it will be used to assert other
  types.

  Suggested by:	imp
  Reviewed by:	imp
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D44844

  (cherry picked from commit ac7a514e20f394ffed0126c0c356aa9107821880)


   sys/cam/ctl/ctl.c               | 12 ++++--------
   sys/cam/ctl/ctl_backend_block.c |  3 +--
   sys/cam/ctl/ctl_io.h            | 15 +++++++++++++++
   sys/cam/ctl/scsi_ctl.c          |  3 +--
   4 files changed, 21 insertions(+), 12 deletions(-)

[commit 2d8562860eca7eff835ca71e2fdde073e2df806b]
Date: 2024-05-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctl: Avoid an upcast for calling ctl_scsi_path_string
Review: The commit addresses a potential alignment warning on i386 by changing an internal function signature, with no user-visible impact.
Body:

  Change the first argument of ctl_scsi_path_string to be the embedded
  header structure instead of the union.  Currently union ctl_io and
  struct ctl_scsiio have the same alignment, but this changes on i386 if
  a new union member is added that contains a uint64_t member (such as
  an embedded struct nvme_command for NVMeoF).  In that case, union
  ctl_io requires stronger alignment, so the upcast from struct
  ctl_scsiio to union ctl_io in ctl_scsi_sense_sbuf raises an increasing
  alignment warning on i386.

  Avoid the warning by passing struct ctl_io_hdr as the first argument
  to ctl_scsi_path_string instead.

  Reviewed by:	imp
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D44716

  (cherry picked from commit 352cf4a64adf117a8a0cf23a20b8de4990b2ba22)


   sys/cam/ctl/ctl.c          | 2 +-
   sys/cam/ctl/ctl_scsi_all.c | 8 ++++----
   sys/cam/ctl/ctl_scsi_all.h | 2 +-
   sys/cam/ctl/ctl_util.c     | 6 +++---
   usr.sbin/ctladm/ctladm.c   | 6 +++---
   5 files changed, 12 insertions(+), 12 deletions(-)

[commit 03094f3700be5c339443fc6372c5e0be9e4ff908]
Date: 2026-01-15
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Drivers.device
Subject: if_ovpn: add interface counters
Review: The if_ovpn driver now tracks input/output packet and byte counts on the interface, providing standard network interface statistics alongside OpenVPN-specific counters.
Body:

  Count input/output packets and bytes on the interface as well, not just
  in openvpn-specific counters.

  PR:		292464
  MFC after:	2 weeks
  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit 21d666a19331f31fb6dfa1e370de5a84a1a5cb46)


   sys/net/if_ovpn.c                | 32 ++++++++++++++++++++++++++++++++
   tests/sys/net/if_ovpn/if_ovpn.sh | 25 +++++++++++++++++++++++++
   2 files changed, 57 insertions(+)

[commit d2d25d8fde2e19fb880c913dcc53871ef0588b55]
Date: 2026-01-14
Score: 5
Status: proposed(include=no,score=0)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: undecided
Subject: pfctl: allow new page character (^L) in pf.conf
Review: Error, not correct JSON Failed to parse the request body as JSON: messages[1].content: invalid escape at line 1 column 4819
Body:

  PF configuration files can contains many things.

  Using the new page characters (i.e. ^L, \014) to mark the beginning
  of parts is useful because many editors such as emacs and vim has
  facilities to jump next/previous ones.

  PR:		86635
  MFC after:	2 weeks
  Submitted by:	MOROHOSHI Akihiko <moro@remus.dti.ne.jp>
  Submitted by:	Simon Wollwage <rootnode+freebsd@wollwage.com>
  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit fc353e5e61fadd6ef618948f417f96381c08239c)


   sbin/pfctl/parse.y                   | 2 +-
   sbin/pfctl/tests/files/pf1078.in     | 3 +++
   sbin/pfctl/tests/files/pf1078.ok     | 2 ++
   sbin/pfctl/tests/pfctl_test_list.inc | 1 +
   4 files changed, 7 insertions(+), 1 deletion(-)

[commit 300a68afe0947923ef0f09ff46a5d572e4ec86b2]
Date: 2026-01-20
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: cron.8: clarify system crontab format
Review: The man:crond[8] man page now clarifies the format of the system crontab file, improving documentation for users who need to understand or modify system cron jobs.
Body:

  PR:		234504

  (cherry picked from commit 53d6b23765ca27ac7eca4096b2a83e84631c4ec8)


   usr.sbin/cron/cron/cron.8 | 11 ++++++-----
   1 file changed, 6 insertions(+), 5 deletions(-)

[commit 7aee235907f3d9ca512a5803e43da4d070afbf21]
Date: 2026-01-08
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: periodic: Support RFC 5424 syslog timestamps
Review: The periodic scripts now support RFC 5424 syslog timestamps, improving compatibility with syslog servers using the newer timestamp format.
Body:

  This is based on an initial implementation by michaelo in
  https://reviews.freebsd.org/D54361.

  PR:		270497
  Reported by:	michaelo
  Reviewed by:	michaelo
  Tested by:	michaelo
  MFC after:	1 week
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D54606

  (cherry picked from commit 8ac6427b1bb95470f6c755202d1c0391ed8eefbd)


   usr.sbin/periodic/etc/daily/460.status-mail-rejects | 13 ++++++++++---
   usr.sbin/periodic/etc/security/800.loginfail        | 11 +++++++++--
   usr.sbin/periodic/etc/security/900.tcpwrap          | 11 +++++++++--
   3 files changed, 28 insertions(+), 7 deletions(-)

[commit 9f0b953443b7dd7f33b8a461651c9d9ed2912d46]
Date: 2025-06-23
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Bootloader.general
Subject: lualoader: Add distinct brand for installer
Review: The bootloader now displays a distinct brand image when booting into the installer, making it clear to users that they are entering the installation environment.
Body:

  Make it obvious to users that the system is booting into the installer.

  Reviewed by:	kevans, manu
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D51001

  (cherry picked from commit ac7a19d41ee5eb1271c46fbc620b2f98dffa2230)


   release/Makefile                           |   3 +++
   stand/images/Makefile                      |   3 ++-
   stand/images/freebsd-install-brand-rev.png | Bin 0 -> 7724 bytes
   stand/lua/Makefile                         |   1 +
   stand/lua/gfx-install.lua                  |  24 ++++++++++++++++++++++++
   5 files changed, 30 insertions(+), 1 deletion(-)

[commit 4ecaa02a8797347f4b85a70902430a4f9f45ef76]
Date: 2025-08-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Rename {ctld,isns}.h to {ctld,isns}.hh
Review: The commit renames header files to .hh as part of a transition to C++ but does not introduce any user-visible changes in functionality, configuration, or behavior.
Body:

  Subsequent commits will use C++ in these headers rather than only C.
  conf.h remains as a C-only header since it is intended for use by the
  C code generated from parse.y.

  Sponsored by:	Chelsio Communications
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1794

  (cherry picked from commit 34e8d66412cd81d020f0e75d078a4404ec39cf5a)


   usr.sbin/ctld/conf.cc             | 2 +-
   usr.sbin/ctld/ctld.cc             | 4 ++--
   usr.sbin/ctld/{ctld.h => ctld.hh} | 6 +++---
   usr.sbin/ctld/discovery.cc        | 2 +-
   usr.sbin/ctld/isns.cc             | 4 ++--
   usr.sbin/ctld/{isns.h => isns.hh} | 6 +++---
   usr.sbin/ctld/kernel.cc           | 2 +-
   usr.sbin/ctld/login.cc            | 2 +-
   usr.sbin/ctld/uclparse.cc         | 2 +-
   9 files changed, 15 insertions(+), 15 deletions(-)

[commit 0b418dea7182f168bb881633a2dc40a9f244a297]
Date: 2025-08-04
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Permit valid integer LUN device types
Review: The ctld(8) utility now accepts valid integer LUN device types, correcting a regression from a previous libutil fix.
Body:

  Fixes:		2e0caa7c7e14 ("libutil: Really fix expand_number(3)")
  Sponsored by:	Chelsio Communications
  (cherry picked from commit 14f2cd78042372d27138a91dcb4f4845fe2e8194)


   usr.sbin/ctld/conf.cc | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4054439b47f2b58fa038c3fed8efc6b0be7b624c]
Date: 2025-04-11
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Do not remove item from an nvlist while iterating it
Review: The ctld daemon's internal nvlist iteration is corrected to avoid removing items while iterating, preventing potential crashes or data corruption during iSCSI target configuration.
Body:

  While here, make use of cnvlist_* to simplify this code.

  Fixes:		d42a73fb6a85 ("ctld: Add a dedicated API between parse.y and the rest of the program")
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49650
  (cherry picked from commit 30020689fb1e5c9549e430bd23600c88e1257697)


   usr.sbin/ctld/kernel.cc | 7 ++++---
   1 file changed, 4 insertions(+), 3 deletions(-)

[commit e11dec7e54e239c490343a275573348b0c826aa0]
Date: 2025-04-11
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Remove dead logging code
Review: The commit removes dead logging code in ctld, which is an internal cleanup with no user-visible impact.
Body:

  Portal discovery auth groups are always named auth groups

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49649

  (cherry picked from commit ce8cfd998b4fc01cfd47e009b0f6dead404841b4)


   usr.sbin/ctld/login.cc | 8 ++------
   1 file changed, 2 insertions(+), 6 deletions(-)

[commit 8c211a00d3b45b46b00e3fb99d803b65e7aadeee]
Date: 2025-04-11
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Require a mask if / is specified in an initiator portal
Review: The ctld(8) daemon now rejects portal strings ending with '/' without a mask, preventing invalid configurations.
Body:

  If the / separator in a portal string is the last character in the
  string, treat the portal as invalid.

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49648

  (cherry picked from commit 4449cf28a3152cf6e87a45176ae15ae250e543de)


   usr.sbin/ctld/ctld.cc | 2 ++
   1 file changed, 2 insertions(+)

[commit 541c6c9d75c15d94e60e944ee9fe70de3e5d6811]
Date: 2025-04-11
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Tighten parsing of IPv6 addresses for initiator-portal
Review: The ctld daemon now requires IPv6 addresses in initiator-portal configuration to be enclosed in square brackets and validates bracket pairing. This affects users configuring iSCSI targets with IPv6 addresses.
Body:

  If an address starts with a [ character, require that it ends with a ]
  character.  Also, if an address starts with a [ character, assume it
  is an IPv6 address.

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49647

  (cherry picked from commit f3eb1514ce44aea5d288a74f34a0c6925ecd43ea)


   usr.sbin/ctld/ctld.cc | 15 +++++++++------
   1 file changed, 9 insertions(+), 6 deletions(-)

[commit 8f799d4b1c7185d4b63310e86312c1867a8d7cb2]
Date: 2025-04-11
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Drop commented-out code to print the configuration
Review: Removes dead code from ctld that was incomplete and not used.
Body:

  This code is incomplete (it does not handle some of the options that
  can be set) and easily rots since it is not enabled by default or
  hooked up to anything that calls it.

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49646

  (cherry picked from commit 0708eb01f28040a50693f40833562ab14fbfe2ad)


   usr.sbin/ctld/ctld.cc | 62 ---------------------------------------------------
   1 file changed, 62 deletions(-)

[commit 88b3dab8d0ec099ac47d5314c2244ae283623143]
Date: 2025-04-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Properly validate mutual user/secret for CHAP-MUTUAL in the UCL parser
Review: The ctld UCL parser now correctly validates mutual user and secret fields for CHAP-MUTUAL authentication, preventing misconfiguration errors.
Body:

  The code was checking the non-mutual UCL objects twice instead.

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49645

  (cherry picked from commit bf41156712929460aaf968e9d38ddc3847f90f6a)


   usr.sbin/ctld/uclparse.cc | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit a8ab78a0785f5e988179a6f15c1eecff7086d9b3]
Date: 2025-04-11
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Remove dead code in UCL parsing of hex DSCP values
Review: Dead code removal in ctld's UCL parsing does not affect user-visible behavior.
Body:

  libucl treats strings starting with "0x" as an integer if they do
  not contain invalid characters.  The code also looks broken as it
  only calls strtol if the string exactly matches "0x" without any
  trailing characters.

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49644

  (cherry picked from commit 251439f1a06867a6baccb274c671b2169c9959fd)


   usr.sbin/ctld/uclparse.cc | 3 ---
   1 file changed, 3 deletions(-)

[commit e87f835bf13bcc514a54f224b8b4d5f85befb213]
Date: 2025-04-11
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Add a label string to auth_groups
Review: The commit refactors internal warning message handling in ctld without introducing user-visible changes, new features, or configuration impacts.
Body:

  This holds the abstract name of an auth-group for use in warning
  messages.  For anonymous groups associated with a target, the label
  includes the target name.

  Abstracting this out removes a lot of code duplication of
  nearly-identical warning messages.

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49643

  (cherry picked from commit 2736dc8c28a33ba911fd59f87b587a3d9722e975)


   usr.sbin/ctld/conf.cc | 33 +++++---------------
   usr.sbin/ctld/ctld.cc | 85 +++++++++++++++++++++++----------------------------
   usr.sbin/ctld/ctld.h  |  4 ++-
   3 files changed, 50 insertions(+), 72 deletions(-)

[commit 80888d8610ee6d0c3553ca22fa684117e186f70a]
Date: 2025-04-11
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Reduce code duplication in auth_check_secret_length
Review: Internal code refactoring in ctld with no user-visible impact.
Body:

  Only check a single secret length in the function and call it twice
  for the CHAP-MUTUAL case.

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49642

  (cherry picked from commit 4214775235ebc01e0d22da5f09a2e4cff16bfa74)


   usr.sbin/ctld/ctld.cc | 67 ++++++++++++++-------------------------------------
   1 file changed, 18 insertions(+), 49 deletions(-)

[commit 9cdd58d51d49503e1066875470014c992937471b]
Date: 2025-04-11
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Fix sign bug validating kernel ports when reloading config
Review: Fixes a bug in man:ctld[8] where reloading configuration via SIGHUP could incorrectly validate kernel ports due to a sign error.
Body:

  When I switched new_pports_from_conf to return bool instead of an
  inverted int, I missed updating the call after reloading the config
  file due to SIGHUP.

  Fixes:		450a84c292ae ("ctld: Some bool-related cleanups")
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49641
  (cherry picked from commit e7611b7531c4fc6d26d36faad79088f277af78f0)


   usr.sbin/ctld/ctld.cc | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit bce1250309302f66165a536c2834c7fc515ebc74]
Date: 2025-04-11
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ctld: Disable -Wshadow for GCC
Review: Disables -Wshadow warnings for ctld when building with GCC, which prevents build failures due to shadowing warnings from system headers.
Body:

  GCC raises shadow warnings in C++ when a global function shadows a
  structure type name (since it shadows the constructors for that type).
  System headers are full of such cases (and some such as struct sigaction
  vs sigaction() are mandated by POSIX), so just disable the warning.

  For example:

  In file included from usr.sbin/ctld/ctld.cc:33:
  sys/sys/event.h:366:20: error: 'int kqueue()' hides constructor for 'struct kqueue' [-Werror=shadow]
    366 | int     kqueue(void);
        |                    ^
  sys/sys/event.h:371:43: error: 'int kevent(int, const kevent*, int, kevent*, int, const timespec*)' hides constructor for 'struct kevent' [-Werror=shadow]
    371 |             const struct timespec *timeout);
        |                                           ^
  In file included from usr.sbin/ctld/ctld.cc:37:
  sys/sys/stat.h:396:63: error: 'int stat(const char*, stat*)' hides constructor for 'struct stat' [-Werror=shadow]
    396 | int     stat(const char * __restrict, struct stat * __restrict);
        |                                                               ^

  Reported by:	bz

  (cherry picked from commit 75a24e7f9afb128138c3b3462b80731cab0f5bdd)


   usr.sbin/ctld/Makefile | 1 +
   1 file changed, 1 insertion(+)

[commit be8bf6c2beda16c2d75e9790baf5e81e75b60851]
Date: 2025-04-02
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Chelsio Communications
Section: Ports.general
Subject: depend-cleanup: Handle ctld moving from C to C++
Review: The commit updates the build dependency cleanup script to handle the ctld utility's transition from C to C++, which may affect users building the system from source.
Body:

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49140

  (cherry picked from commit 7feee915ace1adcbbeca6bdbaf68ac27dee13ce5)


   tools/build/depend-cleanup.sh | 9 +++++++++
   1 file changed, 9 insertions(+)

[commit 6bb9cb02c84b6d64124ae47dd158b6c0bd32f844]
Date: 2025-04-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Convert to C++
Review: The commit converts ctld from C to C++ for internal build purposes without any user-visible changes in functionality, behavior, or configuration.
Body:

  This is the minimal set of changes need to compile as C++ so git can
  handle the rename correctly.

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49139

  (cherry picked from commit 839d0755fea8ef761698b50fa5f293546ae832a8)


   usr.sbin/ctld/Makefile                      |  6 ++---
   usr.sbin/ctld/{conf.c => conf.cc}           |  0
   usr.sbin/ctld/conf.h                        |  4 ++++
   usr.sbin/ctld/{ctld.c => ctld.cc}           | 35 ++++++++++++++++-------------
   usr.sbin/ctld/{discovery.c => discovery.cc} |  0
   usr.sbin/ctld/{isns.c => isns.cc}           |  6 ++---
   usr.sbin/ctld/{kernel.c => kernel.cc}       | 12 +++++-----
   usr.sbin/ctld/{login.c => login.cc}         |  8 +++----
   usr.sbin/ctld/{uclparse.c => uclparse.cc}   |  0
   9 files changed, 39 insertions(+), 32 deletions(-)

[commit 8ac917c7ce6c6b85511cb3d392b809357bad5ec8]
Date: 2025-04-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctl_ioctl.h: Do not use enums for bit fields of flags
Review: The commit changes internal type definitions for compatibility with C++ but does not introduce any user-visible changes in behavior, features, or configuration.
Body:

  C++ does not permit treating enum values as individual bits used with
  the bitwise operators.  For types that are a mask of flags, switch the
  typedef to an unsigned int and use preprocessor macros for flag
  constants.

  Reviewed by:	imp, asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49138

  (cherry picked from commit 48000952260469477346c8a89e927af69ebc00e2)


   sys/cam/ctl/ctl_ioctl.h | 104 ++++++++++++++++++++++++------------------------
   1 file changed, 52 insertions(+), 52 deletions(-)

[commit 48438ab6cf0459e20e0586c31de0376d2ee65ee5]
Date: 2025-04-02
Score: 5
Status: proposed(include=no,score=20)
Sponsor: Chelsio Communications
Section: undecided
Subject: libiscsiutil: Fix header to work with C++
Review: The commit fixes a C++ compatibility issue in libiscsiutil.h, allowing C++ programs to include the header without errors.
Body:

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49137

  (cherry picked from commit e94d3f65b90107204d477a7fab059d8cf3b1b0c3)


   lib/libiscsiutil/libiscsiutil.h | 4 ++++
   1 file changed, 4 insertions(+)

[commit 7711a8c74d210820fd635ac48c8145261aa94cbf]
Date: 2025-02-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Permit simpler syntax for target LUNs in UCL
Review: The ctld configuration syntax for target LUNs is simplified, allowing LUN numbers as keys and string values for non-anonymous LUNs.
Body:

  Allow the LUN number to be specified as the key for a LUN instead
  of requiring it as a "number" field.  If a key is used, permit
  a simple string value to be used for non-anymous LUNs.  This permits
  replacing:

  	lun = [
  		{ number = 0, name = zvol_lun },
  		{
  			number = 1
  			backend = ramdisk
  			size = 1GB
  		}
  	]

  with:

  	lun = {
  		0 = zvol_lun
  		1 {
  			backend = ramdisk
  			size = 1GB
  		}
  	}

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48939

  (cherry picked from commit 5b511473999a1d0145635fcc9d922601f34b670b)


   usr.sbin/ctld/ctl.conf.5 | 22 ++++++++++------------
   usr.sbin/ctld/uclparse.c | 30 +++++++++++++++++++++++-------
   2 files changed, 33 insertions(+), 19 deletions(-)

[commit e1548d92b945f6e0e1ead509595451dc4a5ed24c]
Date: 2025-02-26
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Permit targets to use a string for portal-groups in UCL
Review: The man:ctld[8] configuration now allows a string value for portal-group in UCL, simplifying configuration when a separate auth-group is not needed.
Body:

  In the case that a separate auth-group is not required, this permits
  replacing:

  	portal-group = { name = pg0 }

  with:

  	portal-group = pg0

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48938

  (cherry picked from commit e49db000c4932753fb309ad895c02e98723023f3)


   usr.sbin/ctld/ctl.conf.5 |  2 +-
   usr.sbin/ctld/uclparse.c | 22 +++++++++++++++++-----
   2 files changed, 18 insertions(+), 6 deletions(-)

[commit b7919e0493c8b34a6c8ef126c83b4b8a1e9be64c]
Date: 2025-02-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Support anonymous LUN entries in UCL
Review: The ctld configuration now supports anonymous LUN entries in UCL syntax, allowing LUNs to be defined without a name property. This removes the previous limited support for integer-named LUNs, which were unconfigured.
Body:

  If a target LUN entry doesn't have a name property, assume it is an
  anonymous LUN and parse other properties from the entry to define the
  LUN.

  This removes the odd support for target LUNs only named by an integer.
  My guess is this was meant to implement support for anonymous LUNs
  based on how the syntax for this works in the non-UCL case, but the
  prior implementation was useless (it just created unconfigured LUNs).

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48937

  (cherry picked from commit b797cc839a12fc358e99635ca3adf3cf80e0825b)


   usr.sbin/ctld/ctl.conf.5 |  30 +++++++-------
   usr.sbin/ctld/uclparse.c | 106 ++++++++++++++++++++++++++++-------------------
   2 files changed, 77 insertions(+), 59 deletions(-)

[commit 9dd655a05bea9d50617bfabe252cbccc9590b2a4]
Date: 2025-02-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Add missing properties to the UCL parser
Review: The ctld configuration parser now supports additional properties for portal groups and LUNs, including 'foreign', 'offload', 'tag', 'ctl-lun', and 'device-type'. This allows users to configure more advanced iSCSI target features.
Body:

  - Support for "foreign", "offload", and "tag" properties in portal
    group contexts.

  - Support for "ctl-lun" and "device-type" properties in LUN contexts.

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48936

  (cherry picked from commit 67940b204f5829a72e7c47f92069fb06a7dad91f)


   usr.sbin/ctld/uclparse.c | 49 ++++++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 49 insertions(+)

[commit 8824cd3a11708c48f1f989d1b948e67a2bf956fc]
Date: 2025-02-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Be more consistent for auth parameters in the UCL config
Review: The ctld configuration now accepts either single values or arrays for authentication parameters (chap, chap-mutual, initiator-name, initiator-portal) in both auth-group and target contexts, making configuration more flexible.
Body:

  The auth-group context required an array of entries for "chap",
  "chap-mutual", "initiator-name", and "initiator-portal" whereas the
  target context required exactly one entry (and only permitted a single
  entry).

  Allow either a single entry or an array of entries for these keywords
  in both the auth-group and target contexts.

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48935

  (cherry picked from commit e28b758b35d0f80b38c295587271ec9588040077)


   usr.sbin/ctld/uclparse.c | 163 +++++++++++++++++++++++++++++++++++------------
   1 file changed, 121 insertions(+), 42 deletions(-)

[commit c3688679ded592a35de9ed8ac1d576542c5ab02f]
Date: 2025-02-26
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Fail UCL configurations with a nested error
Review: The ctld(8) daemon now properly fails UCL configurations when nested errors occur in auth groups, portal groups, global LUNs, or targets, preventing silent acceptance of invalid configurations.
Body:

  Errors from auth groups, portal groups, global luns, and targets were
  not propagated out of the main loop.

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D49071

  (cherry picked from commit f3a43b3db881679d0b82b97f18871422050a5819)


   usr.sbin/ctld/uclparse.c | 17 ++++++++++++-----
   1 file changed, 12 insertions(+), 5 deletions(-)

[commit 5cf8a917e086b99f12122c59098005c74fb823e5]
Date: 2025-02-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Add a dedicated API between parse.y and the rest of the program
Review: The commit refactors ctld's internal parser API and fixes several configuration validation issues. It now warns and fails for duplicate LUN specifications, incorrect property types, and missing auth-group creation. These changes affect users who manually configure iSCSI targets via ctld configuration files.
Body:

  The primary purpose of this is to permit the rest of ctld to use C++.
  However, this also has the nice side effect of reducing code
  duplication with the UCL parser.

  As a general rule, setting of options including error handling for
  invalid values, etc. is moved out of parse.y and into conf.c.  The
  globals for the current configuration, auth group, portal group, lun,
  and target are also moved into conf.c hiding the types from parse.y.
  The intention is that all of the functions declared in conf.h will be
  extern "C" for use by parse.y and that the backing data structures can
  be reimplemented as C++ classes instead of C structures if desired.

  A few other small changes are included with this refactoring:

  - Warn and fail a configuration that specifies the same LUN multiple
    times for a target.

  - Use T_* constants for SCSI device types instead of magic numbers.

  - Warn and fail for a few UCL properties that aren't the required type
    including "discovery-auth-group" in a portal group context,
    "auth-type" and "port" in a target context.

  - Fix a bug where chap-mutual in a target in UCL would not auto-create
    a new auth-group.

  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48934

  (cherry picked from commit d42a73fb6a85b2dd4692cb003065be5c68863860)


   usr.sbin/ctld/Makefile   |   2 +-
   usr.sbin/ctld/conf.c     | 772 +++++++++++++++++++++++++++++++++++++++++++++++
   usr.sbin/ctld/conf.h     | 100 ++++++
   usr.sbin/ctld/ctld.c     | 225 ++------------
   usr.sbin/ctld/ctld.h     |  39 +--
   usr.sbin/ctld/kernel.c   |  23 +-
   usr.sbin/ctld/parse.y    | 553 ++++++++++-----------------------
   usr.sbin/ctld/uclparse.c | 689 +++++++++++++++++++-----------------------
   8 files changed, 1388 insertions(+), 1015 deletions(-)

[commit 1b4e894eaeb1058dfcdbab5197660573bcf19a46]
Date: 2025-02-12
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Fix parsing of text values for DSCP in UCL parser
Review: The UCL parser in man:ctld[8] now correctly parses text values for DSCP settings, ensuring that DSCP configuration in ctld.conf works as intended.
Body:

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48933

  (cherry picked from commit 5e6a462277b1e28ea5338a3031c509c829dcf588)


   usr.sbin/ctld/uclparse.c | 44 ++++++++++++++++++++++----------------------
   1 file changed, 22 insertions(+), 22 deletions(-)

[commit e7b94c2f3fa2cd5813f72cb553b54bb98b828306]
Date: 2025-02-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Use preferred style for evaluating result of strcmp
Review: The commit changes style for strcmp comparisons in ctld's configuration parser, which is a code style change with no user-visible impact.
Body:

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48932

  (cherry picked from commit 79a4240b135952cb318adf216a9e5d3ccbd6e343)


   usr.sbin/ctld/uclparse.c | 86 ++++++++++++++++++++++++------------------------
   1 file changed, 43 insertions(+), 43 deletions(-)

[commit bf60fb351df14fc6b5161cc28c1f130d6484d8ba]
Date: 2025-02-12
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Fail for missing or invalid CHAP secrets in UCL config
Review: The ctld(8) daemon now fails to start if the configuration contains missing or invalid CHAP secrets, preventing potential authentication issues.
Body:

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48931

  (cherry picked from commit f42f7bedabb329b68c7c9aa0d9a2dc49637d385f)


   usr.sbin/ctld/uclparse.c | 1 +
   1 file changed, 1 insertion(+)

[commit 67f12d18252a146439df723e5feb9ed3356f095b]
Date: 2025-02-12
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Fix the isns-period and isns-timeout keywords in the UCL parser
Review: The man:ctld[8] configuration keywords isns-period and isns-timeout now set the correct values for iSNS connection timeout and period.
Body:

  These keywords were setting the wrong configuration value (connection
  timeout).

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48930

  (cherry picked from commit 64905b38b1aeeaa9faeb90192b762efc1c2216ee)


   usr.sbin/ctld/uclparse.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit fb77f80ccae154704a4c60e8be2e4a127020c14e]
Date: 2025-02-12
Score: 5
Status: proposed(include=no,score=30)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Consistently free temporary strings during yacc parsing
Review: The commit fixes a memory leak in ctld's configuration parser by ensuring temporary strings are freed after use. This prevents potential memory exhaustion when parsing large or frequently changing configurations.
Body:

  The lexer always allocates a duplicate string via strdup for STR
  tokens.  The parse handlers did not always free these duplicated
  strings after consuming them.

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48929

  (cherry picked from commit 6de7a0d6c47615beecd8692e580aa3136c243303)


   usr.sbin/ctld/parse.y | 34 ++++++++++++++++++++++++----------
   1 file changed, 24 insertions(+), 10 deletions(-)

[commit 21a93ffe7883b87aa7287200c86e901d5f7b834b]
Date: 2025-02-12
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Some bool-related cleanups
Review: The commit involves internal cleanups converting variable types and inverting a boolean flag without any user-visible changes in functionality, configuration, or behavior.
Body:

  - Convert a few variables from int to bool

  - Return bool instead of inverted 0/1 from configuration parsing
    functions and the auth check functions

  - Invert the existing dont_daemonize bool into a daemonize boolx

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48928

  (cherry picked from commit 450a84c292ae5c4195d38bc7f7204d0e1e455f20)


   usr.sbin/ctld/ctld.c      | 131 ++++++++++++++++++++++------------------------
   usr.sbin/ctld/ctld.h      |  30 +++++------
   usr.sbin/ctld/discovery.c |   4 +-
   usr.sbin/ctld/login.c     |   4 +-
   usr.sbin/ctld/parse.y     |  62 +++++++++++-----------
   usr.sbin/ctld/uclparse.c  |  52 ++++++++----------
   6 files changed, 136 insertions(+), 147 deletions(-)

[commit f577b919b36027d8976b212d72ddb7c36061e947]
Date: 2025-02-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Drop some #if 0'd debugging traces
Review: The commit removes debugging traces that were already disabled via #if 0, resulting in no user-visible change in behavior or functionality.
Body:

  Suggested by:	asomers
  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48927

  (cherry picked from commit ca8a23d6cb32d8af18f3c249ed604c8db7c68d08)


   usr.sbin/ctld/kernel.c | 12 ------------
   1 file changed, 12 deletions(-)

[commit f9e5a4d5ba2018712147277c7c788551c9a0f91d]
Date: 2025-02-05
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Move kernel_limits into login.c where it is used
Review: The commit moves kernel_limits from ctld.h and kernel.c into login.c where it is used, which is an internal code refactoring without user-visible changes.
Body:

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48771

  (cherry picked from commit 9e425a8a7ef075706c901b27091a79e2911b7595)


   usr.sbin/ctld/ctld.h   |  8 ++-----
   usr.sbin/ctld/kernel.c | 56 +--------------------------------------------
   usr.sbin/ctld/login.c  | 62 +++++++++++++++++++++++++++++++++++++++++++++++++-
   3 files changed, 64 insertions(+), 62 deletions(-)

[commit 90d5638f97b3d073f90e49e23c919a2317d37bd9]
Date: 2025-02-05
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Don't specify the TCP port for default iSCSI portal group sockets
Review: The ctld daemon no longer specifies a TCP port for default iSCSI portal group sockets, as the default port is already used automatically. This change removes redundant configuration.
Body:

  portal_group_add_listen already uses the default TCP port if no port
  is specified so this was redundant.

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48770

  (cherry picked from commit 0a3e74f55aedc20dce7fc3a456d8307155627460)


   usr.sbin/ctld/ctld.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit d9f3d437144290e46b72235187c4f4e1e6b07846]
Date: 2025-02-05
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Factor out functions to parse dscp and pcp properties
Review: The commit refactors internal parsing functions for dscp and pcp properties in ctld, which is an internal implementation change without user-visible impact.
Body:

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48769

  (cherry picked from commit aa060232706cc9355d2585d765989c7459824b99)


   usr.sbin/ctld/uclparse.c | 157 +++++++++++++++++++++++++++--------------------
   1 file changed, 89 insertions(+), 68 deletions(-)

[commit f1c08b6111246ed390319d3655a0d20a4e999c71]
Date: 2025-02-05
Score: 5
Status: proposed(include=no,score=35)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Write the pidfile once after forking
Review: The ctld daemon now writes its pidfile only once after forking, preventing unnecessary rewrites during each main loop iteration.
Body:

  Don't rewrite the pidfile each time main_loop is called.

  PR:		284282
  Reported by:	asomers
  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48768

  (cherry picked from commit 7bad3c3e5f1c8b4d9e620bb2943299d4a30f3c86)


   usr.sbin/ctld/ctld.c | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 42234f50008eca7a3764e411a4627d85dbae6cae]
Date: 2025-01-30
Score: 5
Status: proposed(include=no,score=35)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Use kevent(2) for socket events rather than select(2)
Review: The ctld daemon now uses kevent(2) for socket events instead of select(2). This improves scalability with many connections.
Body:

  Reviewed by:	asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48597

  (cherry picked from commit 66b107e82b2f4be2e9b648897e04ffd675a43469)


   usr.sbin/ctld/ctld.c | 136 ++++++++++++++++++++++++++++-----------------------
   1 file changed, 74 insertions(+), 62 deletions(-)

[commit 7cf9371c06254528b4857e66c8639e2a88902652]
Date: 2025-01-30
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Use nvlist instead of home-rolled name-value lists
Review: The commit refactors ctld internals to use nvlist for name-value lists, which is an internal implementation change with no direct user-visible impact on functionality, configuration, or behavior.
Body:

  Reviewed by:	asomers (older version)
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48595

  (cherry picked from commit 703b03a8e325101f85610bf09f098442697f2f23)


   usr.sbin/ctld/ctld.c     |  87 ++++++++-------------
   usr.sbin/ctld/ctld.h     |  18 +----
   usr.sbin/ctld/kernel.c   | 200 ++++++++++++++---------------------------------
   usr.sbin/ctld/parse.y    |  15 ++--
   usr.sbin/ctld/uclparse.c |  13 +--
   5 files changed, 111 insertions(+), 222 deletions(-)

[commit def239812e9c8c80c8ec14a2f29f2676d60fbf61]
Date: 2025-01-30
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: libiscsiutil: Add log_warnc() and log_errc() functions
Review: The commit adds internal logging functions to libiscsiutil without any user-visible changes to functionality, behavior, or configuration.
Body:

  These are similar to warnc() and errc() in that they take an explicit
  error code instead of using the value of the errno global.

  Reviewed by:	mav, asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48648

  (cherry picked from commit de3deff65c5b407ab29b45780f2585b3bc24bbd6)


   lib/libiscsiutil/libiscsiutil.h |  4 ++++
   lib/libiscsiutil/log.c          | 22 ++++++++++++++++++++++
   2 files changed, 26 insertions(+)

[commit bff5236e6872d857ea33ddf133d3c8a0b004964d]
Date: 2025-01-24
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: ctld: Fix assertion against the wrong field
Review: Fixes an internal assertion error in man:ctld[8] that could cause unexpected behavior during iSCSI target discovery.
Body:

  Reviewed by:	mav, imp, asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48622

  (cherry picked from commit ca81304f7cbe033be802e3e2ef12378a61fe2175)


   usr.sbin/ctld/discovery.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 0cc467282f13e3edd4f3b382c3700bbb31e96cd5]
Date: 2025-01-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Factor out code to setup a listening socket into a separate function
Review: Internal refactoring of ctld socket setup code with no user-visible impact.
Body:

  While here:

  - Reuse the address family from the addrinfo structure instead of
    calling getsockname(2) on the socket.

  - Remove a bogus comment about the PCP option.

  Reviewed by:	mav, asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48596

  (cherry picked from commit b4a5ab97c8104bd9e3f36b164b4648bf9dc6bc94)


   usr.sbin/ctld/ctld.c | 199 ++++++++++++++++++++++++---------------------------
   1 file changed, 94 insertions(+), 105 deletions(-)

[commit a3311db4010ddb3daf9db5cfd917717515e8eaa4]
Date: 2025-01-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Use bool in uclparse.c
Review: Internal refactoring of ctld's configuration parser to use bool type for readability; no user-visible changes.
Body:

  Previously these functions all returned either 0 or 1, but 0 was
  success and 1 was failure.  Use a bool where false indicates failure
  instead which is more readable.

  Reviewed by:	mav, asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48594

  (cherry picked from commit 78cd9f0c0941e7a85dde12f719d16392b23a9975)


   usr.sbin/ctld/uclparse.c | 256 +++++++++++++++++++++++------------------------
   1 file changed, 128 insertions(+), 128 deletions(-)

[commit 944493636924f540e59562bca1f28a46d29b0f95]
Date: 2025-01-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Chelsio Communications
Section: undecided
Subject: iscsi: Move valid_iscsi_name to libiscsiutil
Review: The commit moves a validation function to a shared library and replaces a custom implementation with man:isxdigit(3). This refactoring does not introduce user-visible changes in behavior, features, or configuration.
Body:

  While here, use isxdigit(3) instead of a home-rolled version.

  Reviewed by:	mav, asomers
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48593

  (cherry picked from commit dd3603749cb7f20a628f04d595b105962b21a3d2)


   lib/libiscsiutil/libiscsiutil.h |   3 ++
   lib/libiscsiutil/utils.c        |  71 ++++++++++++++++++++++++++
   usr.bin/iscsictl/Makefile       |   3 +-
   usr.bin/iscsictl/iscsictl.c     | 107 ++--------------------------------------
   usr.bin/iscsictl/iscsictl.h     |   3 --
   usr.sbin/ctld/ctld.c            | 103 +-------------------------------------
   usr.sbin/ctld/ctld.h            |   2 -
   usr.sbin/ctld/login.c           |   2 +-
   8 files changed, 82 insertions(+), 212 deletions(-)

[commit 5535f9ea4aeca8015fc339e1ee5e3042fd52e816]
Date: 2025-01-18
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Chelsio Communications
Section: undecided
Subject: ctld: Trim trailing whitespace
Review: Trims trailing whitespace in ctld configuration and source files.
Body:

  Sponsored by:	Chelsio Communications

  (cherry picked from commit 237e9b7f5e90debb31ae7fd1e0a288e302659bfd)


   usr.sbin/ctld/ctld.c     |  6 +++---
   usr.sbin/ctld/parse.y    |  2 +-
   usr.sbin/ctld/uclparse.c | 12 ++++++------
   3 files changed, 10 insertions(+), 10 deletions(-)

[commit 45e19db918addf83f1da7885b812f128a4fad144]
Date: 2024-12-30
Score: 5
Status: proposed(include=no,score=15)
Sponsor: Chelsio Communications
Section: undecided
Subject: nv: Add <sys/_nv.h> header for nvlist_t declaration
Review: Adds a new header <sys/_nv.h> that provides a forward declaration of nvlist_t, allowing other headers to reference nvlist_t pointers without including the full nv.h.
Body:

  This can be useful for headers that wish to use nvlist_t pointers in a
  structure or function argument without pulling in all of the headers
  from <sys/nv.h>.

  Reviewed by:	imp
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D48229

  (cherry picked from commit 8a50aa09019a4230374f48c2f7411342f26b7475)


   sys/sys/_nv.h        | 45 +++++++++++++++++++++++++++++++++++++++++++++
   sys/sys/cnv.h        |  8 +-------
   sys/sys/dnv.h        |  8 +-------
   sys/sys/nv.h         |  8 +-------
   tools/build/Makefile |  1 +
   5 files changed, 49 insertions(+), 21 deletions(-)

[commit 051d781bf9d61da7e7631fccd562a0249f702996]
Date: 2026-01-23
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: vt.4: Document that hw.vga.textmode does not apply for UEFI(8) boot
Review: The man:vt[4] manual page now documents that the hw.vga.textmode sysctl does not apply when booting via UEFI.
Body:

  PR:		292598
  Approved by:	ziaee, imp
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D54842

  (cherry picked from commit 28764001b504c3588fd9f8dd6e4c08144d20571c)


   share/man/man4/vt.4 | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit 18d1e673fbbb26dbf364b6ae5147e638fc16e871]
Date: 2025-08-01
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: genet: Add a detach routine
Review: The commit adds a detach routine for the genet driver, which ensures proper cleanup when the driver is unloaded or the device is detached.
Body:

  PR:		288309
  Co-authored by:	Mike Belanger <mibelanger@qnx.com>
  MFC after:	2 weeks

  (cherry picked from commit 96a550e9dd892f24a479da00ead93fbfaafb7733)


   sys/arm64/broadcom/genet/if_genet.c | 35 +++++++++++++++++++++++++++++++++++
   1 file changed, 35 insertions(+)

[commit 20351c1eacd5fa3332c60aa878fef44e21373895]
Date: 2026-01-23
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: capsicum.4: Replace 'fi' ligature and smart quotation mark
Review: Fixes typographical issues in man: capsicum[4] by replacing a ligature and smart quotes, and wraps lines to 80 characters.
Body:

  While here, wrap the line to 80 characters.

  Reviewed by:	jlduran
  Fixes:		c54534e60263 ("capsicum.4: Add some more detail from the Capsicum paper")
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D54761

  (cherry picked from commit e6bafbeb1ee7a61ddfe92ba052c476c7646c405b)


   share/man/man4/capsicum.4 | 10 +++++-----
   1 file changed, 5 insertions(+), 5 deletions(-)

[commit 37908be664c9d07c7695f17f066c968ea7b5aaca]
Date: 2026-01-23
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: mkimg(1): Sync mkimg(1) and usage() with the implementation
Review: The man:mkimg[1] manual page is updated to match the current implementation, improving documentation accuracy.
Body:

  Reviewed by:	imp
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D54419

  (cherry picked from commit 3aa8d5395c4223f1613f28d6f39904c2df4f92d4)


   usr.bin/mkimg/mkimg.1 | 54 ++++++++++++++++++++++++++++++++-------------------
   usr.bin/mkimg/mkimg.c |  3 +++
   2 files changed, 37 insertions(+), 20 deletions(-)

[commit f34fe1a084e5874f0fe955bed95e7381cce0566f]
Date: 2026-01-13
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: libiconv: Fix typo in comment
Review: Typo fix in a comment only, no user-visible impact.
Body:

  (cherry picked from commit dec3ea45b65442b4f3cafcd8a672f1e13b69a066)
  (cherry picked from commit 14dc55c7a03d4d3b3fae9a8ed38649cb2d3fbc52)


   lib/libiconv_modules/mapper_std/citrus_mapper_std.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit bcd6bb8067d13d28d13a309e32818cda9e0d29ff]
Date: 2026-01-06
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: Arm Ltd
Section: Kernel.general
Subject: arm64: Correctly align the SVE signal context
Review: The SVE signal context alignment is corrected, ensuring proper handling of SVE signals on arm64 systems.
Body:

  The SVE signal context needs to be correctly aligned. Fix this by
  creating a new macro to calculate the needed size to provide this
  alignment, and use it when setting and checking the saved SVE signal
  context.

  Reported by:	cperciva
  Reviewed by:	cperciva, markj
  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D54396

  (cherry picked from commit a9e77eb7016df70723c208fc09fbd01ec23a732d)


   sys/arm64/arm64/exec_machdep.c | 14 +++++++++-----
   1 file changed, 9 insertions(+), 5 deletions(-)

[commit a2d1fa2a2b1fcbedd80a35e4ba17172f646ad3d2]
Date: 2026-01-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: modules: efirt: Fix standalone build
Review: The commit fixes a build issue in the efirt module's standalone build, which is an internal build system change without direct user-visible impact.
Body:

  This is extracted from change [1] which is not MFCed. This is a direct
  commit to stable/14 branch.

  [1] f840492b5b0d efidev: add support for memory attribute


   sys/modules/efirt/Makefile | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit bd1a6bff90cb832c256146eef4127495e4ed80b0]
Date: 2024-11-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: sys/modules/hid/*: Fix standalone build
Review: The commit fixes the standalone build for several HID driver modules, which is an internal build system change without direct user-visible impact.
Body:

  Co-authored-by:	Daniel Schaefer <dhs@frame.work>
  Reviewed by:	imp, wulf
  Differential Revision:	https://reviews.freebsd.org/D47830

  (cherry picked from commit 9996c680d12a6245d808bc8def1d2411e736efd6)


   sys/modules/hid/bcm5974/Makefile   | 2 +-
   sys/modules/hid/hcons/Makefile     | 1 +
   sys/modules/hid/hgame/Makefile     | 1 +
   sys/modules/hid/hidmap/Makefile    | 2 +-
   sys/modules/hid/hms/Makefile       | 2 +-
   sys/modules/hid/hmt/Makefile       | 2 +-
   sys/modules/hid/hpen/Makefile      | 1 +
   sys/modules/hid/hsctrl/Makefile    | 1 +
   sys/modules/hid/ietp/Makefile      | 2 +-
   sys/modules/hid/ps4dshock/Makefile | 2 +-
   sys/modules/hid/xb360gp/Makefile   | 1 +
   11 files changed, 11 insertions(+), 6 deletions(-)

[commit 2890e164f15b2a97d29245ebf4dab82667ae557f]
Date: 2025-08-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sys/modules: fix standalone build for multiple modules
Review: Fixes internal build issues for standalone module builds; no direct user-visible impact.
Body:

  Multiple Makefile miss opt_*.h and *_if.h header file. We fix it by
  running make in sys/modules to build all modules.

  MFC note: this is a partial MFS to stable/14, as modules/etherswitch,
  modules/miiproxy and modules/nvmf do not exist in stable/14.

  Approved by:    lwhsu (mentor), markj (mentor)
  Sponsored by:   The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D52062

  (cherry picked from commit 8a847947153e60d812852e5c02de93997b2d3038)


   sys/modules/e6000sw/Makefile          | 2 +-
   sys/modules/evdev/Makefile            | 2 +-
   sys/modules/gpio/gpioaei/Makefile     | 2 ++
   sys/modules/gve/Makefile              | 2 +-
   sys/modules/if_infiniband/Makefile    | 3 ++-
   sys/modules/if_vlan/Makefile          | 2 +-
   sys/modules/linux64/Makefile          | 1 +
   sys/modules/md/Makefile               | 2 +-
   sys/modules/mlx5/Makefile             | 2 +-
   sys/modules/mlx5en/Makefile           | 2 +-
   sys/modules/netgraph/ksocket/Makefile | 2 ++
   sys/modules/qlnx/qlnxev/Makefile      | 1 +
   sys/modules/uinput/Makefile           | 2 +-
   sys/modules/usb/usie/Makefile         | 2 +-
   sys/modules/usb/wmt/Makefile          | 2 +-
   15 files changed, 18 insertions(+), 11 deletions(-)

[commit dfc7e0631d08cc884c2386228b9707c9e0c9d4d2]
Date: 2026-01-23
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Userland.libraries
Subject: libc++ inttypes.h: define __STDC_CONSTANT_MACROS and __STDC_LIMIT_MACROS
Review: libc++ inttypes.h now defines __STDC_CONSTANT_MACROS and __STDC_LIMIT_MACROS, ensuring macros like UINT64_C() and SIZE_MAX are available in C++98/C++03 modes.
Body:

  Before transitively including the base version of inttypes.h, define
  __STDC_CONSTANT_MACROS and __STDC_LIMIT_MACROS, because the base
  inttypes.h directly includes sys/stdint.h, instead of going through the
  'regular' stdint.h.

  The libc++ version of the latter does define those macros, to ensure
  things like UINT64_C() and SIZE_MAX are defined even in C++98 or C++03.

  MFC after:	3 days

  (cherry picked from commit 3cdb6c9d92ecf479a0df338267f3f844ef6feeb2)


   contrib/llvm-project/libcxx/include/inttypes.h | 11 +++++++++--
   1 file changed, 9 insertions(+), 2 deletions(-)

[commit 6380e53112394caa83ed9c123cc34858ea765e9f]
Date: 2026-01-15
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: mxge(4): avoid clang 21 warning in NO-IP configuration
Review: The commit fixes a build warning in a specific kernel configuration (LINT-NOIP) but does not introduce any user-visible changes in functionality, behavior, or configuration.
Body:

  Building the LINT-NOIP kernel on amd64 with clang 21 results in a
  -Werror warning similar to:

      sys/dev/mxge/if_mxge.c:1846:44: error: variable 'sum' is uninitialized when passed as a const pointer argument here [-Werror,-Wuninitialized-const-pointer]
       1846 |                     cksum_offset, sizeof(sum), (caddr_t)&sum);
            |                                                          ^~~

  Indeed, if both `INET` and `INET6` are undefined, `sum` is never
  initialized. Initialize it to zero to silence the warning.

  Reviewed by:	jhibbits
  MFC after:	3 days
  Differential Revision: https://reviews.freebsd.org/D54730

  (cherry picked from commit 74cac745fe302b26ad22114f60735c8b73e90571)


   sys/dev/mxge/if_mxge.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 711b0e19aa5b054bcf62177ef918df16580106fa]
Date: 2026-01-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: netpfil/ipfw: Fix a typo in a source code comment
Review: Fixes a typo in a source code comment only.
Body:

  - s/vaues/values/

  (cherry picked from commit 9be9ab2a242080dea6254e187cf211604170de07)


   sys/netpfil/ipfw/ip_fw_table_value.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit ed2b5f46cf1ad81cc5ee363a89c6d3a357c51509]
Date: 2026-01-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: rockship: Fix a typo in a source code comment
Review: Typo fix in a source code comment only; no user-visible impact.
Body:

  - s/vaues/values/

  (cherry picked from commit cabb5add07a60c146698d09759445276aa96757a)


   sys/arm64/rockchip/clk/rk_clk_fract.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c41b12651a80e5c3c227e7428c2804f66ec17f2c]
Date: 2026-01-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: MFC: libfetch: allow disabling TLS v1.3 when negotiating the connection
Review: The libfetch library now allows disabling TLS v1.3 via the FETCH_TLS13 environment variable or the -T flag in man:fetch[1]. This provides control over TLS protocol negotiation for applications using libfetch.
Body:

  (cherry picked from commit 129aec72250266e60c07ff4643623188f7c27a9d)


   lib/libfetch/common.c |  2 ++
   lib/libfetch/fetch.3  | 12 ++++++++----
   2 files changed, 10 insertions(+), 4 deletions(-)

[commit fae1c84e95f7be4deacdab8a97f140714d8d2ae8]
Date: 2026-01-22
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.libraries
Subject: MFC: libfetch: apply timeout to SSL_read()
Review: The libfetch library now applies the fetchTimeout setting to SSL connections, allowing man:fetch[1] and other tools using libfetch to respect the -T timeout for HTTPS transfers.
Body:

  Currently, fetchTimeout works for non-SSL connections only, so does fetch -T.
  Fix it applying specified timeout to SSL_read().

  (cherry picked from commit 8f8a7f6fffd7dca09013f7c4bfa075bc3825fb8e)


   lib/libfetch/common.c | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit e4730bb6bbd703ae20b73922bb394c4038681b16]
Date: 2025-08-19
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Drivers.device
Subject: Revert "e1000: Try auto-negotiation for fixed 100 or 10 configuration"
Review: The e1000 driver reverts a change that attempted auto-negotiation for fixed 100 or 10 Mbps configurations. This fixes a regression where fixed-speed, no-autonegotiation setups could fail to establish a link.
Body:

  We've gotten a report of this breaking a fixed no autoneg setup.

  Since no link is worse than what this intends to fix (negotiating full
  duplex at forced speed), revert for the undeway 15.0 release cycle
  until this can be further reviewed.

  PR:		288827
  Differential Revision:	https://reviews.freebsd.org/D47336

  This reverts commit 645c45e297c0fcbbb9d2d24cdeeb124234825019.

  (cherry picked from commit 3ff0231c87f360afa4521e635b46f6c711dc4ee3)


   sys/dev/e1000/e1000_phy.c |  5 ++---
   sys/dev/e1000/if_em.c     | 44 ++++++--------------------------------------
   2 files changed, 8 insertions(+), 41 deletions(-)

[commit 40c0d6735538a1557a9b53306dd70aa2fc8ae7d1]
Date: 2026-01-16
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: Subcarpathian BSD User Group
Section: Network.general
Subject: ng_netflow v9: fix template re-announcement using packet count
Review: NetFlow v9 template re-announcements now respect the packet count parameter (templ_packets), ensuring templates are re-sent after the configured number of packets as intended.
Body:

  Increment fe->sent_packets after export9_send().
  Previously, NetFlow v9 templates were only re-announced based on
  time, ignoring the packet count parameter (`templ_packets`).

  PR:		270083
  Reviewed by:	glebius pouria
  Approved by:	glebius (mentor)
  MFC after:	1 week
  Sponsored by:	Subcarpathian BSD User Group

  (cherry picked from commit d836dae9f0d888d441234ea11e3cd91614c86aa2)


   sys/netgraph/netflow/netflow_v9.c | 1 +
   1 file changed, 1 insertion(+)

[commit 6abefcdd2585019bda24dddeab49040ee39f4079]
Date: 2024-06-27
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: Fix SATA NCQ error recovery after 25375b1415
Review: The ahci(4), siis(4), and mvs(4) drivers now correctly fetch error information for NCQ commands, enabling CAM to perform retries on SATA NCQ errors.
Body:

  Since that commit ahci(4), siis(4) and mvs(4) drivers ended up
  using wrong command to fetch error information for NCQ commands.
  Since ATA errors are not very informative to begin with, the only
  noticeable effect is a lack of retries on those errors by CAM.

  MFC after:	1 week
  PR:		279978

  (cherry picked from commit 87085c12ba8fa51f777bc636df67008b45e20d1c)


   sys/dev/ahci/ahci.c | 2 +-
   sys/dev/mvs/mvs.c   | 2 +-
   sys/dev/siis/siis.c | 2 +-
   3 files changed, 3 insertions(+), 3 deletions(-)

[commit f5ea3d46d600c290752a4ebd8a5f8282d9b4887a]
Date: 2026-01-22
Score: 5
Status: proposed(include=no,score=10)
Sponsor: OpenSats Initiative
Section: undecided
Subject: 14.4: Update stable/14 to -PRERELEASE
Review: The commit marks the start of the FreeBSD 14.4 release cycle, changing the version string to -PRERELEASE and entering code slush. This signals developers to prioritize bug fixes over new features, but it does not introduce direct user-visible changes or affect system behavior.
Body:

  This marks the start of the FreeBSD 14.4 release cycle; the stable/14
  tree is now in "code slush".

  Developers are encouraged to prioritize fixing bugs (and/or merging bug
  fixes from HEAD) over new features at this time.  Commit approval from
  re@ is not required but if new features introduce problems they may be
  removed from the release.

  Approved by:	re (implicit)
  Sponsored by:	OpenSats Initiative


   sys/conf/newvers.sh   | 4 ++--
   usr.bin/yacc/config.h | 2 +-
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 631d6cc0275c301bff27aa507a0d8922619d88cc]
Date: 2026-01-20
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: sctp: support bridge interfaces
Review: SCTP now supports bridge interfaces, allowing SCTP sockets to bind to and communicate over bridge network interfaces.
Body:

  Reported by:	Timo Vlker
  Tested by:	Timo Vlker

  (cherry picked from commit 8d82dafa568baf7be46e5e443dd7310986a28aa9)


   sys/netinet/sctp_bsd_addr.c | 1 +
   1 file changed, 1 insertion(+)

[commit 35c9d8f04a192310d37aa13e5749f3a6933693e8]
Date: 2026-01-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: dwc: cleanup
Review: The commit is a cleanup with no user-visible changes.
Body:

  Reviewed by:		Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D54788

  (cherry picked from commit 3d771e0db66da77da5a7f323df1c0638e6b586ea)


   sys/dev/dwc/if_dwc.c | 22 +++++++++-------------
   1 file changed, 9 insertions(+), 13 deletions(-)

[commit ae83ce2e7ada37a5362da621ba9c6c09e75a2c68]
Date: 2026-01-19
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Network.general
Subject: sctp: improve compilation as module
Review: The SCTP module no longer duplicates the sctp_crc32.c code, which fixes the handling of the sctps_sendhwcrc and sctps_sendswcrc statistic counters when using sctp_delayed_cksum.
Body:

  When compiling SCTP as a module, don't compile sctp_crc32.c into
  the module. This avoids code and variable duplication since
  sctp_crc32.c is compiled into the kernel. In particular, the variable
  system_base_info is not duplicated. This fixes the handling of the
  statistic counters sctps_sendhwcrc and sctps_sendswcrc when using
  sctp_delayed_cksum.

  (cherry picked from commit 68a449f09e2a38def9df822d42f91ecd2f27b0e2)


   sys/modules/sctp/Makefile | 1 -
   1 file changed, 1 deletion(-)

[commit e8731113c601a4ed0d2faa3a1e8aaee643176760]
Date: 2026-01-18
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: netstat: fix typo
Review: The commit fixes a typo in the netstat utility, which may affect output formatting but does not introduce a functional change.
Body:

  (cherry picked from commit 0ef8f7133d0f1ee28af1689f013f18e002eeae9f)


   usr.bin/netstat/sctp.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d9665287cd602314ab54e2aba93c1096d61457e6]
Date: 2026-01-17
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: dwc: add receive checksum offload for IPv6
Review: The dwc driver now supports receive checksum offload for TCP/IPv6 and UDP/IPv6. The IFCAP_RXCSUM and IFCAP_RXCSUM_IPV6 capabilities cannot be changed independently.
Body:

  This patch adds support for receive checksum offload for TCP/IPv6
  and UDP/IPv6. Since receive checksum offload can't be configured
  separately for IPv4 and IPv6, IFCAP_RXCSUM and IFCAP_RXCSUM_IPV6
  can't be changed independently.

  Reviewed by:		Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D54756

  (cherry picked from commit 5d8777f3a7aee04eabbc9f3cf12138f9b56e3ebc)


   sys/dev/dwc/if_dwc.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 81bddae7a4dcea29998ed417ad55421ad401c579]
Date: 2026-01-17
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: dwc: add transmit checksum offload for IPv6
Review: The man:dwc[4] driver now supports transmit checksum offload for TCP/IPv6 and UDP/IPv6, improving network performance for IPv6 traffic.
Body:

  This patch adds support for transmit checksum offload for TCP/IPv6
  and UDP/IPv6.

  Reviewed by:		Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D54754

  (cherry picked from commit aca67c37a5215448828a2974a2ff44e75e9159bc)


   sys/dev/dwc/if_dwc.c | 10 ++++++++--
   1 file changed, 8 insertions(+), 2 deletions(-)

[commit 88249c111d4372a8a307bfc08e0c87d1b5c6a7a7]
Date: 2026-01-16
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Drivers.device
Subject: dwc: prepare for IPv6 transmit checksum offloading
Review: The commit prepares for IPv6 transmit checksum offloading in the dwc driver, which may improve network performance for IPv6 traffic on supported hardware.
Body:

  No functional change intended.

  (cherry picked from commit 97b177f51fb939943ef920415e541d00789d12f4)


   sys/dev/dwc/if_dwc.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 39a25aa8a736a827f7a99e682fdb1579af4e8df5]
Date: 2026-01-16
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Drivers.device
Subject: bge: disable TXCSUM if UDP transmit checksum offloading is disabled
Review: The bge driver no longer announces TXCSUM capabilities by default when UDP transmit checksum offloading is disabled, preventing incorrect UDP checksums in bridge configurations. Users can still enable TXCSUM via man:ifconfig[8] if needed.
Body:

  The bge interface is special with respect to transmit checksumi
  offloading. In the default settings, an bge interface announces TXCSUM
  capabilities, but only supports TCP/IPv4 and not UDP/IPv4 due to
  limitations of some of the NICs. This results in problems when the bge
  interface becomes a member of a bridge. Since currently only the
  TXCSUM capabilities are synced when a member is added to a bridge and
  not the protocol specific capabilities, this can result in a situation
  where UDP packets are sent out using a bge interface without having a
  correct checksum.
  To mitigate this problem, initially don't announce TXCSUM capabilities,
  when UDP transmit checksum is disabled. It is still possible to enable
  TXCSUM capabilities via ifconfig.

  PR:			291420
  Reviewed by:		Timo Voelker
  Differential Revision:	https://reviews.freebsd.org/D54486

  (cherry picked from commit bbd30927b1af44226c8de0512912a7fedfce2824)


   share/man/man4/bge.4 | 10 +++++++++-
   sys/dev/bge/if_bge.c | 14 +++++++++++++-
   2 files changed, 22 insertions(+), 2 deletions(-)

[commit 3fdfc6c77aad8eacce0a8e609cc435db1070d726]
Date: 2026-01-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: ipv6: account for jumbo payload option
Review: The IPv6 jumbo payload option handling is adjusted to correctly account for the hop-by-hop extension header size, ensuring proper packet length calculation when the option is used.
Body:

  If a jumbo payload option is added, the length of the mbuf chain is
  increased by 8 but the actual hop-by-hop extension header with the
  jumbo playload option is only inserted in the packet if there are
  other options. Therefore, adjust optlen to reflect the actual size
  of IPv6 extension headers including the hop-by-hop extension header
  containing the jumbo payload option.

  Reported by:		syzbot+73fe316271df473230eb@syzkaller.appspotmail.com
  Reviewed by:		markj, Timo Voelker
  Differential Revision:	https://reviews.freebsd.org/D54394

  (cherry picked from commit 1f5b1de1fdf2924066c1851ed6c73f36fe20b438)


   sys/netinet6/ip6_output.c | 1 +
   1 file changed, 1 insertion(+)

[commit a83f6427c15d0ae24c89c583e72abab9a4669d8f]
Date: 2026-01-16
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Drivers.device
Subject: dwc: improve IPv4 transmit checksum offloading
Review: The dwc driver now allows TCP/IPv4 and UDP/IPv4 transmit checksum offloading even when IPv4 header checksum offloading is not supported, fixing an issue with epair interfaces.
Body:

  This patch provides two improvements for TCP/IPv4 and UDP/IPv4
  transmit checksum offloading:
  (1) Use *CIC_SEG instead of *CIC_FULL, since FreeBSD always provides
      a pseudo header checksum.
  (2) Don't make transmit IPv4 header checksum offloading a prerequisite
      for TCP/IPv4 or UDP/IPv4 transmit checksum offloading.
  This is the root cause of PR 291696, since right now the epair
  interface does not support transmit IPv4 header checksum offloading,
  but TCP/IPv4 and UDP/IPv4 transmit checksum offloading.

  PR:			291696
  Reviewed by:		Timo Voelker
  Tested by:		Marek Benc
  Differential Revision:	https://reviews.freebsd.org/D54395

  (cherry picked from commit f8ddf74175c8013268e65b18750e247306fa088a)


   sys/dev/dwc/if_dwc.c | 21 +++++++--------------
   1 file changed, 7 insertions(+), 14 deletions(-)

[commit 0b2cf69287bbb97d29042a4062b01ea4d9e9e054]
Date: 2025-09-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: linuxkpi: Take const root in read-only radix tree functions
Review: The commit is a preparation step for future changes and does not introduce any user-visible impact, such as new features, behavior changes, or configuration updates.
Body:

  This is a preparation step for a future addition to this file. This is
  also closer to what Linux does.

  Reviewed by:	emaste
  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit cf39b51d36d82214ebdfd03055d321ddd2d85274)
  (cherry picked from commit c5445540995fd37c390ad371a2e95d300ee83988)


   sys/compat/linuxkpi/common/include/linux/radix-tree.h | 4 ++--
   sys/compat/linuxkpi/common/src/linux_radix.c          | 8 ++++----
   2 files changed, 6 insertions(+), 6 deletions(-)

[commit fab0a83ff7484a069f04ec9c6b5657ec9676c7dd]
Date: 2025-12-19
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Network.general
Subject: tcp: fix checksum calculation bug
Review: The commit fixes a TCP checksum calculation bug that could cause incorrect checksums when the IP header is not at the start of the mbuf chain, potentially leading to packet corruption or drops.
Body:

  The new function in_delayed_cksum_o() was introduced to compute
  the checksum in the case the mbuf chain does not start with the
  IP header. The offset of the IP header is specified by the
  parameter iph_offset.
  If iph_offset was positive, the function computed an incorrect
  checksum.

  Reviewed by:		sobomax, tuexen
  Fixes:			5feb38e37847 ("netinet: provide "at offset" variant of the in_delayed_cksum() API")
  Differential Revision:	https://reviews.freebsd.org/D54269

  (cherry picked from commit c8b3b605ae854ead6c8804e0400d80cb8fa73fdf)


   sys/netinet/ip_output.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit c1b29bcd789ebcb5c7b6a3aa10f00de3032cad06]
Date: 2025-12-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: vtnet: improve consistency
Review: The vtnet driver's sysctl flags are now exposed using sbuf_new_for_sysctl() for consistency, but this change does not affect user-visible behavior, performance, or configuration.
Body:

  Use sbuf_new_for_sysctl() instead of sbuf_new_auto() when exposing
  the flags via sysctl.

  (cherry picked from commit 8da838ac31692e381adfc63d83ea49f2adabbf23)


   sys/dev/virtio/network/if_vtnet.c | 14 ++++++--------
   1 file changed, 6 insertions(+), 8 deletions(-)

[commit 9d246c6be2b2c4d8845961c3170d6d65b4a92e3c]
Date: 2025-12-19
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: vtnet: expose features via sysctl tree
Review: The vtnet driver now exposes its feature flags via a sysctl tree, allowing users to inspect supported features.
Body:

  Right now the 64-bit flags field needs to be casted to a 32-bit field,
  because clang warns if more than 32-bits are used.
  Once clang is fixed, this restriction will be removed and more bits
  will be added.

  Reviewed by:		markj, Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D54288

  (cherry picked from commit 634d9c0d111b630c3d63a1cf25d15c32a37afab8)


   share/man/man4/vtnet.4              |  4 +++-
   sys/dev/virtio/network/if_vtnet.c   | 18 ++++++++++++++++++
   sys/dev/virtio/network/virtio_net.h |  8 ++++++++
   3 files changed, 29 insertions(+), 1 deletion(-)

[commit 39140d9d9a27884b5941107abe3ddf92751d41b5]
Date: 2025-12-19
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: printf.9: Support more than 32 bits in %b
Review: The man:printf[9] manual page is updated to document support for more than 32 bits in the %b format specifier, which will be usable once clang supports length modifiers for %b in kernel code.
Body:

  This will be usable after clang has been extended to accept length
  modifiers for %b when compiling kernel code.
  But we need FreeBSD to support it first...

  Reviewed by:		markj, Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D54286

  (cherry picked from commit d2cb9cab8457b2a84898f0ac86f7b45e907f872c)


   share/man/man9/printf.9 | 25 ++++++++++++++++++-------
   sys/kern/subr_prf.c     | 40 +++++++++++++++++++++++++++++++---------
   2 files changed, 49 insertions(+), 16 deletions(-)

[commit 1923671644e2b82030e6d5e9c90bf7e3b62df699]
Date: 2025-12-18
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: printf.9: fix style
Review: Only style fixes to man page formatting with no user-visible impact.
Body:

  Follow the style described by style.9.

  Reported by:	markj

  (cherry picked from commit 391e8709315d4a0e8f5ba91912e370571ab6841b)


   share/man/man9/printf.9 | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit 02494584a52eceee40c6a638170fc3f9366a5bf2]
Date: 2025-12-18
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: vtnet.4: put each sentence on its own line
Review: The man:vtnet[4] manual page is updated to reflect the sysctl flags exposed by the driver.
Body:

  Reported by:	ziaee
  Fixes:		e3a0571ad74d ("vtnet: expose flags via sysctl tree")

  (cherry picked from commit f6e183301851e3e826d53a29e76cfc9bc7626477)


   share/man/man4/vtnet.4 | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 58e5923bf6fc59328a499b818052b4be1675f4c0]
Date: 2025-12-18
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Drivers.device
Subject: vtnet: expose flags via sysctl tree
Review: The vtnet driver now exposes interface flags via the sysctl tree for debugging purposes.
Body:

  Provide the flags used for a vtnet interface via the sysctl tree.
  This is mostly used for debugging purposes.

  Reviewed by:		Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D54283

  (cherry picked from commit e3a0571ad74d8429a95fcae9efc1d91cc109a337)


   share/man/man4/vtnet.4               |  4 +++-
   sys/dev/virtio/network/if_vtnet.c    | 20 ++++++++++++++++++++
   sys/dev/virtio/network/if_vtnetvar.h |  5 +++++
   3 files changed, 28 insertions(+), 1 deletion(-)

[commit 21f6087286c682c799c1c575d780e50a81a5ff2a]
Date: 2025-12-18
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: vtnet: define flags in a consistent way
Review: The commit only moves flag definitions within a header file without any functional change, so it has no user-visible impact.
Body:

  This allows adding flags in the upper 32 bits in a consistent way.
  No functional change intended.

  (cherry picked from commit e0c6c4ecfc755b78ac9135033053d2f15c62bf04)


   sys/dev/virtio/network/virtio_net.h | 46 ++++++++++++++++++-------------------
   1 file changed, 23 insertions(+), 23 deletions(-)

[commit 8e49c6c84cae980196b10886290e0c87c711cfdb]
Date: 2026-01-14
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libexecinfo: tests: Expect failure on aarch64
Review: The commit adds a test guard expecting failure on aarch64, which is an internal test change without user-visible impact.
Body:

  Add a guard that expects a failure of the test on aarch64.

  Reviewed by:	emaste
  Fixes:		df1ea5887326 ("tests: Test libexecinfo backtrace call througth signal trampoline")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54675

  (cherry picked from commit fef84fd8ae845e19cec0f6b9aac0e6451cca3d7a)


   lib/libexecinfo/tests/sigtramp_test.c | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit e5e98c244fe9889db7efb6789a2d0bd2ca1d151b]
Date: 2025-09-29
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.contrib
Subject: openssh: blocklist: Use NetBSD probes
Review: The commit updates the blocklist probe locations in OpenSSH to match NetBSD for consistency and maintenance. It also changes blacklist notification messages to be more descriptive for debugging.
Body:

  Use NetBSD probe locations for consistency.  We have submitted all
  improved or missing probes, keeping them synchronized with NetBSD (our
  blocklist upstream) should simplify upgrades and maintenance, as the
  locations of these probes are a moving target, depending on upstream
  OpenSSH changes.

  Additionally, use BLACKLIST_AUTH_FAIL exclusively for now.  At the time
  of this commit BLACKLIST_BAD_USER, is a no-op.  However, it will change
  in a future upgrade.

  Also, enhance blacklist notification messages for better debugging by
  making them more descriptive.

  Reviewed by:	emaste
  Approved by:	emaste (mentor)
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D52749

  (cherry picked from commit e02003bce726333872d65b7b9a1557d97b6d91a0)
  (cherry picked from commit 53dc967db74fba0d7b5bed413a7bc3216f16c55d)
  (cherry picked from commit 9c82c17c2a3ac61a69cb5337cb6f92ae88bc0b08)
  (cherry picked from commit 7161c525abffe6cdb19ac01223d058fcbabf49c5)


   crypto/openssh/auth-pam.c     |  4 ++--
   crypto/openssh/auth.c         |  6 ++++--
   crypto/openssh/auth2.c        |  5 +----
   crypto/openssh/monitor.c      | 14 ++++++++++++--
   crypto/openssh/packet.c       |  2 --
   crypto/openssh/sshd-session.c | 13 +++++++++----
   6 files changed, 28 insertions(+), 16 deletions(-)

[commit 79041942fa9a4496c11f437e323fb0fc767fcce5]
Date: 2025-08-08
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: openssh: Don't include an unused EVP_CIPHER_CTX_get_iv() stub
Review: Removes an unused stub macro to resolve a build conflict with OpenSSL, ensuring sshd builds without warnings when Kerberos support is disabled.
Body:

  This stub isn't actually used on modern versions of OpenSSL for which
  OpenSSH uses EVP_CIPHER_CTX_get_updated_iv instead via a wrapper macro.

  However, the wrapper macro conflicted with the existing namespace
  macro triggering an error on GCC:

  In file included from crypto/openssh/sshd-session.c:65:
  crypto/openssh/openbsd-compat/openssl-compat.h:71:11: error: "EVP_CIPHER_CTX_get_iv" redefined [-Werror]
     71 | #  define EVP_CIPHER_CTX_get_iv EVP_CIPHER_CTX_get_updated_iv
        |           ^~~~~~~~~~~~~~~~~~~~~
  In file included from <command-line>:
  crypto/openssh/ssh_namespace.h:12:9: note: this is the location of the previous definition
     12 | #define EVP_CIPHER_CTX_get_iv                   Fssh_EVP_CIPHER_CTX_get_iv
        |         ^~~~~~~~~~~~~~~~~~~~~

  The error was masked on clang due to MIT krb5 adding a blanket
  -Wno-macro-redefined.  Building sshd-session without Kerberos support
  was sufficient to trigger a warning from clang.

  Reviewed by:	des
  Differential Revision:	https://reviews.freebsd.org/D51810

  (cherry picked from commit e8633bc76ad935fa44156034713c608477bc3da0)


   crypto/openssh/openbsd-compat/libressl-api-compat.c | 8 +++++---
   crypto/openssh/ssh_namespace.h                      | 1 -
   2 files changed, 5 insertions(+), 4 deletions(-)

[commit b19f74cfc43b2b555875fa8be35ae23cab6e6096]
Date: 2025-08-08
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: openssh: Include <fcntl.h> explicitly in includes.h
Review: The commit fixes a build failure in OpenSSH due to a macro redefinition, but it is an internal build fix with no user-visible impact.
Body:

  This was previously included due to nested includes in Heimdal's
  headers.  Without this, the build fails with an error due to redefining
  AT_FDCWD.

  clang:

  In file included from crypto/openssh/sshd-session.c:46:
  /usr/obj/.../tmp/usr/include/fcntl.h:232:9: error: 'AT_FDCWD' macro redefined [-Werror,-Wmacro-redefined]
    232 | #define AT_FDCWD                -100
        |         ^
  crypto/openssh/openbsd-compat/bsd-misc.h:69:10: note: previous definition is here
     69 | # define AT_FDCWD (-2)
        |          ^

  GCC (can't be disabled):

  In file included from crypto/openssh/sshd-session.c:46:
  sys/sys/fcntl.h:232:9: error: "AT_FDCWD" redefined [-Werror]
    232 | #define AT_FDCWD                -100
        |         ^~~~~~~~
  In file included from crypto/openssh/openbsd-compat/openbsd-compat.h:218,
                   from crypto/openssh/includes.h:173,
                   from crypto/openssh/sshd-session.c:30:
  openssh/openbsd-compat/bsd-misc.h:69:10: note: this is the location of the previous definition
     69 | # define AT_FDCWD (-2)
        |          ^~~~~~~~

  Reviewed by:	des
  Differential Revision:	https://reviews.freebsd.org/D51809

  (cherry picked from commit 7de6d9d9b6bd8b1cd5e190cf4f12df498b34a646)


   crypto/openssh/includes.h | 3 +++
   1 file changed, 3 insertions(+)

[commit b3647e2a408e8a0246ec2240a152f8c41c3482cb]
Date: 2026-01-06
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: ConnectWise
Section: Userland.programs
Subject: netstat: fix a segfault with --libxo
Review: The man:netstat[1] utility no longer segfaults when using the --libxo option to print the protocol field. The width of the tcp-state field in encoded output is also corrected.
Body:

  Fix a segfault when printing the "protocol" field.  The field-format and
  encoding-format were expecting different numbers of arguments.

  Also, fix the width of the tcp-state field in encoded output.

  PR:		292228
  Fixes:		c2b08c13c20 netstat: add support for UDP-Lite endpoints
  Sponsored by:	ConnectWise
  Reviewed by:	tuexen, js, des
  Differential Revision: https://reviews.freebsd.org/D54567

  (cherry picked from commit 3b6615ec0332f901fcc9e9307f78717424f09c1e)


   usr.bin/netstat/inet.c | 11 +++++------
   1 file changed, 5 insertions(+), 6 deletions(-)

[commit 3b5c296fa1519a7fbfb8c48703bcacadd4b7d9c0]
Date: 2025-12-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: fusefs: Fix further intermittency in the BadServer.ShortWrite test case
Review: The commit fixes an intermittent test failure in the fusefs test suite, which is an internal testing issue without direct user impact.
Body:

  After being unmounted, the mockfs server would occasionally read from
  /dev/fuse again, if the main function didn't exit fast enough, getting
  an ENODEV error.  Handle that appropriately.

  Reported by:	Siva Mahadevan <me@svmhdvn.name>
  Fixes:		d86025c1d49c84c4dc8c3635c83c078ad56e5a53
  Reviewed by:	Siva Mahadevan <me@svmhdvn.name>
  Differential Revision: https://reviews.freebsd.org/D54331

  (cherry picked from commit f51e9d0e0988df58c94db586ab5c8b5fd091c004)


   tests/sys/fs/fusefs/mockfs.cc | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit af46d309a72b73398c3d0e4bee9b21437af17d7a]
Date: 2026-01-15
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Userland.programs
Subject: netstat: Remove padding from cc and stack fields
Review: The man:netstat[1] command no longer adds unnecessary whitespace padding to the cc and stack fields when using the -C and -c options, making output cleaner for users with multiple congestion control algorithms or TCP stacks.
Body:

  Trim white space padding that gets added libxo fields cc and stack when
  using -C and -c.

  The padding is only visible if you're using multiple stacks or
  congestion algorithms.

  PR:             292262
  Reviewed by:    asomers, tuexen
  Approved by:    asomers (mentor)
  Differential Revision:  https://reviews.freebsd.org/D54709

  (cherry picked from commit faa31fc0e7acc1c53bba2b69a63e9ff55d24faf7)


   usr.bin/netstat/inet.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 4f0342cf84dbe4fadbfea02e3279aafab36ea848]
Date: 2026-01-07
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Bootloader.general
Subject: lualoader: fix pruning of non-existent default kernel
Review: The lualoader boot menu now correctly updates the default kernel setting when the default kernel is removed, preventing boot failures when not using the kernel selector.
Body:

  Removing the kernel from the list of available kernels is sufficient to
  avoid rendering it in the list, but we need more for booting to actually
  work.  Notably, the 'kernel' loader.conf var was left intact to its
  default value, so if one didn't use the kernel selector in the menu then
  we'd try to boot the nonexistent 'kernel' instead of the new default
  (first autodetected).

  There's room to improve the error messages here, but for now let's just
  make it actually work correctly.

  PR:		292232
  Fixes:	d04415c520b03 ("loader: lua: remove the default kernel [...]")
  (cherry picked from commit e30086ab4c8778ea70a3b19e83546ce1b4a16492)


   stand/lua/core.lua | 6 ++++++
   1 file changed, 6 insertions(+)

[commit 919c1e19058d2e214fa3c33498123adb6ca3366c]
Date: 2025-12-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Modirum MDPay | Klara, Inc.
Section: Userland.programs
Subject: bectl: log modifying functions to zpool history
Review: The man:bectl[8] utility now logs its modifications to the ZFS pool history, providing an audit trail for boot environment operations.
Body:

  Modeled directly after the method used by the zfs/zpool commands: flag
  commands with a "please log me" flag, and when there, reconstruct the
  command line. On success, call the library function to add it to the
  log.

  (Majority of the change by Rob; minor edits by kevans@)

  Signed-off-by: Rob Norris <rob.norris@klarasystems.com>
  Co-authored-by:	Kyle Evans <kevans@FreeBSD.org>
  Sponsored by:	Modirum MDPay
  Sponsored by:	Klara, Inc.
  (cherry picked from commit 2a87929671e6e6919c18f2c25d60f2c73c3d18f4)


   lib/libbe/be.c     | 12 +++++++++
   lib/libbe/be.h     |  2 ++
   lib/libbe/libbe.3  | 16 ++++++++++--
   sbin/bectl/bectl.c | 73 ++++++++++++++++++++++++++++++++++++++++++------------
   4 files changed, 85 insertions(+), 18 deletions(-)

[commit d3c523b6f5aa644e85d7c2c1177953f5d73e8529]
Date: 2025-11-04
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: makedev(9): drop an additional note about cdevpriv dtors
Review: The man:make_dev[9] manual page now includes a note about a potential deadlock when calling destroy_dev(9) from a cdevpriv destructor, clarifying a previously safe scenario that now risks deadlock.
Body:

  These were previously somewhat safe to call destroy_dev(9), but will now
  also cause a deadlock in the same fashion that d_close doing so would
  previously.  Amend the note to point it out, in case it's useful for
  someone.

  Reviewed by:	imp, kib, markj

  (cherry picked from commit 90314c04f10f583c37c59ec51fd628e3deaf3622)


   share/man/man9/make_dev.9 | 12 ++++++++----
   1 file changed, 8 insertions(+), 4 deletions(-)

[commit b196a718ca0e77685b8e40aaac0911f11604d00c]
Date: 2025-10-29
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: libc: report _SC_NPROCESSORS_ONLN more accurately in cpu-limited jails
Review: The sysconf(3) function now reports the number of CPUs available to the process based on its cpuset restrictions, particularly affecting jails with CPU limits. This provides a more accurate count for cpu-limited jails, though it may slightly reduce query performance.
Body:

  We don't support CPU hotplug, but we do support cpuset(8) restrictions
  on jails (including prison0, which uses cpuset 1).  The process cannot
  widen its cpuset beyond its root set, so it makes sense to instead
  report the number of cpus enabled there rather than the total number
  in the system.

  This change is effectively a nop for the majority of systems and jails
  in the wild, though it does reduce the performance of this query now
  that we can't take advantage of AT_NCPUS being provided in the auxinfo.

  The implementation here is notably different than Linux, which would not
  take cgroups into account.  They do, however, take CPU hotplug into
  account, so the possibility for it to diverge from (and be lower than)
  the # configured count to reflect what the process can actually be
  scheduled on doesn't really diverge in semantics.

  Reviewed by:	kib

  (cherry picked from commit d617806aac1469319970e3551656e9deabb98a35)


   lib/libc/gen/sysconf.3           |   6 +-
   lib/libc/gen/sysconf.c           |  16 ++++-
   lib/libc/tests/sys/cpuset_test.c | 140 ++++++++++++++++++++++++++++++++++++++-
   3 files changed, 156 insertions(+), 6 deletions(-)

[commit 57b08d98db0a5bc16a6f0b47ade5b25021564d14]
Date: 2025-10-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: libutil: defer setting the MAC label until after the login class
Review: The MAC label is now set after the login class, preventing conflicts with MAC policies like mac_biba(4) that restrict login class changes after labeling. This ensures class-based configurations work correctly during initial login setup.
Body:

  MAC policies, like mac_biba(4), may forbid changing the login class once
  a label has been applied.  For setting up the initial login context,
  this isn't really expected and in-fact may break some class-based
  configuration.

  Defer setting the MAC label until after the login class is set, and
  remove the requirement that we have a pwd entry since the label is
  pulled from the login class -- we only use pwd for syslog in this path.

  Patch is largely by Kevin Barry, with some modifications and this commit
  message by kevans@.

  PR:		177698
  Reviewed by:	des, olce
  Co-authored-by:	Kevin Barry <ta0kira gmail com>

  (cherry picked from commit 98edcbcce0a4650084bd86e704cfa38bf590250c)


   lib/libutil/login_class.c | 55 ++++++++++++++++++++++++++---------------------
   1 file changed, 30 insertions(+), 25 deletions(-)

[commit f00ebc7eb3a65494749fb85b3fd8f27ea09296ae]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Docs.manpages
Subject: libc: fix description issues in mac_text(3)/mac_free(3)
Review: The commit corrects documentation errors in man:mac_text[3] and man:mac_free[3] regarding the freeing of mac_t objects. This clarifies that mac_t should not be freed with free(3), preventing potential misuse.
Body:

  mac_text(3) as-written would seem to indicate that a `mac_t` should be
  freed with free(3), but this isn't the case.  One can derive from
  context from when the change was introduced and COMPATIBILITY that this
  was intended to talk about *text in `mac_to_text`, so move the comment
  there.

  PR:		179832
  Co-authored-by:	Priit Jrv <priit cc ttu ee>

  (cherry picked from commit 081218b7a2006e5b6783e51f66fd751871ac1272)


   lib/libc/posix1e/mac_free.3 | 4 ++--
   lib/libc/posix1e/mac_text.3 | 8 +++++---
   2 files changed, 7 insertions(+), 5 deletions(-)

[commit b46515ed59a8c1923f1a6bec04729feef72cf4bc]
Date: 2025-12-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sockstat: improve printaddr() according to style(9)
Review: Minor style improvements to man:sockstat[1] with no user-visible impact.
Body:

  Reviewed by:	des
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D54412

  (cherry picked from commit f89f7e58ba1d54c6a683e3cc899938895496c088)


   usr.bin/sockstat/sockstat.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit dccf0058ef62802fc44e041b4fd6ba1a3fb4439c]
Date: 2026-01-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: grep/tests: Fix up the zgrep executable path in a newly added test
Review: The commit fixes a test script path for zgrep, which is an internal test-only change with no user-visible impact.
Body:

  Fixes:	da5d94d29a5e ("Remove obsolete BUGS section from zgrep(1) man page, add test")
  (cherry picked from commit 045112f148fa092c92ec53204708f638b226ff8f)


   usr.bin/grep/tests/grep_freebsd_test.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 582882558ce9e894e467aed31571f67aa8ae7e65]
Date: 2026-01-09
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: Remove obsolete BUGS section from zgrep(1) man page, add test
Review: The commit removes an obsolete BUGS section from the zgrep(1) man page and adds a test for multiple -e flags. The user-visible impact is that the man page is updated to reflect current behavior, and the test ensures functionality.
Body:

  I forgot to check/update the man page with D54217. While here add
  a test for multiple -e flags.

  Reviewed by:	markj
  Approved by:	markj
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54632

  (cherry picked from commit da5d94d29a5ec29817476c39ae2b2ad1666c3f06)


   usr.bin/grep/tests/grep_freebsd_test.sh | 11 +++++++++++
   usr.bin/grep/zgrep.1                    | 18 ------------------
   2 files changed, 11 insertions(+), 18 deletions(-)

[commit 916166d9f98f6db8630b1955c1ae5606614a950f]
Date: 2025-06-25
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: uchcom.4: Add HARDWARE, makeover
Review: The man:uchcom(4) manual page is updated with improved documentation, including hardware information, clearer usage description, and references to related sysctl and applications.
Body:

  Tag spdx, improve document description for apropos, improve synopsis
  for clarity and consistency, improve description to explain usage,
  improve hardware for hardware release notes, mention the sysctl, xref
  the application to use this driver, improve history.

  MFC:			no (unless change adding CH9102/CH343 mfcs)
  Fixes:			1395712cab8e9 (add support for CH9102 and CH343)
  Reviewed by:		carlavilla, kevlo
  Differential Revision:	https://reviews.freebsd.org/D51036
  (cherry picked from commit f0ba0b99ef0a9cf9e7822278d7d2bc0a80911361)


   share/man/man4/uchcom.4 | 88 +++++++++++++++++++++++++++++++++++--------------
   1 file changed, 64 insertions(+), 24 deletions(-)

[commit 8241dbc3a2af6e422774904dfa42feb0241b36c5]
Date: 2026-01-08
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Kernel.general
Subject: GCE: ARM64 Support: Add hw.pci.honor_msi_blacklist=0.
Review: The hw.pci.honor_msi_blacklist sysctl is set to 0 by default in GCE ARM64 configurations, enabling MSI support for devices like gve(4) and nvme(4) on Google Cloud ARM64 instances. This prevents boot panics and improves interrupt handling for these drivers.
Body:

  This is required for MSI support on GCE ARM64 instances which is
  prerequisite to gve(4) not panicking at boot, and nvme(4) also has
  a real sad time without interrupts. Tested on a variety of c4a VMs.

  This is meant to be a temporary hack; long term fix would be to
  check for the hypervisor and quirk gve(4) device with
  PCI_QUIRK_ENABLE_MSI_VM.

  PR:		kern/292081
  (cherry picked from commit 9ae43352c89c776c8171f5881a984bc39acf5d6a)


   release/tools/gce.conf | 3 +++
   1 file changed, 3 insertions(+)

[commit dd1d6a06542cb07acf23682d77eed1a093226d76]
Date: 2026-01-14
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: net80211: fix arguments to IEEE80211_NOTE in ieee80211_fix_rate
Review: Fixes a debug logging macro call in the net80211 wireless stack, which may affect debug output but does not change user-visible functionality.
Body:

  Fix the arguments to the debug statement.

  (slightly adjusted from the original submission by bz)

  PR:		286448

  (cherry picked from commit 75556c7e999e9095ce71558ae61f49c1ba61a192)
  (cherry picked from commit 2e93d2f39d72e5542781165c368343d7d73643e9)


   sys/net80211/ieee80211_proto.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 16e2bb8177bd86a954ef968551d8c8980582381a]
Date: 2026-01-16
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Kernel.general
Subject: UPDATING: Bump __FreeBSD_version to 1403508 for various LinuxKPI changes
Review: The __FreeBSD_version macro is updated to 1403508, which may affect software that checks for specific FreeBSD versions during compilation.
Body:

  Precautiously bump __FreeBSD_version for  various LinuxKPI changes
  so they could be detected if needed (which they should not need to,
  hopefully).


   UPDATING        | 4 ++++
   sys/sys/param.h | 2 +-
   2 files changed, 5 insertions(+), 1 deletion(-)

[commit fff9ab9ed295e7f584feba459a1f0a3f4a1b783e]
Date: 2025-12-28
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: 802.11: reset hdr after crypto in lkpi_80211_txq_tx_one()
Review: The LinuxKPI 802.11 subsystem now correctly resets the frame header pointer after crypto offloading operations, ensuring proper packet classification and queueing. This resolves an issue where rtwx8 driver packets would not flow after block-ack negotiation.
Body:

  When lkpi_80211_txq_tx_one() calls into the crypto offloading parts to
  possibly make space in the headroom, the beginning of our frame moves.
  We have to reset hdr after that call as otherwise later classifications
  based on the hdr->frame_control will fail or cause wrong classificaiton
  of packets.
  This makes sure frames will either be directly sent using (*mo_tx)()
  or use the correct tid for the correct queue.  This helps to get
  rtwx8 packets flowing after BA was negotiated.

  Sponsored by:	The FreeBSD Foundation
  Fixes:		11db70b6057e4

  (cherry picked from commit f0395993e1ea83705e0da6623843e7d5d03f7269)
  (cherry picked from commit 4d255abe992fef69c97ce10991d815eda638c76d)


   sys/compat/linuxkpi/common/src/linux_80211.c | 2 ++
   1 file changed, 2 insertions(+)

[commit e7c3b91d30176988612f3ab95140f50f13f29178]
Date: 2025-12-28
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: add compat.linuxkpi.80211.IF.dump_stas_queues
Review: The commit adds queue information to the compat.linuxkpi.80211.IF.dump_stas sysctl, which can be used for debugging wireless driver issues.
Body:

  Extend the normal compat.linuxkpi.80211.IF.dump_stas sysctl by
  queue information.  This was helpful for debugging various issues,
  like selecting the outbound queue, stopping queues for BAR and helped
  finding multiple bugs.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 32ea8209825af594cbfa1fc654d45eb9a6aab528)
  (cherry picked from commit 6b9c0ac008a9c52b21b05c96ead6def41aa89ead)


   share/man/man4/linuxkpi_wlan.4               |  9 +++-
   sys/compat/linuxkpi/common/src/linux_80211.c | 78 ++++++++++++++++++++++++++--
   sys/compat/linuxkpi/common/src/linux_80211.h |  4 ++
   3 files changed, 85 insertions(+), 6 deletions(-)

[commit 8fc0789a4dda595311bec566719ff3c2e2744ee2]
Date: 2025-12-10
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: lock down the "txq_scheduled" tailq
Review: The LinuxKPI 802.11 subsystem now uses a per-transmit-queue lock for the scheduled queue, preventing kernel panics during concurrent access, especially noticeable during high-rate network traffic with multiple wireless chipsets.
Body:

  For consistency rename the "scheduled_txqs" tailq to
  "txq_scheduled" and add a lock per txq ("txq_scheduled_lock[]").
  We use the "_bh" locking as this called from the device driver.

  This fixes panics due to concurrent access to the tailq, especially
  in between "first" and "remove" on the out-direction and between
  "insert" and "elem_init" on the in-direction.

  This was easily reproducible just running iperf3 at basic rates for
  a few seconds to minutes with multiple chipsets, not only rtw89.

  Sponsored by:	The FreeBSD Foundation
  PR:		290636
  Reported by:	arved, and others before

  (cherry picked from commit 567a097c8ab60d9fcd68a87c3c5ad605fe8715cc)
  (cherry picked from commit 2e1156f75836a0e5a4026e13d72b54f272e705cb)


   sys/compat/linuxkpi/common/src/linux_80211.c | 51 ++++++++++++++++++++++------
   sys/compat/linuxkpi/common/src/linux_80211.h |  3 +-
   2 files changed, 42 insertions(+), 12 deletions(-)

[commit 1b9d37ebbdb36be70c26da4c3a801cd2fb346b70]
Date: 2025-11-25
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: mt76: set appropriate CONFIG options for the module build
Review: The commit adjusts build configuration options for the mt76 wireless driver module, but does not introduce user-visible changes in functionality, hardware support, or behavior.
Body:

  Always set CONFIG_ARCH_DMA_ADDR_T_64BIT as it is true for all
  architectures we support.  Add an option for CONFIG_NET_MEDIATEK_SOC_WED,
  which we currently do not yet support.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 87aa494dfca73204516799033821ab1db184933f)
  (cherry picked from commit e2ebe56c50e77f3302c85a8203f8fa4050ae0f54)


   sys/modules/mt76/Makefile.inc | 9 +++++++++
   1 file changed, 9 insertions(+)

[commit 7e2143845d30bd66424e87c61eb2bd16a3da9622]
Date: 2025-11-25
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: LinuxKPI: mt76: depend on CONFIG_NET_MEDIATEK_SOC_WED
Review: The commit adds a dependency on CONFIG_NET_MEDIATEK_SOC_WED for the LinuxKPI mt76 driver, which is an internal kernel configuration change without direct user-visible impact.
Body:

  If CONFIG_NET_MEDIATEK_SOC_WED is not set then be silent;  if
  CONFIG_NET_MEDIATEK_SOC_WED is set we will enable logic or rather te
  pr_debug("TODO") calls for now.

  Spsonsored by:	The FreeBSD Foundation

  (cherry picked from commit 51c73fc5f5dd95c6a0e3d232091a732a14c7ecc9)
  (cherry picked from commit 7ed3a99f3563fce1f1088a376151e7ad68b738d6)


   .../common/include/linux/soc/mediatek/mtk_wed.h    | 28 +++++++++++++++++++++-
   1 file changed, 27 insertions(+), 1 deletion(-)

[commit 78e0a224f50856ad33fc0484fad11ee3dc3b2dcf]
Date: 2025-12-03
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: move ieee80211_offload_flags
Review: No functional changes; only internal code movement.
Body:

  Move the enum and leave a comment on the struct member for the vif
  about the type.

  No functional changes.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit b10ff7ed37a9b891bec7e1093e44fa7abb2054b4)
  (cherry picked from commit a714641fa5380cc320d23181d4b18f7f89ccd183)


   sys/compat/linuxkpi/common/include/net/mac80211.h | 14 +++++++-------
   1 file changed, 7 insertions(+), 7 deletions(-)

[commit 2a04a8562ecc23d68f64d0b8df86b5f3da223ac5]
Date: 2025-12-03
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: device: add a pr_debug("TODO") call to device_release_driver()
Review: The commit adds a debug logging call that does not affect user-visible behavior, performance, or configuration.
Body:

  The logic in device_release_driver() got disabled in 93b14194acaf2
  and since left alone.  Add a pr_debug() call so we have a chance to
  notice if that code is actually still in need to be fixed and re-enabled.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit fc9666d0fc0c2541e44bfbcaa5bb1b670395687c)
  (cherry picked from commit 0f496780deee49cfd86f4e02db775b706405fef9)


   sys/compat/linuxkpi/common/include/linux/device.h | 1 +
   1 file changed, 1 insertion(+)

[commit bd339e8341bac1a20716c662b6d024161ec4f8c6]
Date: 2025-12-03
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: make airtime fairness an IMPROVE
Review: The commit changes a TODO comment to an IMPROVE comment in the LinuxKPI header, which has no user-visible impact.
Body:

  We are ways away from implementing "airtime fairness" in LinuxKPI
  (or rather net80211).  For now make it an 'improve' rather than a
  'todo' to get the logging away.  Everything will work without it.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 86bfe5b4d5a7b90d3746059dd1f87cdd5a0bf90c)
  (cherry picked from commit c55874da4cf57800fc8a665ee221e4c2e1ac6601)


   sys/compat/linuxkpi/common/include/net/mac80211.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit add692e05ca1825b974804ad65d961719be098f2]
Date: 2025-11-17
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: LinuxKPI: 802.11: initialize the passed in chandef in cfg80211_chandef_create
Review: Initializes the cfg80211_chan_def structure in cfg80211_chandef_create() to prevent uninitialized memory access, addressing a compiler warning.
Body:

  cfg80211_chandef_create() gets passed a pointer to a cfg80211_chan_def.
  It seems that several users are passing in an uninitialized variable
  from the stack and expect cfg80211_chandef_create() to initialize it.
  Run memset() on the struct, which for all callers currently seems to do
  the right thing, to avoid later accesses to uninitialized struct members
  like "punctured".

  Reported by:	CI (gcc build)
  Sponsonred by:	The FreeBSD Foundation

  (cherry picked from commit 640205bc22c8b2bd31c766f4d0c409c183a8b8dc)
  (cherry picked from commit d389d1ac1699aea517a18cf73486e7077cfbda46)


   sys/compat/linuxkpi/common/include/net/cfg80211.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6b70b671b3c89678866a6d4979d214434c095186]
Date: 2025-10-11
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Network.wireless
Subject: LinuxKPI: 802.11: additions for Linux v6.17 based wireless drivers
Review: LinuxKPI 802.11 subsystem is updated with additions for Linux v6.17 based wireless drivers. This includes new functions, defines, and struct members to support newer wireless drivers.
Body:

  This includes some type cleanups as well as some shuffling of structs
  and functions to sort dependencies out.  Few new functions and defines
  as well as new struct members.  Minor fixes to style and debug logging.

  This is the majority of changes.  None of these should conflict with
  current in-tree drivers.  The final bit of changes will come along with
  the driver updates adding an extra argument to function pointers.

  (cherry picked from commit 0567484734ad9732978e189ebed042f6320e2471)
  (cherry picked from commit f2b2d6c18a57abbedb14bf439ed5c69d648c47b6)


   .../linuxkpi/common/include/linux/ieee80211.h      |   2 +
   sys/compat/linuxkpi/common/include/linux/nl80211.h |  10 +
   sys/compat/linuxkpi/common/include/net/cfg80211.h  | 320 ++++++++++++++-------
   sys/compat/linuxkpi/common/include/net/mac80211.h  |  37 +--
   sys/compat/linuxkpi/common/src/linux_80211.c       |  12 +-
   5 files changed, 246 insertions(+), 135 deletions(-)

[commit a7ac5ba799c74f34effc88e7161873777d3675d8]
Date: 2025-10-17
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: LinuxKPI: netdevice add attach/detach skeleton functions
Review: The LinuxKPI netdevice interface adds skeleton functions for netif_device_attach/detach() to support rtw8[89] driver updates.
Body:

  For the moment add skeleton functions for netif_device_attach/detach()
  needed by rtw8[89] v6.17.

  (cherry picked from commit 5ea941a4fbfd1ba2483e47fe30ed6713fe912284)
  (cherry picked from commit 4bdd0e51d7113aadcbfba9a76d72d8e924c5dcdf)


   sys/compat/linuxkpi/common/include/linux/netdevice.h | 15 +++++++++++++++
   1 file changed, 15 insertions(+)

[commit efa6449e09dae6a8ee2a111313f761c275dc5fc7]
Date: 2025-10-11
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Network.wireless
Subject: LinuxKPI: skbuff: add a misplaced socket operation to skbuff.h for now
Review: The commit adds a missing socket operation definition to the LinuxKPI skbuff.h header, which is needed for a wireless driver at version 6.17. This enables compatibility with newer Linux wireless drivers in the LinuxKPI subsystem.
Body:

  This likely belongs in socket code which we do not have in LinuxKPI.
  Needed by a wirless driver at v6.17.

  (cherry picked from commit 88dbf83345feefa7181bd6df47786e1a8d1d304d)
  (cherry picked from commit 3ad05fa24a240011a8252140ff6431cb0b7879d9)


   sys/compat/linuxkpi/common/include/linux/skbuff.h | 3 +++
   1 file changed, 3 insertions(+)

[commit a75a58393b81a3a9d2c36eb7f5770d2b50d7ebee]
Date: 2025-10-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: LinuxKPI: soc/mediatek add pr_debug calls
Review: Adds debug logging to the LinuxKPI MediaTek subsystem for unsupported Wireless Ethernet Dispatch (wed) functionality.
Body:

  We do not support Wireless Ethernet Dispatch (wed) on the mt76 (yet).
  Add pr_debug calls with TODO in case we run into the calls anyway so
  we could deal with them.

  (cherry picked from commit 224ac9d2a030f85924e44a507ddc412797c3fe87)
  (cherry picked from commit b9b571e6146a1b95ba18de065166a1a50eb88dfc)


   .../common/include/linux/soc/mediatek/mtk_wed.h    | 46 +++++++---------------
   1 file changed, 15 insertions(+), 31 deletions(-)

[commit 26d5278eaee0025a0a24c3860fc58fd2be26c7d9]
Date: 2025-10-19
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: LinuxKPI: page_pool headers moved; add netmem.h
Review: LinuxKPI page pool headers are restructured to match upstream Linux 6.17 changes, adding netmem.h and splitting page_pool.h into types.h and helpers.h.
Body:

  page_pool headers were not used yet;  they were created for mt76 but
  are without functionality.  Upstream has migrated them for v6.17 and
  split them up into multiple files.  Also add netmem.h which the little
  needed is directly related to page pools.

  (cherry picked from commit 7c31cdfa408a4ebce7a3e10d29056a15c28bc092)
  (cherry picked from commit d388ff8016adf0f24b9b846941f1f15f5463c49e)


   sys/compat/linuxkpi/common/include/net/netmem.h    |  21 ++++
   sys/compat/linuxkpi/common/include/net/page_pool.h | 119 ---------------------
   .../common/include/net/page_pool/helpers.h         |  79 ++++++++++++++
   .../linuxkpi/common/include/net/page_pool/types.h  |  36 +++++++
   4 files changed, 136 insertions(+), 119 deletions(-)

[commit 1f9ca940c1ba1e27b3dbd62d8dd6384cd7c4c8c1]
Date: 2025-10-17
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: LinuxKPI: add skeleton pci_enable_wake()
Review: The commit adds a skeleton implementation of pci_enable_wake() in the LinuxKPI compatibility layer, which does not yet provide functional wake support but prepares for future implementation. This change has no immediate user-visible impact.
Body:

  Given we do not yet support "wake" bits in device there is little need
  doing it in PCI if we cannot check if we are supposed to do the
  operation in first place.  Once we would implement this, we would need
  to also do the appropriate PCI (pme) checks before enabling (disabling)
  it.

  Reviewed by:	dumbbell
  Differential Revision: https://reviews.freebsd.org/D53208

  (cherry picked from commit 885e8f272f7515b0325974de72d18b73318eff07)
  (cherry picked from commit be52a81be07997f84f454637372a056415f6a2eb)


   sys/compat/linuxkpi/common/include/linux/pci.h | 13 +++++++++++++
   1 file changed, 13 insertions(+)

[commit 6248a65545474b0e534ddcf97959205f133ac2de]
Date: 2025-10-17
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Drivers.device
Subject: LinuxKPI: add fips.h
Review: LinuxKPI adds a stub fips.h header, which does not enable FIPS compliance but may affect compatibility with Linux drivers.
Body:

  We do not currently aim to support crypto FIPS compliance in LinuxKPI
  so keep this turned off.

  Reviewed by:	emaste, dumbbell
  Differential Revision: https://reviews.freebsd.org/D53207

  (cherry picked from commit 98609f4fecffd0e70293ddd57c2b785e498b1131)
  (cherry picked from commit 3aaaba20786966062d1355d4809142b623ffc4b7)


   sys/compat/linuxkpi/common/include/linux/fips.h | 12 ++++++++++++
   1 file changed, 12 insertions(+)

[commit 4c27dfb166f12bf27cd25a52442f4aa744c513e6]
Date: 2025-10-11
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: LinuxKPI: platform_device return type change
Review: The LinuxKPI platform_device return type change is an internal API adjustment with no direct user-visible impact, as it affects unsupported driver code and is not used by any active, supported drivers.
Body:

  The return type now is void;  I believe no one ever used this
  so we can just chnage it.  The only active platform_driver_register()
  calls seems to be in ath1[01]k and mt76 and there in unsupported code.

  Reviewed by:	dumbbell, emaste
  Differential Revision: https://reviews.freebsd.org/D53205

  (cherry picked from commit 0ae4998423e0d513fb88e404dfb1c2a285d11309)
  (cherry picked from commit 5434a1635ed3fab8214f3fea8ada9772e4372372)


   sys/compat/linuxkpi/common/include/linux/platform_device.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b0497fabb9d462fa3b9e443188c7dd98b8dbc1b0]
Date: 2025-10-11
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: LinuxKPI: add three skeleton functions to etherdevice.h
Review: Adds skeleton functions to LinuxKPI etherdevice.h with placeholder debug messages; no functional change.
Body:

  We will see how much we will need them and how to fill them at that
  point.  They are left with a pr_debug("TODO") for now.

  Differential Revision: https://reviews.freebsd.org/D53204

  (cherry picked from commit cc792250acadd29e80a69501ad326d1340c0c1c6)
  (cherry picked from commit 805038b70a23f3f488ecba6e103f2aa1f9dad63c)


   .../linuxkpi/common/include/linux/etherdevice.h    | 23 ++++++++++++++++++++++
   1 file changed, 23 insertions(+)

[commit 923c01f09ba737490e9ac9ee122f4de6742ca077]
Date: 2025-10-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: LinuxKPI: add __counted_by_le() and __counted_by_be()
Review: Adds __counted_by_le() and __counted_by_be() macros to the LinuxKPI for compatibility with a wireless driver at version 6.17.
Body:

  The former is needed by a wireless driver at v6.17.

  Reviewed by:	dumbbell, emaste
  Differential Revision: https://reviews.freebsd.org/D53203

  (cherry picked from commit 0a4b11ddb298fa08e1a81af7337995a3769552bf)
  (cherry picked from commit 0e30cab0f32ee40e89f59b3a287ae96c084e1e7a)


   sys/compat/linuxkpi/common/include/linux/compiler.h | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit 710bc041bb138e8a24c71fbb970d6c54106ef84d]
Date: 2025-10-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: igc(4): also build module on aarch64
Review: The igc(4) driver module is now built on aarch64, making it available for use on ARM64 systems with compatible Intel Ethernet hardware.
Body:

  igc(4) seems to work fine on arm64 for as much as I could test with
  a 2.5Gbit/s interface on a mPCIe card.
  Enable the module build so it is available.

  (cherry picked from commit 51fbeadac4ccce6aafe51be9377d4114321295e5)
  (cherry picked from commit 2c345e94ae0048ecec577ab52bc81510365038d0)


   sys/modules/Makefile | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6d7d95b4758d04adcf051d6dcf7355caf4a1f2cd]
Date: 2025-10-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: dc(4): fix argument to if_foreach_llmaddr() for 21143.
Review: The dc(4) driver no longer crashes due to an incorrect argument passed to if_foreach_llmaddr().
Body:

  As found on RTEMS the argument to if_foreach_llmaddr() was wrong
  causing crashes.

  Fixes:		51e80820552e0
  PR:		290314

  (cherry picked from commit 33afdf0e356d84ffe5c62c886f84cf12ba147d3e)
  (cherry picked from commit 10c71151ade7b5f021b49b7e117059730a2ddb56)


   sys/dev/dc/if_dc.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 61c549c2bbf01eacb74093674694c595ded0e757]
Date: 2025-10-13
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: fwget: pci: mediatek: correct package name
Review: The commit corrects a package name reference in fwget's mediatek PCI network firmware fetching logic, ensuring the correct firmware package (wifi-firmware-mt76-kmod) is identified for MediaTek WiFi devices.
Body:

  The port is called wifi-firmware-mt76-kmod not "mediatek" in the
  moddle.

  Reported by:	Lars Tunkrans (drsnx60 gmail.com)
  Reviewed by:	emaste, jrm, imp
  Differential Revision: https://reviews.freebsd.org/D53067

  (cherry picked from commit 10d88a7aa670a3cc2bf763e64bd292b4caa3a811)
  (cherry picked from commit e0487486279bc0690f65401622deebdbdea6a882)


   usr.sbin/fwget/pci/pci_network_mediatek | 36 ++++++++++++++++-----------------
   1 file changed, 18 insertions(+), 18 deletions(-)

[commit 8d76cbe16b42749336cf369fbba850bfb30e5cd6]
Date: 2025-09-04
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation (initially)
Section: Drivers.device
Subject: LinuxKPI: pci: implementation of [lkpi_]pci_get_slot()
Review: The LinuxKPI PCI compatibility layer adds a pci_get_slot() function for wireless driver support, with a guard to avoid conflicts with the native FreeBSD PCI function.
Body:

  Like lkpi_pci_get_domain_bus_and_slot() implement lkpi_pci_get_slot()
  using pci_find_bsf() instead of pci_find_dbsf() (no domain).
  This is needed for a wireless driver.

  Unfortunately the name [pci_get_slot()] collides with the native PCI
  function.  Add a guard around it and disable the use when the native
  version is required (in lkpifill_pci_dev() and in bnxt/bnxt_en; if the
  latter gets fixed we can probably also fix work around it in the former;
  further conflicts in drm-kmod 6.1-lts, 6.6-lts, and master were resolved).

  Sponsored by:	The FreeBSD Foundation (initially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52065

  (cherry picked from commit 4179e6b78297369f0cf0eae1076e01e5151c5cbe)
  (cherry picked from commit 62c3b77d1d1084dc46663eed52e288307b5c7e64)


   sys/compat/linuxkpi/common/include/linux/pci.h |  6 ++++++
   sys/compat/linuxkpi/common/src/linux_pci.c     | 15 +++++++++++++++
   sys/dev/bnxt/bnxt_en/if_bnxt.c                 |  1 +
   3 files changed, 22 insertions(+)

[commit 2f4700c4dc1598c1b99996412a932764d5cbac45]
Date: 2025-09-04
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation (initially)
Section: Hardware.virtualization
Subject: LinuxKPI: pci: allocate entire pci_dev hiereachy up to root port on attach
Review: The LinuxKPI PCI subsystem now allocates pci_dev structures for the entire device hierarchy up to the root port during attach, ensuring compatibility with drivers like iwlwifi(4) that may operate in non-sleepable contexts.
Body:

  In linux_pci_attach_device() allocate a LinuxKPI pci_dev for each device in
  the hierarchy up to the root port[1] as we cannot do that later on demand
  as we may be in a context where we may not sleep.

  Take special care of DRM as there is a non-PCI device in the chain which
  needs to be skipped.

  iwlwifi(4) can hit this case called from a callout.

  While here leave a comment as the cleanup order of
  linux_pci_attach_device() needs correction seperately.

  Sponsored by:	The FreeBSD Foundation (initially)
  PR:		283027
  PR:		289647
  Suggested by:	jhb [1]
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52069

  (cherry picked from commit bbeeb585315645db20118ef349a4e3dc83b148cc)
  (cherry picked from commit 3860afe99ec39b9942967941181f28f27f3fc548)
  (cherry picked from commit 123c2dc6e15a62ceba3469caf0f1a6801214a7d3)
  (cherry picked from commit d8972ad2f6e7113d779d4ec975ce32552030b2a3)


   sys/compat/linuxkpi/common/src/linux_pci.c | 47 +++++++++++++++++++++++++-----
   1 file changed, 40 insertions(+), 7 deletions(-)

[commit 64075d53646679554c6b62911076b6b26e862acf]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: LinuxKPI: 802.11: avoid recursive wiphy lock
Review: The LinuxKPI 802.11 subsystem avoids a potential deadlock when freeing network nodes by deferring key deletion until after the wiphy lock is released.
Body:

  When freeing the last reference of the net80211 node the net80211
  node_free() code may directly call into the crypto code to delete
  the keys.  While we still holding the wiphy lock this would lead to
  a recursion on the non-recursive wiphy lock.  Defer freeing the
  reference until we are back under the net80211 com lock.

  Reported by:	Mark Phillips (mark freebsdfoundation.org) on 15.0-ALPHA1

  (cherry picked from commit 3c38dce87ecd2c87744e4b7ff1904ee841f88a47)
  (cherry picked from commit b0469fa7f10f9fe5510a5445f38d1bf0b832c1e7)


   sys/compat/linuxkpi/common/src/linux_80211.c | 54 ++++++++++++++++++----------
   1 file changed, 36 insertions(+), 18 deletions(-)

[commit 62d86be3d64d65ba207f81f18d0dbf38f57935ee]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation (initially)
Section: undecided
Subject: LinuxKPI: devres: divorce dem_kfree from lkpi_devm_kmalloc_release
Review: The commit fixes an internal LinuxKPI devres issue discovered during a driver update, with no direct user-visible impact.
Body:

  dem_kfree() is called from all over the place and should actually
  do something;  contrary to lkpi_devm_kmalloc_release() it can also
  take a const void *.  We have to __DECONST() that though as the
  entire devres framework does otherwise not take a const argument.

  This was discovered during the rtw89 update to 6.16.

  Sponsored by:	The FreeBSD Foundation (initially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52082

  (cherry picked from commit 4ab64e34911ab06e567caaf07ed18f7770a61cc8)
  (cherry picked from commit f20a09e161f07874c3a01b1579e8a5d2356df8ce)


   sys/compat/linuxkpi/common/include/linux/device.h |  5 +++--
   sys/compat/linuxkpi/common/src/linux_devres.c     | 26 ++++++++++++++++++++++-
   2 files changed, 28 insertions(+), 3 deletions(-)

[commit fa3f62df151532a2e6b2934d5d5dc632b923c2b5]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation (initially)
Section: undecided
Subject: LinuxKPI: maths64: implement roundup_u64()
Review: The commit adds a LinuxKPI helper function for a WiFi driver update, but it is an internal implementation detail with no direct uservisible effect.
Body:

  Needed by a wifi driver update.

  Sponsored by:	The FreeBSD Foundation (initially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52080

  (cherry picked from commit 2a44e10edb13e6b2be7fa2814b418a6959cb1171)
  (cherry picked from commit 88122c8eb70d81decb7c6dd16e551c3df6ad3818)


   sys/compat/linuxkpi/common/include/linux/math64.h | 6 ++++++
   1 file changed, 6 insertions(+)

[commit 4a3facee3ce66fedaafbb10dd2c927f001af2b7e]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=20)
Sponsor: The FreeBSD Foundation (initially)
Section: undecided
Subject: LinuxKPI: kunit: add static_stub.h and more dummy headers
Review: Adds LinuxKPI KUnit static stub header and dummy headers for wifi driver updates.
Body:

  These came up during a wifi driver update.

  Sponsored by:	The FreeBSD Foundation (initially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52079

  (cherry picked from commit 7c473933624f701263a83da526cac680b1ca69ed)
  (cherry picked from commit 3753913c9e1c3375be29b8f4ab925b054fe1ac4b)


   sys/compat/linuxkpi/common/include/kunit/static_stub.h | 15 +++++++++++++++
   sys/compat/linuxkpi/dummy/include/kunit/skbuff.h       |  0
   sys/compat/linuxkpi/dummy/include/kunit/test-bug.h     |  0
   sys/compat/linuxkpi/dummy/include/kunit/test.h         |  0
   4 files changed, 15 insertions(+)

[commit eba61bc6749e571ca5797b85f572925916266927]
Date: 2025-08-18
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation (initially)
Section: undecided
Subject: LinuxKPI: add __struct_size
Review: The commit adds a compiler macro for LinuxKPI internal use, which does not produce any user-visible changes in behavior, features, or configuration.
Body:

  Use __builtin_object_size() by default.
  If __builtin_dynamic_object_size() is available use that instead.

  I would hope that in a future version we can remove the conditional
  checks but in order to be able to MFC this without checking all
  compiler versions simply keep it this way for now.

  Sponsored by:	The FreeBSD Foundation (initially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52077

  (cherry picked from commit ff5bcb742899f8398ccb1b9e292b2e5aeeb7fedb)
  (cherry picked from commit 310885b40ad256b054d65353c375b29700ee024c)


   sys/compat/linuxkpi/common/include/linux/compiler.h | 6 ++++++
   1 file changed, 6 insertions(+)

[commit 163fe10479a34071eb860695459999e2575e714c]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation (initially)
Section: undecided
Subject: LinuxKPI: add DEFINE_LOCK_GUARD_0 for rcu
Review: The commit adds internal locking guard macros for the LinuxKPI subsystem, which is an internal implementation detail with no direct user-visible impact.
Body:

  This adds guard support for non-real-types like rcu locking meaning
  that we need to keep the lock state separately ourselves.  _T is still
  special and needs to be updated.  Given it may not be used it needs
  an __unused attribute (we are using the LinuxKPI __maybe_unused which
  indeed is more expressive in this case).

  Sponsored by:	The FreeBSD Foundation (initially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52076

  (cherry picked from commit 3f48a0fe53ca7e001852f4a406c1bdfab1cd2f6d)
  (cherry picked from commit 4d5a78c5f40aa2dfd672ccfa4a6fff93e216c32b)


   sys/compat/linuxkpi/common/include/linux/cleanup.h | 35 ++++++++++++++++++++++
   .../linuxkpi/common/include/linux/rcupdate.h       |  5 +++-
   2 files changed, 39 insertions(+), 1 deletion(-)

[commit 6ceb046df3d72dfa2c218fdb9b32635d11bdcfcd]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation (initially)
Section: undecided
Subject: LinuxKPI: cleanup: implement __free() and DEFINE_FREE(); use for kfree()
Review: The commit adds internal cleanup macros for the LinuxKPI subsystem, which is used by WiFi drivers, but it does not introduce any uservisible change in behavior, features, or configuration.
Body:

  A wifi driver update needs this.

  Sponsored by:	The FreeBSD Foundation (initially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52075

  (cherry picked from commit 39e9290d890b2aa07b68f2fe956b96e5df9a1da2)
  (cherry picked from commit 830cc677d97eebd02ade8b33ec17de38f2705a73)


   sys/compat/linuxkpi/common/include/linux/cleanup.h | 14 +++++++++++++-
   sys/compat/linuxkpi/common/include/linux/slab.h    |  4 ++++
   2 files changed, 17 insertions(+), 1 deletion(-)

[commit c84bfaa2531870a023fa9b267a765b9518ed3350]
Date: 2025-09-04
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation (intiially)
Section: Drivers.device
Subject: LinuxKPI: timer KPI *_timer -> timer_*
Review: The commit renames timer functions in the LinuxKPI to match Linux 6.2 changes, keeping old functions for compatibility. This affects Linux binary compatibility layer updates.
Body:

  del_timer() got renamed to timer_delete() approximately in Linux 6.2
  (similar for *_sync and likely others).
  Keep the old functions as compat; unclear when we can gc them.
  We should also re-define them with a linuxkpi_ prefix to avoid possible
  conflicts in the future if we do a full pass over this at some point.

  Sponsored by:	The FreeBSD Foundation (intiially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52074

  (cherry picked from commit 5cb64a1d3fe75526fb879ef4dce5860bbb4e4aea)
  (cherry picked from commit 88198564dbd82a97d655e73459c03eccf7031331)


   sys/compat/linuxkpi/common/include/linux/timer.h | 16 ++++++++++++++--
   sys/compat/linuxkpi/common/src/linux_compat.c    | 11 ++---------
   2 files changed, 16 insertions(+), 11 deletions(-)

[commit 3c1f1bcb14d3e1f8c4f3af912fdce867cc72f3ab]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=20)
Sponsor: The FreeBSD Foundation (initially)
Section: undecided
Subject: LinuxKPI: rename from_timer() to timer_container_of()
Review: The LinuxKPI subsystem updates its internal macro name to match Linux 6.16, affecting compatibility with Linux kernel modules. This change is transparent to users but ensures continued support for newer Linux driver code.
Body:

  With Linux 6.16 from_timer() got renamed to timer_container_of(); add
  the LINUXKPI_VERSION check with a default to the current version.
  Update all in-tree consumers (apart from wireless drivers managed
  otherwise).

  Sponsored by:	The FreeBSD Foundation (initially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52073

  (cherry picked from commit 81cb7c4c8e7bc4951c77fe64a63a847ed6abee38)
  (cherry picked from commit 352be5b48ba8b3ec1e3e5dd0dbee4da8d1fa78b0)


   sys/compat/linuxkpi/common/include/linux/timer.h | 5 +++++
   sys/compat/linuxkpi/common/src/linux_80211.c     | 2 +-
   sys/dev/irdma/irdma_cm.c                         | 2 +-
   sys/dev/irdma/irdma_utils.c                      | 4 ++--
   sys/dev/qat/qat_common/adf_gen4_timer.c          | 2 +-
   5 files changed, 10 insertions(+), 5 deletions(-)

[commit fe8793b39bef5a035aa4dce6fd8479f954ac5845]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation (initially)
Section: undecided
Subject: LinuxKPI: correct the LINUXKPI_VERSION check for abs_diff()
Review: The commit adjusts a version check for an internal LinuxKPI function, which does not result in any user-visible change in behavior, features, or configuration.
Body:

  The code introduced abs_diff() as migrated from drm to standard
  linux headers.  The LINUXKPI_VERSION check did not allow this to
  be visible by default in-tree.  Make sure the v6.6 check is optional.
  drm-kmod always defines LINUXKPI_VERSION so this should be fine.

  Sponsored by:	The FreeBSD Foundation (initially)
  Fixes:		afc450fac9f04
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52071

  (cherry picked from commit 736b16e88d2384f9dd0ec11c0492e825b8d42193)
  (cherry picked from commit ab45c859374d750a6b68292cf40889b8ca5db04a)


   sys/compat/linuxkpi/common/include/linux/math.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 8f8a0aadfa8d0176c0d2527973208850faf432d3]
Date: 2025-09-04
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: The FreeBSD Foundation (initially)
Section: Drivers.device
Subject: LinuxKPI: pci: allow children to be attached to a pci_dev
Review: The LinuxKPI PCI subsystem now allows child devices to be attached to a pci_dev, enabling suspend/resume hooks for LinuxKPI-based 802.11 drivers.
Body:

  This will be used for hooking suspend/resume in for LinuxKPI 802.11
  based drivers.

  Sponsored by:	The FreeBSD Foundation (initially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52070

  (cherry picked from commit 627234627b51c2f12c29d10617d7bbd18936ea55)
  (cherry picked from commit 8fca57469f7c33367c5f32f738a8fa8af40b6dda)


   sys/compat/linuxkpi/common/src/linux_pci.c | 3 +++
   1 file changed, 3 insertions(+)

[commit c017775775ee7548a071806042b0294e94824991]
Date: 2025-07-31
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation (intially) | The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: pci: implement [linuxkpi_]pcim_request_all_regions()
Review: The LinuxKPI PCI subsystem now implements pcim_request_all_regions() and adjusts error handling for pci_request_region() to improve compatibility with Linux drivers, particularly for SR-IOV and network interfaces like mlx5en(4).
Body:

  Factor out the pci_request_region() implementation into an internal
  function and make pci_request_region() a simple wrapperaround it.
  Likewise implement pcim_request_all_regions() as a loop calling
  pci_request_region() for each entry.

  In two cases which we returned an error before (bar index is valid but
  bar is not (no len), and neither IO nor MEM) we now reutrn success
  (nothing to do for us).  Otherwise callers, especially
  pcim_request_all_regions() would error out for the wrong reasons.
  This seems to also match the expected behaviour of pci_request_region().

  Sponsored by:	The FreeBSD Foundation (intially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52068

  LinuxKPI: pci: undo the pci_resource_len() check in lkpi_pci_request_region()

  Creating non-passthru SR-IOV interfaces on a mlx5en(4) failed.
  The problem lies in the pci_resource_len() call but not that the BAR length
  is tmeporary 0 but in that we call lkpi_pci_get_bar() with a true argument
  which will create the BAR resource for us and report the approriate length
  back.  However, the later call to bus_alloc_resource_any() will then fail
  given the resource already exists.

  Restore the previous behaviour and let bus_alloc_resource_any() do the
  work.  Adjust the return values from -ENODEV to -EBUSY to match callers
  expectations.

  In linuxkpi_pcim_request_all_regions(), like in linuxkpi_pci_request_regions(),
  filter out the -EBUSY errors as "not an error" and try the next bar.
  This also seems to be consistent with the expectations of the callers.

  PR:		290793
  Reported by:	David BOYER (jcduss13 gmail.com)
  Tested on:	mlx5en, iwlwifi, mt7921
  Reviewed by:	kib
  Fixes:		7e21158d44cd "implement [linuxkpi_]pcim_request_all_regions()"
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53902

  (cherry picked from commit 7e21158d44cd46e720395604ca6f00f2fa36b20c)
  (cherry picked from commit ff31767e530abb4a54131af199fed6ec946a5fa4)
  (cherry picked from commit ed29ffd396e522a45ab1980c12a75b3409b51712)
  (cherry picked from commit 2032abb31cbe067d41067a81e529d91f1bace4c9)


   sys/compat/linuxkpi/common/include/linux/pci.h | 11 ++++--
   sys/compat/linuxkpi/common/src/linux_pci.c     | 52 +++++++++++++++++++++-----
   2 files changed, 51 insertions(+), 12 deletions(-)

[commit 008b9c7db5b28ed38f30e05f9c0bfb6e30156a35]
Date: 2025-07-31
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: The FreeBSD Foundation (intially)
Section: Drivers.device
Subject: LinuxKPI: pci: implement pcim_iomap()
Review: The LinuxKPI pci subsystem adds the pcim_iomap() function, which provides a managed version of pci_iomap() for automatic resource cleanup. This may affect developers writing or updating Linux-compatible drivers in the FreeBSD kernel.
Body:

  Like pci_iomap() add the devres version pcim_iomap() using the former
  to get the resource.

  Add a helper function to validate that the bar is within a valid range
  and sprinkle that check also to other related functions.

  Sponsored by:	The FreeBSD Foundation (intially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52067

  (cherry picked from commit 2f9064a5d2b50f292cc8699d2be5c66c317f1dc7)
  (cherry picked from commit cfb8f4bf2c2b9cfc8d5ed5a19b98f4a19f023ba6)


   sys/compat/linuxkpi/common/include/linux/pci.h |  3 ++
   sys/compat/linuxkpi/common/src/linux_pci.c     | 58 +++++++++++++++++++++++++-
   2 files changed, 59 insertions(+), 2 deletions(-)

[commit baefe812214ebdeb042cf5a85e8232f4ee1a97ab]
Date: 2025-09-04
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: The FreeBSD Foundation (intially)
Section: Drivers.device
Subject: LinuxKPI: pci: implement for_each_pci_dev() and improve pci_get_device()
Review: The LinuxKPI PCI subsystem now implements for_each_pci_dev() and improves pci_get_device() to support starting search from a specified device, enabling updates to wireless drivers that depend on these interfaces.
Body:

  Implement for_each_pci_dev() needed by a wireless driver update.
  For that also improve pci_get_device() and add the functionality to
  support the odev argument to start searching from that.

  Sponsored by:	The FreeBSD Foundation (intially)
  Reviewed by:	dumbbell
  Differential Revision:	https://reviews.freebsd.org/D52066

  (cherry picked from commit 910cf345d0ee9a5d72856a1ba35382eb4f0db951)
  (cherry picked from commit 68f8fa4ada24aaf53a2d463b53259439dfb32146)


   sys/compat/linuxkpi/common/include/linux/pci.h |  3 +++
   sys/compat/linuxkpi/common/src/linux_pci.c     | 12 +++++++++---
   2 files changed, 12 insertions(+), 3 deletions(-)

[commit 2c48a938d570b895002b16f78133ff4256efea1d]
Date: 2025-09-03
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Drivers.device
Subject: LinuxKPI: skbuff: no longer use IEEE80211_DEBUG to turn on debug
Review: The commit removes the automatic inclusion of debug support for LinuxKPI skbuff via IEEE80211_DEBUG, which may affect out-of-tree wireless drivers using LinuxKPI headers.
Body:

  A port using linux(kpi) header files but not using skbuffs is hitting
  the case that it cannot find opt_wlan.h.  Give up to the idea that
  skbuff.h is only used by wireless drivers (or in-tree) and that
  IEEE80211_DEBUG (via opt_lwan.h) could autmatically compile in debug
  support.

  It is likely time to add a LINUXKPI_DEBUG knob in the near future
  (also for linuxkpi_debug or linuxkpi_debug_rcu).

  PR:		289268

  (cherry picked from commit bc222e96d135687aea4e67ee9b11fb9490f42546)


   sys/compat/linuxkpi/common/include/linux/skbuff.h | 14 ++++++--------
   1 file changed, 6 insertions(+), 8 deletions(-)

[commit c5ca8670efda02044811dfa87d14dec35ad8a66a]
Date: 2025-08-31
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: fwget: pci: video amd: correct glob matching entries
Review: The commit corrects firmware matching entries for AMD video cards in man:fwget[8], ensuring the correct firmware is fetched for specific device IDs.
Body:

  - one duplcate entry: 0x664*|0x664*) -> 0x664*|0x665*)
  - one unneeded glob: 0x98e4*) -> 0x98e4)
  - 0x15e7|0x1636|0x1638|0x164c) half of these are green-sardine; split
  - a missing entry for skillfish2 : + 0x143f

  Reviewed by:	imp, manu
  Differential Revision: https://reviews.freebsd.org/D52312

  (cherry picked from commit 1d12658755930e20904d498398379cad0e4ae396)


   usr.sbin/fwget/pci/pci_video_amd | 11 +++++++----
   1 file changed, 7 insertions(+), 4 deletions(-)

[commit 772579c13e5ce63eb4fddd97db77f5f53c7c19fa]
Date: 2025-08-31
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: fwget: pci: hex strings use 0-9 and a-f not a-z
Review: The fwget utility now uses lowercase hex digits (0-9, a-f) for PCI device IDs, ensuring consistency with other tools and documentation.
Body:

  Reviewed by:	imp, manu
  Differential Revision: https://reviews.freebsd.org/D52311

  (cherry picked from commit 50cab1202d39e67cd38b395e3e08e140e7617d95)


   usr.sbin/fwget/pci/pci | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 53d1c328e9123c8065f121afdd9dccb222af2221]
Date: 2025-08-29
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: rc: bluetooth: startup improvements
Review: The Bluetooth startup script man:rc.d/bluetooth[8] now retries the hccontrol reset up to three times for improved reliability and fixes a redirection bug that could create stray files.
Body:

  During startup hccontrol reset needs to be run multiple times
  for iwbt to work more reliably.  Add a loop trying up to
  three times.

  Tested by:	various (original version; I changed test to -eq)
  Differential Revision: https://reviews.freebsd.org/D44861

  Fix a redirect of stderr to stdout which is going to /dev/null.
  A '&' got missing in the original rewrite from the review that
  I took and committed.  Seems no one had noticed during testing
  or review.  People may have ended up with a "/1" file in their
  root file system.

  Fixes:		40652f86b5ef
  Reported by:	Vladyslav Movchan (vladislav.movchan gmail.com)

  (cherry picked from commit 40652f86b5ef17c9016a5eaf4bc89b2f324540e8)
  (cherry picked from commit 78807c196c9481cdd88b5ce611b488903f52fbd0)


   libexec/rc/rc.d/bluetooth | 13 +++++++++++--
   1 file changed, 11 insertions(+), 2 deletions(-)

[commit 5b7aa8225bea341b830666e2724ecb13316e27b0]
Date: 2025-08-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: skbuff: checksum offloading flags
Review: The commit refactors internal LinuxKPI definitions for checksum offloading flags without changing user-visible behavior, driver interfaces, or configuration.
Body:

  Given the checksum offloading flags are mutually exclusive and are
  not a bit mask, we can compress them into 2 bit for the four possible
  values.  Change the define but leave the type at uint8_t for now with
  a comment.  We can possible combine them with another sub-octet field
  in the future.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 343f8f71af70c92b36be19e1d97530b84f871c3e)


   sys/compat/linuxkpi/common/include/linux/skbuff.h | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 4a26d2750b5695a1e700ea1530628e7ad470baaa]
Date: 2025-05-24
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: do not delete keys while still assoc
Review: The LinuxKPI 802.11 subsystem now prevents deletion of encryption keys while the interface is still associated, avoiding firmware exceptions and potential packet loss during races.
Body:

  While we are still associated we cannot delete the keys as packets
  may still go out and if the firmware has no more keys it will raise
  and exception.

  This can happen given net80211 has its own mind when to do this and
  we, in various places, unlock and re-lock the com lock, so are open
  to races.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 86a0941db7028a5eb4d56aaa34998b833e5de174)


   sys/compat/linuxkpi/common/src/linux_80211.c | 40 +++++++++++++++++++++++++++-
   1 file changed, 39 insertions(+), 1 deletion(-)

[commit 8121f688bb550af894b4b1b3ff66dba283ac16d5]
Date: 2025-08-29
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: adjust lower wake_queue locking
Review: The LinuxKPI 802.11 subsystem adjusts wake_queue locking to prevent recursive wiphy lock acquisition, which resolves a deadlock issue affecting Linux driver compatibility, particularly with rtw89 hardware scanning.
Body:

  In bc24342d96aa8 we added lower wake_queue locking.  There are paths,
  such as in rtw89 from a (*hw_scan_cancel)() that we can get to there and
  then would recursively acquire the wiphy lock which is not allowed.
  Adjust locking to a spin lock to match Linux driver expectations.

  Sponsored by:	The FreeBSD Foundation
  Fixes:		bc24342d96aa8

  (cherry picked from commit fc36de571f11abda5cc68a4abd963053f676f8c5)


   sys/compat/linuxkpi/common/src/linux_80211.c | 19 +++++++++++++++----
   sys/compat/linuxkpi/common/src/linux_80211.h |  1 +
   2 files changed, 16 insertions(+), 4 deletions(-)

[commit 096f1bd897464edfd115f7dd2272e3488cbca191]
Date: 2025-08-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: mark all structs in struct ieee80211_mgmt __packed
Review: The commit marks internal structures as packed for raw packet handling in the LinuxKPI compatibility layer. This is a low-level implementation detail with no direct user-visible impact on functionality, configuration, or behavior.
Body:

  These structs as part of the union are used to handle raw packet data
  so mark them all __packed.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit d1df103190c12a63a1f718bc3cf6a1afe1ece759)


   sys/compat/linuxkpi/common/include/linux/ieee80211.h | 20 ++++++++++----------
   1 file changed, 10 insertions(+), 10 deletions(-)

[commit 3d35647d33cf90d3ead87e45dd62eac4d3bddc66]
Date: 2025-08-13
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: implement str_disable_enable()
Review: The commit adds a LinuxKPI function for wireless driver support, which may affect compatibility with certain Linux wireless drivers.
Body:

  Implement str_disable_enable() needed by a wireless driver by using
  the already existing str_enable_disable() with a toggled argument.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	emaste
  Differential Revision: https://reviews.freebsd.org/D52081

  (cherry picked from commit a274435d0dc04a876ce2898a9036223972d23fdc)


   sys/compat/linuxkpi/common/include/linux/string_helpers.h | 2 ++
   1 file changed, 2 insertions(+)

[commit ea8a9265e0fc42700636677303e4175aa83a0344]
Date: 2025-08-20
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: usb: hub: uhub_root_intr() mark function arguments as __unused
Review: This commit marks function arguments as __unused with no functional change, so it has no user-visible impact.
Body:

  No functional change.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	aokblast, imp
  Differential Revision: https://reviews.freebsd.org/D52147

  (cherry picked from commit 7dce26eded4e4c8a511ecc7e8522b9a0332386ea)


   sys/dev/usb/usb_hub.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit b4688ce7454fd5324c2cd7e3743b21261592e18f]
Date: 2025-06-22
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: stop using hw_value on a channel
Review: The LinuxKPI 802.11 subsystem no longer uses the hw_value field for channel mapping, which may affect compatibility with some wireless drivers using this interface.
Body:

  During initial LinuxKPI 802.11 bringup looking at the usage in one
  driver I started using hw_value as an equivalent for ic_ieee.
  That is not correct.   Remove all usage but logging of hw_value
  from LinuxKPI 802.11 code and leave the field to the drivers.

  We have to go through some hoops to get the needed ic_ieee value
  but so be it.  At some point we may want to clear this up in
  net80211 (especially given we'll have to handle more per-band data
  in the future).

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit aa2989738ab1f1dae55702e2bf1d853f6fdcfdd0)


   sys/compat/linuxkpi/common/src/linux_80211.c | 14 +++++++-------
   1 file changed, 7 insertions(+), 7 deletions(-)

[commit b23b05c1d42044e7a1a812ddb7f21b27551ad156]
Date: 2025-07-10
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: factor out sinfo printing
Review: Internal refactoring of LinuxKPI 802.11 debug output; no user-visible changes.
Body:

  Factor out the sinfo printing into an sbuf from the sysctl handler.
  That allows us to use lkpi_80211_dump_lvif_stas() for printing other
  debug information as well.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit a086478e58bf398cc9892fba6bc0122a56b87a97)


   sys/compat/linuxkpi/common/src/linux_80211.c | 62 ++++++++++++++++------------
   1 file changed, 35 insertions(+), 27 deletions(-)

[commit 03cc8045e57a5cba2e5e4aa109fdf5a903630d15]
Date: 2025-06-14
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: fill in sinfo for chains in case driver does not
Review: The LinuxKPI 802.11 subsystem now fills in chain signal information for sysctl reporting when drivers do not provide it.
Body:

  We are getting per-packet information on the rx chains.  Save them
  locally like we do for rx rate and add them to sinfo for the sysctl
  in case the driver does not fill in that information.
  Also note: chain_signal is a bitmask and not a number;  treat it
  accordingly.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit b3b61079ccc24792f1410840e42c36f71b9cab9f)


   sys/compat/linuxkpi/common/src/linux_80211.c | 23 ++++++++++++++++++++---
   1 file changed, 20 insertions(+), 3 deletions(-)

[commit 203fe473d079add112ddc2a019e9b33d48821309]
Date: 2025-08-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: improve ieee80211_request_smps()
Review: The commit adjusts logging and adds a mode check in the LinuxKPI 802.11 compatibility layer, but these are minor internal improvements without direct user-visible impact.
Body:

  Adjust logging from TODO() to IMPROVE() now that we can use fmt strings
  there too.  Make sure we are not getting unsuported values to print.

  Also for non-station mode simply return.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit b1e67b1a74d33e7a26e53886750a48f070a47226)


   sys/compat/linuxkpi/common/include/net/mac80211.h | 11 +++++++----
   1 file changed, 7 insertions(+), 4 deletions(-)

[commit 11f0a07f37c49e7c9bce020a2996c92a5466bb46]
Date: 2025-07-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPi: 802.11: adjust linuxkpi_set_ieee80211_dev() to set ic_name
Review: The commit adjusts internal LinuxKPI 802.11 compatibility layer functions for future driver support and does not introduce any user-visible changes.
Body:

  While we used to pass in the dev_name(), we now use wiphy_dev() inside
  the implementation to get the dev and the name.  This is for two reasons:
  (1) ath1xk also unset the dev and we need to check once we add support,
  and (2) in preparation for future work, which needs to hook into that
  point.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 60307068cf64700f5379c782ad98336d4d0f7390)


   sys/compat/linuxkpi/common/include/net/mac80211.h |  4 ++--
   sys/compat/linuxkpi/common/src/linux_80211.c      | 19 ++++++++++++++++---
   2 files changed, 18 insertions(+), 5 deletions(-)

[commit 7937d7fe644d7f55f563b65c349637c7acde0e25]
Date: 2025-06-22
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: 802.11: correct struct linuxkpi_ieee80211_channel
Review: Corrects type annotations and field ordering in the LinuxKPI IEEE 802.11 channel structure, which may affect compatibility with Linux wireless drivers.
Body:

  Some of the annotations were not quite right.  Also various fields had
  not been typed properly.  Correct the types of field members and
  given the change also re-sort.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit a394924856373b5228f542360618cfed8e334504)


   sys/compat/linuxkpi/common/include/net/cfg80211.h | 25 ++++++++++++++---------
   1 file changed, 15 insertions(+), 10 deletions(-)

[commit ee44e19f0f8c5050c88e991e7f83521d776d094a]
Date: 2025-06-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: improve reg_query_regdb_wmm()
Review: The commit reduces console spam from the LinuxKPI reg_query_regdb_wmm() function by replacing TODO() with a formatted IMPROVE macro and changes the error return value. This is a minor internal improvement with no direct user-visible impact.
Body:

  Adjust the IMPROVE macro to also take a format string and use that
  in reg_query_regdb_wmm() instead of TODO() to avoid spamming the console
  with something that needs larger reworks.  Return -ENODATA instead of
  -ENXIO as that seems a better fit though the only consumer uses it
  without checking the return value these days.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 85eccabc41c92d9147cac5c6f5434e2015d7eca8)


   sys/compat/linuxkpi/common/include/net/cfg80211.h | 9 ++++-----
   1 file changed, 4 insertions(+), 5 deletions(-)

[commit 8346b963c66628bd03121cacec60a9351cbbaa0e]
Date: 2025-08-21
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: assign values to WLAN_HT_CAP_SM_PS_*
Review: The commit only adds missing constant values to a Linux compatibility header with no functional changes, so it has no user-visible impact.
Body:

  No functional changes.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit cd3c9f7afc275c250025bdd1140ce0e821d23f34)


   sys/compat/linuxkpi/common/include/linux/ieee80211.h | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit d784cfcd5c44ad0dc1a92ce5a42421ff06688089]
Date: 2025-05-10
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: announce netdev features under boot -v
Review: The commit adds verbose logging of netdev features during interface attachment under bootverbose, which aids debugging but does not introduce user-visible functionality changes.
Body:

  Under bootverbose print the announced netdev features during
  ifattach. Helps us to debug problems amongst drivers if needed.

  Leave a comment where to add checksum offlooading setting on the
  ifp if we get there (this would be based on netdev features).

  Sponsored by:	The FreeBSD Foundation
  MFC after:	3 days
  (cherry picked from commit 8c1fdcf8c4026290d122f573e1207188ac029bac)


   sys/compat/linuxkpi/common/src/linux_80211.c | 10 +++++++---
   1 file changed, 7 insertions(+), 3 deletions(-)

[commit 4faad6c23983b564b0c832eaed059b65758e38b3]
Date: 2025-07-20
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: 802.11: add guards to lkpi_ic_ampdu_rx_{start,stop}
Review: The commit adds NULL pointer guards in the LinuxKPI 802.11 compatibility layer to prevent kernel panics during AMPDU RX stop operations, improving stability for wireless drivers using this layer.
Body:

  After updating calls into lkpi_ic_ampdu_rx_stop() were seen along
  with panics.
  Working backwards adding checks to each level we lastly ended up fighting
  a lsta which is NULL.  Simply return in any error cases as there is
  nothing we can do and just leave it to net80211.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 8475942ca8e887287959ec2671266a210f41ed86)


   sys/compat/linuxkpi/common/src/linux_80211.c | 28 ++++++++++++++++++++++++++++
   1 file changed, 28 insertions(+)

[commit 66e3185134528714f0017fe52f110b0cd9e94c19]
Date: 2025-08-01
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: linuxKPI: 802.11: assert wihpy lock in lkpi_80211_mo_start()
Review: The commit adds a lock assertion in the LinuxKPI 802.11 subsystem to match newer Linux driver expectations, ensuring proper synchronization for wireless drivers.
Body:

  Newer versions of Linux wifi drivers assert the wiphy lock in the
  (*start)() path.  Make sure we do too and do hold the wiphy lock.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 897cf423a39474096dc699f7b9d173e4a97d3510)


   sys/compat/linuxkpi/common/src/linux_80211.c        | 4 ++++
   sys/compat/linuxkpi/common/src/linux_80211_macops.c | 2 ++
   2 files changed, 6 insertions(+)

[commit 463d0ab1374f771366babb6e5a3fd64e24fcb543]
Date: 2025-08-13
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: add dummy IEEE80211_EML_CAP_EMLSR_*_DELAY_256US
Review: Adds dummy IEEE80211_EML_CAP_EMLSR_*_DELAY_256US constants to the LinuxKPI 802.11 compatibility layer for compilation support of a Wi-Fi driver update.
Body:

  A wifi driver update needs these to compile.  Just add them.  We'll
  given them porper values when we'll do a full pass needing them.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 9f779097032cb9d41dfc6f7a57f41768463899f8)


   sys/compat/linuxkpi/common/include/net/cfg80211.h | 2 ++
   1 file changed, 2 insertions(+)

[commit cc8d17e4366ce376204037fbf2a3a9eb3eeecda8]
Date: 2025-08-13
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: add wiphy_locked_debugfs_read()
Review: The commit adds a skeleton implementation of wiphy_locked_debugfs_read() for LinuxKPI 802.11 compatibility, which is a placeholder with a TODO reminder and does not introduce any user-visible functionality or changes.
Body:

  A wifi driver update required wiphy_locked_debugfs_read().
  Add a skeleton implementation just reminding us of the TODO() for
  now.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 0dcce5bd70b00430c6c4b447724e88551e0eab0d)


   sys/compat/linuxkpi/common/include/net/cfg80211.h | 13 +++++++++++++
   1 file changed, 13 insertions(+)

[commit 796aa6055e797b32ee1e3d1092f3e28f14e2c6d1]
Date: 2025-08-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: ieee80211_probereq_get() takes const arguments
Review: The commit adjusts function signatures to accept const arguments to avoid compiler warnings, which is an internal implementation detail with no user-visible impact.
Body:

  With a wireless driver updates we are passed const arguments for
  addr and ssid.  Adjust the local implementation to take the const
  in order to avoid compiler warnings (at no extra harm).

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 2b37274a9a26d66010001217d53901de5b254b8b)


   sys/compat/linuxkpi/common/include/net/mac80211.h | 6 +++---
   sys/compat/linuxkpi/common/src/linux_80211.c      | 4 ++--
   2 files changed, 5 insertions(+), 5 deletions(-)

[commit aaecab14f52c01ee0bfbb054ad5da7b0c6680586]
Date: 2025-08-13
Score: 5
Status: proposed(include=no,score=35)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: define the full set of IEEE80211_VHT_MAX_AMPDU_*
Review: LinuxKPI 802.11 header adds definitions for VHT maximum A-MPDU length exponents, improving compatibility with Linux wireless drivers.
Body:

  Define all of IEEE80211_VHT_MAX_AMPDU_* and add a reference to the
  standard section.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 97cf5a33709b130fb108b75859af8fdc0ac4a9e3)


   sys/compat/linuxkpi/common/include/linux/ieee80211.h | 15 ++++++++++++++-
   1 file changed, 14 insertions(+), 1 deletion(-)

[commit 236b76516b6fc4d9439921259a7d2b9645e37a27]
Date: 2025-08-14
Score: 5
Status: proposed(include=no,score=30)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: add bitfield.h to ieee80211.h
Review: The commit adds a missing include to the LinuxKPI compatibility header, which may affect compilation of third-party wireless drivers that rely on this header.
Body:

  Add the include to make some driver code compile without having
  to add FreeBSD-specific includes to drivers.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 7d49a336d5bf8ce4174286c2c5d1d93b3549cb88)


   sys/compat/linuxkpi/common/include/linux/ieee80211.h | 1 +
   1 file changed, 1 insertion(+)

[commit 1aa8504d1c5156ff2b46c4eb0cc01fb2332dfb96]
Date: 2025-08-21
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: rtw88 / rtw89: define LINUXKPI_VERSION
Review: The commit adds a LINUXKPI_VERSION definition for rtw88 and rtw89 wireless drivers to ensure compatibility with future LinuxKPI updates.
Body:

  Always define the LINUXKPI_VERSION for LinuxKPI based wireless
  drivers.  This ensures that LinuxKPI can move indepdent of drivers.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit aecd63f4479423a65bdde7f93da66139293f0928)


   sys/modules/rtw88/Makefile | 1 +
   sys/modules/rtw89/Makefile | 1 +
   2 files changed, 2 insertions(+)

[commit 30ea10d3513096d65840e10d8db964368ee7cc91]
Date: 2025-08-19
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: iwlwifi.4: add link to bugzilla in the BUGS section
Review: The commit adds a link to a Bugzilla meta-bug in the BUGS section of man:iwlwifi[4].
Body:

  Given iwlwifi has a (hopefully) fully categorized bug-set under one
  meta-bug (tracking) we can give a link to that.

  Suggested by:	grahamperrin (as part of a large GH pull request)
  Suggested by:	ziaee (final markup)
  Sponosred by:	The FreeBSD Foundation
  Reviewed by:	ziaee
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1541

  (cherry picked from commit 0f73fdfc2ab990f0b576c23c27d43436d3304755)


   share/man/man4/iwlwifi.4 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit cfc216559c92e8c4b610175d58a10c09a6a5e66d]
Date: 2025-06-19
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: bsnmp: wlan: use correct value for rssi
Review: The bsnmpd wlan module now reports correct RSSI values by properly converting from net80211's internal representation.
Body:

  net80211 keeps the rssi value in 0.5bm relative to the noise floor
  (see comment in ieee80211_node.h).  Do proper maths to get a plain
  rssi value back (once further fixes are in net80211).

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	emaste
  Differential Revision: https://reviews.freebsd.org/D50930

  (cherry picked from commit 69ffe3a6e778c3400a27a1098969802ac4cb5f56)


   usr.sbin/bsnmpd/modules/snmp_wlan/wlan_sys.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 42c4f4d98216ebf1355e1387ff8d0bd42a88b120]
Date: 2025-07-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: dwmmc: cleanup cmd and locking, consistency between mmc and mmccam
Review: The commit contains only internal driver refactoring, locking assertions, and code cleanup without any user-visible changes to functionality, performance, or configuration.
Body:

  In general sprinkle locking assertions and harmonized KASSERTs
  throughout the upper part of the driver to document expectations.

  In dwmmc_cmd_done() "cmd" should be set correctly and be used for
  both MMCCAM and classic mmc rather than special-casing mmccam.
  In dwmmc_next_operation() place variable declarations on the top
  for both cases before the first debug and lock assertion calls;
  then factor out common parts at the end and put both cases in the
  same order.
  By calling dwmmc_next_operation() directly from both dwmmc_request()
  in the mmc case, and dwmmc_cam_request() in the mmccase (rather than)
  chaining calls in the latter, we avoid unlocking the sc in the mmccam
  case and have a consistent call path from both; also removing the
  mmccam #ifdef from dwmmc_request() brings more clarity.
  In dwmmc_next_operation() enhance the panic/error messages with
  some extra information and assert that we come in with a cam pinfo
  on CAM_ACTIVE_INDEX.

  Reviewed by:	manu
  Differential Revision: https://reviews.freebsd.org/D51628

  (cherry picked from commit 0f8a8416a4e07ddeaecc4eafd6f418da0f21efc7)


   sys/dev/mmc/host/dwmmc.c | 83 +++++++++++++++++++++++++-----------------------
   1 file changed, 44 insertions(+), 39 deletions(-)

[commit 96419b3aa91e71ef09832061afd6ffc630280faf]
Date: 2025-07-31
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: pci: fix argument type to linuxkpi_pci_iomap[_range]
Review: Fixes internal type mismatch in LinuxKPI PCI mapping functions; no user-visible impact.
Body:

  The last argument (maxlen) to linuxkpi_pci_iomap_range and
  linuxkpi_pci_iomap is an unsigned long not an int.  LinuxKPI is
  not using that argument in the end but fix it where needed.
  While here adjust the name to 'maxlen' and remove the "mmio_" to
  bar and off.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	emaste
  Differential Revision: https://reviews.freebsd.org/D51651

  (cherry picked from commit 421bf3a968674cbb1fc7eb1c323fd4d5d2409718)


   sys/compat/linuxkpi/common/include/linux/pci.h |  8 ++++----
   sys/compat/linuxkpi/common/src/linux_pci.c     | 18 +++++++++---------
   2 files changed, 13 insertions(+), 13 deletions(-)

[commit 7d33beb6af2de0b769756211aaf2f253ed5e3e22]
Date: 2025-07-31
Score: 5
Status: proposed(include=no,score=0)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: pci: harmonize #defines
Review: Error, not correct JSON Failed to parse the request body as JSON: messages[1].content: invalid escape at line 1 column 4746
Body:

  In some blocks of #defines spacing, trailing \ and indentation of a
  second line differed.  Some of them are currently fine on a single
  line but future additions may not fit in that scheme.
  Harmonize them into a #define X\t\t\t...\\n<4 spaces>Y scheme.

  No functional changes.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	emaste
  Differential Revision: https://reviews.freebsd.org/D51650

  (cherry picked from commit 69ed0f766bb68876fed2096739d8adc313cf3340)


   sys/compat/linuxkpi/common/include/linux/pci.h | 48 +++++++++++++++-----------
   1 file changed, 28 insertions(+), 20 deletions(-)

[commit 0b6bb81935970d61bdc6580048c806ef17ef8cd4]
Date: 2025-07-31
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: acpi: fix guid_t argument type
Review: The commit fixes a compile error in the LinuxKPI ACPI compatibility layer for in-tree Linux-based drivers, ensuring they build correctly.
Body:

  acpi_check_dsm() and acpi_evaluate_dsm_typed() take a guid_t argument
  and not a char *.  For in-tree Linux based drivers this leads to a
  compile error due to a warning.  Fix the function argument type and
  cast internally.

  While this made the long statements in the wrapper functions for *_dsm_*
  even less readable split them up using a local variable.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	emaste
  Differential Revision: https://reviews.freebsd.org/D51649

  (cherry picked from commit 21cb44bf33f137eaab1ff6f9287c6bc8c27677f0)


   sys/compat/linuxkpi/common/include/acpi/acpi_bus.h |  4 ++--
   sys/compat/linuxkpi/common/src/linux_acpi.c        | 24 ++++++++++++++--------
   2 files changed, 17 insertions(+), 11 deletions(-)

[commit 296ebf7b8a50b24b4950b7bd92e170ee224e6671]
Date: 2026-01-09
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Innovate UK
Section: undecided
Subject: iflib: remove convoluted custom zeroing code
Review: Internal code cleanup with no user-visible impact.
Body:

  Replace a collection of aliasing violations and ifdefs with memset
  (which now expands to __builtin_memset and should be quite reliably
  inlined.)  The old code is hard to maintain as evidenced by the most
  recent change to if_pkt_info_t updating the defines, but not the zeroing
  code.

  Reviewed by:	gallatin, erj
  Effort:		CHERI upstreaming
  Sponsored by:	Innovate UK
  Fixes:		43d7ee540efe ("iflib: support for transmit side nic KTLS offload")
  Differential Revision:	https://reviews.freebsd.org/D54605

  (cherry picked from commit 31e7dc6b9a000b02353bfc41cbd897533287cda2)


   sys/net/iflib.c | 65 +++++----------------------------------------------------
   1 file changed, 5 insertions(+), 60 deletions(-)

[commit 506203ae99e62b791d2f0fcb465cf5e080579824]
Date: 2026-01-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: makefs.8: Cleanup man page
Review: Minor cleanup of man:makefs[8] documentation with no user-visible functional changes.
Body:

  Reviewed by:	ziaee
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54538

  (cherry picked from commit 12c51484188f88bcabc5b38ca8523fcde76830a6)


   usr.sbin/makefs/makefs.8 | 9 +++++----
   1 file changed, 5 insertions(+), 4 deletions(-)

[commit 64341378fadf9bb3e5490b91d17e659097f7804f]
Date: 2026-01-05
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: makefs: Fix typo 's/mirrorring/mirroring/'
Review: Fixes a typo in a comment string within the msdosfs component of makefs. This change has no user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 73af599fb7be6806b553ac6f470d76711b74286c)


   usr.sbin/makefs/msdos/msdosfs_vfsops.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 2706f7abcac7da9bfec2895102f0631b6f7b4b7c]
Date: 2025-09-04
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Arm Ltd
Section: Hardware.virtualization
Subject: arm64: Add a multiple TLBI workaround
Review: The commit adds a workaround for Arm Cortex-A55, Cortex-A76, and Cortex-A510 CPUs requiring multiple TLBI instructions, which must be enabled by users at boot time.
Body:

  The Arm Cortex-A55, Cortex-A76, and Cortex-A510 CPUs have errata that
  require multiple TLBI, DSB instructions to workaround.

  Add support to pmap to implement these. As it appears that all
  affected TLBI calls are via pmap.c this should be sufficient.

  As all variants of this erratum are Category-B (rare) require the
  user to enable it at boot time.

  Reviewed by:	alc
  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D52190

  (cherry picked from commit a884f699e4bfc1be4e721d3ec4fa93915be18a86)


   sys/arm64/arm64/pmap.c | 80 ++++++++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 80 insertions(+)

[commit 7cd4ec4adb8f3727f59b6208b9e3bcc6c0bf30c0]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=30)
Sponsor: Arm Ltd
Section: undecided
Subject: arm64: Add a function to check a range of CPU revs
Review: Adds a function to check CPU revision ranges for erratum detection, which may affect kernel behavior on specific ARM64 hardware.
Body:

  Add a function that can check if a given midr is within a range of
  revisions. This will be used to check if a CPU is affected by a known
  erratum.

  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D52187

  (cherry picked from commit c76b0247a95ed090cc0d83b2698228d2937af3e6)


   sys/arm64/include/cpu.h | 25 +++++++++++++++++++++++++
   1 file changed, 25 insertions(+)

[commit 972c4dc33bd76495581f4067234ca73865d65e09]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Arm Ltd
Section: undecided
Subject: arm64: Replace cpu_tlb_flushID in initarm
Review: The commit replaces an internal function call with another that is functionally identical in SMP configurations, with no user-visible impact.
Body:

  Replace cpu_tlb_flushID with pmap_s1_invalidate_all_kernel in initarm.
  They are identical in the SMP case.

  Reviewed by:	alc
  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D52184

  (cherry picked from commit fa23bfb425d53a87064d86ec9ae0ae5e31aa5d5b)


   sys/arm64/arm64/machdep.c | 2 +-
   sys/arm64/arm64/pmap.c    | 4 +---
   sys/arm64/include/pmap.h  | 2 ++
   3 files changed, 4 insertions(+), 4 deletions(-)

[commit a5371aed0235915187a3d39809a637a63d510b37]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Arm Ltd
Section: undecided
Subject: arm64: Create a TLBI invalidate for the kernel
Review: The commit refactors internal pmap functions for arm64 to optimize kernel address space invalidation, but there is no user-visible change in behavior, performance, or configuration.
Body:

  Add pmap_s1_invalidate_all_kernel to remove the need to check for the
  kernel_pmap when it's passed in.

  While here replace pmap calls to cpu_tlb_flushID with
  pmap_s1_invalidate_all_kernel as they are identical.

  Reviewed by:	kib
  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D52183

  (cherry picked from commit 8df4dc90952be7afee36e3cc80c1a76e2c66fbac)


   sys/arm64/arm64/pmap.c | 19 +++++++++++++++----
   1 file changed, 15 insertions(+), 4 deletions(-)

[commit 5b364c721f8e85c54f1bcfa073f7c59f29e494ba]
Date: 2025-09-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Arm Ltd
Section: undecided
Subject: arm64: Read the CPU feature tunables once
Review: The commit optimizes CPU feature tunable handling by reading them once at boot, preventing potential memory allocation issues on non-boot CPUs. This is an internal kernel change with no direct user-visible impact.
Body:

  Rather than reading the CPU tunables each time we enable a feature
  just read them once on boot. Reading them early on non-boot CPUs
  causes issues where they try to allocate memory before the core is set
  up to do so. As they don't change it is safe to cache the state of
  them.

  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D52578

  (cherry picked from commit 5e0e2565288f3d1f1b4223d8bb53c7d70e0aa92c)


   sys/arm64/arm64/cpu_feat.c   | 35 +++++++++++++++++++++++++----------
   sys/arm64/include/cpu_feat.h |  3 +++
   2 files changed, 28 insertions(+), 10 deletions(-)

[commit e79e4c7031a444ac4d8466bc9834d2f4c3d31132]
Date: 2025-09-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Arm Ltd
Section: undecided
Subject: arm64: Add cpu_feat_disabled for disabled features
Review: The commit adds internal kernel infrastructure for handling disabled CPU features on arm64, which does not have a direct user-visible impact. It is a low-level kernel change that does not affect configuration, behavior, or hardware support in a way that users would notice.
Body:

  When a feature is disabled we may need to run a cleanup handler, e.g.
  to remove a feature from the sanitized ID registers. Add support for
  this with a new feat_disabled handler.

  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D52577

  (cherry picked from commit 055229eda697445880edd0050d0230a3f1bc85b3)


   sys/arm64/arm64/cpu_feat.c   | 10 +++++++---
   sys/arm64/include/cpu_feat.h |  5 ++++-
   2 files changed, 11 insertions(+), 4 deletions(-)

[commit 68d8de27c94d585980a99e22fed60171bcaed2ef]
Date: 2025-09-19
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Arm Ltd
Section: Kernel.general
Subject: arm64: Fix enabling CPU features
Review: The arm64 CPU feature management is corrected to properly enable features by default while allowing users to disable them via loader tunables.
Body:

  Previously when enabling CPU feature we assumed the no check function
  means the feature was unconditionally enabled. When adding support to
  disable features on boot this check was incorrectly partially left in
  place. As all current features have a check function this meant all
  features were disabled.

  Fix this by restoring the previous behaviour while also allowing the
  user to disable the feature.

  Reviewed by:	emaste
  Fixes:		4bc68fa98f68 ("arm64: Support managing features from loader")
  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D52579

  (cherry picked from commit 5e690f1e12ce8699f16019854dfffd1857a801d8)


   sys/arm64/arm64/cpu_feat.c | 9 +++++----
   1 file changed, 5 insertions(+), 4 deletions(-)

[commit 2210c15b08b9f70054d4de46a5a8566d395e0abe]
Date: 2025-09-04
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Arm Ltd
Section: Bootloader.general
Subject: arm64: Support managing features from loader
Review: The arm64 loader now supports enabling or disabling CPU features and errata via a tunable, allowing users to work around broken firmware or enable specific errata workarounds.
Body:

  Allow the user to enable/disable supported cpu features/errata from a
  known tunable. This will allow the user to disable features, e.g. to
  work around broken firmware. It can also be used to enable workarounds
  for rare errata.

  Reviewed by:	imp
  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D52358

  (cherry picked from commit 4bc68fa98f68211ee7943d77cfc91f60ccb5880d)


   sys/arm64/arm64/cpu_feat.c   | 22 +++++++++++++++++++++-
   sys/arm64/include/cpu_feat.h | 27 ++++++++++++++++++++++++++-
   2 files changed, 47 insertions(+), 2 deletions(-)

[commit ddc20379099b8c3fea87bc0a8f2c8b6585b1d0bc]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=35)
Sponsor: Arm Ltd
Section: undecided
Subject: arm64: Add a sysctl to see if features are enabled
Review: Adds a sysctl to query enabled CPU features on arm64. This will later be used as a tunable to control features.
Body:

  This will also be used as a tunable to control features in a later
  change.

  Reviewed by:	imp
  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D52357

  (cherry picked from commit 9204a315a71c5aa9a9b8c11f2dcefb155dd5fc34)


   sys/arm64/arm64/cpu_feat.c   |  7 +++++--
   sys/arm64/include/cpu_feat.h | 13 ++++++++++---
   2 files changed, 15 insertions(+), 5 deletions(-)

[commit 1c375ad453c000f64aa4f48eb4709bd5d3383bf7]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Arm Ltd
Section: undecided
Subject: arm64: Add a macro to create cpu_feat
Review: This commit adds an internal macro for CPU feature detection with no immediate user-visible impact.
Body:

  This will be used later to extend cpu feature detection

  Reviewed by:	imp (earlier version)
  Sponsored by:   Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D52356

  (cherry picked from commit b3605a7bb6f8c58d939e642671ce70b0ce39b95e)


   sys/arm64/include/cpu_feat.h | 10 ++++++++++
   1 file changed, 10 insertions(+)

[commit 3b24eedc93b77640280baf42b7ce560a32b0745b]
Date: 2025-01-24
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Arm Ltd
Section: Hardware.virtualization
Subject: arm64: Add a new CPU feature framework
Review: A new CPU feature framework for arm64 is added, allowing discovery and enabling of hardware features and errata workarounds during boot. This framework supports early and late enabling of features on a per-CPU or system-wide basis.
Body:

  This will be used to enable features that are discoverable on boot. It
  has support to check if a feature needs to be enabled, and if there is
  any errata associated with the feature that mean it shouldn't be
  enabled. It can also be used to enable errata workarounds that aren't
  associated with a specific feature, e.g. where we need to trap access
  to a register in userspace to emulate it.

  As some features need to be enabled early, while others can wait there
  are two options for when to enable a feature:
   * CPU_FEAT_EARLY_BOOT: The feature will be enabled early in the boot.
     On the boot CPU this is in initarm, while on secondary CPUs this
     is before signalling the CPU has started.
   * CPU_FEAT_AFTER_DEV: The feature will be enabled after devices have
     attached but before interrupts are enabled.

  There are also two scopes for where to enable the feature:
   * CPU_FEAT_PER_CPU: The feature will be checked and enabled on all
     CPU cores.
   * CPU_FEAT_SYSTEM: The feature will only be checked and enabled on a
     single core.
  It is expected the former will be used for most features, while the
  latter is for features that set a global variable to be checked.

  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D47812

  (cherry picked from commit ac4fa5838bb33f0c3ba05fce02d41164bd84a560)


   sys/arm64/arm64/cpu_feat.c   | 119 +++++++++++++++++++++++++++++++++++++++++++
   sys/arm64/arm64/machdep.c    |   4 ++
   sys/arm64/arm64/mp_machdep.c |   5 ++
   sys/arm64/include/cpu_feat.h |  88 ++++++++++++++++++++++++++++++++
   sys/conf/files.arm64         |   1 +
   5 files changed, 217 insertions(+)

[commit 25ff471f0bbcf5b489678e9f94877386366dc521]
Date: 2025-09-15
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Arm Ltd
Section: Hardware.virtualization
Subject: arm64: Add the new C1 CPU IDs
Review: The commit adds support for new Arm C1 series CPUs (C1-Nano, C1-Pro, C1-Premium, C1-Ultra), enabling proper identification and potential optimization for these processors.
Body:

  Add the Arm C1-Nano, C1-Pro, C1-Premium, and C1-Ultra CPUs from their
  Technical Reference Manuals.

  Sponsored by:	Arm Ltd

  (cherry picked from commit 8fee6b9ecc84d3602a461f1cd33df91e50849cdf)


   sys/arm64/arm64/identcpu.c | 4 ++++
   sys/arm64/include/cpu.h    | 4 ++++
   2 files changed, 8 insertions(+)

[commit 935f00c4ddf6c0e90752e7017e1d8d165e0796a1]
Date: 2025-06-23
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Arm Ltd
Section: Hardware.virtualization
Subject: arm64: Add more CPU MIDR values
Review: The commit adds more CPU MIDR values for arm64 CPUs, improving CPU identification and enabling potential optimizations for newly recognized hardware.
Body:

  Found in Linux and https://github.com/arm-software/data

  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D50726

  (cherry picked from commit 124b5dbf5c09a17251b75f6b96c9ab7b218eee7f)


   sys/arm64/arm64/identcpu.c | 28 ++++++++++++++++++++++++++--
   sys/arm64/include/cpu.h    | 20 +++++++++++++++++++-
   2 files changed, 45 insertions(+), 3 deletions(-)

[commit 6025e23a8f2fca481e31436e3fa7a47fba5306d6]
Date: 2025-10-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Arm Ltd
Section: Drivers.device
Subject: pci/n1sdp: Disable HotPlug
Review: HotPlug support is disabled on N1SDP platforms to prevent continuous interrupt reporting from pcib3 and pcib5 controllers.
Body:

  Work around an issue when HotPlug is enabled where pcib3 and pcib5
  continuously report the following:

  pcib3: HotPlug interrupt: 0x30
  pcib3: Command Completed
  pcib3: HotPlug interrupt: 0x30
  pcib3: Command Completed
  ...

  As a workaround disable HotPlug on the N1SDP as it's unlikely anyone
  will depend on it.

  Reviewed by:	br
  Fixes:	1f5c50a86173 ("pci_host_generic:Add pcib_request_feature on ACPI")
  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D53134

  (cherry picked from commit edbbf26e2650e02cd3925dd1deaacf9b8fb2e2a0)


   sys/dev/pci/controller/pci_n1sdp.c | 12 ++++++++++++
   1 file changed, 12 insertions(+)

[commit d3759996530a17d0ae17eb52703909b859ad1209]
Date: 2026-01-08
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.config
Subject: release: make sh the default shell
Review: The default shell for the root user and the 'freebsd' user in release images is now sh(1).
Body:

  The default shell for root has been changed to sh(1) followup changing
  in release images sh(1) the shell for the "freebsd" user.

  MFC After:	1 week
  Reviewed by:	manu, emaste (re)
  Approved by:	manu, emaste (re)
  Differential Revision:	https://reviews.freebsd.org/D54602

  (cherry picked from commit d64db8892f8519f108d838f8d7e1d3b675ed37cd)


   release/tools/arm.subr     | 2 +-
   release/tools/vagrant.conf | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit 14f366b358ac336f78910e53d8e753f57f999852]
Date: 2026-01-07
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: set the hostname when user-data is missing
Review: The nuageinit utility now sets the hostname even when the user-data file is missing, preventing an unnecessary exit and ensuring hostname configuration proceeds.
Body:

  This address the situation reported here
  https://github.com/freebsd/freebsd-src/pull/1952#issuecomment-3720210259

  The user-data file was missing and the `sethostname` function is never
  called. This commit adjusts slightly the logic to avoid the `exit()` call
  when the `user-data` file is missing.

  MFC After:	1 week
  Signed-off-by: Gonri Le Bouder <goneri@lebouder.net>
  Differential Revision:	https://github.com/freebsd/freebsd-src/pull/1953
  (cherry picked from commit cae280931c9e1f072d8bf300c377ae120300b898)


   libexec/nuageinit/nuageinit | 113 ++++++++++++++++++++++++++------------------
   1 file changed, 67 insertions(+), 46 deletions(-)

[commit a56998eeef8d82b9d92d9205c84f3adc3c019add]
Date: 2026-01-08
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: nuageinit: fix test after recent behaviour change
Review: The commit fixes a test failure in the nuageinit test suite after a behavior change, but does not introduce any user-visible changes.
Body:

  with recent change nuageinit always create a "freebsd" user, if no
  users are specified, which means we do need to get the rootdir in the
  testsuite containing a group file otherwise pw complains and the tests
  fails.

  (cherry picked from commit 65e77d34fdff9065616cfaedef3ef53329cdad26)


   libexec/nuageinit/tests/nuageinit.sh | 4 ++++
   1 file changed, 4 insertions(+)

[commit 9f5c4fbf6ca2c8343ab10bb0178ebe3cf76076cd]
Date: 2026-01-07
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.config
Subject: release: stop disabling sendmail
Review: Removes explicit sendmail disabling from release configurations, as sendmail is already disabled by default since FreeBSD 14.0. This simplifies release configuration files without changing the default behavior.
Body:

  sendmail is already disabled by default everywhere since 14.0

  MFC After:	1 week
  Approved by:	emaste (re)
  Reviewed by:	emaste (re)
  Differential Revision:	https://reviews.freebsd.org/D54575

  (cherry picked from commit d07198ff72aeddc5a884cfb81b22c22f2abf88f6)


   release/Makefile             | 3 ---
   release/tools/arm.subr       | 4 ----
   release/tools/openstack.conf | 6 ------
   release/tools/oracle.conf    | 1 -
   release/tools/vagrant.conf   | 6 ------
   5 files changed, 20 deletions(-)

[commit 46eca8270ce528936e65c805eba9635ecd2cbcdb]
Date: 2026-01-06
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: only create the default user when needed
Review: The nuageinit utility now creates the default user only when the 'users' key is missing or when 'default' is present in the users list, and handles SSH key injection more consistently.
Body:

  The "default" user should only be created when:

  - the `users` key is missing
  - or the `default` string is present in the `users` list

  Since the `public_keys` is extracted from the meta-data, this patch has
  to slightly adjust the way they are loaded.
  The change simplify the logic around the default user SSH key injection.
  Both `ssh_authorized_keys` and `public_keys` are handled at the same time.

  MFC After:	1 week
  Signed-off-by: Gonri Le Bouder <goneri@lebouder.net>
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1952
  (cherry picked from commit cbc00fcc2b92e6e38b0a180261547b1a22b461bd)


   libexec/nuageinit/nuageinit | 150 ++++++++++++++++++++++++++------------------
   1 file changed, 88 insertions(+), 62 deletions(-)

[commit bdc2a7c9198a91aaacce7a1c3cbe6902b7bc4c50]
Date: 2026-01-06
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: nuageinit(7): pert mandoc linter
Review: The commit fixes formatting issues in the man:nuageinit[7] manual page to comply with mandoc linting rules. This improves the quality and correctness of the documentation.
Body:

  MFC After: 	1 week

  (cherry picked from commit 9ea30bbb0e3c34b3ea369e217d930e2165610c0c)


   libexec/nuageinit/nuageinit.7 | 34 +++++++++++++++++-----------------
   1 file changed, 17 insertions(+), 17 deletions(-)

[commit 5ba6ed861df77399c8957f95ca1f62cb9865c28f]
Date: 2026-01-02
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: config2_network support dns service cfg
Review: The nuageinit utility now supports DNS configuration from the services section in network_data.json, allowing global DNS settings to be applied.
Body:

  This change enhances `config2_network()` to honor the DNS
  configuration, when it's defined through the `services` section.

  The `network_data.json` file can hold DNS configuration at two different
  places:
  - within a network configuration entry
  - or `dns` entry in the `services` section, in this case the configuration is global.

  An example of such configuration:

  {"links": [{"id": "interface0", "type": "phy",
  "ethernet_mac_address": "52:54:00:01:59:03"}], "networks": [{"id": "private-ipv4-0", "type": "ipv4", "link": "interface0",
  "ip_address": "192.168.123.5", "netmask": "255.255.255.0", "routes": [{"network": "0.0.0.0", "netmask": "0.0.0.0", "gateway":
  "192.168.123.1"}], "network_id": "9e5b1ed9-f5e6-4941-a90f-2e06bab858de", "dns_nameservers": ["192.168.123.1"], "services": [{"type":
   "dns", "address": "192.168.123.1"}]}], "services": [{"type": "dns", "address": "192.168.123.1"}]}

  See: https://docs.openstack.org/nova/latest/user/metadata.html

  MFC After: 	1 week
  Signed-off-by: Gonri Le Bouder <goneri@lebouder.net>
  Pull Request: 	https://github.com/freebsd/freebsd-src/pull/1941
  (cherry picked from commit 7af8b75201b7af353fa74c8feb937b52f5ccf9bb)


   libexec/nuageinit/nuageinit   | 25 ++++++++++++++++++++++++-
   libexec/nuageinit/nuageinit.7 |  2 ++
   2 files changed, 26 insertions(+), 1 deletion(-)

[commit 01c811c317262e46bcc37ff5f8ac4a2f399bfdef]
Date: 2026-01-03
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: nuageinit/man: clarify how to enable sudo and doas
Review: The man:nuageinit[7] manual page clarifies that sudo and doas are not part of the base system and must be listed in the packages section to be enabled.
Body:

  Clarify that both `sudo` and `doas` are not part of the base system and
  they need to be listed in the `packages` section if the user wants to
  enable them.

  MFC After: 	1 week
  Signed-off-by: Gonri Le Bouder <goneri@lebouder.net>
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1944
  (cherry picked from commit 402f1353707783e2adc8d0bff01faf557820f6f5)


   libexec/nuageinit/nuageinit.7 | 12 +++++++++++-
   1 file changed, 11 insertions(+), 1 deletion(-)

[commit 9b9ebc918a6782a717f8380d1d65572804a102a9]
Date: 2025-12-05
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Userland.contrib
Subject: ncurses: readd "bsdpads"
Review: ncurses now includes the bsdpads configuration, which may affect compatibility with older programs such as Nethack.
Body:

  During the import of ncurses 6.5 some bsd specifics configuration where
  lost and reintroduce quickly after the import, unfortunatly there was a
  typo in this fix which caused the "bsdpads" to not be enabled in
  ncurses.

  Fortunatly only very old programs may be affected by this change,
  unfortunatly Nethack (in the ports tree is one of them.)

  PR:		287358
  MFC After:	3 days

  (cherry picked from commit 836a0d46320c18d83029bf138b630b6ce5ebe6ae)


   lib/ncurses/tinfo/ncurses_cfg.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 215d16e4102b3c03c6bde13c78f57922b94ad74e]
Date: 2025-08-26
Score: 5
Status: proposed(include=no,score=25)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: openssh: Add detail on client side VersionAddendum
Review: The commit updates the FREEBSD-upgrade file to note that upstream OpenSSH now includes client-side VersionAddendum support, which was previously a FreeBSD-specific feature.
Body:

  FreeBSD introduced VersionAddendum for the server as a local change in
  2001 in commit 933ca70f8f88 and later extended it to the client in
  commit 9e2cbe04ff4f.

  In 2012 upstream added support for server VersionAddendum, in commit
  23528816dc10.  They did not add client support.

  We removed the client support from main in commit bffe60ead024 ("ssh:
  retire client VersionAddendum").

  As of the 10.0p2 release upstream has added client-side VersionAddendum.
  Make note of this in FREEBSD-upgrade's patches section.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit b55439338dc40d1954fd37281d48786148483190)


   crypto/openssh/FREEBSD-upgrade | 11 +++++++++--
   1 file changed, 9 insertions(+), 2 deletions(-)

[commit 8d87742a96f59008e2fb655fa4434cd397d953a5]
Date: 2026-01-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: RELNOTES:  Correct commit hash in commit ec98cb56861f
Review: The commit only updates internal documentation (RELNOTES file) with a commit hash correction, which does not affect users or introduce any user-visible changes.
Body:


   RELNOTES | 4 ++++
   1 file changed, 4 insertions(+)

[commit 7f20404b9f91557d655a50d8d43c77f87379d577]
Date: 2025-01-27
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Bootloader.general
Subject: loader.efi: add stride & offset for MacBookPro3,1
Review: The EFI loader adds stride and offset values for the 17" 1680x1050 model of MacBookPro3,1, improving display support on this specific hardware variant.
Body:

  Note that there are three variants of this MacBook. We only have the
  stride and offset values for the 17" 1680x1050 model.

  Reviewed by:	vexeduxr
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1584

  (cherry picked from commit be6ba97aaee762c2e5300834f1916ae5dfd5a0b9)


   stand/efi/loader/framebuffer.c | 17 +++++++++++++++++
   1 file changed, 17 insertions(+)

[commit 4832232096f8e691563e5200b9f0d86d158bc51a]
Date: 2026-01-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Bootloader.general
Subject: loader.efi: probe for UGA if GOP isn't found
Review: The EFI loader now probes for UGA (Universal Graphics Adapter) if GOP (Graphics Output Protocol) is not found, improving compatibility with older UEFI systems.
Body:

  Probe for UGA instead of returning early if we can't find GOP.

  Reviewed by:	tsoome
  PR:		291935
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54431

  (cherry picked from commit 5d85dde27b4769604fc108b89328607e70e767ed)


   stand/efi/loader/framebuffer.c | 74 ++++++++++++++++++++++--------------------
   1 file changed, 38 insertions(+), 36 deletions(-)

[commit 00d2b1b0c4d48bd8daf0b01851e694a7dff12fe1]
Date: 2026-01-06
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: ng_tty: avoid the sign extention of char
Review: Fixes a potential sign extension issue in the netgraph tty driver's character comparison, ensuring correct handling of hotchar detection.
Body:

  When c is compared to sc->hotchar, both undergo integer promotion, which
  can lead to c being sign extended. Fix this by casting c to an unsigned
  char.

  Reviewed by:	kevans
  MFC after:	5 days
  Differential Revision:	https://reviews.freebsd.org/D54544

  (cherry picked from commit 9b2478f60bfda663c84b48e272a2293159e1b0a0)


   sys/netgraph/ng_tty.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 618cf02ffc529da1bb76622386bb7cc0eeb0a823]
Date: 2026-01-03
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libgeom: Fix 32-bit gcc build
Review: The commit fixes a build issue for 32-bit gcc, which is an internal build fix without user-visible impact.
Body:

  MFC after:	1 week
  Fixes:		27894e20f140 ("libgeom: Fix segfault in 32-on-64 case")

  (cherry picked from commit 17355cf50fcbd0d8ddb638e1f2fd5861b526edbe)


   lib/libgeom/geom_xml2tree.c | 7 +++++--
   1 file changed, 5 insertions(+), 2 deletions(-)

[commit ee28edf7546270091fab3626c7f55b5919e7cee8]
Date: 2026-01-03
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: libgeom: Improve type safety of xml2tree code
Review: The commit adds type safety assertions in libgeom's xml2tree code to prevent memory corruption from mismatched object types. This is an internal improvement with no direct user-visible impact.
Body:

  When resolving references, assert that the type of the object we find
  is what we expect.  This will help prevent memory corruption if two
  objects of different types somehow end up with the same identifier.

  MFC after:	1 week
  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D54454

  (cherry picked from commit 4b0d5d1d6a7c9773e38882feb4747a76b37a645c)


   lib/libgeom/geom_xml2tree.c | 54 ++++++++++++++++++++++++++++++++++++---------
   1 file changed, 44 insertions(+), 10 deletions(-)

[commit cff33cd16d6751ab0693a00473ccfe7c8132cfdf]
Date: 2026-01-03
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libgeom: Clean up xml2tree code
Review: Internal code cleanup with no user-visible changes.
Body:

  MFC after:	1 week
  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D54453

  (cherry picked from commit fad6707e2589d8557ceb6b6bf11f22323b265f01)


   lib/libgeom/geom_xml2tree.c | 100 ++++++++++++++++++++++----------------------
   lib/libgeom/libgeom.h       |   2 +-
   2 files changed, 52 insertions(+), 50 deletions(-)

[commit 92f299dc666d82925abbe33e826eb52fb1ffb013]
Date: 2026-01-03
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Userland.libraries
Subject: libgeom: Fix segfault in 32-on-64 case
Review: The libgeom library now correctly parses object identifiers in 32-bit userland on a 64-bit kernel, preventing memory corruption and crashes when resolving consumer-producer references.
Body:

  We were using strtoul() to parse object identifiers, which are kernel
  pointers.  This works fine as long as the kernel and userland match,
  but in a 32-bit libgeom on a 64-bit kernel this will return ULONG_MAX
  for all objects, resulting in memory corruption when we later pick the
  wrong object while resolving consumer-producer references.

  MFC after:	1 week
  PR:		292127
  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D54452

  (cherry picked from commit 27894e20f140ee2729c14b589035870c8185b87d)


   lib/libgeom/geom_xml2tree.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 66206e00de17f929a863f92c11cbb2938796beed]
Date: 2026-01-03
Score: 5
Status: proposed(include=no,score=40)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: undecided
Subject: linuxkpi: Correct kstrtobool
Review: The commit updates the LinuxKPI kstrtobool function to match Linux behavior more closely, affecting compatibility for kernel modules using this interface.
Body:

  Implement the exact same logic as in Linux:

  * Accept 'e', 't', 'y', '1', "on" for true.

  * Accept 'd', 'f', 'n', '0', "of" for false.

  * Disregard any characters beyond that.

  * Check that the string is not null, but don't check the result pointer.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.
  Reviewed by:	bz, emaste
  Differential Revision:	https://reviews.freebsd.org/D54451

  (cherry picked from commit f86148d2777d4d7985ed8f4ae957c41c44bd2484)


   sys/compat/linuxkpi/common/include/linux/kstrtox.h | 16 +++++-----------
   1 file changed, 5 insertions(+), 11 deletions(-)

[commit 445f0d4b27d362867041d8ba20d79981a0eeba83]
Date: 2026-01-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: undecided
Subject: linuxkpi: Don't clobber result on failure
Review: The commit addresses internal code warnings in the LinuxKPI compatibility layer without introducing user-visible changes.
Body:

  In kstrto*(), don't assign to *res until we know the conversion is
  successful, and address issues that may result in warnings if code
  that uses <linux/kstrtox.h> is compiled at high warning levels.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.
  Reviewed by:	bz, emaste
  Differential Revision:	https://reviews.freebsd.org/D54440

  (cherry picked from commit 3542d60fb8042474f66fbf2d779ed8c5a80d0f78)


   sys/compat/linuxkpi/common/include/linux/kstrtox.h | 43 +++++++++++++++-------
   1 file changed, 30 insertions(+), 13 deletions(-)

[commit bf1c000e630524b476b931a60154adef4de120a0]
Date: 2024-12-22
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: linuxkpi: Add `kstrtou32()`
Review: Adds the kstrtou32() function to the LinuxKPI for compatibility with the amdgpu DRM driver from Linux 6.7.
Body:

  [Why]
  This is used by the amdgpu DRM driver in Linux 6.7.

  Reviewed by:	manu
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D48744

  (cherry picked from commit cd245b79418638e0fa8dc4027275ef5da9039993)


   sys/compat/linuxkpi/common/include/linux/kstrtox.h | 7 +++++++
   1 file changed, 7 insertions(+)

[commit 4b2e33e4815262757f998a188821b58b1fe1feea]
Date: 2024-01-13
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Userland.contrib
Subject: Update to bmake-20240108
Review: bmake updated to version 20240108.
Body:

  (cherry picked from commit d5e0a182cf153f8993a633b93d9220c99a89e760)


   contrib/bmake/ChangeLog                            | 102 +++
   contrib/bmake/README                               |  17 +-
   contrib/bmake/VERSION                              |   2 +-
   contrib/bmake/arch.c                               |  10 +-
   contrib/bmake/bmake.1                              |   6 +-
   contrib/bmake/bmake.cat1                           |   6 +-
   contrib/bmake/boot-strap                           |  16 +-
   contrib/bmake/bsd.after-import.mk                  |  17 +-
   contrib/bmake/buf.c                                |   6 +-
   contrib/bmake/buf.h                                |   4 +-
   contrib/bmake/compat.c                             |  65 +-
   contrib/bmake/cond.c                               | 111 ++--
   contrib/bmake/configure                            |  34 +-
   contrib/bmake/configure.in                         |  16 +-
   contrib/bmake/dir.c                                | 330 +++-------
   contrib/bmake/for.c                                |  14 +-
   contrib/bmake/hash.c                               |  28 +-
   contrib/bmake/hash.h                               |  21 +-
   contrib/bmake/job.c                                | 139 ++--
   contrib/bmake/job.h                                |   6 +-
   contrib/bmake/lst.c                                |  22 +-
   contrib/bmake/lst.h                                |   8 +-
   contrib/bmake/main.c                               | 156 ++---
   contrib/bmake/make.1                               |   6 +-
   contrib/bmake/make.c                               |  28 +-
   contrib/bmake/make.h                               |   5 +-
   contrib/bmake/meta.c                               |   6 +-
   contrib/bmake/mk/ChangeLog                         |  42 ++
   contrib/bmake/mk/compiler.mk                       |   4 +-
   contrib/bmake/mk/dirdeps.mk                        |  17 +-
   contrib/bmake/mk/dpadd.mk                          |  14 +-
   contrib/bmake/mk/gendirdeps.mk                     |   6 +-
   contrib/bmake/mk/host-target.mk                    |   7 +-
   contrib/bmake/mk/init.mk                           |   8 +-
   contrib/bmake/mk/install-mk                        |   4 +-
   contrib/bmake/mk/jobs.mk                           |   5 +-
   contrib/bmake/mk/lib.mk                            |  25 +-
   contrib/bmake/mk/man.mk                            |  93 ++-
   contrib/bmake/mk/meta.autodep.mk                   |   4 +-
   contrib/bmake/mk/own.mk                            |   3 +-
   contrib/bmake/mk/prog.mk                           |   5 +-
   contrib/bmake/mk/rst2htm.mk                        |   3 +-
   contrib/bmake/os.sh                                |   0
   contrib/bmake/parse.c                              | 279 +++------
   contrib/bmake/str.c                                |  77 ++-
   contrib/bmake/str.h                                |  29 +-
   contrib/bmake/suff.c                               | 168 ++---
   contrib/bmake/unit-tests/Makefile                  |   9 +-
   contrib/bmake/unit-tests/cmd-errors-jobs.exp       |   2 +-
   contrib/bmake/unit-tests/cmd-errors-lint.exp       |   2 +-
   contrib/bmake/unit-tests/cmd-errors.exp            |   2 +-
   contrib/bmake/unit-tests/cmdline-undefined.mk      |   4 +-
   contrib/bmake/unit-tests/comment.mk                |   4 +-
   contrib/bmake/unit-tests/cond-cmp-string.mk        |  14 +-
   contrib/bmake/unit-tests/cond-cmp-unary.mk         |   8 +-
   contrib/bmake/unit-tests/cond-eof.mk               |   4 +-
   contrib/bmake/unit-tests/cond-func-defined.exp     |   2 +-
   contrib/bmake/unit-tests/cond-func-defined.mk      |   8 +-
   contrib/bmake/unit-tests/cond-func-empty.mk        |  16 +-
   contrib/bmake/unit-tests/cond-func-exists.mk       |   6 +-
   contrib/bmake/unit-tests/cond-func.mk              |   4 +-
   contrib/bmake/unit-tests/cond-late.exp             |   2 +-
   contrib/bmake/unit-tests/cond-late.mk              |   6 +-
   contrib/bmake/unit-tests/cond-op-and.mk            |   8 +-
   contrib/bmake/unit-tests/cond-op-or.mk             |   8 +-
   contrib/bmake/unit-tests/cond-short.exp            |   2 +-
   contrib/bmake/unit-tests/cond-short.mk             |  23 +-
   contrib/bmake/unit-tests/cond-token-number.mk      |   6 +-
   contrib/bmake/unit-tests/cond-token-plain.exp      |   4 +-
   contrib/bmake/unit-tests/cond-token-plain.mk       |  16 +-
   contrib/bmake/unit-tests/cond-token-string.exp     |   2 +-
   contrib/bmake/unit-tests/cond-token-string.mk      |  10 +-
   contrib/bmake/unit-tests/cond-token-var.mk         |  16 +-
   contrib/bmake/unit-tests/dep-var.exp               |   2 +-
   contrib/bmake/unit-tests/dep-var.mk                |  10 +-
   contrib/bmake/unit-tests/depsrc-ignore.exp         |   2 +-
   .../bmake/unit-tests/deptgt-delete_on_error.exp    |   2 +-
   contrib/bmake/unit-tests/deptgt-makeflags.exp      |   2 +-
   contrib/bmake/unit-tests/deptgt-makeflags.mk       |   6 +-
   contrib/bmake/unit-tests/deptgt.mk                 |   6 +-
   contrib/bmake/unit-tests/dir.mk                    |   4 +-
   contrib/bmake/unit-tests/directive-else.mk         |   4 +-
   .../bmake/unit-tests/directive-export-gmake.exp    |   1 +
   contrib/bmake/unit-tests/directive-export-gmake.mk |  25 +-
   contrib/bmake/unit-tests/directive-export.exp      |   6 +-
   contrib/bmake/unit-tests/directive-export.mk       |  10 +-
   contrib/bmake/unit-tests/directive-for-empty.mk    |  12 +-
   contrib/bmake/unit-tests/directive-for-errors.mk   |  14 +-
   contrib/bmake/unit-tests/directive-for-escape.exp  |   4 +-
   contrib/bmake/unit-tests/directive-for-escape.mk   |  12 +-
   contrib/bmake/unit-tests/directive-for-if.mk       |   4 +-
   contrib/bmake/unit-tests/directive-for.exp         |  19 +-
   contrib/bmake/unit-tests/directive-for.mk          |  27 +-
   contrib/bmake/unit-tests/directive-ifmake.mk       |   4 +-
   contrib/bmake/unit-tests/directive-ifndef.mk       |  36 +-
   .../bmake/unit-tests/directive-include-guard.exp   |  16 +
   .../bmake/unit-tests/directive-include-guard.mk    | 188 ++++--
   contrib/bmake/unit-tests/directive-warning.mk      |   4 +-
   contrib/bmake/unit-tests/directive.mk              |   4 +-
   contrib/bmake/unit-tests/escape.exp                |  36 +-
   contrib/bmake/unit-tests/escape.mk                 |   7 +-
   contrib/bmake/unit-tests/hanoi-include.mk          |   7 +-
   contrib/bmake/unit-tests/jobs-error-indirect.exp   |   2 +-
   .../bmake/unit-tests/jobs-error-nested-make.exp    |   2 +-
   contrib/bmake/unit-tests/jobs-error-nested.exp     |   4 +-
   contrib/bmake/unit-tests/lint.mk                   |   4 +-
   contrib/bmake/unit-tests/moderrs.exp               |  20 +-
   contrib/bmake/unit-tests/moderrs.mk                |   6 +-
   contrib/bmake/unit-tests/opt-debug-file.mk         |   4 +-
   contrib/bmake/unit-tests/opt-debug-jobs.mk         |   4 +-
   contrib/bmake/unit-tests/opt-debug-lint.mk         |   6 +-
   contrib/bmake/unit-tests/opt-debug-loud.mk         |   6 +-
   contrib/bmake/unit-tests/opt-debug-var.mk          |   4 +-
   contrib/bmake/unit-tests/parse-var.mk              |   6 +-
   contrib/bmake/unit-tests/recursive.exp             |   4 +-
   contrib/bmake/unit-tests/recursive.mk              |  15 +-
   contrib/bmake/unit-tests/sh-dots.mk                |   6 +-
   contrib/bmake/unit-tests/sh-leading-hyphen.exp     |   2 +-
   contrib/bmake/unit-tests/shell-sh.mk               |   4 +-
   contrib/bmake/unit-tests/unexport.mk               |   4 +-
   contrib/bmake/unit-tests/var-eval-short.mk         |   4 +-
   contrib/bmake/unit-tests/var-op-append.mk          |  33 +-
   contrib/bmake/unit-tests/var-op-assign.mk          |   4 +-
   contrib/bmake/unit-tests/var-op-default.mk         |   8 +-
   contrib/bmake/unit-tests/var-op-expand.mk          |   6 +-
   contrib/bmake/unit-tests/var-op-shell.mk           |  20 +-
   contrib/bmake/unit-tests/var-readonly.exp          |   3 +
   contrib/bmake/unit-tests/var-readonly.mk           |   4 +-
   contrib/bmake/unit-tests/var-recursive.exp         |   8 +-
   contrib/bmake/unit-tests/var-recursive.mk          |   4 +-
   contrib/bmake/unit-tests/var-scope-cmdline.mk      |   4 +-
   .../bmake/unit-tests/var-scope-local-legacy.exp    |   2 +-
   contrib/bmake/unit-tests/var-scope-local-legacy.mk |  22 +-
   contrib/bmake/unit-tests/var-scope-local.exp       |   4 +-
   contrib/bmake/unit-tests/var-scope-local.mk        |  12 +-
   contrib/bmake/unit-tests/vardebug.exp              |  20 +-
   contrib/bmake/unit-tests/vardebug.mk               |  29 +-
   contrib/bmake/unit-tests/varmisc.exp               |   5 +-
   contrib/bmake/unit-tests/varmisc.mk                |  28 +-
   contrib/bmake/unit-tests/varmod-assign.exp         |  32 +
   contrib/bmake/unit-tests/varmod-assign.mk          |  71 ++-
   contrib/bmake/unit-tests/varmod-defined.exp        |   2 +-
   contrib/bmake/unit-tests/varmod-defined.mk         |  10 +-
   contrib/bmake/unit-tests/varmod-edge.exp           |   2 +-
   contrib/bmake/unit-tests/varmod-edge.mk            |   8 +-
   contrib/bmake/unit-tests/varmod-gmtime.mk          |  15 +-
   contrib/bmake/unit-tests/varmod-ifelse.exp         |  20 +-
   contrib/bmake/unit-tests/varmod-ifelse.mk          |  36 +-
   contrib/bmake/unit-tests/varmod-indirect.mk        |  24 +-
   contrib/bmake/unit-tests/varmod-l-name-to-value.mk |   4 +-
   contrib/bmake/unit-tests/varmod-localtime.mk       |   4 +-
   contrib/bmake/unit-tests/varmod-loop-varname.mk    |   4 +-
   contrib/bmake/unit-tests/varmod-loop.mk            |   6 +-
   contrib/bmake/unit-tests/varmod-match-escape.mk    |  20 +-
   contrib/bmake/unit-tests/varmod-match.exp          |  33 +-
   contrib/bmake/unit-tests/varmod-match.mk           | 317 ++++++----
   contrib/bmake/unit-tests/varmod-mtime.exp          |  16 +-
   contrib/bmake/unit-tests/varmod-mtime.mk           |  45 +-
   contrib/bmake/unit-tests/varmod-order.exp          |   6 +-
   contrib/bmake/unit-tests/varmod-range.exp          |  21 +-
   contrib/bmake/unit-tests/varmod-range.mk           |  26 +-
   contrib/bmake/unit-tests/varmod-subst-regex.mk     |  57 +-
   contrib/bmake/unit-tests/varmod-subst.mk           |  46 +-
   contrib/bmake/unit-tests/varmod-sysv.mk            |  10 +-
   contrib/bmake/unit-tests/varmod-to-separator.mk    |   4 +-
   contrib/bmake/unit-tests/varmod-undefined.mk       |   6 +-
   contrib/bmake/unit-tests/varmod.mk                 |   6 +-
   contrib/bmake/unit-tests/varname-dot-shell.exp     |  10 +-
   contrib/bmake/unit-tests/varname-dot-suffixes.exp  |  20 +-
   contrib/bmake/unit-tests/varname-dot-suffixes.mk   |  19 +-
   contrib/bmake/unit-tests/varname-empty.exp         |  24 +-
   contrib/bmake/unit-tests/varname-empty.mk          |   4 +-
   .../varname-make_print_var_on_error-jobs.mk        |   4 +-
   contrib/bmake/unit-tests/varname.mk                |   4 +-
   contrib/bmake/unit-tests/varparse-dynamic.mk       |   4 +-
   contrib/bmake/unit-tests/varparse-errors.exp       |  28 +-
   contrib/bmake/unit-tests/varparse-errors.mk        |   8 +-
   contrib/bmake/unit-tests/varparse-mod.mk           |   6 +-
   contrib/bmake/unit-tests/varparse-undef-partial.mk |  13 +-
   contrib/bmake/util.c                               |  96 ++-
   contrib/bmake/var.c                                | 696 +++++++++------------
   usr.bin/bmake/Makefile.config                      |   2 +-
   usr.bin/bmake/config.h                             |   4 +-
   usr.bin/bmake/unit-tests/Makefile                  |   9 +-
   184 files changed, 2585 insertions(+), 2176 deletions(-)

[commit d437d1f1d5367af81417de9e0dc84d6a0e6846a1]
Date: 2026-01-08
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: GCE: Fix growfs path
Review: The sed command in the GCE image build script now correctly uses ${DESTDIR} to modify the target image's /etc/rc.d/growfs script instead of the host system's file.
Body:

  The sed command was missing the ${DESTDIR} prefix, meaning it was
  attempting to modify the build host's /etc/rc.d/growfs instead of
  the target image's script. Tested in an arm64 builder that builds
  as non-root.

  PR:		kern/292081

  (cherry picked from commit 709c1049fe0c6d0217e81268d4f33f7191474453)


   release/tools/gce.conf | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c76941a6929d613fbe8f3f2bbbfae7c6dfdd458b]
Date: 2026-01-08
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Hardware.virtualization
Subject: GCE: Enable vtnet(4) Multiqueue.
Review: The vtnet(4) driver now enables multiqueue support by default on Google Compute Engine, allowing network interrupts to scale across multiple vCPUs. This improves network performance on multi-core VMs.
Body:

  Removes hw.vtnet.mq_disable=1.

  This workaround was originally introduced nearly a decade ago to
  address stability issues on KVM that have long since been resolved
  in both the FreeBSD driver and the GCE hypervisor. Removing this
  allows network interrupts to scale across multiple vCPUs.

  Tested on n2-highcpu-16 VM with 15.0-RELEASE and confirmed multiple
  queue pairs active and interrupts handling across cores.

  PR:		kern/292081

  (cherry picked from commit f604d84618ad478fa46ec374480cbcbc1d93bf07)


   release/tools/gce.conf | 1 -
   1 file changed, 1 deletion(-)

[commit cff07c11c7085e118dae8fc76b374b8e4850bdbb]
Date: 2025-12-13
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: mps(4): Fix a typo in a device message
Review: Fixes a typo in a device message for the mps(4) driver.
Body:

  - s/reseting/resetting/

  (cherry picked from commit bcc735cb710fb74d1fb5f7be3d37701343c58ccd)


   sys/dev/mps/mps.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit cb3ce1408d8b9b30771f3e3abc36325943d0cbba]
Date: 2025-12-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: mmc(4): Fix a typo in a device debug message
Review: Fixes a typo in a debug message for the mmc(4) driver, which has no user-visible impact.
Body:

  - s/reseting/resetting/

  (cherry picked from commit 3b6f9481a85600cf1f23a819c3afee30fcd4122f)


   sys/cam/mmc/mmc_xpt.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit fced0139a3fb8d11dbee64069f79d5d9ba0b7cb9]
Date: 2025-12-13
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: altq(4): Fix a typo in a source code comment
Review: Fixes a typo in a comment within the altq(4) source code; no user-visible impact.
Body:

  - s/backet/bucket/

  (cherry picked from commit 1df4d82bd17ebd7449a6b58c32b65a12269ca068)


   sys/net/altq/altq.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 0d82ee2726dfe21ef08387ac21db8d77031963c6]
Date: 2026-01-07
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: vm_object.h: tweak OBJ_ONEMAPPING comment even more
Review: Only changes a comment in a kernel header file; no user-visible impact.
Body:

  (cherry picked from commit dcb80621bbf9a733b91f1a011af873318fac2709)


   sys/vm/vm_object.h | 5 ++---
   1 file changed, 2 insertions(+), 3 deletions(-)

[commit aa21e75f6da3875c4c519d3187f65e8b00c230ee]
Date: 2026-01-01
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vm/vm_object.h: clarify the OBJ_ONEMAPPING semantic
Review: The commit clarifies internal kernel documentation without any user-visible change.
Body:

  (cherry picked from commit 9c923575606bbd29dcf0ec3384150d2d67136cbb)


   sys/vm/vm_object.h | 5 +++--
   1 file changed, 3 insertions(+), 2 deletions(-)

[commit 1f150b9c73e5bbb0bb909df70b1edf9c59b16f4a]
Date: 2026-01-07
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: mrsas.4: Fix devid hex style
Review: The commit fixes a formatting issue in the man:mrSAS[4] man page, correcting the hexadecimal style of a device ID. This change improves documentation accuracy but does not affect functionality.
Body:

  (cherry picked from commit c2b407244f3a939d8b09f9a22d872ebdce5f6b19)


   share/man/man4/mrsas.4 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit ec98cb56861fa1cff372ae006f9c2c6a0fc78649]
Date: 2025-08-28
Score: 5
Status: added(include=yes,score=85)
Sponsor: Microchip Technology Inc.
Section: Drivers.device
Subject: smartpqi: update to version 4660.0.2002
Review: The man:smartpqi[4] driver is updated to version 4660.0.2002, providing updated support for Microchip smartpqi controllers.
Body:

  This updates the smartpqi driver to Microchip's
  latest available public release.

  Reviewed by: imp
  Approved by: imp

  Sponsored by: Microchip Technology Inc.

  Differential Revision: https://reviews.freebsd.org/D52507

  (cherry picked from commit c558eca47970c8467ed0494145f08d1879050bbd)


   share/man/man4/smartpqi.4               |  88 +++++++-
   sys/dev/smartpqi/smartpqi_cam.c         |  53 ++---
   sys/dev/smartpqi/smartpqi_cmd.c         |   4 +-
   sys/dev/smartpqi/smartpqi_controllers.h | 371 ++++++++++++++++++++++++++++++++
   sys/dev/smartpqi/smartpqi_defines.h     |  43 ++--
   sys/dev/smartpqi/smartpqi_discovery.c   | 167 +++++---------
   sys/dev/smartpqi/smartpqi_event.c       |  10 +-
   sys/dev/smartpqi/smartpqi_helper.c      |  32 ++-
   sys/dev/smartpqi/smartpqi_init.c        |  13 +-
   sys/dev/smartpqi/smartpqi_intr.c        |   3 +-
   sys/dev/smartpqi/smartpqi_ioctl.c       |  12 +-
   sys/dev/smartpqi/smartpqi_main.c        | 320 +++------------------------
   sys/dev/smartpqi/smartpqi_misc.c        |  28 +--
   sys/dev/smartpqi/smartpqi_prototypes.h  |  52 ++---
   sys/dev/smartpqi/smartpqi_queue.c       |  25 +--
   sys/dev/smartpqi/smartpqi_request.c     | 104 ++++-----
   sys/dev/smartpqi/smartpqi_response.c    |  14 +-
   sys/dev/smartpqi/smartpqi_sis.c         |   6 +-
   sys/dev/smartpqi/smartpqi_structures.h  |   5 +-
   19 files changed, 725 insertions(+), 625 deletions(-)

[commit 653099bcc191eba839d7266333618fa6ca915605]
Date: 2026-01-06
Score: 5
Status: added(include=yes,score=85)
Sponsor: 
Section: Drivers.device
Subject: mrsas.4: Add Fujitsu RAID Controller SAS 6Gbit/s 1GB (D3116)
Review: The man:mr_sas[4] driver now supports the Fujitsu RAID Controller SAS 6Gbit/s 1GB (D3116), which is used in Fujitsu PRIMERGY servers like the RX300 S7.
Body:

  This is an OEM card from Fujitsu using an LSI SAS2208 ROC controller shipped
  with many Fujitsu PRIMERGY servers like RX300 S7.

  Controller description: https://www.fujitsu.com/global/products/computing/servers/primergy/blades/connection/cb-pmod-110426.html

  Reviewed by:	ziaee
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D54566

  (cherry picked from commit ccec94bf63de8ee067b03b981a283d9f968c3667)


   share/man/man4/mrsas.4 | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 1410d22cac55c325dc437fb4575465001e65fe97]
Date: 2025-09-15
Score: 5
Status: proposed(include=no,score=35)
Sponsor: 
Section: undecided
Subject: libc++: silence -Wnontrivial-memaccess warning with newer clang
Review: Silences -Wnontrivial-memaccess warnings in libc++ when building with newer Clang versions, preventing build failures with Clang HEAD.
Body:

  Apply part of LLVM commit 71315698c91d0cda054b903da0594ca6f072c350 to
  silence the -Wnontrivial-memaccess warning that is triggered any time
  this function is instantiated by user code. This fixes another
  buildworld failure with Clang HEAD.

  Original commit message:
  [clang] Warn about memset/memcpy to NonTriviallyCopyable types (#111434)
  This implements a warning that's similar to what GCC does in that
  context: both memcpy and memset require their first and second operand
  to be trivially copyable, let's warn if that's not the case.

  Reviewed by:	emaste, dim
  MFC after:	1 week
  Differential Revision: https://reviews.freebsd.org/D52534

  (cherry picked from commit 34a006eaa39ceb6b0a96fa386c9b9b8a44681979)
  (cherry picked from commit ca149d75e9bd6455abc3c74e7db160464cfabbdb)


   .../llvm-project/libcxx/include/__memory/uninitialized_algorithms.h    | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 4fc0ae5d6b459156317acc070acbbdc53cda1d6e]
Date: 2026-01-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: share/mk: Remove trailing '/' from debug info directories
Review: The change removes a trailing slash from debug info directory paths, which may affect where debug files are placed during builds.
Body:

  Signed-off-by: Marian Cingel <cingel.marian@gmail.com>
  Reviewed by:	emaste
  Pull request:	https://github.com/freebsd/freebsd-src/pull/1947
  (cherry picked from commit 7359df79d3affeccf17f12f16c23ba3d4c5e0346)
  (cherry picked from commit 3e8f7f7c6c015f044f9e65ea8a1f307d449d41b3)


   share/mk/bsd.debug.mk | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit ac8b22b3732afbc05edec105a438f13b507bbac3]
Date: 2025-09-27
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: mrsas.4: Cleaning
Review: The commit updates the mrsas.4 man page with editorial improvements, hardware list updates, and mdoc grammar corrections, making sysctls aproposable and linking cross-references.
Body:

  + Rewrite SYNOPSIS for consistency
  + Rewrite HARDWARE for HW Relnotes, and add some stragglers
  + Correct mdoc grammar, making sysctls aproposable and linking xrefs
  + Clean up TODO, cannonicalize to CAVEATS, a standard section
  + Editorial pass, tag SPDX

  MFC after:		3 days
  Reviewed by:		imp
  Differential Revision:	https://reviews.freebsd.org/D52125

  (cherry picked from commit 52eb7e394a7e28e9b08e2096c4a085a384cc1dd0)


   share/man/man4/mrsas.4 | 199 ++++++++++++++++++++++---------------------------
   1 file changed, 91 insertions(+), 108 deletions(-)

[commit 65cf47bad664f9395f17e698759be50fd8599e27]
Date: 2025-12-19
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: OPNsense | Klara, Inc.
Section: Network.general
Subject: ifconfig: Fix the -L flag when using netlink
Review: The man:ifconfig[8] -L flag now correctly displays remaining lifetimes for IPv6 addresses derived from router-advertised prefixes when using netlink.
Body:

  By default, when ifconfig shows a v6 address derived from a
  router-advertised prefix, it shows the initial preferred and valid
  lifetimes.  When -L is specified, it is supposed to show the remaining
  lifetimes, but this was broken in the conversion to netlink.

  Fix that, and add a regression test which validates ifconfig output
  before and after a short-lived address expires.

  Reported by:	Franco Fichtner <franco@opnsense.org>
  Reviewed by:	melifaro, allanjude, Seyed Pouria Mousavizadeh Tehrani
  Fixes:		4c91a5dfe483 ("ifconfig: make interface and address listing use Netlink as transport")
  MFC after:	2 weeks
  Sponsored by:	OPNsense
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D54294

  (cherry picked from commit df6861d755c8f72380ae7fb8df535b27eba8c0be)


   sbin/ifconfig/af_inet6.c  |  6 +++--
   tests/sys/netinet6/ndp.sh | 62 +++++++++++++++++++++++++++++++++++++++++++++++
   tests/sys/netinet6/ra.py  | 11 ++++++++-
   3 files changed, 76 insertions(+), 3 deletions(-)

[commit ee1daae7b9141b771d1d25837642ec93c8791c6c]
Date: 2025-12-19
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: tests: Fix style in ra.py
Review: No user-visible changes; only style fixes in a test file.
Body:

  No functional change intended.

  MFC after:	2 weeks

  (cherry picked from commit 7080c1b09d72e64f17185e90d7b660175f8fbaba)


   tests/sys/netinet6/ra.py | 22 ++++++++++++----------
   1 file changed, 12 insertions(+), 10 deletions(-)

[commit 5738812be35a26cc1fa1f96d363d2c67bfb85fe0]
Date: 2025-12-18
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Drivers.device
Subject: armv8rng: Fix an inverted test in random_rndr_read_one()
Review: The armv8rng driver now correctly returns entropy on the first successful read instead of potentially retrying up to ten times.
Body:

  If we get a random number, the NZCV is set to 0b0000.  Then
  "cset %w1, ne" will test whether Z == 0 and set %w1 to 1 if so.
  More specifically, "cset %w1, ne" maps to "csinc %w1, wzr, wzr, eq",
  which stores 0 in %w1 when NZCV == 0b0100 and 1 otherwise.

  Thus, on a successful read we expect ret != 0, so the loop condition
  needs to be fixed.  In practice this means that we would end up trying
  to fetch entropy up to ten times in a row.  If all attempts are
  successful, the last will be returned, otherwise no entropy will be
  returned.

  Reported by:	Kevin Day <kevin@your.org>
  Reviewed by:	andrew
  Fixes:		9eecef052155 ("Add an Armv8 rndr random number provider")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54259

  (cherry picked from commit 93811883500b99f9f1fb4ffd6e764226d37dcfd0)


   sys/dev/random/armv8rng.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b87f70f695f1ed21e0e7867f0c60778c3737d1a7]
Date: 2025-12-14
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: CHERI Research Centre (EPSRC grant UKRI3001)
Section: Network.general
Subject: pfsync: Avoid zeroing the state export union
Review: The commit fixes a bug in pfsync state export that could cause incorrect zeroing of state formats, ensuring proper handling of different state format sizes. This prevents potential data corruption in state synchronization.
Body:

  pfsync_state_export() takes a pointer to a union that is in reality a
  pointer to one of the three state formats (1301, 1400, 1500), and zeros
  the union.  The three formats do not have the same size, so zeroing is
  wrong when the format isn't that which has the largest size.

  Refactor a bit so that the zeroing happens at the layer where we know
  which format we're dealing with.

  Reported by:	CHERI
  Reviewed by:	kp
  MFC after:	1 week
  Sponsored by:	CHERI Research Centre (EPSRC grant UKRI3001)
  Differential Revision:	https://reviews.freebsd.org/D54163

  (cherry picked from commit 796abca7e281f0d4b7f72f48da4f941e1c8b139c)


   sys/net/pfvar.h            |  6 ++++--
   sys/netpfil/pf/if_pfsync.c | 10 ++++++----
   sys/netpfil/pf/pf_ioctl.c  | 26 +++++++++++++++++++-------
   3 files changed, 29 insertions(+), 13 deletions(-)

[commit e08642c98c67d16c68558206a5abc822557bb824]
Date: 2025-12-14
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: socket: Fix the name of a parameter in a comment
Review: Only a comment fix, no user-visible impact.
Body:

  Reported by:	des
  Fixes:		0a68f644dca1 ("socket: Split up soreceive_generic()")
  MFC after:	1 week

  (cherry picked from commit a0d607957533c7fbefaac5cd81d34c037cc27344)


   sys/kern/uipc_socket.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 284f29f84ac8a5a3f9f02ef145332af678ccc23f]
Date: 2025-12-14
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Klara, Inc.
Section: Network.general
Subject: netmap: Let memory allocator parameters be settable via loader.conf
Review: The netmap memory allocator parameters can now be set via loader.conf tunables, which is useful when dev.netmap.port_numa_affinity is enabled.
Body:

  This is useful when dev.netmap.port_numa_affinity is set to 1.  When
  interfaces attach, they get a memory allocator that is copied from
  nm_mem.  Parameters in nm_mem can be set using sysctls, but this happens
  after their values are copied.

  To work around this, we can make it possible to set these memory
  parameters as tunables.

  Reviewed by:	vmaffione
  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D54178

  (cherry picked from commit c694122f3cfb7d52b882fa79086d49f45a2c7fd2)


   sys/dev/netmap/netmap_mem2.c | 34 +++++++++++++++++++---------------
   1 file changed, 19 insertions(+), 15 deletions(-)

[commit 0957cb17e8a79b94c1e80bf53d57d333c86071c5]
Date: 2025-12-18
Score: 5
Status: proposed(include=no,score=15)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: kern: racct: Remove code unused since %cpu resource computation revamp
Review: Removes unused code from the resource accounting subsystem following earlier improvements to CPU resource computation.
Body:

  Reviewed by:    emaste, markj
  Fixes:          c72188d85a79 ("racct: Improve handling of the pcpu resource")
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D54284

  (cherry picked from commit 55ce12672b948c002431851af54843bfc7f50d6f)


   sys/kern/kern_racct.c | 133 --------------------------------------------------
   1 file changed, 133 deletions(-)

[commit 2c3fb4cd509623f9510c62cde81d3e76b441435c]
Date: 2025-08-05
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: racct: Improve handling of the pcpu resource
Review: The racct subsystem now computes CPU usage as a decaying average of aggregated wallclock time for all threads, providing more accurate CPU consumption values for short-lived processes and containers.
Body:

  The previous scheme would inflate the CPU consumption of short-lived
  processes.  For containers (e.g., processes, jails), the total pcpu
  usage was computed as a sum of the pcpu usage of all constituent
  threads, which makes little sense for a decaying average.

  Instead, aggregate wallclock time of all on-CPU threads and compute the
  pcpu resource as a decaying average as the sum.  This gives much more
  reasonable and accurate values in various simple tests.

  PR:		235556
  Reviewed by:	markj
  MFC after:	1 month
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D30878

  (cherry picked from commit c72188d85a793c7610208beafb83af544de6e3b7)

  Changes for this MFC to stable/14:
  - Removal of process swap out (thread stacks swapped out) was done only
    in 'main' and stable/15 and prior to the original commit, causing
    a conflict with a test on P_INMEM.  In this MFC, the %CPU is not
    forced to 0 anymore when P_INMEM is not set (contrary to what ps(1)
    explicitly does, which we find dubious).  The %CPU decay will take
    care of that in a more accurate manner (for processes that have just
    been swapped out).
  - Commit 9530c6f082ada9e6 ("racct: Simplify skipping idle process in the
    throttling daemon") was MFCed before this one although it occurred
    after it.  Consequently, adding the 'idle' variable in racctd() was
    removed from this MFC, as the other original commit removes it.


   sys/kern/kern_racct.c | 306 ++++++++++++++++++++++++--------------------------
   sys/sys/proc.h        |   2 +-
   sys/sys/racct.h       |   6 +-
   3 files changed, 150 insertions(+), 164 deletions(-)

[commit 4e4272024e33d06f0b38a7d93c1c65b779220d13]
Date: 2025-12-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: jail: Don't define malloc type M_PRISON_RACCT on !RACCT
Review: The commit removes a conditional definition of a malloc type when resource accounting (RACCT) is disabled, which is an internal kernel change with no user-visible impact.
Body:

  Reviewed by:    emaste, jamie
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D54271

  (cherry picked from commit a8be81456cfeecc66ba3b41eb9a2d3dfea7ebc8c)


   sys/kern/kern_jail.c | 2 ++
   1 file changed, 2 insertions(+)

[commit db094e82c2f754251eaa1375a79175a20066e3c3]
Date: 2026-01-02
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: bsd.sys.mk: suppress another gcc warning for libc++
Review: The commit suppresses a GCC warning for libc++ headers to avoid -Werror failures, affecting builds using GCC with -Wsystem-headers.
Body:

  Similar to base 63d1c3c43690, suppress -Wc++20-extensions for gcc.
  Otherwise libc++ headers will lead to many -Werror warnings, due to our
  use of -Wsystem-headers, which is not officially supported upstream.

  MFC after:	3 days

  (cherry picked from commit 62a7fdc13ab45b48977424ef77bbc0f11f601e39)


   share/mk/bsd.sys.mk | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 36e77eafb4d3eba643759d79f6355f682545917d]
Date: 2025-12-18
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.contrib
Subject: ntp: Fix buildworld with MK_OPENSSL=no
Review: ntp build configuration is updated to handle builds without OpenSSL support.
Body:

  Reported by:	wosch
  Tested by:	wosch

  (cherry picked from commit 2804461adfc670c78c1dcb9cab6b2191c8d486ec)


   usr.sbin/ntp/Makefile.inc | 2 +-
   usr.sbin/ntp/config.h     | 3 ++-
   2 files changed, 3 insertions(+), 2 deletions(-)

[commit 639afa4b441909f6d8fab53080730f17c6c126cc]
Date: 2025-11-26
Score: 5
Status: proposed(include=no,score=40)
Sponsor: Netflix
Section: undecided
Subject: ipfilter: fix broken build
Review: The commit fixes a build break in ipfilter, which restores the ability to compile the system with LINT kernel configuration.
Body:

  Every commit earns me a dozen emails that LINT is broken. This should
  stop that.

  Fixes: eda1756d0454f ipfilter: Verify frentry on entry into kernel
  Sponsored by: Netflix
  (cherry picked from commit ddec4209b10d65ef19e1d1b884e1b876eab58c7d)


   sys/netpfil/ipfilter/netinet/fil.c    | 4 +---
   sys/netpfil/ipfilter/netinet/ip_nat.c | 3 ---
   2 files changed, 1 insertion(+), 6 deletions(-)

[commit a23b64b46cb1e9885073ef6086769584b69f56bf]
Date: 2025-12-15
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Kernel.general
Subject: ipfilter: Add missing kenv fetch
Review: The ipfilter kernel module now fetches the environment when loaded, ensuring proper initialization.
Body:

  When a module the environment must be explicitly fetched.

  Fixes:			d9788eabffa4
  PR:			291548
  Noted by:		markj
  Reviewed by:		markj
  Differential Revision:	https://reviews.freebsd.org/D54242
  MFC after:		3 days
  (cherry picked from commit a6ea80bc917510b5e056cc5a29b62dfd7b39d068)


   sys/netpfil/ipfilter/netinet/ip_fil_freebsd.c | 2 ++
   1 file changed, 2 insertions(+)

[commit a85c3ef7d80161da04241d275da804644cdc5347]
Date: 2025-11-15
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: ipfilter: Disable ipfs(8) by default
Review: The ipfs(8) utility is now disabled by default and its kernel support is optional, marking it as experimental. Users who rely on ipfs need to explicitly enable it in the kernel configuration.
Body:

  At the moment ipfs(8) is a tool that can be easily abused. Though the
  concept is sound the implementation needs some work.

  ipfs(8) should be considered experimental at the moment.

  This commit also makes ipfs support in the kernel optional.

  Reviewed by:		emaste, glebius
  MFC after:		1 week
  Differential revision:	https://reviews.freebsd.org/D53787

  (cherry picked from commit 0ff0c19e7f70bc4d3f98196a8ad43de635cf13e5)


   sbin/ipf/Makefile                        | 6 +++++-
   share/mk/src.opts.mk                     | 1 +
   sys/conf/NOTES                           | 1 +
   sys/conf/options                         | 1 +
   sys/modules/ipfilter/Makefile            | 6 ++++++
   sys/netpfil/ipfilter/netinet/ip_nat.c    | 5 ++++-
   sys/netpfil/ipfilter/netinet/ip_state.c  | 4 ++++
   tools/build/mk/OptionalObsoleteFiles.inc | 4 ++++
   8 files changed, 26 insertions(+), 2 deletions(-)

[commit 616571ca7727be103247d4443fcfc89f7f5ba915]
Date: 2025-10-29
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Network.general
Subject: ipfilter: Restrict ipfilter within a jail
Review: Adds a sysctl/tunable net.inet.ipf.jail_allowed to control whether a jail can manage its own ipfilter rules, pools, and settings. The default denies jail access, requiring the host system to manage jail rules or the sysctl to be enabled for jail control.
Body:

  Add a sysctl/tunable (net.inet.ipf.jail_allowed) to control whether a
  jail can manage its own ipfilter rules, pools, and settings. A jail's
  control over its own ipfilter rules and settings may not be desireable.
  The default is jail access to ipfilter is denied.

  The host system can stil manage a jail's rules by attaching the rules,
  using the on keyword, limiting the rule to the jail's interface. Or
  the sysctl/tunable can be enabled to allow a jail control over its own
  ipfilter rules and settings.

  Implementation note: Rather than store the jail_allowed variable,
  referenced by sysctl(9), in a global area, storing the variable in the
  ipfilter softc is consistent with ipfilter's use of its softc.

  Discussed with:		emaste, jrm
  MFC after:		1 week
  Differential revision:	https://reviews.freebsd.org/D53623

  (cherry picked from commit d9788eabffa4b67fc534685fc3d9b8e3334af196)


   sbin/ipf/libipf/interror.c                    |  1 +
   sys/netpfil/ipfilter/netinet/fil.c            |  1 +
   sys/netpfil/ipfilter/netinet/ip_fil.h         |  1 +
   sys/netpfil/ipfilter/netinet/ip_fil_freebsd.c | 15 +++++++++++++++
   sys/netpfil/ipfilter/netinet/mlfk_ipl.c       |  1 +
   5 files changed, 19 insertions(+)

[commit af32b767e10310d06706724fc6ea9ae3a711be47]
Date: 2025-11-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ipfilter: Restore used variable
Review: The commit fixes a build warning by restoring a variable that was incorrectly marked as unused, but it does not introduce any user-visible changes in functionality, behavior, or configuration.
Body:

  One of the "unused" i variables is actually used.

  Fixes:		20c48f090b27
  (cherry picked from commit 78c6cfdc3dc0b84aa2daf0f32c7c9cdf3b34fee5)


   sys/netpfil/ipfilter/netinet/fil.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit dfab913f72a9257f146c64f5cacc3474690cfc2e]
Date: 2025-11-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ipfilter: Remove unused variable
Review: Removing an unused variable has no user-visible impact.
Body:

  Reported by:	jlduran
  Fixes:		eda1756d0454, 821774dfbdaa
  MFC after:	1 week
  X-MFC with:	eda1756d0454, 821774dfbdaa
  (cherry picked from commit 20c48f090b270d0124d5f0b31c6f3a639efbbc80)


   sys/netpfil/ipfilter/netinet/fil.c    | 2 +-
   sys/netpfil/ipfilter/netinet/ip_nat.c | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit b94fbf89ef715a1caaba27311e165a43b0a49f67]
Date: 2025-11-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: ipfilter: Verify ipnat on entry into kernel
Review: The ipnat(8) utility now validates the length of variable-length strings in ipnat structures before kernel processing, preventing potential kernel panics due to malformed configuration data.
Body:

  The ipnat struct is built by ipnat(8), specifically ipnat_y.y when
  parsing the ipnat configuration file (typically ipnat.conf). ipnat
  contains a variable length string field at the end of the struct. This
  data field, called in_names, may contain various text strings such as
  NIC names. There is no upper bound limit to the length of strings as
  long as the in_namelen length field specifies the length of in_names
  within the ipnat structure and in_size specifies the size of the ipnat
  structure itself.

  Reported by:		Ilja Van Sprundel <ivansprundel@ioactive.com>
  Reviewed by:		markj
  MFC after:		1 week
  Differential revision:	https://reviews.freebsd.org/D53843

  (cherry picked from commit 821774dfbdaa12ef072ff7eaea8f9966a7e63935)


   sbin/ipf/libipf/interror.c            |  6 +++++
   sys/netpfil/ipfilter/netinet/ip_nat.c | 42 ++++++++++++++++++++++++++++++++++-
   2 files changed, 47 insertions(+), 1 deletion(-)

[commit 53978114bcf89f5f1fc8a2722c42e3347c24bb6b]
Date: 2025-10-29
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Network.general
Subject: ipfilter: Verify frentry on entry into kernel
Review: The ipfilter kernel module now validates the length of variable-length string fields in frentry structures, preventing potential buffer overflows when processing rules from ipf.conf.
Body:

  The frentry struct is built by ipf(8), specifically ipf_y.y when parsing
  the ipfilter configuration file (typically ipf.conf). frentry contains
  a variable length string field at the end of the struct. This data field,
  called fr_names, may contain various text strings such as NIC names,
  destination list (dstlist) names, and filter rule comments.  The length
  field specifies the length of fr_names within the frentry structure and
  fr_size specifies the size of the frentry structure itself.

  The upper bound limit to the length of strings field is controlled by the
  fr_max_namelen sysctl/kenv or the max_namelen ipfilter tuneable.

  The initial concepts were discussed with emaste and jrm.

  Reported by:		Ilja Van Sprundel <ivansprundel@ioactive.com>
  Reviewed by:		markj
  MFC after:		1 week
  Differential revision:	https://reviews.freebsd.org/D53843

  (cherry picked from commit eda1756d0454f9383940dc825cf571ff67e0c013)


   sbin/ipf/libipf/interror.c              |  5 +++
   sys/netpfil/ipfilter/netinet/fil.c      | 61 +++++++++++++++++++++++++++++++--
   sys/netpfil/ipfilter/netinet/ip_fil.h   |  1 +
   sys/netpfil/ipfilter/netinet/mlfk_ipl.c |  1 +
   4 files changed, 66 insertions(+), 2 deletions(-)

[commit 9ac25e9b5b31fb03f090e157166b05d2d501a8f0]
Date: 2025-11-18
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: ipfilter: Add ipf_check_names_string()
Review: Adds input validation for IPFilter rule names, preventing malformed names from causing issues in firewall configuration.
Body:

  ipf_check_names_string will verify userland inputs in names strings
  (fr.fr_names, in.in_names) for correctness.

  Original concept of ipf_check_names_string() instead of macros by
  markj.

  Reviewed by:		markj
  MFC after:		1 week
  Differential revision:	https://reviews.freebsd.org/D53843

  (cherry picked from commit 525c535d5aa87f686dcfee620619827f7c6090db)


   sys/netpfil/ipfilter/netinet/fil.c    | 31 +++++++++++++++++++++++++++++++
   sys/netpfil/ipfilter/netinet/ip_fil.h |  1 +
   2 files changed, 32 insertions(+)

[commit b2f4c3b36c2c60ba77ad1536cbe1c115bfcf3af1]
Date: 2025-10-27
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ipfs: Fix typo in error message
Review: Fixes a typo in an error message of the ipfs utility.
Body:

  MFC after:	3 days

  (cherry picked from commit 5ae7b106cfd4801ef5e0f69b02ad9b3ae3ccfbec)


   sbin/ipf/ipfs/ipfs.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit f1081a8c5741cb68860dba6cb10eb3448e4c1d21]
Date: 2025-12-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vt: Remove .fnt.uu from Makefile SUFFIXES
Review: The commit removes a stale .fnt.uu suffix from a Makefile, which has no user-visible impact as the uudecode rule was already removed.
Body:

  The uudecode make rule was removed years ago.

  Fixes: 68510f3bac15 ("Remove uudecode make rule for vt fonts")
  (cherry picked from commit c910c7a3d224764adf53581cc097cefb6f963502)
  (cherry picked from commit ad4cfaafb83343dc77a77cfe8768fe4e02a1a304)


   share/vt/fonts/Makefile | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 408cd2fff86176513c69e880d7515af11f980cb7]
Date: 2025-11-28
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: linux: Add required symbol to EXPORT_SYMS list
Review: The commit adds a required symbol to the EXPORT_SYMS list for the Linux compatibility modules, ensuring that certain Linux kernel symbols are available for use by Linux binary compatibility.
Body:

  PR:		291270
  (cherry picked from commit 3e2093de47251de5e6e61c08d2955251137afd01)
  (cherry picked from commit 4c318cb3320d9aedd17a2e3c07ff5c69225a29eb)


   sys/modules/linux/Makefile        | 1 +
   sys/modules/linux_common/Makefile | 1 +
   2 files changed, 2 insertions(+)

[commit 94f54c6930657578512cecf8713b0c65f2dc4138]
Date: 2025-11-20
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: mgb.4, muge.4: Use standard HARDWARE introduction
Review: Updates the man:mgb.4 and man:muge.4 manual pages to use standard HARDWARE introduction wording, clarifying that the pages describe controller ICs, not end-user adapters.
Body:

  Release notes are generated using this text.

  I used "interfaces" not "adapters" in these pages as the listed devices
  are the controller ICs, not end-user projects.

  Reviewed by:	ziaee
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53846

  (cherry picked from commit a4aa7df767e0df49ca3294d2b578be25812364d8)
  (cherry picked from commit 11c5b906fcac36e1b8749e9ef2f65ed8ad9812f9)


   share/man/man4/mgb.4  | 2 +-
   share/man/man4/muge.4 | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit 012736a2a882eb20797083361df519cf10438f42]
Date: 2025-10-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: Cirrus-CI: Switch back to tzst packages, but use level 1
Review: The commit changes CI configuration to use zstd compression level 1 for packages, reducing build time while maintaining smaller package sizes compared to uncompressed tarballs.
Body:

  We previously used `PKG_FORMAT: tar` to avoid spending a lot of time in
  zstd compression.  Instead just set PKG_LEVEL to compression level 1,
  which still produces packages that are much smaller than uncompressed
  tarballs with only a small penalty in build time.

  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D52858

  (cherry picked from commit ae5914c0e4478fd35ef9db3f32665b60e04d5a6f)
  (cherry picked from commit ba89a061d0bae42c4367bc5408b8c51fd63a2715)


   .cirrus.yml | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit be9dcb2d15252f4a3e91ecf3049e703841adf2d7]
Date: 2025-10-02
Score: 5
Status: proposed(include=no,score=25)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: Cirrus-CI: Build packages in parallel
Review: The commit changes the Cirrus-CI configuration to build packages in parallel, which may reduce CI build times for developers and contributors.
Body:

  Reviewed by:	ivy
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D52857

  (cherry picked from commit e2796f0359afad522113c25d720fa30677a044ab)
  (cherry picked from commit 2ef79b0524b516792f1ebb1c623999ef2ec06408)


   .cirrus.yml | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 76df3f6f3680556c777e2e13565c9e217c12d5b1]
Date: 2025-12-18
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: ConnectWise
Section: Userland.programs
Subject: gpart: add libxo support for "show" subcommand + man page updates
Review: The man:gpart[8] utility now supports libxo output for the "show" subcommand, enabling machine-readable formatting. The man pages for geom and gpart are updated to document libxo support.
Body:

  Added libxo support to `gpart show`, also updated the man
  pages for geom and gpart to show where you can expect
  libxo formatted output.

  PR:                     290629
  Sponsored by:           ConnectWise
  Reviewed by:            asomers, mckusick, phil
  Approved by:            asomers (mentor)
  Differential Revision:  https://reviews.freebsd.org/D53950

  (cherry picked from commit 4f809ffec69cd6ede3e7be9a5bc876b2e5931028)

  geom_part: Fix format string issues

  This fixes a segfault on i386 and armv7 and numerous style violations.

  PR:		292008
  Fixes:		4f809ffec69c ("gpart: add libxo support for "show" subcommand + man page updates")
  Reviewed by:	js
  Differential Revision:	https://reviews.freebsd.org/D54393

  (cherry picked from commit faff7013187b03f4240af6f52f608e7ebafe19f3)


   lib/geom/part/Makefile    |   2 +-
   lib/geom/part/geom_part.c | 107 +++++++++++++++++++++++++++++++---------------
   lib/geom/part/gpart.8     |  11 ++++-
   sbin/geom/core/geom.8     |  12 +++++-
   4 files changed, 95 insertions(+), 37 deletions(-)

[commit a5c6c95631195181bd3707d96ab79184235df6a6]
Date: 2025-12-19
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.libraries
Subject: libc/amd64: fix stpncpy.S again
Review: The stpncpy(3) implementation for amd64 is corrected to avoid a regression on older CPUs lacking the BMI1 instruction set, ensuring proper behavior across all supported hardware.
Body:

  The previous fix introduced a regression on machines without the BMI1
  instruction set extension.  The TZCNT instruction used in this function
  behaves different on old machines when the source operand is zero, but
  the code was originally designed to never trigger this case.  The bug
  fix caused this case to be possible, leading to a regression on
  sufficiently old hardware.

  Fix the code by messing with things such that the source operand is
  never zero.

  PR:		291720
  Fixes:		66eb78377bf109af1d9e25626bf254b4369436ec
  Tested by:	cy
  Approved by:	markj (mentor)
  Differential Revision:	https://reviews.freebsd.org/D54303

  (cherry picked from commit 2f83319214d9adb8ab7a77e35d1014658b3f9cae)


   lib/libc/amd64/string/stpncpy.S | 9 +++------
   1 file changed, 3 insertions(+), 6 deletions(-)

[commit 793877e7667ce667cdf3539de68af78fb511c06f]
Date: 2025-12-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: libc/amd64: Disable baseline version of stpncpy()
Review: The baseline version of stpncpy on amd64 is disabled due to a bug on some CPUs, reverting to a previous implementation.
Body:

  This implementation appears to be broken on some CPUs.  Disable it
  until the issue can be investigated and fixed.

  PR:		291720
  Fixes:		66eb78377bf1 ("libc/amd64: fix overread conditions in stpncpy()")
  Fixes:		90253d49db09 ("lib/libc/amd64/string: add stpncpy scalar, baseline implementation")
  (cherry picked from commit ce9557d4ee174267504a63b2c8f6009be27368c9)


   lib/libc/amd64/string/stpncpy.S | 2 ++
   1 file changed, 2 insertions(+)

[commit b0dc25c6d378fbab41f86e494d4e7fcbadeb1b74]
Date: 2025-12-10
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: libc/amd64: fix overread conditions in stpncpy()
Review: The amd64 implementation of man:stpncpy[3] no longer reads beyond the end of a buffer when the buffer ends at a page boundary, preventing a potential program crash.
Body:

  Due to incorrect unit test design, two overread conditions went
  undetected in the amd64 baseline stpncpy() implementation.
  For buffers of 1--16 and 32 bytes that do not contain nul bytes
  and end exactly at a page boundary, the code would incorrectly
  read 16 bytes from the next page, possibly crossing into an
  unmapped page and crashing the program.  If the next page was
  mapped, the code would then proceed with the expected behaviour
  of the stpncpy() function.

  Three changes were made to fix the bug:

   - an off-by-one error is fixed in the code deciding whether to
     enter the runt case or not, entering it for 0<n<=32 bytes
     instead of 0<n<32 bytes as it was before.
   - in the runt case, the logic to skip reading a second 16-byte
     chunk if the buffer ends in the first chunk was fixed to
     account for buffers that end at a 16-byte boundary but do not
     hold a nul byte.
   - in the runt case, the logic to transform the location of the
     end of the input buffer into a bit mask was fixed to allow
     the case of n==32, which was previously impossible due to the
     incorrect logic for entering said case.

  The performance impact should be minimal.

  PR:		291359
  See also:	D54169
  Reported by:	Collin Funk <collin.funk1@gmail.com>
  Reviewed by:	getz
  Approved by:	markj (mentor)
  MFC after:	1 week
  Fixes:		90253d49db09a9b1490c448d05314f3e4bbfa468 (D42519)
  Differential Revision:	https://reviews.freebsd.org/D54170

  (cherry picked from commit 66eb78377bf109af1d9e25626bf254b4369436ec)


   lib/libc/amd64/string/stpncpy.S | 7 ++++---
   1 file changed, 4 insertions(+), 3 deletions(-)

[commit e2f095779323204e90843b405863c81dc02423d2]
Date: 2025-12-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libc/tests/string: improve stpncpy() "bounds" unit test
Review: The commit only updates a unit test for libc's stpncpy function, which does not affect user-visible behavior, system functionality, or configuration.
Body:

  The test is extended the same way I previously extended the memccpy()
  test to fix what is probably the same kind of bug.

  PR:		291359
  Reported by:	Collin Funk <collin.funk1@gmail.com>
  Reviewed by:	ngie
  Approved by:	markj (mentor)
  Fixes:		6fa9e7d8737548ef93c573387ce62402c368d486 (D42519)
  See also:	61ed5748e4e9c7397fcb2638b442f46ac5c9e7c5 (D46051)
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54169

  lib/libc/tests/string/stpncpy_test.c: apply ngie's fixes

  (cherry picked from commit 123c086200491819595abc271d360e605288fd18)
  (cherry picked from commit 8be8642826099368208efb2c1222f2a102cc5b08)


   lib/libc/tests/string/stpncpy_test.c | 55 +++++++++++++++++++++++++-----------
   1 file changed, 39 insertions(+), 16 deletions(-)

[commit b35e955333efdd97a3a369740d2b2038fb86826c]
Date: 2025-12-05
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: bhyvectl: improve options error handling
Review: The man:bhyvectl[8] utility now detects and reports errors for mutually exclusive command-line options early, providing clearer error messages instead of obscure connection failures.
Body:

  Currently, it is possible to execute bhyvectl(8) with mutually exclusive
  options, such as "--destroy" and "--suspend", and it will print out
  obscure errors, e.g.:

   bhyvectl --suspend=/var/run/vms/my_vm --destroy --vm my_vm
   connect() failed: Connection refused

  Address that by failing early if mutually exclusive options were
  specified.

  Additionally, move the BHYVE_SNAPSHOT block before the errors are
  printed, so its errors are also displayed.

  Approved by:		markj
  Sponsored by:		The FreeBSD Foundation
  MFC after:		2 weeks
  Differential Revision:	https://reviews.freebsd.org/D54092

  (cherry picked from commit 148111d3775eb159d71a36e3a8b4c5c1bf53392c)


   usr.sbin/bhyvectl/bhyvectl.c | 24 ++++++++++++++++++------
   1 file changed, 18 insertions(+), 6 deletions(-)

[commit 3f649d1edfbea6caccd3270fe0071875adb9651a]
Date: 2025-12-05
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Hardware.virtualization
Subject: bhyve: change suspend exit code
Review: The bhyve(8) hypervisor now exits with code 5 when a VM is suspended, distinguishing it from a reboot exit code of 0.
Body:

  Currently, after suspending, bhyve(8) exits with 0. This code is
  also used to indicate that a VM was rebooted. To differentiate
  reboot and suspend, use the next available exit code, 5, for suspend.

  Approved by:		markj
  Sponsored by:		The FreeBSD Foundation
  MFC after:		2 weeks
  Differential Revision:	https://reviews.freebsd.org/D54087

  (cherry picked from commit 611bbb190ff593e0e424e311575d7e978e623659)


   usr.sbin/bhyve/bhyve.8    | 4 +++-
   usr.sbin/bhyve/snapshot.c | 2 +-
   2 files changed, 4 insertions(+), 2 deletions(-)

[commit 21961607e631a9c00a6a8aa1a20d3b2034f834ae]
Date: 2025-09-15
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sys/xen: Use __printflike() instead of format(printf)
Review: The commit replaces format(printf) with __printflike() in Xen-related headers to resolve a compiler warning. This is an internal change with no user-visible impact.
Body:

  The __printflike macro sets the format to freebsd_kprintf which recent
  clang understands and warns about. Fixes the following error:
  `passing 'printf' format string where 'freebsd_kprintf' format string is expected [-Werror,-Wformat]`

  MFC after:	1 week

  (cherry picked from commit 4cd7be3e81863bd22aacccc34fc2e8b2cfcb14d9)


   sys/dev/xen/blkback/blkback.c  | 2 +-
   sys/xen/xen_intr.h             | 2 +-
   sys/xen/xenbus/xenbusvar.h     | 8 ++++----
   sys/xen/xenstore/xenstorevar.h | 2 +-
   4 files changed, 7 insertions(+), 7 deletions(-)

[commit 108270f4c03d4d39815c587627e650e558e22d2e]
Date: 2025-09-15
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ocs_fc: Use __printflike() instead of format(printf)
Review: The commit changes internal macro usage to fix a compiler warning without any user-visible impact.
Body:

  The __printflike macro sets the format to freebsd_kprintf which recent
  clang understands and warns about. Fixes the following error:
  `passing 'printf' format string where 'freebsd_kprintf' format string is expected [-Werror,-Wformat]`

  MFC after:	1 week

  (cherry picked from commit 3c0ea1b629764c49611e3e3adfa0c44f9afa3558)


   sys/dev/ocs_fc/ocs_ddump.h |  3 +--
   sys/dev/ocs_fc/ocs_mgmt.h  |  3 +--
   sys/dev/ocs_fc/ocs_os.h    |  2 +-
   sys/dev/ocs_fc/ocs_utils.h | 12 ++++--------
   4 files changed, 7 insertions(+), 13 deletions(-)

[commit 752d056fce33052d482eeb24756497fc44dac579]
Date: 2025-12-30
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: crypto: avoid warnings about too-long initializer strings
Review: This commit suppresses compiler warnings by marking internal arrays as non-string, which has no user-visible impact.
Body:

  Mark `sigma` and `tau` as `__non_string`, to avoid warnings from clang
  21 similar to:

      sys/crypto/chacha20/chacha.c:53:31: error: initializer-string for character array is too long, array size is 16 but initializer has size 17 (including the null terminating character); did you mean to use the 'nonstring' attribute? [-Werror,-Wunterminated-string-initialization]
         53 | static const char sigma[16] = "expand 32-byte k";
            |                               ^~~~~~~~~~~~~~~~~~
      sys/crypto/chacha20/chacha.c:54:29: error: initializer-string for character array is too long, array size is 16 but initializer has size 17 (including the null terminating character); did you mean to use the 'nonstring' attribute? [-Werror,-Wunterminated-string-initialization]
         54 | static const char tau[16] = "expand 16-byte k";
            |                             ^~~~~~~~~~~~~~~~~~

  MFC after:	3 days
  Reviewed by:	markj
  Differential Revision: https://reviews.freebsd.org/D54364

  (cherry picked from commit 710ec409dffed3306ced253bba85dbdc7758510b)


   sys/crypto/chacha20/chacha.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 0c5ac3e46e789133a90e874b3e54e4fa9a2e665b]
Date: 2025-12-28
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Hardware.virtualization
Subject: compat: linux: use appropriate variables for copying out old timers
Review: The commit fixes a bug in the Linux compatibility layer where incorrect variables were used for copying out timer values, preventing stack garbage from being returned to userland. This resolves a potential issue for applications using Linux timer syscalls under Linuxulator.
Body:

  We copyout &l_oval but do the conversions into &l_val, leaving us with
  stack garbage.	A build with an LLVM21 cross-toolchain seems to catch
  this.

  Reported by:	Florian Limberger <flo purplekraken com>
  Reviewed by:	markj
  Fixes:		a1fd2911ddb06 ("linux(4): Implement timer_settime64 syscall.")
  MFC after:	3 days
  Differential Revision: https://reviews.freebsd.org/D52985

  (cherry picked from commit 541a98d7e28a8e4697ac2fa78dd4c4203c2c3a9c)


   sys/compat/linux/linux_timer.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit c645b2f41833063795f470e393c2b0f0961b1134]
Date: 2025-12-25
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: bsd.sys.mk: suppress some new clang 21 warnings for C++
Review: The build system now suppresses new clang 21 warnings for C++ system headers, preventing -Werror build failures with libc++ headers.
Body:

  Otherwise, these lead to many -Werror warnings in libc++ headers, due to
  our use of -Wsystem-headers, which is not officially supported upstream:

  Suppress -Wc++20-extensions, due to:

      /usr/include/c++/v1/__algorithm/simd_utils.h:96:50: error: explicit template parameter list for lambdas is a C++20 extension [-Werror,-Wc++20-extensions]
         96 | inline constexpr size_t __simd_vector_size_v = []<bool _False = false>() -> size_t {
            |                                                  ^

  Suppress -Wc++23-lambda-attributes, due to:

      /usr/include/c++/v1/__format/format_functions.h:462:32: error: an attribute specifier sequence in this position is a C++23 extension [-Werror,-Wc++23-lambda-attributes]
        462 |   if (bool __is_identity = [&] [[__gnu__::__pure__]] // Make sure the compiler knows this call can be eliminated
            |                                ^

  Suppress -Wnullability-completeness, due to:

      /usr/include/c++/v1/string:1068:80: error: pointer is missing a nullability type specifier (_Nonnull, _Nullable, or _Null_unspecified) [-Werror,-Wnullability-completeness]
       1068 |   _LIBCPP_HIDE_FROM_ABI _LIBCPP_CONSTEXPR_SINCE_CXX20 basic_string(const _CharT* __s, size_type __n) {
            |                                                                                ^

  MFC after:	3 days

  (cherry picked from commit 63d1c3c43690ff3c3e76e1fb03c8640fe30a2663)


   share/mk/bsd.sys.mk | 5 +++++
   1 file changed, 5 insertions(+)

[commit 3cd0026966d0174c7143ac1d8233ed81ffa68ddf]
Date: 2025-12-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sh: avoid warnings about too-long initializer strings
Review: The commit suppresses compiler warnings by marking arrays as non-string; this is an internal build fix with no user-visible impact.
Body:

  Mark `optletter` and `t_op::op_text` as `__non_string`, to avoid
  warnings from clang 21 similar to:

      bin/sh/options.h:77:36: error: initializer-string for character array is too long, array size is 19 but initializer has size 20 (including the null terminating character); did you mean to use the 'nonstring' attribute? [-Werror,-Wunterminated-string-initialization]
         77 | const char optletter[NSHORTOPTS] = "efIimnsxvVECabupTPh";
            |                                    ^~~~~~~~~~~~~~~~~~~~~
      bin/test/test.c:153:3: error: initializer-string for character array is too long, array size is 2 but initializer has size 3 (including the null terminating character); did you mean to use the 'nonstring' attribute? [-Werror,-Wunterminated-string-initialization]
        153 |         {"==",  STREQ},
            |          ^~~~

  MFC after:	3 days
  Reviewed by:	jilles
  Differential Revision: https://reviews.freebsd.org/D54362

  (cherry picked from commit e6546807f4c1a8a6a6fa53fceab7b8c80e3ed802)


   bin/sh/options.h | 2 +-
   bin/test/test.c  | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit 41626383b651d4229197c2f439d5ff940da025c3]
Date: 2025-12-24
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: OptionalObsoleteFiles.inc: fix up WITH_LLVM_LINK_STATIC_LIBRARIES cases
Review: Fixes cleanup of old shared libraries when WITH_LLVM_LINK_STATIC_LIBRARIES is set in src.conf(5).
Body:

  In commit cf1eaaf41cef I added the WITH_LLVM_LINK_STATIC_LIBRARIES
  src.conf(5) build knob, which also affects OptionalObsoleteFiles.inc.

  However, the checks were incorrect: when WITH_LLVM_LINK_STATIC_LIBRARIES
  is active, the OLD_LIBS libprivatellvm.so.19, libprivateclang.so.19 and
  libprivatelldb.so.19 should always be cleaned up.

  Fixes:		cf1eaaf41cef
  MFC after:	1 week

  (cherry picked from commit 160077a4d75186a979f28f0778259c66d8cac8be)


   tools/build/mk/OptionalObsoleteFiles.inc | 12 ++++++------
   1 file changed, 6 insertions(+), 6 deletions(-)

[commit 908ca4f6af8a95d6c6ae65caed4371f96afb6409]
Date: 2025-06-18
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.config
Subject: src.conf: Add WITH_LLVM_LINK_STATIC_LIBRARIES build knob
Review: Adds a WITH_LLVM_LINK_STATIC_LIBRARIES build knob to src.conf(5) that allows linking LLVM tools statically against libllvm, libclang, and liblldb for improved performance at the cost of larger binary sizes.
Body:

  In commit 2e47f35be5dc libllvm, libclang and liblldb were converted into
  private shared libraries. This allowed clang, lld, lldb, and other llvm
  tools to be linked against these shared libraries, which makes them
  smaller and avoids duplication.

  However, this also comes at the cost of some performance, since the
  dynamic libraries are quite large, and contain lots of long symbols
  (mangled C++ identifiers).

  Add a WITH_LLVM_LINK_STATIC_LIBRARIES build knob that can be used to go
  back to the previous behavior: libllvm, libclang and liblldb are built
  as internal static libraries, i.e. only available during buildworld, and
  fully linked into the various executables such as clang, lld, etc.

  PR:		287447
  Reviewed by:	emaste
  MFC after:	1 week
  Differential Revision: https://reviews.freebsd.org/D50956

  (cherry picked from commit 8d5a11cd0137d3ad70f6b06e063ea91a776d510a)


   lib/clang/libclang/Makefile                         |  9 ++++-----
   lib/clang/liblldb/Makefile                          | 14 ++++++++++++--
   lib/clang/libllvm/Makefile                          | 10 ++++------
   share/man/man5/src.conf.5                           |  9 ++++++++-
   share/mk/src.opts.mk                                |  1 +
   tools/build/mk/OptionalObsoleteFiles.inc            | 11 ++++++++---
   tools/build/options/WITH_LLVM_LINK_STATIC_LIBRARIES |  6 ++++++
   usr.bin/clang/Makefile.inc                          |  2 +-
   usr.bin/clang/clang.prog.mk                         |  2 +-
   usr.bin/clang/lld/Makefile                          |  2 +-
   usr.bin/clang/lldb-server/Makefile                  |  5 +++++
   usr.bin/clang/lldb/Makefile                         |  5 +++++
   usr.bin/clang/llvm.prog.mk                          |  5 +++++
   13 files changed, 61 insertions(+), 20 deletions(-)

[commit 186ac4724746b50acfa43e148ca99991aa1dbe9e]
Date: 2025-12-29
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: MFC: ipfw.8: document how to delete nat configuration instance
Review: The man:ipfw[8] manual page now documents how to delete a NAT configuration instance.
Body:

  (cherry picked from commit e51047118cb1d15abe8077a5b47b8063fa364ad9)


   sbin/ipfw/ipfw.8 | 16 +++++++++++++++-
   1 file changed, 15 insertions(+), 1 deletion(-)

[commit a3559f398824e3e7b7d102f4483610881119ff47]
Date: 2025-12-29
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: ipfw.8: fix documentation bug for setmark
Review: The man:ipfw[8] manual page is corrected to reflect that the setmark keyword does not currently implement a sticky mark, clarifying the actual behavior for users.
Body:

  A mark set with "setmark" keyword is intended to be "sticky"
  and documented as such but in fact it is not yet,
  as current implementation lacks "sticky" feature
  and its implementation will be not MFC'd, most probably.

  Correct the manual page until the implementation improved.

  Discussed with:	Boris Lytochkin <lytboris@gmail.com> (author)

  (cherry picked from commit a7b8a5d37bcb0009297962137bfb6c6570e5af12)
  (cherry picked from commit 9fdf49e8a501047b61a615ab1b4b133159ad76e1)


   sbin/ipfw/ipfw.8 | 8 ++++++--
   1 file changed, 6 insertions(+), 2 deletions(-)

[commit 74c8530c214cbc6eb01af00f12aa1d204c65ab26]
Date: 2025-12-23
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: camcontrol.8: Descriptions before examples
Review: The man:camcontrol[8] manual page is reorganized to place descriptions before examples, improving readability when navigating the documentation.
Body:

  This page has a lot of examples, so having them in the previous order
  can be confusing. Rewrite to the normal order where the descriptions
  come before the command, followed by a colon, which is still clear even
  jumping to the middle of the section.

  PR:			291759
  MFC after:		3 days
  Reviewed by:		imp
  Differential Revision:	https://reviews.freebsd.org/D54285

  (cherry picked from commit fbc321b9cdceecd3c97742868da5d500423cf484)


   sbin/camcontrol/camcontrol.8 | 349 ++++++++++++++++++-------------------------
   1 file changed, 148 insertions(+), 201 deletions(-)

[commit 063714951ad0e8407f39095f36de6be62a5fe07b]
Date: 2025-12-29
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Userland.contrib
Subject: kyua manuals: Correct --results-file short form
Review: Corrects the short form of the --results-file option in kyua man pages from -r to -R.
Body:

  PR:		290647
  Ref:		kyua/cli/common.cpp#104
  MFC after:	3 days
  Reviewed by:	ziaee
  Closes:		https://github.com/freebsd/kyua/issues/267

  (cherry picked from commit bbaa7d628175ee484e31a054fb3cf7b7866cad13)


   contrib/kyua/doc/kyua-db-exec.1.in      | 2 +-
   contrib/kyua/doc/kyua-db-migrate.1.in   | 2 +-
   contrib/kyua/doc/kyua-report-html.1.in  | 2 +-
   contrib/kyua/doc/kyua-report-junit.1.in | 2 +-
   contrib/kyua/doc/kyua-report.1.in       | 2 +-
   contrib/kyua/doc/kyua-test.1.in         | 2 +-
   6 files changed, 6 insertions(+), 6 deletions(-)

[commit 7fa86256aaca948671c38f462e9ef4692799d8fc]
Date: 2025-12-29
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: ioctl.2: Mention EACCES
Review: The man:ioctl[2] manual page now documents that ioctl operations can fail with EACCES.
Body:

  ioctls can fail with EACCES, see sys/kern/tty.c

  PR:			239504
  MFC after:		3 days
  Reviewed by:		ziaee
  Reported by:		Brennan Vincent <brennan@umanwizard.com>
  Differential Revision:	https://reviews.freebsd.org/D49072

  (cherry picked from commit e2afbc45258f2fa4bdcf126e959ac660e76fc802)


   lib/libc/sys/ioctl.2 | 5 ++++-
   1 file changed, 4 insertions(+), 1 deletion(-)

[commit 47db87fe8398d975e6bd8634eb8104ad0c001743]
Date: 2025-12-27
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: vt.4: Remove Xr to nonexistent vidcontrol(8)
Review: Removes an incorrect cross-reference to the nonexistent vidcontrol(8) manual page from the vt.4 documentation.
Body:

  PR: 291985
  Fixes: a8740ba860bf ("vt.4: Document increasing scrollback size")
  (cherry picked from commit f22cffe43343d9d48c731952d94976c5deb9659e)


   share/man/man4/vt.4 | 1 -
   1 file changed, 1 deletion(-)

[commit ce92b9d8332a436ec03d3457dffe247865ffc9c2]
Date: 2025-11-21
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: vt.4: Document increasing scrollback size
Review: The man:vt[4] man page now documents how to increase the scrollback buffer size for the virtual terminal driver.
Body:

  MFC:			immediately as 2 llms say this is impossible
  Reviewed by:		adrian, emaste
  Differential Revision:	https://reviews.freebsd.org/D53860

  (cherry picked from commit a8740ba860bfc35879f886b80b30327d0d3b16bd)


   share/man/man4/vt.4 | 9 ++++++++-
   1 file changed, 8 insertions(+), 1 deletion(-)

[commit 1b23b79beef230009f4df5c15f1571a134521810]
Date: 2025-08-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vt.4: Style pass
Review: The commit is a style pass on the vt.4 man page with no user-visible changes.
Body:

  Outstanding: I'm not sure kernel configuration declarations are defined
  variables. Dv does not allow arguments, but some why allowed paths, so
  non-path arguments were being incorrectly marked up as paths.

  MFC after:		3 days (with resolved conflicts)
  Reviewed by:		0mp, emaste
  Differential Revision:	https://reviews.freebsd.org/D49565

  (cherry picked from commit 7cd6da268a8fbf34b16564dd9a94c86853eb7c56)


   share/man/man4/vt.4 | 48 ++++++++++++++++++++++++------------------------
   1 file changed, 24 insertions(+), 24 deletions(-)

[commit c330c43e58d74726a9014d3cc380bd59bbcef256]
Date: 2024-01-15
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: vt.4: explain console fonts
Review: The man:vt[4] manual page now includes a section explaining console fonts, covering conversion, support, and usage.
Body:

  Add explaination about console fonts, how to convert them, which subset
  of things support them and how to use them.

  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1063

  (cherry picked from commit 7bd6cbbf69c7a9b952ebed096625a4a4a6b7bbfd)


   share/man/man4/vt.4 | 15 +++++++++++++++
   1 file changed, 15 insertions(+)

[commit 1839dd31cab9a02acc2a1065bb0a63488a69ba0b]
Date: 2025-12-29
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: linprocfs.5: Synchronize style and format with 15-STABLE
Review: The commit updates the man:linprocfs[5] manual page to synchronize style and format with the 15-STABLE branch, improving consistency and readability.
Body:

  This is a logical backport of 1d193b1808098328d3ad16b436a329b258935e0c
  including the changes happended after that.

  Reviewed by:	fernape
  Differential Revision:	https://reviews.freebsd.org/D54408


   share/man/man5/linprocfs.5 | 89 +++++++++++++++++++++++++++++++++++++++++-----
   1 file changed, 81 insertions(+), 8 deletions(-)

[commit ab5ec8ccbcf0f1b470690742e2049bb4534b4eae]
Date: 2025-12-24
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: nfsd.8: Add a short paragraph w.r.t. NFSv3 vs NFSv4 setup
Review: The man:rpc.nfsd[8] manual page now includes a paragraph explaining that NFSv3, NFSv4, or both can be configured.
Body:

  The nfsd can be configured to support NFSv3, NFSv4 or both
  of them.

  This patch adds a short paragraph to nfsd.8 to explain this.

  This is a content change.

  (cherry picked from commit 4f184fd35d81bbd85284d47d2a65aeece67e87d4)


   usr.sbin/nfsd/nfsd.8 | 62 ++++++++++++++++++++++++++++++++++++++++++++++++++--
   1 file changed, 60 insertions(+), 2 deletions(-)

[commit c4290c35857d46a880ae3873fef58aa98a20c087]
Date: 2024-02-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sys/cdefs.h: add __noexcept and __noexcept_if
Review: The commit adds internal macros for C++11 noexcept support without any direct user-visible impact.
Body:

  These macros provide the C++11 noexcept and noexcept(...) keywords if
  we're compiling in a C++11 environment.  Otherwise, they expand to an
  empty string.

  This will be used to add the required noexcept specifier to several libc
  functions as required in C++11.

  MFC after:	2 weeks

  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1085

  (cherry picked from commit 02b0d4b688cc4deb14cb6e7534a2a4958e48b753)


   sys/sys/cdefs.h | 11 +++++++++++
   1 file changed, 11 insertions(+)

[commit 108f057e50cafdbec62785a2c4a53fde6142b99f]
Date: 2025-12-26
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: bhyve: Document that MAC address has to be unicast
Review: The man:bhyve[8] and man:bhyve_config[5] man pages now clarify that bhyve requires MAC addresses to be unicast.
Body:

  bhyve accepts any MAC address even foreign as long it is a unicast one.

  Reviewed by:	ziaee
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D54372

  (cherry picked from commit e1bfd541c7cdee1e184cacb2ea3bbebb3a500dfb)


   usr.sbin/bhyve/bhyve.8        |  3 ++-
   usr.sbin/bhyve/bhyve_config.5 | 12 ++++++++----
   2 files changed, 10 insertions(+), 5 deletions(-)

[commit c847ea5418e23d4f103882ad35c710af59061cfa]
Date: 2025-12-26
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: bhyve_config.5: Fix consistency and terms in manpage
Review: Fixes consistency and spelling in the man:bhyve_config[5] man page.
Body:

  Correct inconsistent spelling of terms and duplication.

  Reviewed by:	ziaee
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D54370

  (cherry picked from commit 66604463e737f4754ae6268171031ceefc226837)


   usr.sbin/bhyve/bhyve_config.5 | 17 +++++++++--------
   1 file changed, 9 insertions(+), 8 deletions(-)

[commit 23b83bfeb767eaf04ea15bf65aaa6a47761186b9]
Date: 2025-10-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: dpaa2: Setup interface caps on attach
Review: The dpaa2_ni driver now properly enables hardware checksum offloading for both IPv4 and IPv6 traffic when the interface attaches. This restores expected performance benefits for network traffic using this driver.
Body:

  39d4094173f9 ("epair: add support for checksum offloading") revealed
  that HW checksum offloading is not enabled when the dpaa2_ni driver
  is attached despite being declared and enabled on the dpni interface.

  I modified dpaa2_ni_setup_if_caps to take into account both IPv4 and
  IPv6 checksum offloading capabilities and added a call to re-configure
  interface capabilities on attach to fix it.

  Reviewed by:	bz
  Fixes:		39d4094173f9 ("epair: add support for checksum offloading")
  MFC after:	1 week
  Differential Revision: https://reviews.freebsd.org/D53436

  (cherry picked from commit a731cb93a66271713d6ea197946e4a307e5b0837)


   sys/dev/dpaa2/dpaa2_ni.c | 52 +++++++++++++++++++++++++++++++++++++++++-------
   1 file changed, 45 insertions(+), 7 deletions(-)

[commit 143273854faae2ad27193ce58cab773356a70e2a]
Date: 2025-12-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: sys/font.h: avoid warnings about too-long initializer strings
Review: The commit suppresses a compiler warning for internal build consistency but does not introduce any user-visible changes in functionality, behavior, or configuration.
Body:

  Mark `font_header::fh_magic` as `__non_string`, to avoid a warning from
  clang 21 similar to:

      /usr/src/usr.bin/vtfontcvt/vtfontcvt.c:763:15: error: initializer-string for character array is too long, array size is 8 but initializer has size 9 (including the null terminating character); did you mean to use the 'nonstring' attribute? [-Werror,-Wunterminated-string-initialization]
        763 |                 .fh_magic = FONT_HEADER_MAGIC,
            |                             ^~~~~~~~~~~~~~~~~
      /usr/obj/usr/src/amd64.amd64/tmp/usr/include/sys/font.h:109:27: note: expanded from macro 'FONT_HEADER_MAGIC'
        109 | #define FONT_HEADER_MAGIC       "VFNT0002"
            |                                 ^~~~~~~~~~

  MFC after:	3 days

  (cherry picked from commit e2c93ed09f259ed049923bdaa9b697b3586e2f1a)


   sys/sys/font.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4f8f0941c285a897beefe1c9795be8d9bbdcf724]
Date: 2025-12-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: bsnmpd: avoid warnings about too-long initializer strings
Review: Fixes a compiler warning in bsnmpd tools by marking a string constant with __non_string, but does not introduce any user-visible change.
Body:

  Mark `UTC` as `__non_string`, to avoid a warning from clang 21 similar
  to:

      usr.sbin/bsnmpd/tools/libbsnmptools/bsnmptc.c:339:29: error: initializer-string for character array is too long, array size is 3 but initializer has size 4 (including the null terminating character); did you mean to use the 'nonstring' attribute? [-Werror,-Wunterminated-string-initialization]
      --- all_subdir_usr.sbin ---
        339 |         static const char UTC[3] = "UTC";
            |                                    ^~~~~

  MFC after:	3 days

  (cherry picked from commit 3054e22e4524df24908d7e9379681c1ccf829b93)


   usr.sbin/bsnmpd/tools/libbsnmptools/bsnmptc.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 43d41e72fa2d3365241346c8b122c1a5215f2723]
Date: 2025-12-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: makefs: avoid warnings about too-long initializer strings
Review: The commit suppresses a compiler warning by marking a field as non-string, which is an internal build fix with no user-visible impact.
Body:

  Mark `direntry::deName` as `__non_string`, to avoid warnings from clang
  21 similar to:

    usr.sbin/makefs/msdos/msdosfs_vnops.c:512:4: error: initializer-string for character array is too long, array size is 11 but initializer has size 12 (including the null terminating character); did you mean to use the 'nonstring' attribute? [-Werror,-Wunterminated-string-initialization]
      512 |         {       ".          ",                          /* the . entry */
          |                 ^~~~~~~~~~~~~
    usr.sbin/makefs/msdos/msdosfs_vnops.c:522:4: error: initializer-string for character array is too long, array size is 11 but initializer has size 12 (including the null terminating character); did you mean to use the 'nonstring' attribute? [-Werror,-Wunterminated-string-initialization]
      522 |         {       "..         ",                          /* the .. entry */
          |                 ^~~~~~~~~~~~~

  MFC after:	3 days

  (cherry picked from commit ba0a11512237681fc621670023d56195cb8c82ad)


   usr.sbin/makefs/msdos/direntry.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 9f60c9b76fa4b45c73531073c306e0ddeb32cd16]
Date: 2025-12-26
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: m4: avoid warnings about too-long initializer strings
Review: The m4(1) utility no longer emits compilation warnings about too-long initializer strings when built with clang 21.
Body:

  Mark `digits` as `__non_string`, to avoid warnings from clang 21 similar
  to:

      usr.bin/m4/misc.c:123:27: error: initializer-string for character array is too long, array size is 36 but initializer has size 37 (including the null terminating character); did you mean to use the 'nonstring' attribute? [-Werror,-Wunterminated-string-initialization]
        123 |         static char digits[36] = "0123456789abcdefghijklmnopqrstuvwxyz";
            |                                  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

  MFC after:	3 days

  (cherry picked from commit a3394b6a23fb66ccb7e588129d2465ef8ea26d30)


   usr.bin/m4/misc.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 5402a4d73fe7f26d9ae7d6a9a5937c87ad06b5a2]
Date: 2025-12-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: fsck_msdosfs: avoid warnings about too-long initializer strings
Review: The commit suppresses a compiler warning in fsck_msdosfs by marking two static arrays as non-string. This has no user-visible impact; it is an internal build fix.
Body:

  Mark `dot_name` and `dotdot_name` as as `__non_string`, to avoid
  warnings from clang 21 similar to:

      sbin/fsck_msdosfs/dir.c:466:39: error: initializer-string for character array is too long, array size is 11 but initializer has size 12 (including the null terminating character); did you mean to use the 'nonstring' attribute? [-Werror,-Wunterminated-string-initialization]
        466 | static const u_char dot_name[11]    = ".          ";
            |                                       ^~~~~~~~~~~~~
      sbin/fsck_msdosfs/dir.c:467:39: error: initializer-string for character array is too long, array size is 11 but initializer has size 12 (including the null terminating character); did you mean to use the 'nonstring' attribute? [-Werror,-Wunterminated-string-initialization]
        467 | static const u_char dotdot_name[11] = "..         ";
            |                                       ^~~~~~~~~~~~~

  MFC after:	3 days

  (cherry picked from commit 98c3d868fb5a7da7356c58e8c51423975bbd078b)


   sbin/fsck_msdosfs/dir.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 9ea1aadfdb306d95e79854ca569aefc7cf993fcb]
Date: 2025-12-29
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: cross-build: Avoid adding <sys/cdefs.h> to SYSINCS
Review: The commit fixes cross-building issues by preventing inclusion of FreeBSD-specific headers when building on non-FreeBSD systems, which affects developers using cross-compilation environments.
Body:

  Summary:
  The sys/cdefs.h in src is incompatible with glibc's sys/cdefs.h so
  cross-building broke when the former was added to SYSINCS in 1c9ff80f06. This
  commit adds a guard around that to only do that when building on FreeBSD. This
  should fix github CI.

  Test Plan:
  Ran buildkernel using tools/build/make.py on linux in github CI and
  locally on FreeBSD to double check nothing broke.

  Reviewed by:    dim
  MFC after:      3 days
  Differential Revision: https://reviews.freebsd.org/D54385

  (cherry picked from commit b6672803a1cf10dd1c912fe6571a8d426b8868bd)


   tools/build/Makefile | 2 ++
   1 file changed, 2 insertions(+)

[commit 2ade7285253fc5dfe0adfc51f7bd342b9293f253]
Date: 2025-12-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: tools.build: add sys/cdefs.h to SYSINCS, since lots of other headers use it
Review: The commit adds sys/cdefs.h to the SYSINCS list to resolve a build dependency for the legacy stage, but this is an internal build system change without direct user-visible impact.
Body:

  This is needed to let the legacy stage compile against newer versions of
  sys/font.h, which transitively includes sys/cdefs.h, and requires the
  new __nonstring macro from it.

  Fixes:		e2c93ed09f25
  MFC after:	3 days

  (cherry picked from commit 1c9ff80f06350fa44b7e50ce09ad665ab0082abb)


   tools/build/Makefile | 4 ++++
   1 file changed, 4 insertions(+)

[commit 0925033ac7704279664c0deceaea7835bfb5cc1d]
Date: 2025-12-16
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: cdefs.h: Introduce __nonstring attribute
Review: Adds __nonstring attribute to cdefs.h to suppress clang's -Wunterminated-string-initialization warning, affecting developers using this attribute for non-NUL-terminated char arrays.
Body:

  This attribute can be used to annotate char arrays that are not supposed to
  be terminated with a NUL char and is needed to silence clang's new
  -Wunterminated-string-initialization warning. The name matches linuxkpi.

  Reviewed by:	emaste, jhb
  MFC after:	1 week
  Differential Revision: https://reviews.freebsd.org/D52565

  (cherry picked from commit 802c6d5d61d15494a54a386dc2ffbcfefc68c8ab)


   sys/sys/cdefs.h                                    | 7 +++++++
   tools/build/cross-build/include/common/sys/cdefs.h | 8 ++++++++
   2 files changed, 15 insertions(+)

[commit 92d80c231d0a0f53daf6224037181d648b06b632]
Date: 2025-11-15
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: GCE: Don't .error on unsupported targets
Review: The commit removes a build error for unsupported architectures when using GCE image creation, allowing the build to continue with a dummy architecture value instead of failing.
Body:

  We ingest Makefile.gce even when we're not trying to create GCE images
  so we don't want to .error here.  Instead, set GCE_ARCH to a dummy
  value which should make the problem clear to anyone who attempts to
  create GCE images on an unsupported architecture.

  Reported by:	Jenkins
  Fixes:		0a8ecca4e315 ("GCE: Specify the architecture of images")

  (cherry picked from commit 787d09753f70bb382a7cbfba742a612fa54069e6)


   release/Makefile.gce | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 86b5e5bb7814f4f972dc29076969d06cd76567cb]
Date: 2025-11-14
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Userland.contrib
Subject: GCE: Specify the architecture of images
Review: The GCE image creation process now enforces architecture matching between instance and image, preventing mismatches like arm64 instances with amd64 images.
Body:

  Without a specified architecture, a user can attempt to create an
  arm64 instance with an amd64 image or vice versa. With the change
  the API will prevent that mismatch.

  (cherry picked from commit 0a8ecca4e3156bcd4ebbfcb24d968e67a3a09434)


   release/Makefile.gce | 9 +++++++++
   1 file changed, 9 insertions(+)

[commit 5143ea18e51042811bfb8be2b14e57befbde10fe]
Date: 2025-12-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: pmcannotate: avoid accessing uninitialized local variables
Review: The commit fixes a compiler warning by initializing variables and adding NULL checks, but this is an internal code cleanup with no user-visible impact.
Body:

  Initialize `tbfl` and `tofl` to NULL, and check whether they are
  non-NULL before calling remove(3) on them, to avoid warnings from clang
  21 similar to:

      usr.sbin/pmcannotate/pmcannotate.c:746:3: error: variable 'tbfl' is uninitialized when used here [-Werror,-Wuninitialized]
        746 |                 FATAL(exec, "%s: Impossible to locate the binary file\n",
            |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        747 |                     exec);
            |                     ~~~~~
      usr.sbin/pmcannotate/pmcannotate.c:57:9: note: expanded from macro 'FATAL'
         57 |         remove(tbfl);                                                   \
            |                ^~~~
      usr.sbin/pmcannotate/pmcannotate.c:695:12: note: initialize the variable 'tbfl' to silence this warning
        695 |         char *tbfl, *tofl, *tmpdir;
            |                   ^
            |                    = NULL
      usr.sbin/pmcannotate/pmcannotate.c:746:3: error: variable 'tofl' is uninitialized when used here [-Werror,-Wuninitialized]
        746 |                 FATAL(exec, "%s: Impossible to locate the binary file\n",
            |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        747 |                     exec);
            |                     ~~~~~
      usr.sbin/pmcannotate/pmcannotate.c:58:9: note: expanded from macro 'FATAL'
         58 |         remove(tofl);                                                   \
            |                ^~~~
      usr.sbin/pmcannotate/pmcannotate.c:695:19: note: initialize the variable 'tofl' to silence this warning
        695 |         char *tbfl, *tofl, *tmpdir;
            |                          ^
            |                           = NULL

  MFC after:	3 days

  (cherry picked from commit cd880010c49a5d4ec529f4204d4e88cd27727255)


   usr.sbin/pmcannotate/pmcannotate.c | 8 ++++++--
   1 file changed, 6 insertions(+), 2 deletions(-)

[commit ecb101967370cb1dedef5c46109011a93eeb1aa1]
Date: 2025-12-22
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: Remove debug crutch I accidentally left in
Review: Removes a debug crutch that was accidentally left in, which has no user-visible impact.
Body:

  Fixes:		cf1eaaf41cef
  MFC after:	1 week

  (cherry picked from commit 3b1126208f44a90c7dc04a87207e54b22d45893c)


   lib/clang/libllvm/Makefile | 1 -
   1 file changed, 1 deletion(-)

[commit 4660accec8d3e31b513bcbcf57d3a3a532ea60ca]
Date: 2025-12-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Reduce number of external symbols in libllvm, libclang and liblldb
Review: The commit reduces the number of exported symbols in libllvm, libclang, and liblldb, making the shared libraries smaller and potentially improving load times. This is an internal optimization without direct user-visible impact.
Body:

  In commit 2e47f35be5dc libllvm, libclang and liblldb were converted into
  private shared libraries. This allowed clang, lld, lldb, and other llvm
  tools to be linked against these shared libraries, which makes them
  smaller and avoids duplication.

  However, upstream builds the shared libraries using several visibility
  options, which reduces the number of external symbols, and makes the
  libraries a bit smaller.

  On my test machine:
  * libprivatellvm.so goes from 75643 to 34706 symbols (~54% reduction)
  * libprivateclang.so goes from 53250 to 33531 symbols (~37% reduction)
  * libprivatelldb.so goes from 27242 to 18798 symbols (~31% reduction)

  Note: to get the full benefit, a clean build is required. Incremental
  builds should still work, but I didn't want to force a full rebuild on
  everybody.

  MFC after:	1 week

  (cherry picked from commit cf1eaaf41cefe7e3aef45f6dab862191a3939ed8)


   lib/clang/libllvm/Makefile | 12 ++++++++++++
   lib/clang/llvm.build.mk    |  1 +
   2 files changed, 13 insertions(+)

[commit c55bd9b2727595b170d25c87d0561477952cce54]
Date: 2025-12-25
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: cuse(3): annotate cuse_init() to suppress thread safety analysis
Review: The commit adds a thread safety annotation to suppress compiler warnings; this is an internal code change with no user-visible impact.
Body:

  This avoids warnings from clang 21, similar to:

      /usr/src/lib/libcuse/cuse_lib.c:111:14: error: writing variable 'h_cuse' requires holding mutex 'm_cuse' exclusively [-Werror,-Wthread-safety-analysis]
        111 |         TAILQ_INIT(&h_cuse);
            |                     ^
      /usr/src/lib/libcuse/cuse_lib.c:111:14: error: writing variable 'h_cuse' requires holding mutex 'm_cuse' exclusively [-Werror,-Wthread-safety-analysis]
      /usr/src/lib/libcuse/cuse_lib.c:112:14: error: writing variable 'h_cuse_entered' requires holding mutex 'm_cuse' exclusively [-Werror,-Wthread-safety-analysis]
        112 |         TAILQ_INIT(&h_cuse_entered);
            |                     ^
      /usr/src/lib/libcuse/cuse_lib.c:112:14: error: writing variable 'h_cuse_entered' requires holding mutex 'm_cuse' exclusively [-Werror,-Wthread-safety-analysis]

  MFC after:	3 days

  (cherry picked from commit 5629b5cf79934e0b94ddbbd93b7756f74fe4050a)


   lib/libcuse/cuse_lib.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3e5025ea3a5f46d74bc1b9a2f793e25694e744c1]
Date: 2025-12-21
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: bhyve.8: Fix consistency and terms in manpage
Review: The commit fixes spelling and consistency issues in the man:bhyve[8] man page, improving documentation clarity.
Body:

  Correct inconsistent spelling of terms and duplication.

  Reviewed by:	ziaee
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D54332

  (cherry picked from commit 5819f8b285fc55a75e5dea56ffe73b376525150c)


   usr.sbin/bhyve/bhyve.8 | 61 +++++++++++++++++++++++++++-----------------------
   1 file changed, 33 insertions(+), 28 deletions(-)

[commit f95ddf7441b3596913da2d99cafda518ec8c2e1b]
Date: 2024-11-12
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Drivers.device
Subject: LinuxKPI: Use IfAPI to get LLADDR
Review: The LinuxKPI wireless subsystem now uses the IfAPI to retrieve the link-layer address, improving compatibility with certain Linux wireless drivers.
Body:

  Reviewed by:	bz, emaste
  Differential Revision: https://reviews.freebsd.org/D47525

  (cherry picked from commit 57609cb2de149a3c99c43e98d37cfa4784958f73)


   sys/compat/linuxkpi/common/src/linux_80211.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 16d50efd575e288b608ae2e8f50d908f39704ac7]
Date: 2024-11-08
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Juniper Networks, Inc.
Section: Drivers.device
Subject: qlnx: Convert recent changes to IfAPI
Review: The commit converts recent changes to the IfAPI for the qlnx driver, which is a network driver. This may affect network interface management and compatibility for users of qlnx hardware.
Body:

  Sponsored by:	Juniper Networks, Inc.
  Reviewed by:	zlei
  Differential Revision: https://reviews.freebsd.org/D47533

  (cherry picked from commit 1eaecc214ea2bfde84f4194c1d0e20b18117343f)


   sys/dev/qlnx/qlnxe/qlnx_os.c | 24 ++++++++++++++----------
   1 file changed, 14 insertions(+), 10 deletions(-)

[commit 63b0b8bd791a63070effca0b4d37a34cd52955da]
Date: 2024-10-31
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Juniper Networks, Inc.
Section: undecided
Subject: bnxt: Use IfAPI accessors where able
Review: The bnxt(4) driver now uses IfAPI accessors instead of directly accessing private ifnet structure members. This change improves code maintainability but does not introduce any user-visible functional changes, new features, or configuration impacts.
Body:

  Summary:
  Don't directly access ifnet members, it's a private structure.

  Sponsored by:	Juniper Networks, Inc.
  Differential Revision: https://reviews.freebsd.org/D47353

  (cherry picked from commit 84d7ec4c657f406c6cbd29baf32c8e057b663d17)


   sys/dev/bnxt/bnxt_re/bnxt_re.h  | 4 ++--
   sys/dev/bnxt/bnxt_re/ib_verbs.c | 6 +++---
   sys/dev/bnxt/bnxt_re/main.c     | 4 ++--
   3 files changed, 7 insertions(+), 7 deletions(-)

[commit 2fef1a6ef9f095df5ed8f1cd8766878fb960c86b]
Date: 2024-10-31
Score: 5
Status: proposed(include=no,score=35)
Sponsor: Juniper Networks, Inc.
Section: undecided
Subject: netlink: Don't directly access ifnet members
Review: The netlink route interface code no longer directly accesses internal ifnet structure members, which may affect third-party software that relies on similar access patterns.
Body:

  Summary:
  Remove the final direct access of struct ifnet members from netlink.
  Since only the first address is used, create the iterator and then free,
  without fully iterating.

  Reviewed By:	kp
  Sponsored by:	Juniper Networks, Inc.
  Differential Revision: https://reviews.freebsd.org/D42972

  (cherry picked from commit b224af946a17b8e7a7b4942157556b5bc86dd6fb)


   sys/netlink/route/iface.c | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit bcd1e5fb540ffed26b25f520a69e092423f8ccaa]
Date: 2023-08-25
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Juniper Networks, Inc.
Section: undecided
Subject: mac_ipacl: Use IfAPI
Review: The commit updates internal code to use the IfAPI interface, which is a refactoring without user-visible impact.
Body:

  Use `if_t` instead of `struct ifnet *`, and if_name() accessor.

  Sponsored by:	Juniper Networks, Inc.

  (cherry picked from commit b820820ece099a73511d7daec407d78f38185a9b)


   sys/security/mac_ipacl/mac_ipacl.c | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit fff399d8c6adfdd52275faa6b79da70a0682af6a]
Date: 2025-12-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: tipi.work
Section: undecided
Subject: bsd-family-tree: add FreeBSD 15.0
Review: Adds FreeBSD 15.0 to the bsd-family-tree file, updating the historical lineage documentation.
Body:

  (cherry picked from commit 7b44ab1c6abe106a44604a8504edca0e57ec1c42)

  Sponsored by:	tipi.work


   share/misc/bsd-family-tree | 5 ++++-
   1 file changed, 4 insertions(+), 1 deletion(-)

[commit 5b428bb8a0ca0216af8c7a957a6617c26e864def]
Date: 2025-11-07
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: bsd-family-tree: Re-center OpenBSD line
Review: The commit only adjusts visual spacing in a diagram file with no user-visible functional impact.
Body:

  Commit 09aeca28dd75 ("BSD family tree: reduce OpenBSD-NetBSD crowding")
  moved OpenBSD releases over 2 spaces.  Move the line through OpenBSD
  releases over as well.

  Reviewed by:	obrien
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53635

  (cherry picked from commit 1821cf482ff128b08bd65807e1f7aad7eb873e0b)


   share/misc/bsd-family-tree | 808 ++++++++++++++++++++++-----------------------
   1 file changed, 404 insertions(+), 404 deletions(-)

[commit 36b9d6094b38d5a33ea5221a9fb76b819e536638]
Date: 2025-10-31
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: tipi.work
Section: Userland.contrib
Subject: bsd-family-tree: add macOS 26
Review: The bsd-family-tree file is updated to include macOS 26, which may be of interest for historical or reference purposes.
Body:

  Sponsored by:	tipi.work

  (cherry picked from commit c6e02892bbca1237546e3943c0971768822e1745)


   share/misc/bsd-family-tree | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit e6bdbc17bec4645946838c18f1c3b3dfdf50707e]
Date: 2025-12-21
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: vm_fault_trap(): fix comments grammar
Review: Only comment grammar fixes with no user-visible impact.
Body:

  (cherry picked from commit 95788a851deb33242c18beb47f8a79eec320dfa5)


   sys/vm/vm_fault.c | 12 ++++++------
   1 file changed, 6 insertions(+), 6 deletions(-)

[commit b29fb0b5259cc991d6e51e0de53455701014858e]
Date: 2025-10-23
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: devfs: make destroy_dev() a release barrier for cdevpriv destructors runs
Review: The devfs subsystem now ensures that cdevpriv destructors run as a release barrier in destroy_dev(). This prevents race conditions when devices are destroyed while still in use.
Body:

  (cherry picked from commit 4dbe6628179d8e6bf400bfdb4bfa869bdc102a56)


   sys/fs/devfs/devfs_int.h   |  1 +
   sys/fs/devfs/devfs_vnops.c | 17 ++++++++++++++---
   sys/kern/kern_conf.c       |  3 +++
   3 files changed, 18 insertions(+), 3 deletions(-)

[commit c6cddb8a5b0ea73a0d545feed59dfe62aa568344]
Date: 2024-05-09
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: at cron file is now in /etc/cron.d
Review: The man:atrun[8] cron file location is moved from /var/at/at.deny to /etc/cron.d/at.deny, affecting system administrators who manage at job permissions.
Body:

  PR: 243380
  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1106

  (cherry picked from commit 783baf00128f6cf6fc08404eaad6a11b29d4025d)


   libexec/atrun/atrun.man | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c8282c0dc36faefc3c5273daca6b85e3d1912d7b]
Date: 2025-12-13
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.programs
Subject: Fix zgrep(1) wrapper regression, add test
Review: The zgrep(1) wrapper script now correctly handles arguments with spaces, fixing a regression that caused failures with certain patterns.
Body:

  @bdrewery reported D48873 broke "bzgrep -q '1 2' /var/log/messages.0.bz2"
  The mistake was in using $* instead of "$@" (I suspect $* is never right).

  Reported by:	bdrewery
  Reviewed by:	markj
  Approved by:	markj
  Fixes:		1070477cc8b7 ("Fix remaining zgrep(1) wrapper script regressions")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54217

  (cherry picked from commit 80726c2257e9d6d79341aac65ba22987f53619bc)


   usr.bin/grep/tests/grep_freebsd_test.sh | 10 ++++++++++
   usr.bin/grep/zgrep.sh                   |  2 +-
   2 files changed, 11 insertions(+), 1 deletion(-)

[commit 4706a2bea9880b6bc86a2f1e45b330de447ea91f]
Date: 2025-02-08
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: Fix remaining zgrep(1) wrapper script regressions
Review: The zgrep(1) wrapper script now correctly handles short flags without whitespace and multiple -e flags, fixing pattern matching issues. It also includes a test case for the unimplemented recursion (-r) feature.
Body:

  Summary:
  Fix short flags without whitespace, e.g:

      zgrep -wefoo test

  Fix multiple -e flags:

      zgrep -e foo -e xxx test

  Previously only the last pattern would be used.

  Clean up possible leading blank in ${grep_args}.

  Update comment: 2.51 -> 2.6.0

  Add a test case for the last known zgrep wrapper issue: recursion
  (-r) not implemented.

  Reviewed By: markj

  Differential Revision: https://reviews.freebsd.org/D48873

  (cherry picked from commit 1070477cc8b7a88b1fd2b1ba810a1fff761799a1)


   contrib/netbsd-tests/usr.bin/grep/t_grep.sh | 24 ++++++++++---
   usr.bin/grep/zgrep.sh                       | 52 +++++++++++++++++++++++++----
   2 files changed, 65 insertions(+), 11 deletions(-)

[commit 7cc02662711ca0eb036114686f4f293a5e4be8bc]
Date: 2025-12-09
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: mtree: tests: Import NetBSD's mtree test suite
Review: Imports NetBSD's mtree test suite into the FreeBSD test framework.
Body:

  Manually import latest mtree test suite from NetBSD.

  MFC after:	1 week

  (cherry picked from commit 2f29d0f3e6d25599c188c94bf1e395d9cbeb2a4d)


   contrib/netbsd-tests/usr.sbin/mtree/t_mtree.sh | 40 +++++++++++++++++++++++++-
   1 file changed, 39 insertions(+), 1 deletion(-)

[commit 12aa5ff90bd57da67f0ef4c25ea4cde28567315b]
Date: 2025-12-09
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: mtree: Fix typos
Review: Fixes typos in man:mtree[8] source code, which does not affect user-visible behavior.
Body:

  Manually apply a typo fix.  This change has already been submitted
  upstream as bin/59824.

  MFC after:	1 week

  (cherry picked from commit dab5daf54cc26aaf2679a2eda5f378461f279ec5)


   contrib/mtree/compare.c | 2 +-
   contrib/mtree/spec.c    | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit 525766f1ae38ad3f0648348d9bea2d2546a0fbf7]
Date: 2025-12-19
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Kernel.general
Subject: Revert "sys: Bump 32-bit kernel removal to 16.0"
Review: The commit reverts a previous change that bumped the 32-bit kernel removal target from 15.0 to 16.0, clarifying that 32-bit powerpc and i386 kernels may still be removed in 15.0.
Body:

  32-bit powerpc and i386 kernels still exist in 14.x, so we don't want to
  imply that those may persist until 16.0.  The message only claims that
  the kernels "may be" removed in 15.0 anyhow.

  This reverts commit c19688407a2c797e74762aebd90c1f1cc70ab726.

  Reported by:	jhb


   sys/kern/init_main.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 1a67e18678f68e616896ace72f79cd4e399b0bd3]
Date: 2025-12-16
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Network.general
Subject: ipfilter: Prevent stack buffer overflow
Review: The ipfilter subsystem now prevents a stack buffer overflow vulnerability when copying ipfs data from user space. This addresses a security issue that could be exploited by malicious users.
Body:

  When copying ipfs data from user space, don't just check that the payload
  length is nonzero, but also that it does not exceed the size of the stack
  buffer we're copying it into.

  While we're at it, use a union to create a buffer of the exact size we
  need instead of guessing that 2048 will be enough (and not too much).

  Finally, check the size of the payload once it gets to where it's used.

  MFC after:	3 days
  Reported by:	Ilja Van Sprundel <ivansprundel@ioactive.com>
  Reviewed by:	cy
  Differential Revision:	https://reviews.freebsd.org/D54194

  (cherry picked from commit a34c50fbd2a52bb63acde82e5aec4cb57880e39b)


   sbin/ipf/libipf/interror.c             |  5 ++++
   sys/netpfil/ipfilter/netinet/ip_sync.c | 51 ++++++++++++++++++++++++----------
   2 files changed, 42 insertions(+), 14 deletions(-)

[commit 00bdb832fd5def6dee43773d93a4f69c8db44643]
Date: 2025-12-14
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: proc: Fix proc_init / proc_dtor ordering issues
Review: Fixes a kernel memory leak in the process creation failure path and ensures proper initialization order for process tracing structures.
Body:

  * Move the initialization of p_ktr into proc_init() and make the check
    in proc_dtor() unconditional.  Prior to this, it was possible to fail
    and invoke proc_dtor() after the first thread had been created (which
    was the condition for checking p_ktr in proc_dtor()) but before p_ktr
    had been initialized.

  * Move the p_klist initialization in fork1() past the last possible
    failure point so we don't have to free it on failure.  We didn't,
    which meant we were leaking a knlist every time we failed to fork
    due to hitting the resource limit.

  PR:		291470
  MFC after:	1 week
  Reviewed by:	kib
  Differential Revision:	https://reviews.freebsd.org/D54215

  (cherry picked from commit 026d962ef14dafe19fa73361bea6dcc95f141dfa)


   sys/kern/kern_fork.c | 4 ++--
   sys/kern/kern_proc.c | 8 ++++----
   2 files changed, 6 insertions(+), 6 deletions(-)

[commit 90e09bfe799dc96e7e6e0071a053852cad152d96]
Date: 2025-12-14
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Kernel.general
Subject: vfs: Let prison_enforce_statfs zero the fsid
Review: The fsid field in struct statfs is now zeroed only when jail's enforce_statfs is greater than 1, or when enforce_statfs is 1 and the mountpoint is outside the jail. This changes the visibility of filesystem identifiers for jailed processes under certain configurations.
Body:

  Currently, we unconditionally zero the fsid before returning a struct
  statfs to a jailed process.  Move this into prison_enforce_statfs() so
  it only happens if enforce_statfs is greater than 1, or enforce_statfs
  is 1 but the mountpoint is outside the jail.

  PR:		291301
  MFC after:	1 week
  Reviewed by:	kib
  Differential Revision:	https://reviews.freebsd.org/D54214

  (cherry picked from commit d4f25d0c7957f0f1960028eec82625c2d6405537)


   sys/kern/kern_jail.c    | 3 +++
   sys/kern/vfs_syscalls.c | 5 +----
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit c7cc4706504e268fd3ca2f3382aa3f58004b71c6]
Date: 2025-12-10
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: AFRL, DARPA
Section: Network.general
Subject: netlink: Don't overwrite existing data in a linear buffer in snl_writer
Review: Fixes a bug in netlink message buffer reallocation that could overwrite existing data in the linear buffer chain, preventing potential data corruption.
Body:

  First, a bit of background on some of the data structures netlink uses
  to manage data associated with a netlink connection.

  - struct linear_buffer contains a single virtually-contiguous buffer
    of bytes.  Regions of this buffer are suballocated via lb_allocz()
    which uses a simple "bump" where the buffer is split into an
    allocated region at the start and a free region at the end.  Each
    allocation "bumps" the boundary (lb->offset) forward by the
    allocation size.

    Individual allocations are not freed.  Instead, the entire buffer is
    freed once all of the allocations are no longer in use.

    Linear buffers also contain an embedded link to permit chaining
    buffers together.

  - snl_state contains various state for a netlink connection including
    a chain of linear buffers.  This chain of linear buffers can contain
    allocations for netlink messages as well as other ancillary data
    buffers such as socket address structures.  The chain of linear
    buffers are freed once the connection is torn down.

  - snl_writer is used to construct a message written on a netlink
    connection.  It contains a single virtually-contiguous buffer
    (nw->base) allocated from the associated snl_state's linear buffer
    chain.  The buffer distinguishes between the amount of space
    reserved from the underlying allocator (nw->size) and the current
    message length actually written (nw->offset).  As new chunks of data
    (e.g. netlink attributes) are added to the write buffer, the buffer
    is grown by snl_realloc_msg_buffer by reallocating a larger buffer
    from the associated snl_state and copying over the current message
    data to the new buffer.

  Commit 0c511bafdd5b309505c13c8dc7c6816686d1e103 aimed to fix two bugs
  in snl_realloc_msg_buffer.

  The first bug is that snl_realloc_msg_buffer originally failed to
  update nw->size after growing the buffer which could result in
  spurious re-allocations when growing in the future.  It also probably
  could eventually lead to overflowing the buffer since each
  reallocation request was just adding the new bytes needed for a chunk
  to the original 'nw->size' while 'nw->offset' kept growing.
  Eventually the new 'nw->offset' would be larger than 'nw->size + sz'
  causing routines like snl_reserve_msg_data_raw() to return an
  out-of-bounds pointer.

  The second change in this commit I think was trying to fix the buffer
  overflows due to 'nw->size' being wrong, but instead introduced a new
  set of bugs.  The second change ignored the returned pointer from
  snl_allocz() and instead assumed it could use all of the
  currently-allocated data in the current linear buffer.  This is only
  ok if the only data in the linear buffer chain for the associated
  snl_state is the snl_writer's message buffer.  If there is any other
  data allocated from the snl_state, it could be earlier in the current
  linear buffer, so resetting new_base to nw->ss->lb->base can result in
  overwriting that other data.  The second change was also
  over-allocating storage from the underlying chain of linear buffers
  (e.g. a writer allocation of 256 followed by 512 would end up using
  the first 512 bytes, but 768 bytes would be reserved in the underlying
  linear buffer).

  To fix, revert the second change keeping only the fix for 'nw->size'
  being wrong.

  Reviewed by:	igoro, markj
  Fixes:		0c511bafdd5b ("netlink: fix snl_writer and linear_buffer re-allocation logic")
  Sponsored by:	AFRL, DARPA
  Differential Revision:	https://reviews.freebsd.org/D54148
  (cherry picked from commit 255af72c8059b0117db646f82efa2e4848fa7570)


   sys/netlink/netlink_snl.h | 20 +++++++++-----------
   1 file changed, 9 insertions(+), 11 deletions(-)

[commit b79115e13010467d009fc3fed49c0a332f953833]
Date: 2025-12-09
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: rman: Simplify initialization of internal globals
Review: Internal refactoring of resource manager initialization with no user-visible impact.
Body:

  Use TAILQ_HEAD_INITIALIZER and MTX_SYSINIT to remove the 'once' code
  from rman_init.

  Reviewed by:	des
  Differential Revision:	https://reviews.freebsd.org/D54142

  (cherry picked from commit a35eae89cbddaac73d3b6c2b5c1b90e3a0c00997)


   sys/kern/subr_rman.c | 12 +++---------
   1 file changed, 3 insertions(+), 9 deletions(-)

[commit be89c92739ed6063df479bc21b6d9acce133e78c]
Date: 2025-12-08
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Userland.programs
Subject: bsdinstall: Mount /dev and /packages after using the shell to partition disks
Review: The installer now automatically mounts /dev and /packages after using the Shell option for manual disk partitioning, preventing errors in chrooted commands like fwget.
Body:

  Normally after partitions are created by the installer, the 'mount'
  script is used to mount the target disk partitions under /mnt.  The
  tail end of this script also mounts a couple of additional filesystems
  under /mnt so that chrooted programs can work such as devfs and
  /packages.

  When the "Shell" option is used to permit the user to manually mount
  the destination filesystem, the "mount" script is not used as the user
  is instructed to mount the target filesystems and construct
  /mnt/etc/fstab, etc.  However, this means that the user is responsible
  for mounting devfs (which is not included in /etc/fstab) and /packages
  as well.  The help message for the "Shell" option doesn't mention
  these requirements, so users may not know to do so.  This can lead to
  confusing errors as chrooted commands can fail to find needed /dev
  entries.  For example, running fwget to fetch wireless firmware fails
  because /dev/pci doesn't exist.

  To make this less painful for users using this option, split out the
  bottom half of the 'mount' script that mounts these non-fstab-related
  filesystems into a separate 'mount_aux' script.  Invoke 'mount_aux'
  after using "Shell" to create the filesystem to ensure that these
  filesystems are always present.

  PR:		290901
  Reported by:	Peter <freebsd@peterk.org>
  Tested by:	Peter <freebsd@peterk.org>
  Differential Revision:	https://reviews.freebsd.org/D53770

  (cherry picked from commit f63a8c0a0915a3eceac179d4d18b2c03b1319fa2)


   tools/build/mk/OptionalObsoleteFiles.inc |  1 +
   usr.sbin/bsdinstall/scripts/Makefile     |  1 +
   usr.sbin/bsdinstall/scripts/auto         |  1 +
   usr.sbin/bsdinstall/scripts/mount        | 10 +-------
   usr.sbin/bsdinstall/scripts/mount_aux    | 39 ++++++++++++++++++++++++++++++++
   5 files changed, 43 insertions(+), 9 deletions(-)

[commit 7087adfd960af71fba968371439a706badf830e9]
Date: 2025-12-08
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: proc0_post: Clear relevant thread stats directly
Review: The commit refactors internal kernel thread statistics clearing to avoid unnecessary operations, but this is an internal optimization with no user-visible impact.
Body:

  rufetch() has several other effects besides clearing these per-thread
  stats most of which are explicitly discarded by the subsequent calls
  to ruxreset().  Just clear the relevant stats directly instead.

  Reviewed by:	olce, kib, markj
  Differential Revision:	https://reviews.freebsd.org/D54050

  (cherry picked from commit acd02443a952b1f5412d35d03f081ad48bae34d7)


   sys/kern/init_main.c | 9 ++++++---
   1 file changed, 6 insertions(+), 3 deletions(-)

[commit cdad10ea780f9b2f4d49a073a07709b2ceb9d59a]
Date: 2025-12-08
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: thread0: Clear td_rux stats in proc0_post
Review: The commit fixes an internal kernel accounting bug that prevents over-reporting of CPU usage for thread0 after boot. This ensures that man:getrusage[2] and related tools report accurate per-thread resource statistics.
Body:

  proc0_post aims to reset the CPU usage accounting for all threads and
  processes in the system to zero once the time of day is verified.
  However, not all of the per-thread stats were not being cleared,
  resulting in over-reported time for thread0 post-boot.

  Reviewed by:	olce, kib, markj
  Fixes:		bed4c5241663 ("Implement RUSAGE_THREAD. Add td_rux...")
  Differential Revision:	https://reviews.freebsd.org/D54040
  (cherry picked from commit dafe50ebd874ca3ccd5908c441cee9f478c501f0)


   sys/kern/init_main.c | 8 ++++++--
   1 file changed, 6 insertions(+), 2 deletions(-)

[commit 5685988838e403843422b5a727ff385a37b4909e]
Date: 2025-12-08
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ruxreset: Add an inline function to reset all the stats in rusage_ext
Review: The commit adds an internal function for resetting rusage statistics and uses it during process initialization, which is an internal implementation detail with no direct user-visible impact.
Body:

  Use it in proc0_post to reset per-process CPU usage.

  Suggested by:	olce
  Reviewed by:	olce, kib
  Differential Revision:	https://reviews.freebsd.org/D54049

  (cherry picked from commit 3f8ed605dbd0ee211ce8fe59c0c072b916d6311c)


   sys/kern/init_main.c |  5 +----
   sys/sys/proc.h       | 12 ++++++++++++
   2 files changed, 13 insertions(+), 4 deletions(-)

[commit 1a5539989e04a4ec03ad8787368858de4a2ae097]
Date: 2025-11-27
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: exports.5: Typo: "auomatically" => "automatically"
Review: Fixes a typo in man:exports[5], changing 'auomatically' to 'automatically'.
Body:

  Fixes:          9d975e47d5a3 ("exports.5: Clarify that exported dirs should be local mount points")
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 7521dc5dce35159add70003340e1555456721a2d)


   usr.sbin/mountd/exports.5 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c4b315440f6ea7031a4aabd2273419e042848f98]
Date: 2025-09-01
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation | Google LLC (GSoC 2025)
Section: Docs.manpages
Subject: mdo.1: Document group-related and fine-grained control functionalities
Review: The man:do[1] manual page is updated to document group-related and fine-grained control functionalities, including new sections on process credentials, security considerations, and the relationship between man:do[1] and man:mac_do[4].
Body:

  This is a manual page update describing the functionality that was added
  to mdo(1) in commit 3ca1e69028ac ("mdo(1): Add support and shortcuts for
  fully specifying users and groups").  Please either refer to that commit
  or the new manual page's content for more information.

  While here:
  - Add to the introduction a description of process credentials and some
    specific vocabulary that is used throughout the page, as well as the
    relationship between mdo(1) and mac_do(4).
  - Update the HISTORY section.
  - Add AUTHORS and SECURITY CONSIDERATIONS sections.

  Reviewed by:    ziaee
  MFC after:      1 minute
  Sponsored by:   The FreeBSD Foundation
  Sponsored by:   Google LLC (GSoC 2025)
  Co-authored-by: Kushagra Srivastava <kushagra1403@gmail.com>
  Differential Revision:  https://reviews.freebsd.org/D53905

  (cherry picked from commit 73dd00f2fd7de2a5d8dda8fa25ebcd7c8964ff52)


   usr.bin/mdo/mdo.1 | 269 +++++++++++++++++++++++++++++++++++++++++++++++++-----
   1 file changed, 245 insertions(+), 24 deletions(-)

[commit b7c5f19e0fafc8561fe9368ce0477bdcc536a9db]
Date: 2025-05-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: mdo.1: Describe this command's history
Review: The commit adds historical context to the man:mdoc[1] manual page, which is a documentation update without user-visible functional changes.
Body:

  Reviewed by: imp, ziaee
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1712

  (cherry picked from commit a27c25625ddc7dc26185282dd6416a8f584bf55d)


   usr.bin/mdo/mdo.1 | 7 ++++++-
   1 file changed, 6 insertions(+), 1 deletion(-)

[commit 1dc4fa83bb8b78314cd24bbfda547edbfe2c7553]
Date: 2025-11-14
Score: 5
Status: proposed(include=no,score=25)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: mdo(1): Avoid calling getgroups() in some unnecessary cases
Review: The man:mdo[1] utility avoids calling getgroups() in some unnecessary cases, which may improve performance when supplementary groups are not being modified.
Body:

  If the basis for supplementary groups are the current ones, we do not
  need to fetch them when they are to be replaced entirely (which we
  already have been doing), as in the '!start_from_current_groups' case,
  but specifically also when they are not going to be touched at all.

  This change in passing makes the modified code block's comment saying
  that SETCREDF_SUPP_GROUPS need not be set here correct.

  MFC after:      2 weeks
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D53771

  (cherry picked from commit b92b1b47583036bd02e656564ff22c92b8949077)


   usr.bin/mdo/mdo.c | 10 ++++++++--
   1 file changed, 8 insertions(+), 2 deletions(-)

[commit 2815d86103ae1b0e871c0dd68bb8b3c3090a2264]
Date: 2025-11-14
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: setcred(): Fix 32-bit compatibility copy-in
Review: The setcred() system call now correctly handles 32-bit compatibility on 64-bit architectures, preventing credential requests with garbage IDs.
Body:

  For 32-bit processes on 64-bit architectures, a difference of 'int'
  pointers was wrongly used as a number of bytes to copy in a memcpy()
  used to internally construct a 64-bit 'struct setcred' from the 32-bit
  variant, leading to copying only part of the 32-bit structure, and thus
  to requesting credentials with garbage IDs except for the real and
  effective user IDs.

  This bug was spotted by jhb@, who produced a slightly more invasive fix
  in D53757 (a switch to using CP() on all fields).  In the interest of
  minimizing the diff for possible inclusion in 15.0, the commit here just
  limits itself to fixing the number of bytes to copy.

  Tested successfully on a VM with 32-bit mdo(1) (and in passing also
  tested that the same executable on a kernel without this change exhibits
  the bug in practice, in the form of setcred() failing with EINVAL).

  Reported by:    jhb
  Reviewed by:    jhb
  Fixes:          ddb3eb4efe55 ("New setcred() system call and associated MAC hooks")
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D53767

  (cherry picked from commit 4872b48b175cc637ee38f645d68b8207d9335474)


   sys/kern/kern_prot.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit f9f1c9d732596fecc088af3ddf20bbfc5cb18094]
Date: 2025-11-03
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: kern: RACCT: Keep process credentials alive via references
Review: This commit refactors internal credential handling for RACCT to improve code clarity and prevent potential reference counting errors. No user-visible functional changes are introduced.
Body:

  In system calls changing process credentials, on RACCT, calls to
  racct_proc_ucred_changed() must be issued on the new credentials.
  Currently, this is done after the new credentials have been installed on
  the process via proc_set_cred() or proc_set_cred_enforce_proc_lim(),
  which modifies 'p_ucred'.  Only the process lock guarantees that the new
  credentials pointed to by 'p_ucred' cannot themselves be concurrently
  modified, which would cause their 'struct ucred' to potentially lose its
  last reference from the process before the call to
  racct_proc_ucred_changed(), which needs one.

  For better code understandability and to avoid errors in future
  modifications, stop relying on proc_set_cred*() storing the passed
  'struct ucred' in the process 'p_ucred' and on the process lock to avoid
  the reference taken by proc_set_cred*() to vanish.  Instead, ensure that
  a reference is held when racct_proc_ucred_changed() is called.

  As racct_proc_ucred_changed() is actually passed explicit pointers to
  the old and new credentials, there is in fact no need to call it after
  proc_set_cred().  Instead, call it before proc_set_cred() and its taking
  over the reference.

  Since setcred() uses proc_set_cred_enforce_proc_lim(), which can fail,
  instead of proc_set_cred(), we instead take an additional reference with
  crhold().  Indeed, racct_proc_ucred_changed() should update resource
  accounting only if proc_set_cred_enforce_proc_lim() succeeds (an
  alternative would be to call it in advance and then in case of failure
  of the latter to call it again in order to backpedal the updated
  accounting, but we don't see a compelling reason to do that instead of
  taking an additional reference).

  While here, add to the documentation of proc_set_cred_enforce_proc_lim()
  that it does not take over the credentials reference in case of failure.
  While here, in racct_proc_ucred_changed()'s herald comment, add the
  precise condition in which this function must be called.

  No functional change intended.

  Reviewed by:    kib
  MFC after:      1 week
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D53563

  (cherry picked from commit c3d2b68c6933d0610bc3e09e9b94f963b4dc85aa)


   sys/kern/kern_jail.c       |  9 ++++++--
   sys/kern/kern_loginclass.c |  7 +++++-
   sys/kern/kern_prot.c       | 54 +++++++++++++++++++++++++++++++++-------------
   sys/kern/kern_racct.c      |  6 ++++--
   4 files changed, 56 insertions(+), 20 deletions(-)

[commit ef2392225825139ce9bff895dd732a78fea03d3e]
Date: 2025-11-09
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: setpgid(): Fix space before TAB in herald comment
Review: No user-visible change; whitespace-only cleanup.
Body:

  No functional change.

  With this tiny change, all the file becomes whitespace-clean.

  MFC after:      1 week
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit d05ab93913f340c5590eafa4cc09cc84aa86282e)


   sys/kern/kern_prot.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 269e6a4bc0656994ea895c88135a2b0d162e8d13]
Date: 2025-11-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: proc_set_cred(): Allow 'newcred' to have multiple references
Review: The commit is an internal kernel change to support a future commit and does not introduce any user-visible changes.
Body:

  This is an extension needed by next commit, where some additional
  reference is kept on the credentials to be set on a process in order to
  keep these credentials alive even after the process lock is released (an
  intervening reset of process credentials could release the reference
  that the process holds).

  Only 'cr_users' is incremented, as the reference (counted in 'cr_ref')
  comes from the caller, who passes it to the process.

  Reviewed by:    kib, markj
  MFC after:      1 week
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D53636

  (cherry picked from commit 5d46d11772c3280fd1c8ae09f20ce6c57f631c30)


   sys/kern/kern_prot.c | 8 +++-----
   1 file changed, 3 insertions(+), 5 deletions(-)

[commit 8185ac38a099f244ae6a71d381ac6c226d9264eb]
Date: 2025-10-29
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: setcred(): Fix RACCT resource accounting on credentials change
Review: The RACCT resource accounting now correctly updates when process credentials change, ensuring accurate resource tracking for users and processes.
Body:

  When credentials are changed, we need to adjust the sum of resources
  associated to the initial and new process' user IDs (and old and new
  login classes and jails, but setcred() does not change them) for them to
  stay consistent.

  PR:             290352
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D53457

  (cherry picked from commit 2be5127c4a31bacac9b4158395bfa844f6033626)


   sys/kern/kern_prot.c | 17 ++++++++++++++++-
   1 file changed, 16 insertions(+), 1 deletion(-)

[commit cc16a07a8e8fc4921e5072bff6263315918cf7bf]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=45)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: kern: Fix credentials leaks on RACCT but no RCTL
Review: Fixes credential leaks in system calls when RACCT is enabled but RCTL is disabled, affecting setuid(), setreuid(), setresuid(), jail_attach(), and setloginclass().
Body:

  Affected system calls: setuid(), setreuid(), setresuid(), jail_attach(),
  setloginclass().

  In these system calls, the crhold() calls that, on RACCT, make the
  just-installed process credentials survive a concurrent change of the
  same credentials just after PROC_UNLOCK() were not matched by
  a corresponding crfree() when RCTL is off.  In fact, in that latter
  case, they are simply not necessary, so wrap them with '#ifdef RCTL'
  stances.  'kern_rctl.c' causes a compile error if RACCT is not defined
  but RCTL is, so ease reading by not nesting '#ifdef's.

  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D53456

  (cherry picked from commit f4315ff8b3fee71eb0098864a84618f2f8ba85d5)


   sys/kern/kern_jail.c       | 2 ++
   sys/kern/kern_loginclass.c | 2 ++
   sys/kern/kern_prot.c       | 6 ++++++
   3 files changed, 10 insertions(+)

[commit bd26c99b688e4f9dabfc477d6e89ead587f923f4]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: racct: Simplify skipping idle process in the throttling daemon
Review: No functional change intended; internal refactoring only.
Body:

  In racctd(), commit c72188d85a79 ("racct: Improve handling of the pcpu
  resource") added a superfluous test to skip the idle process when
  computing the resource usage and checking for limits, consisting of
  a comparison of the considered process' pointer with that of the process of
  the first CPU's idle thread.  The P_IDLEPROC flag introduced in commit
  33be1632047c ("racct: Fix accounting of CPU time for the system idle
  process") is sufficient and simpler for this purpose.

  In the second loop throttling processes based on their %CPU usage, the
  test excluding processes not in PRS_NORMAL was not consistent with that
  of the first loop (which tests for the idle process also).  This had no
  practical consequences except a superfluous call to
  racct_pcpu_available() as the RACCT_PCTCPU counter stays at 0 on the
  idle process (because of the first loop).  Factor out the test in the
  new racct_proc_to_skip() function.

  No functional change intended.

  Reviewed by:    markj
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D53455

  (cherry picked from commit 9530c6f082ada9e6d0323f36697ce53997ab2326)


   sys/kern/kern_racct.c | 12 +++++++++---
   1 file changed, 9 insertions(+), 3 deletions(-)

[commit fd404e957dd93d0e8525e4bc37df3f66610ca19d]
Date: 2025-05-01
Score: 5
Status: proposed(include=no,score=30)
Sponsor: Klara, Inc.
Section: undecided
Subject: racct: Fix accounting of CPU time for the system idle process
Review: Resource accounting for the system idle process is corrected, ensuring that CPU time and other metrics are not incorrectly aggregated for idle threads.
Body:

  - Add a flag which cleanly indicates that a given process is the system
    idle process.
  - Modify racctd() to skip over the idle proc when aggregating CPU time
    and other metrics which don't apply to the idle thread.
  - Remove handling for idle threads from racct_getpcpu().

  PR:		269097
  Reviewed by:	olce, kib
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50073

  (cherry picked from commit 33be1632047c05dbfcc139476e05f49c3a86d560)


   sys/kern/kern_idle.c  |  3 +++
   sys/kern/kern_racct.c | 22 ++++------------------
   sys/sys/proc.h        |  2 +-
   3 files changed, 8 insertions(+), 19 deletions(-)

[commit 12b613efb4c670959ce540354db353bfb06e72a8]
Date: 2025-09-25
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: vm_domainset: Ensure round-robin works properly
Review: The round-robin domain allocation for interleaved memory policy now works correctly, preventing the iterator index from being reset when allocation restarts after a failure.
Body:

  All iterators that rely on an object's 'struct domainset_ref' (field
  'domain' on 'struct vm_object'), which is the case for page allocations
  with objects, are used with the corresponding object locked for writing,
  so cannot lose concurrent iterator index's increases even if those are
  made without atomic operations.  The only offender was thread stack
  allocation, which has just been fixed in commit 3b9b64457676 ("vm: Fix
  iterator usage in vm_thread_stack_create()").

  However, the interleaved policy would still reset the iterator index
  when restarting, losing track of the next domain to allocate from when
  applying round-robin, which all allocation policies do if allocation
  from the first domain fails.

  Fix this last round-robin problem by not resetting the shared index at
  iterator's phase init on DOMAINSET_POLICY_INTERLEAVE.

  Add an assertion to check that, when passed, an object is write-locked
  in order to prevent the problem mentioned in the first paragraph from
  reappearing.

  Reviewed by:    markj
  MFC after:      1 week
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52733

  (cherry picked from commit 7b0fe2d405ae09b1247bccc6fa45a6d2755cbe4c)

  In stable/14, all page allocations with object have the latter locked
  for writing.  Contrary to what happened in main (and stable/15), the
  offender mentioned in the original commit message never appeared in
  stable/14 because it was introduced in main by commit 7a79d0669761 ("vm:
  improve kstack_object pindex calculation to avoid pindex holes") and
  later fixed by commit 3b9b64457676 ("vm: Fix iterator usage in
  vm_thread_stack_create()"), both of which were never MFCed.  So, the
  following part of the original commit message: "The only offender was
  thread stack allocation, which has just been fixed in commit
  3b9b64457676 ("vm: Fix iterator usage in vm_thread_stack_create()")."
  does not apply here.


   sys/vm/vm_domainset.c | 10 +++++++---
   1 file changed, 7 insertions(+), 3 deletions(-)

[commit 67a2afe25ab8c4f93f82624d0f0a00cfa22f83bb]
Date: 2025-10-14
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: sys/rpc: UNIX auth: Do not log on bogus AUTH_SYS messages
Review: Removes verbose logging of authentication failures in the RPC UNIX authentication module to prevent excessive log generation from malformed requests.
Body:

  Remove the printf() stances added in commit d4cc791f3b2e ("sys/rpc: UNIX
  auth: Fix OOB reads on too short message").

  Even if it can be helpful to know why an authentication message is
  rejected, printing explanatory messages on each request attempt is
  a remote log filler that could be triggered by accident, and the generic
  RPC code generally does not do that.  These printf() calls should be
  restored only after some limiting or configuration mechanism is devised.

  MFC with:       d4cc791f3b2e ("sys/rpc: UNIX auth: Fix OOB reads on too short message")
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 2110ae0ef9d6ca8cf52b29fcaf926c4343f56826)


   sys/rpc/svc_auth_unix.c | 20 +++-----------------
   1 file changed, 3 insertions(+), 17 deletions(-)

[commit c3f9ca7ab109be27a1f8d6a1745669ba6b4c9790]
Date: 2025-10-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sys/rpc: UNIX auth: Style: Remove unnecessary headers, minor changes
Review: Minor style changes and header cleanup in RPC UNIX authentication code with no user-visible impact.
Body:

  MFC after:      2 days
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit a4105a5d4e179aa1ef661ee45d6008e83fefd2a7)


   sys/rpc/authunix_prot.c | 9 +++------
   sys/rpc/svc_auth_unix.c | 4 +---
   2 files changed, 4 insertions(+), 9 deletions(-)

[commit 1fa29df2cd37e74daa95c1150ec284b269db2e1f]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sys/rpc: UNIX auth: Support XDR_FREE
Review: The commit adds support for XDR_FREE in UNIX authentication, which is an internal implementation detail with no direct user-visible impact. It does not change behavior, add features, or affect configuration.
Body:

  xdr_authunix_parms() does not allocate any auxiliary memory, so we can
  simply support XDR_FREE by just returning TRUE.

  Although there are currently no callers passing XDR_FREE, this makes us
  immune to such a change in a way that doesn't cost more but is more
  constructive than a mere KASSERT().

  Suggested by:   rmacklem
  MFC after:      2 days
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 4ae70c3ea498e06676040ee99254d261e29ae82e)


   sys/rpc/authunix_prot.c | 4 ++++
   1 file changed, 4 insertions(+)

[commit 8807380a7400d0ea1ef788c81e70b3a363f632a9]
Date: 2025-10-07
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: sys/rpc: UNIX auth: Fix OOB reads on too short message
Review: The svc_auth_unix.c fix addresses multiple out-of-bounds read vulnerabilities in the UNIX authentication handling for RPC services, which could lead to security issues.
Body:

  In the inline version (_svcauth_unix()), fix multiple possible OOB reads
  when the credentials part of a request is too short to contain mandatory
  fields or with respect to the hostname length or number of groups it
  advertises.  The previously existing check was arriving too late and
  relied on possibly wrong data coming from earlier OOB reads.

  While here, use 'uint32_t' as the length/size type, as it is more than
  enough and removes the need for conversions, explicit or implicit.
  While here, factor out setting 'stat' to AUTH_BADCRED and then jumping
  to 'done' on error, through the new 'badcred' label.  While here,
  through comments, refer to what the non-inline version is doing
  (xdr_authunix_parms() in 'authunix_prot.c') and the reasons.

  Reviewed by:    rmacklem
  Fixes:          dfdcada31e79 ("Add the new kernel-mode NFS Lock Manager.")
  MFC after:      2 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52964

  (cherry picked from commit d4cc791f3b2e1b6926420649a481eacaf3bf268e)


   sys/rpc/svc_auth_unix.c | 99 ++++++++++++++++++++++++++++++-------------------
   1 file changed, 60 insertions(+), 39 deletions(-)

[commit 2e3e62e4de9efa6f2d55538aa6e7c36cfe849476]
Date: 2025-10-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sys/rpc: UNIX auth: Use AUTH_SYS_MAX_{GROUPS,HOSTNAME} as limits (2/2)
Review: The commit removes local defines and uses existing macros, which is an internal refactoring without user-visible impact.
Body:

  Remove local defines from 'svc_auth_unix.c' and use the new limit
  macros instead.

  Reviewed by:    rmacklem
  MFC after:      2 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52963

  (cherry picked from commit e665c0f6f7a611d25d9d7e7f64d98c84b3a92820)


   sys/rpc/svc_auth_unix.c | 7 ++-----
   1 file changed, 2 insertions(+), 5 deletions(-)

[commit dab039c0e9803f1b0cd30cf0719e8d70822fb88d]
Date: 2025-10-07
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: sys/rpc: UNIX auth: Use AUTH_SYS_MAX_{GROUPS,HOSTNAME} as limits (1/2)
Review: The RPC UNIX authentication now enforces limits on machine name length and number of supplementary groups, rejecting non-conforming messages. This may affect NFS clients or servers using UNIX authentication.
Body:

  Consistently with the XDR_INLINE() variant of xdr_authunix_parms()
  (_svcauth_unix() in 'svc_auth_unix.c'), reject messages with credentials
  having a machine name length in excess of AUTH_SYS_MAX_HOSTNAME or more
  than AUTH_SYS_MAX_GROUPS supplementary groups, which do not conform to
  RFC 5531.  This is done mainly because we cannot store excess groups
  anyway, even if at odds with the robustness principle ("be liberal in
  what you accept").

  While here, make sure the current code is immune to AUTH_SYS_MAX_GROUPS
  changing value (in future RFCs?) even if that seems improbable.

  Reviewed by:    rmacklem
  Fixes:          dfdcada31e79 ("Add the new kernel-mode NFS Lock Manager.")
  MFC after:      2 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52962

  (cherry picked from commit b119ef0f6a81eb32b0e1cd0075cec499543e7ddd)


   sys/rpc/authunix_prot.c | 33 +++++++++++++++++++++++----------
   1 file changed, 23 insertions(+), 10 deletions(-)

[commit f15270ef49f93cb949c2d8bcc65caf44f2d36295]
Date: 2025-10-07
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sys/rpc: Define AUTH_SYS_MAX_{GROUPS,HOSTNAME}
Review: Defines constants for maximum groups and hostname size in AUTH_SYS credentials, used internally for subsequent changes.
Body:

  As, respectively, the maximum number of "supplementary" groups and the
  maximum hostname size allowed in the credentials structure for AUTH_SYS
  (aka, AUTH_UNIX).

  Will be used in subsequent commits.

  Reviewed by:    rmacklem
  MFC after:      2 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52961

  (cherry picked from commit f7c4f800cc0b4fac1c99cda8e22d46b67592f9fa)


   sys/rpc/auth.h | 4 ++++
   1 file changed, 4 insertions(+)

[commit 0574fca39fb3fa8fef062b74e82f359b99f1bee0]
Date: 2025-10-07
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: sys/rpc: UNIX auth: Fix OOB accesses, notably writes on decode
Review: The UNIX authentication decoder in the RPC subsystem now prevents out-of-bounds memory accesses when processing group IDs, addressing a potential security issue.
Body:

  When the received authentication message had more than XU_NGROUPS, we
  would write group IDs beyond the end of cr_groups[] in the 'struct
  xucred' being filled (as 'ngroups_max' is always greater than
  XU_NGROUPS).

  For robustness, prevent various OOB accesses that would result from
  a change of value of XU_NGROUPS or a 'struct xucred' with an invalid
  'cr_ngroups' field, even if these cases are unlikely.

  Reviewed by:    rmacklem
  Fixes:          dfdcada31e79 ("Add the new kernel-mode NFS Lock Manager.")
  MFC after:      2 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52960

  (cherry picked from commit 47e9c81d4f1324674c624df02a51ad3a72aa7444)


   sys/rpc/authunix_prot.c | 40 +++++++++++++++++++++-------------------
   1 file changed, 21 insertions(+), 19 deletions(-)

[commit ede3009e4569b79055643b8fd65b4165092e8517]
Date: 2025-10-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sys/rpc: UNIX auth: Rename 'ngroups' => 'supp_ngroups' for clarity
Review: Renames the 'ngroups' field to 'supp_ngroups' in UNIX RPC authentication structures for clarity, with no functional change.
Body:

  MFC after:      2 days
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit bda3b61512b2597d4c77d2b9c9074b844dec0405)

  Two minor conflicts, due to missing comments added in commit
  be1f7435ef21 ("kern: start tracking cr_gid outside of cr_groups[]")
  which will not be MFCed, were solved by adding these comments.


   sys/rpc/authunix_prot.c | 21 +++++++++++++--------
   sys/rpc/svc_auth_unix.c | 21 +++++++++++++--------
   2 files changed, 26 insertions(+), 16 deletions(-)

[commit ed39e2b3cf429dc34cd27c1fa09a39db9451ea78]
Date: 2025-07-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: kern: adopt the cr_gid macro for cr_groups[0] more widely
Review: The commit is a preparatory internal refactoring with no immediate user-visible changes. It warns downstream developers about future changes, but does not affect FreeBSD users directly.
Body:

  A future change may split cr_gid out of cr_groups[0] so that there's a
  cleaner separation between the supplemental groups and the effective
  group.  Do the mechanical conversion where we can, and drop some
  comments where we need further work because some assumptions about
  cr_gid == cr_groups[0] have been made.

  This should not be a functional change, but downstreams and other
  out-of-tree code are advised to investigate their usage of cr_groups
  sooner rather than later, as a future change will render assumptions
  about these two being equivalent harmful.

  Reviewed by:	asomers, kib, olce
  Differential Revision:	https://reviews.freebsd.org/D51153

  (cherry picked from commit 46c07316f90628a82dd461376ccff64a81254325)

  This was MFCed to ease application of further commits.

  NOTE: Downstreams and out-of-tree code targeting stable/14 need not do
  the switch, as splitting 'cr_gid' out of cr_groups[], as we did in
  stable/15 (and is in 15.0), is not on the agenda for stable/14.

  Comments that were added temporarily for stable/15, alluding to the
  future split, have been removed.


   sys/fs/fuse/fuse_internal.h     |  6 +++---
   sys/fs/fuse/fuse_ipc.c          |  2 +-
   sys/fs/fuse/fuse_vnops.c        |  2 +-
   sys/fs/nfs/nfs_commonport.c     |  2 +-
   sys/fs/nfsclient/nfs_clrpcops.c |  2 +-
   sys/kern/kern_prot.c            | 38 +++++++++++++++++++-------------------
   sys/kern/vfs_syscalls.c         |  4 ++--
   sys/netpfil/pf/pf.c             |  4 ++--
   sys/netsmb/smb_conn.c           |  4 ++--
   sys/rpc/authunix_prot.c         |  6 +++---
   sys/rpc/svc_auth_unix.c         |  2 +-
   sys/security/audit/audit.c      |  2 +-
   sys/security/audit/audit_arg.c  |  2 +-
   sys/ufs/ufs/ufs_vnops.c         |  4 ++--
   14 files changed, 40 insertions(+), 40 deletions(-)

[commit d913e3fe23b538bf602a58d5cdf1438c16a8e41d]
Date: 2025-07-24
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: tftpd: explicitly set egid after dropping supplemental groups
Review: The tftpd daemon now explicitly sets the effective group ID after dropping supplemental groups, improving security and portability.
Body:

  tftpd seems to be the last program in base that implicitly relies on
  setgroups() to set the egid.  This is a security landmine in portable
  software as most operating systems don't behave this way, so do an
  explicit setgid() in case the kernel doesn't set it already.

  While we're here, FreeBSD's setgroups() has supported nominally clearing
  all supplemental groups since 1997.  It still leaves the egid in our
  cr_groups[0] because we don't have an out-of-band way to store the egid,
  and on other systems it'll clear the supplemental group entirely as one
  would want.

  Reviewed by:	allanjude (previous version), des, olce
  Differential Revision:	https://reviews.freebsd.org/D51149

  (cherry picked from commit 5138a20765c76cdc8f245d3d7caeffe9a9011bb2)


   libexec/tftpd/tftpd.c | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit b987035c2af7adb56f8a89253e09a0f4ead1beb7]
Date: 2025-09-08
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: uma_core: Rely on domainset iterator to wait on M_WAITOK
Review: The commit simplifies internal locking and waiting mechanisms in the UMA slab allocator, but does not introduce any user-visible changes in behavior, performance, or configuration.
Body:

  Commit 8b987a77691d ("Use per-domain keg locks.") removed the need to
  lock the keg entirely, replacing it with per-domain keg locks.  In
  particular, it removed the need to hold a lock over waiting for a domain
  to grow free memory.

  Simplify the code of keg_fetch_slab() and uma_prealloc() by removing the
  M_WAITOK -> M_NOWAIT downgrade and the local call to vm_wait_doms()
  (which used to necessitate temporary dropping the keg lock) which the
  iterator machinery already handles on M_WAITOK (and compatibly with
  vm_domainset_iter_ignore() at that, although that does not matter now).

  Reviewed by:    bnovkov, markj
  Tested by:      bnovkov
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52441

  (cherry picked from commit 781802df7a2bfe224ef17596d56cf83c49517655)


   sys/vm/uma_core.c | 22 ++++++----------------
   1 file changed, 6 insertions(+), 16 deletions(-)

[commit fecb79a5a83e1207c773df113b5d855634809107]
Date: 2025-03-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Bootloader.general
Subject: libsa: smbios: Detect less-than-64-bit platforms via __SIZEOF_SIZE_T__
Review: The smbios(4) detection in the boot loader is updated to better handle platforms with different pointer sizes, ensuring correct SMBIOS table addressing on 64-bit and CHERI systems.
Body:

  What we really want here is to know if pointers can refer to 64-bit
  addresses, regardless of whether they also hold other information (such
  as capabilities in CHERI).  __SIZEOF_SIZE_T__ is probably the closest
  indication to that piece of information, so let's use it.  __ILP32__
  wasn't wrong in practice though, as we don't support 32-bit CHERI
  hardware (and likely never will).

  Consistently with this change, test whether we can actually address the
  64-bit SMBIOS's structure table by converting the end address to
  'size_t' and checking whether its value is preserved.

  Suggested by:   jhb (for the __ILP32__ => __SIZEOF_SIZE_T__ part)
  Reviewed by:    jhb, imp
  MFC after:      2 weeks
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D49318

  (cherry picked from commit d3bfcd66409befc2d545e5449963b41c25c369a9)


   stand/libsa/smbios.c | 11 +++++++----
   1 file changed, 7 insertions(+), 4 deletions(-)

[commit c19688407a2c797e74762aebd90c1f1cc70ab726]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: sys: Bump 32-bit kernel removal to 16.0
Review: The 32-bit kernel removal target is moved from FreeBSD 15.0 to 16.0, allowing continued support for 32-bit architectures like armv7 in the 15.x release series.
Body:

  We are shipping at least one 32-bit kernel in FreeBSD 15.0 (i.e.,
  armv7).

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 7b28d549427bd85ecfae24d09da6eacb26c15822)
  (cherry picked from commit 19b642b5dc2f000de4e3e55d9da94398ecb0aca3)


   sys/kern/init_main.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b3d8026db32244e1c4816a50f7172938c46cc1c3]
Date: 2025-09-09
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: boot.config.5: Clarify that this controls legacy boot blocks
Review: The man:boot.config[5] manual page clarifies that the boot.config file controls legacy boot blocks, not UEFI booting.
Body:

  Reviewed by;	ziaee
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D52460

  (cherry picked from commit e96359d111aaffa6bf0ea72a6f183eb3b91e6c72)
  (cherry picked from commit de67d3cfc6537f6bfa8f2601da7af9c165d09075)


   share/man/man5/boot.config.5 | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 5ece89c74efd8ab836459af5bc6720af904ad1d4]
Date: 2025-12-15
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Network.general
Subject: ipfilter: Add missing kenv fetch
Review: The ipfilter module now fetches kernel environment variables when loaded as a module, ensuring proper configuration.
Body:

  When a module the environment must be explicitly fetched.

  Fixes:			d9788eabffa4
  PR:			291548
  Noted by:		markj
  Reviewed by:		markj
  Differential Revision:	https://reviews.freebsd.org/D54242

  (cherry picked from commit a6ea80bc917510b5e056cc5a29b62dfd7b39d068)


   sys/netpfil/ipfilter/netinet/ip_fil_freebsd.c | 2 ++
   1 file changed, 2 insertions(+)

[commit c53d90c50c7732b34fe6ce65127e136ef2e62cee]
Date: 2025-11-22
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: loader.efi.8: Minor formatting nits
Review: Minor formatting fixes in man:loader.efi[8] improve readability and prevent line wrapping on 80-column displays.
Body:

  - Add several missing .Pp after lists and literal blocks.

  - Fix the column widths for the console table and use a shorter indent
    so that it doesn't wrap on an 80-col display.

  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D53866

  (cherry picked from commit 46d05a49a1d0d655af6cae2afd48a973698cbf71)


   stand/man/loader.efi.8 | 9 ++++++++-
   1 file changed, 8 insertions(+), 1 deletion(-)

[commit a9d8eb9e2e3cb63bfb5cbfd9c7eb0128822a5ea9]
Date: 2025-11-12
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: pcic.4: Remove stale manual
Review: The man:pcic[4] manual page is removed as it is obsolete. This change updates the documentation to reflect current hardware support.
Body:

  Extracted from:	https://reviews.freebsd.org/D53434

  (cherry picked from commit 1d9f2db7c0b981bf5d45e3ef17dda13b953e1c97)
  (cherry picked from commit 6aaf184dc4e294779db7133629b7ae953b4da285)


   ObsoleteFiles.inc       |   3 +-
   share/man/man4/Makefile |   1 -
   share/man/man4/ath.4    |   1 -
   share/man/man4/exca.4   |   3 +-
   share/man/man4/pcic.4   | 100 ------------------------------------------------
   5 files changed, 3 insertions(+), 105 deletions(-)

[commit 0002b1d651c8e33b5ab5bed34fe503b85e585d59]
Date: 2025-11-12
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: Retire pccard(4)
Review: The pccard(4) man page is removed, reflecting the long-obsolete status of pccard hardware support.
Body:

  pccard has been declared obsolete for a long time and also the
  support has been removed but the man page still exists. It mentions
  being scheduled to be removed before 13.0 but it still exists in the
  tree.

  [Extracted from review D53434]

  (cherry picked from commit 5b9fba1cb0d84ee297908ec4d575c33cf1f68ad5)
  (cherry picked from commit 8a8c58f71e80e186da3679266eef54f4180e4d11)


   ObsoleteFiles.inc                   |  3 ++
   share/man/man4/Makefile             |  1 -
   share/man/man4/cardbus.4            |  1 -
   share/man/man4/pccard.4             | 78 -------------------------------------
   share/man/man4/pccbb.4              |  3 +-
   share/man/man4/xl.4                 |  1 -
   share/man/man9/DEVICE_DETACH.9      |  5 +--
   share/man/man9/bus_alloc_resource.9 |  5 ---
   usr.sbin/dumpcis/dumpcis.8          |  3 +-
   9 files changed, 6 insertions(+), 94 deletions(-)

[commit 3a25f21eed6e37e8d4bf70ac7cc4aaf69950806e]
Date: 2025-11-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kmod.mk: Remove a trailing reference to pccarddevs.h
Review: The commit removes a trailing reference to pccarddevs.h in kmod.mk, which is a build system cleanup with no user-visible impact.
Body:

  Fixes:		31b35400cf77 ("pccard: Remove more of the PC Card infrastructure")
  (cherry picked from commit 6bf611ada21216aefcd830ba71fbf0b5d776ea47)


   sys/conf/kmod.mk | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 108b5d90bc1fa8ed83cfd6f58e636193e03e8049]
Date: 2025-10-30
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: bus_alloc_resource: First step in passing resource IDs by value
Review: The commit adds inline wrapper functions for bus_alloc_resource* that accept resource IDs by value, but this is an internal API change without direct user-visible impact. It does not affect userland applications, drivers, storage, networking, bootloader, hardware support, documentation, or ports.
Body:

  Add wrapper inline functions for bus_alloc_resource* that accept a
  resource ID by value (instead of a pointer).  The rest of the bus
  resource API (outside of compat shims) does not accept resource IDs as
  arguments, but instead obtains the resource ID from the resource
  itself when needed.  As such, there is no reason to return any
  potentially modified resource IDs to the caller.

  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D53401

  (cherry picked from commit 7eb213614b90cde31707a53c4b8ae6acacf2aa0f)


   share/man/man9/bus_alloc_resource.9 | 24 +++++++--------------
   sys/kern/subr_bus.c                 |  2 +-
   sys/sys/bus.h                       | 42 +++++++++++++++++++++++++++++++++++++
   sys/sys/param.h                     |  2 +-
   4 files changed, 51 insertions(+), 19 deletions(-)

[commit 7f33109a13f9fee4303cece3d60ddfb3be826081]
Date: 2025-10-27
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: closefrom_test: Convert to atf-c(3)
Review: The commit converts a test from plain C to ATF (Automated Test Framework), which is an internal change to the testing infrastructure without any user-visible impact.
Body:

  Reviewed by:	ngie, markj
  Differential Revision:	https://reviews.freebsd.org/D52800

  (cherry picked from commit 2fbb6e213ac2075594da5f68a72d41074fd85b69)


   tests/sys/file/Makefile         |   2 +-
   tests/sys/file/closefrom_test.c | 443 ++++++++++++++++++++--------------------
   2 files changed, 218 insertions(+), 227 deletions(-)

[commit ee5ad300a0df2e7dceeeda9bff1504c70ad84c69]
Date: 2025-10-23
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: closefrom_test: Fix the first test
Review: The commit fixes a regression test for the closefrom system call, but it does not introduce any user-visible changes; it only corrects a test case.
Body:

  The first test is supposed to close the new fd, but was instead not
  closing anything.

  Reviewed by:	ngie, markj
  Fixes:		3cedbec3ee08 ("Integrate tools/regression/fifo into ...")
  Differential Revision:	https://reviews.freebsd.org/D52799
  (cherry picked from commit b307799b5141331effbb93d7f87dd00e9b991982)


   tests/sys/file/closefrom_test.c | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 319f32a1748e4963c7680d4b124fa1e53ddc7c6a]
Date: 2024-01-01
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: Fix grammar error in test/sys/file/closefrom_test.c
Review: Fixes a grammar error in a test file, which has no user-visible impact.
Body:

  Event:		Advanced UNIX Programming Course (Fall23) at NTHU.
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/973

  (cherry picked from commit 664812f73488c4c0e16982c5c97d639deb9d2431)


   tests/sys/file/closefrom_test.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 857d3887e66426865ca73fa143b04b3ca7930ef5]
Date: 2025-10-03
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: getconf: Report value of _SC_PHYS_PAGES
Review: The man:getconf[1] utility now reports the value of _SC_PHYS_PAGES, providing information about the total number of physical pages available on the system.
Body:

  PR:		289717
  Reviewed by:	jhb

  (cherry picked from commit aa9e4fe3c9021d623743e26aef879a0036f87c0f)


   usr.bin/getconf/sysconf.gperf | 1 +
   1 file changed, 1 insertion(+)

[commit d866f1d4f968f8ead4765944d82f4af640815678]
Date: 2025-09-16
Score: 5
Status: proposed(include=no,score=10)
Sponsor: AFRL, DARPA
Section: undecided
Subject: aarch64: Save correct value of x18 on trapframe for nested faults
Review: The commit fixes a debugger display issue for the x18 register on nested faults on aarch64, but it does not introduce any user-visible functional change, new feature, or configuration impact.
Body:

  x18 is overwritten with a temporary copy of the kernel stack pointer
  when it is saved in the trapframe.  This does not matter in terms of
  function since nested exception return does not restore x18 from the
  trapframe, but it does mean that examining x18 in a debugger in stack
  frames above a nested fault outputs the wrong register value.

  To fix, compute the value of the original stack pointer to save in x18
  later after the trapframe has been constructed.

  Reviewed by:	jhb, andrew
  Sponsored by:	AFRL, DARPA
  Differential Revision:	https://reviews.freebsd.org/D52472

  (cherry picked from commit 99213b3c352cdf568ea7cf5b4dddb1879f16a601)


   sys/arm64/arm64/exception.S | 5 +++--
   1 file changed, 3 insertions(+), 2 deletions(-)

[commit c9be34e2e6af8ba22124b4c4229adb5db3006eda]
Date: 2025-09-16
Score: 5
Status: proposed(include=no,score=5)
Sponsor: AFRL, DARPA
Section: undecided
Subject: aarch64: Clarify the initial adjustments to sp for kernel exception entry
Review: This commit clarifies internal assembly code comments and expression formatting without changing functionality, so it has no user-visible impact.
Body:

  The first store-pair instruction in save_registers_head decrements the
  stack pointer to create room for most of the trapframe (and the
  redzone area for nested exceptions).  However, the expression was a
  bit non-intuitive as it was using an expression without a leading
  negative sign to adjust the stack pointer.  Rewrite the expression so
  that it is more clearly a negative adjustment to the stack pointer.

  Suggested by:	andrew
  Reviewed by:	andrew
  Sponsored by:	AFRL, DARPA
  Differential Revision:	https://reviews.freebsd.org/D52514

  (cherry picked from commit 7314f78b240bdbf2bcec07e3d5a475e37941bb6b)


   sys/arm64/arm64/exception.S | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 6acf7356d859a59f237f14bfb5a28ded63480a5f]
Date: 2025-10-03
Score: 5
Status: proposed(include=no,score=35)
Sponsor: 
Section: undecided
Subject: filedesc: Close race between fcntl(F_SETFL) and ioctl(FIONBIO/FIOASYNC)
Review: The commit fixes a race condition between fcntl(F_SETFL) and ioctl(FIONBIO/FIOASYNC) operations, ensuring correct synchronization of non-blocking and async I/O flag states. It also corrects a bug where file flags could incorrectly reflect a new state after a failed ioctl.
Body:

  - Use the recently-added fsetfl_lock/unlock API to synchronize direct
    FIONBIO and FIOASYNC ioctls with fcntl(F_SETFL).

  - While here, skip calling the underlying ioctl if the flag's current
    state matches the requested state.

  - Also while here, only update the flag state if the underlying ioctl
    succeeds.  This fixes a bug where the flags represented the new
    state even if the underlying ioctl failed.  A test is added for this
    last case that a failing FIOASYNC on /dev/null doesn't result in
    setting O_ASYNC in the file flags.

  Reviewed by:	kib
  Differential Revision:	https://reviews.freebsd.org/D52721

  (cherry picked from commit dfd7d1610aeb654aafcaa8cf77b75fc5c7d60250)


   sys/kern/sys_generic.c           | 36 +++++++++++++++++++++---------------
   tests/sys/file/fcntlflags_test.c | 27 +++++++++++++++++++++++++++
   2 files changed, 48 insertions(+), 15 deletions(-)

[commit 200e1ca48fdc11914cce91957d75e549b91f07c1]
Date: 2025-10-03
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: fcntlflags_test: Port to atf-c(3)
Review: The commit ports a test to atf-c(3), which is an internal testing framework change with no user-visible impact.
Body:

  Reviewed by:	kib
  Differential Revision:	https://reviews.freebsd.org/D52720

  (cherry picked from commit 5c331f449e9ca549d03ae1a3f50ac0e5306b488e)


   tests/sys/file/Makefile          |   2 +-
   tests/sys/file/fcntlflags_test.c | 116 +++++++++++++++++++--------------------
   2 files changed, 58 insertions(+), 60 deletions(-)

[commit 7bf3b6d8e4263d63f4276b27035f2c6254c28a86]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: fcntl(F_SETFL): only allow one thread to perform F_SETFL
Review: The fcntl(F_SETFL) operation is now serialized to prevent multiple threads from concurrently modifying file descriptor flags, ensuring consistency between driver state and user-visible flags.
Body:

  Use f_vflags file locking for this.
  Allowing more than one thread handling F_SETFL might cause de-sync
  between real driver state and flags.

  Reviewed by:	markj
  Tested by:	pho
  Sponsored by:	The FreeBSD Foundation
  MFC after:	2 weeks
  Differential revision:	https://reviews.freebsd.org/D52487

  (cherry picked from commit 4c3a868d13c053ef173268cdfe1365978a282178)


   sys/kern/kern_descrip.c |  3 +++
   sys/kern/vfs_vnops.c    | 36 ++++++++++++++++++++++++++++++++++++
   sys/sys/file.h          |  4 ++++
   3 files changed, 43 insertions(+)

[commit b3aada5bfdb9da22fdd33a67ca508074da6d1b5b]
Date: 2025-09-10
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: fcntl(F_SETFL): Don't unconditionally invoke FIONBIO and FIOASYNC
Review: The fcntl(F_SETFL) system call now only invokes FIONBIO and FIOASYNC ioctls when the associated flag state changes, rather than unconditionally. This prevents failures when character device drivers do not implement both ioctls, improving compatibility and reducing unexpected errors.
Body:

  Currently, F_SETFL always invokes FIONBIO and FIOASYNC ioctls on the
  file descriptor even if the state of the associated flag has not
  changed.  This means that a character device driver that implements
  non-blocking I/O but not async I/O needs a handler for FIOASYNC that
  permits setting the value to 0.  This also means that
  fcntl(fd, F_SETFL, fcntl(fd, F_GETFL)) can fail for a character device
  driver that does not handle both FIONBIO and FIOASYNC.  These
  requirements are not obvious nor well documented.

  Instead, only invoke FIONBIO and FIOASYNC if the relevant flag changes
  state.  This only requires a device driver to implement support for
  FIONBIO or FIOASYNC if it supports the corresponding flag.

  While here, if a request aims to toggle both F_NOBLOCK and F_ASYNC and
  FIOASYNC fails, pass the previous state of F_NONBLOCK to FIONBIO
  instead of always disabling non-blocking I/O and then possibly
  reverting the flag back to on in f_flags.

  Reviewed by:	mckusick, imp, kib, emaste
  Differential Revision:	https://reviews.freebsd.org/D52403

  (cherry picked from commit 3c152a3de42a7d077e8d19159b679c3fb7572820)


   sys/kern/kern_descrip.c | 32 +++++++++++++++++++-------------
   1 file changed, 19 insertions(+), 13 deletions(-)

[commit 645942dafaac8190459097b18eb16d9eff5148db]
Date: 2025-09-10
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ixgbe: Remove unused function ixgbe_is_media_cage_present
Review: Removes an unused function from the ixgbe driver, eliminating a compiler warning. No user-visible functionality is changed.
Body:

  Remove the unused function ixgbe_is_media_cage_present that
  generates a compiler warning.

  Signed-off-by: Yogesh Bhosale yogesh.bhosale@intel.com

  Reported by:	markj
  Differential Revision:	https://reviews.freebsd.org/D52467

  (cherry picked from commit 275f7d72ff6a71bbe46b4282a88f0ea9a24be22a)


   sys/dev/ixgbe/ixgbe_e610.c | 34 ----------------------------------
   1 file changed, 34 deletions(-)

[commit d19083e833d73319425650de938d087b8ca9f673]
Date: 2025-12-09
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Drivers.device
Subject: if_ovpn: use epoch to free peers
Review: The commit fixes a use-after-free race condition in the OpenVPN interface driver (if_ovpn) by ensuring peer references are protected within the network epoch. This prevents potential crashes or instability when handling received packets.
Body:

  Avoid a possible use-after-free in the rx path.
  ovpn_decrypt_rx_cb() calls ovpn_finish_rx() which releases the lock,
  but continues to use the peer.
  Ensure that the peer cannot be freed until we're sure all potential
  users have stopped using it (i.e. have left net_epoch).

  Reported by:	Kevin Day <kevin@your.org>
  MFC after:	1 week
  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit 5e2bbfe387f7eac8f802c4b6ad2114f0e17bb5f2)


   sys/net/if_ovpn.c | 14 ++++++++++++--
   1 file changed, 12 insertions(+), 2 deletions(-)

[commit 26702912e85700ec3fb761382d445df815789f92]
Date: 2025-12-15
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Userland.programs
Subject: rtsold: Validate entries in domain search lists
Review: The rtsold daemon now validates entries in domain search lists to prevent potential buffer overflows, addressing a security vulnerability (CVE-2025-14558).
Body:

  Reported by:	Kevin Day <kevin@your.org>
  Approved by:	so
  Security:	FreeBSD-SA-25:12.rtsold
  Security:	CVE-2025-14558

  (cherry picked from commit bf804f69dd94b3c98962618b4ad3b48a35bff2ff)


   usr.sbin/rtsold/rtsol.c | 46 ++++++++++++++++++++++++++++++++++++++++------
   1 file changed, 40 insertions(+), 6 deletions(-)

[commit 98d08b86b4e5b77fa1401d4a44ec3ecc7b13f1b0]
Date: 2025-11-18
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: The FreeBSD Foundation
Section: Userland.contrib
Subject: diff3: Use logical-not, not bitwise for booleans
Review: Fixes a bug in man:diff3[1] where boolean logic for incompatible options was incorrectly using bitwise operations, ensuring correct behavior when multiple incompatible options are used.
Body:

  And compare impcompat != 0 as it's actually an integer incremented on
  each use of one of the AeExX3 options.

  Reviewed by:	fuz
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53808

  (cherry picked from commit abcb80f46c2607fc16564ca87cc25f0908f29f99)
  (cherry picked from commit 56bdfd2d967ac104dc599bced168e1a200aa168e)


   contrib/diff/src/diff3.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 07681cb31b2440e990ad56cc8ccc52bf3537fb3d]
Date: 2025-11-18
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: diff3: Remove bespoke getopt.h
Review: The commit removes a custom getopt.h header file from diff3, which resolves a compiler warning but does not introduce any user-visible changes in functionality, behavior, or configuration.
Body:

  diff3's getopt.h included a function declaration without a prototype,
  which produces a compiler warning.  Just remove the bespoke getopt.h
  and use the system header.

  Reported by:	Mark Millard
  Reviewed by:	fuz
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53802

  (cherry picked from commit 38829592dc77e9ead4259785e0bfb93bd4c2fe34)
  (cherry picked from commit 437c77476e726e0414e460c973fd88fe812ce2b4)


   contrib/diff/lib/getopt.h | 176 ----------------------------------------------
   1 file changed, 176 deletions(-)

[commit 81b68da9d428c9e3fed8ed7e3115cb2c5fa6fa52]
Date: 2025-12-09
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: trim.8: minor update for manual page
Review: The man:trim[8] manual page now clarifies that the utility is not for trimming free blocks in populated file systems or ZFS pools.
Body:

  Further explain that trim(8) is not for trimming free blocks
  in populated file systems/ZFS pools, as people still take it wrong sometimes.

  (cherry picked from commit dbc4a1c69191909a7210cad6da46b755557d0d34)
  (cherry picked from commit b2f8d46d898fb50222aefca47d687a852c647b2f)


   usr.sbin/trim/trim.8 | 16 +++++++++++++---
   1 file changed, 13 insertions(+), 3 deletions(-)

[commit e5fbddef958d3ce81bf338def30a94c404762047]
Date: 2025-12-09
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: ofed/libibverbs: remove no longer needed local alloca.h
Review: Removes a local alloca.h header file from the libibverbs library, which is part of the OFED (OpenFabrics Enterprise Distribution) software stack.
Body:

  (cherry picked from commit 70edd3c126a591dec129958d3e103521de84746d)


   contrib/ofed/libibverbs/alloca.h     | 18 ------------------
   contrib/ofed/libibverbs/cmd.c        |  1 -
   contrib/ofed/libibverbs/compat-1_0.c |  1 -
   contrib/ofed/libibverbs/device.c     |  1 -
   4 files changed, 21 deletions(-)

[commit 0cfd862d4769471ac98a08792f959ae9166a1f90]
Date: 2025-12-09
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: ofed/libibverbs: remove strdupa() hack from config.h
Review: libibverbs config.h no longer includes a strdupa() hack, which may affect builds on systems where strdupa() is not available.
Body:

  (cherry picked from commit 6a75e3951506c12b42428a47710d07cadcdd723e)


   contrib/ofed/libibverbs/config.h | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 242f545e4e31b7fd49f4afac99531adebde55fce]
Date: 2025-12-04
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.libraries
Subject: libc/string: add strdupa(3) and strndupa(3)
Review: Adds strdupa(3) and strndupa(3) functions, which allocate memory on the stack for string duplication. This provides a convenient alternative to strdup(3) for temporary copies, but users must be aware of stack size limitations.
Body:

  (cherry picked from commit a98e5d78500193dc7aa352e1f60ac2c6529e2c38)


   include/string.h             | 28 ++++++++++++++++++++++++++++
   lib/libc/string/Makefile.inc |  4 +++-
   lib/libc/string/strdup.3     | 34 +++++++++++++++++++++++++++++++++-
   3 files changed, 64 insertions(+), 2 deletions(-)

[commit 2cfa240c0bdaaf039e849fd81f4dc46c1e702663]
Date: 2025-07-15
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: vfs_cache: Fix the SDT definition of vfs:fplookup:lookup:done
Review: Fixes a mismatch in DTrace SDT probe argument types for vfs:fplookup:lookup:done, ensuring correct data is reported when tracing.
Body:

  1. The definition lists struct nameidata as the type of the first
     argument. However, the actual probes always pass a variable of type
     struct nameidata* to SDT_PROBE3.
  2. The third argument (args[2]) is actually enum cache_fpl_status.

  Reviewed by:	markj
  Approved by:	markj (mentor)
  Fixes:		07d2145a1717 vfs: add the infrastructure for lockless lookup
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51315

  (cherry picked from commit 6567623f831daaffa67777d17780e8f424c1bb01)


   sys/kern/vfs_cache.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 323a47103c2b466099fb72212bf7e3507a856a43]
Date: 2025-04-28
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: cross-build: Workaround system-provided strchrnul on macOS 15.4+
Review: This commit is a cross-build workaround for macOS 15.4+ and does not affect FreeBSD runtime behavior or user-visible features.
Body:

  macOS added a native strchrnul in 15.4.  There is not an easy way to
  detect it at compile time, so use a macro to rename our local inline
  version to avoid conflicts while also forcing its use during
  bootstrap.  The local version can be removed once macOS versions older
  than 15.4 are no longer supported as build hosts.

  Co-authored by:	jrtc27
  Reported by:	kib
  Reviewed by:	jrtc27
  Differential Revision:	https://reviews.freebsd.org/D49893

  (cherry picked from commit 4e2616b74cb7eed921aa10fb776cdc2d5fd4e42f)


   tools/build/cross-build/include/mac/string.h | 7 +++++--
   1 file changed, 5 insertions(+), 2 deletions(-)

[commit d37b3562e701ab1583ea7ae47b9bd3214ef39d37]
Date: 2025-12-08
Score: 5
Status: proposed(include=no,score=0)
Sponsor: 
Section: undecided
Subject: imgact_elf: Fix off-by-one in note size check
Review: Error, not correct JSON Failed to parse the request body as JSON: messages[1].content: invalid escape at line 1 column 5089
Body:

  Prior to c86af2cc4cd1 ("imgact_elf: Check note body sizes"), this was
  note_name + n_namesz >= note_end, which checks that there is at least
  one byte after the unpadded name (which could be either padding or
  data), and given our notes always have data with them this was fine.
  However, once we started checking the padded name (note that "FreeBSD\0"
  is already a multiple of 4 bytes, so has no padding) and data, this
  turned into checking that there is at least one byte after the unpadded
  data, and since our ELF notes already have a multiple of 4 bytes for
  their data and therefore have no padding, this means that we are now
  checking that there is at least one byte after the ELF note, which is
  not going to be the case for the last ELF note. Instead, switch this to
  a strict greater than, as should be used when comparing one-past-the-end
  pointers, which both sides of the inequality are.

  For executables, this was generally not a problem in reality, since the
  last of our ELF notes is NT_FREEBSD_NOINIT_TAG, which isn't read by the
  kernel. However, ld-elf.so.1 (and libcompat variants), like shared
  libraries, only has NT_FREEBSD_ABI_TAG, which meant the kernel did not
  see this ELF note when directly executing it (e.g. as done by ldd), and
  on RISC-V this is the only branding present, so doing so would fail with
  ENOEXEC. This does also mean on non-RISC-V direct exec ld-elf.so.1 runs
  with the wrong p_osrel, but given it sets kern.proc.osrel.PID to the
  executable's NT_FREEBSD_ABI_TAG that it loads, this probably doesn't
  matter in practice.

  PR:		291446
  Reported by:	bdragon
  Tested by:	bdragon
  Fixes:		c86af2cc4cd1 ("imgact_elf: Check note body sizes")
  MFC after:	3 days

  (cherry picked from commit 5d58198ccc2b562098ee5fc4898013622b32b065)


   sys/kern/imgact_elf.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 34671bb50983ccd21faddb5e33c02454c9065995]
Date: 2025-12-06
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: freebsd-update: Mention upgrading packages, not just ports
Review: The freebsd-update script now mentions upgrading packages before upgrading ports, reflecting common usage patterns.
Body:

  These days most end users are likely using pre-built packages, not
  locally-built ports. Thus be sure to mention this as an important case,
  and put it ahead of ports.

  Reviewed by:	emaste
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D42968

  (cherry picked from commit ced74610217ff0be071e4614c64a4ff66c40bc6b)


   usr.sbin/freebsd-update/freebsd-update.sh | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 3300572ffcc679457995c8ec4d9eb354cf12defc]
Date: 2025-08-22
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Ports.packaging
Subject: bsd.compat.mk: Honour XSTRIPBIN for lib32
Review: The build system now honors XSTRIPBIN for lib32 builds, ensuring correct strip tool usage when cross-building FreeBSD with lib32 support on non-FreeBSD hosts.
Body:

  Currently we only honour XNM and XOBJCOPY, but XSTRIPBIN is important
  during install. Otherwise we end up using STRIPBIN for the host, not the
  target, which is normally the same, but may not be, especially on
  non-FreeBSD systems. In particular, cheribuild will build FreeBSD with
  STRIPBIN=/usr/bin/strip XSTRIPBIN=strip (with the latter referring to
  the bootstrap strip in PATH), which breaks for WITH_LIB32 when the
  host's /usr/bin/strip is unable to process the lib32 binaries (e.g.
  building arm64 FreeBSD's lib32 on an amd64 GNU/Linux system).

  MFC after:	1 week

  (cherry picked from commit ad13dc1ece2fe4a6192bceffea4a868ba6a2e0e2)


   share/mk/bsd.compat.mk | 1 +
   1 file changed, 1 insertion(+)

[commit 123a24445686afb0c2742df53d900098d1227526]
Date: 2025-08-22
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: Makefile.libcompat: Use same PATH for _lc_build-tools as _build-tools
Review: Fixes a build issue for lib32 ncurses when using GNU sed on Linux hosts, ensuring the correct sed is used.
Body:

  Without this, we end up with just the host's tools in PATH during
  _lc_build-tools. In particular, sed on GNU/Linux systems will be GNU
  sed, whose -i option has different semantics, and this causes the lib32
  build of ncurses to fail trying to create curses.h with:

    sed: can't read s|...|...|g: No such file or directory

  This has always been a bug in Makefile.libcompat but previously it
  didn't end up mattering; this is the first known case.

  Fixes:		1cc020eba69e ("ncurses: Provide reproducible paths")
  MFC after:	1 week

  (cherry picked from commit e84374d38bc1690eb62de75874348b1cfa21ea93)


   Makefile.libcompat | 1 +
   1 file changed, 1 insertion(+)

[commit 362eb7d340140ba02724e275d8d5ff2e2dcdaf90]
Date: 2025-07-11
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: rtld-elf: Delete unused RELOC_ALIGNED_P copies
Review: The commit removes unused internal code in the dynamic linker (rtld) for aarch64 and riscv architectures. This change has no user-visible impact as it only cleans up dead code.
Body:

  This was copied from arm to aarch64 to riscv, but only arm uses it.

  MFC after:	1 week

  (cherry picked from commit 02d06043ba88f931f9debd5aa519fc303ca70d11)


   libexec/rtld-elf/aarch64/reloc.c | 7 -------
   libexec/rtld-elf/riscv/reloc.c   | 7 -------
   2 files changed, 14 deletions(-)

[commit d9bff46977de2ffa67d2876cca6c31ab6ff9b3f1]
Date: 2025-07-10
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: sys: Various whitespace style(9) fixes for sys/elf_common.h
Review: Internal whitespace style cleanup with no user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 22ae840b9f0ff290cb08edacf975a99d264d3a0d)


   sys/sys/elf_common.h | 20 ++++++++++----------
   1 file changed, 10 insertions(+), 10 deletions(-)

[commit a1fed6a29cb1410b76d771f9699d8f26c4b01ebb]
Date: 2025-07-10
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: sys: Sync RISC-V relocations
Review: The commit adds new RISC-V relocation types to elf_common.h, which may affect binary compatibility and toolchain support for RISC-V architecture.
Body:

  MFC after:	1 week

  (cherry picked from commit 65bd6c7acd1fba38ce0b234d5d777a2ebad7e807)


   sys/sys/elf_common.h | 11 ++++++++++-
   1 file changed, 10 insertions(+), 1 deletion(-)

[commit d13a8521247f10deb80cff652053fd74ebd9878b]
Date: 2025-07-10
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sys: Delete stale comments in sys/elf_common.h
Review: The commit removes outdated comments in an internal header file without any user-visible impact.
Body:

  Originally the relocations for RISC-V were partitioned into dynamic and
  static (with those that are both being classed as dynamic), but they
  were packed next to each other, and so as new relocations were added
  they were allocated sequentially, at the end of the static block, even
  if really dynamic, R_RISCV_IRELATIVE being the first such case (and only
  one we currently have a definition for). Delete the misleading comments.

  Fixes:		4b88ccbc79cc ("Sync relocation definitions")
  MFC after:	1 week

  (cherry picked from commit d26f481bcdfec9354614ccc0f7f694bd7bcc5a6c)


   sys/sys/elf_common.h | 3 ---
   1 file changed, 3 deletions(-)

[commit dccbc59475ced25a04b8bd8a58b1ceed46635857]
Date: 2025-07-10
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.contrib
Subject: share: Delete bitrotted make_*_driver.sh scripts
Review: The bitrotted make_*_driver.sh example scripts are removed from share/examples/drivers. Developers looking for driver templates will no longer find these outdated scripts.
Body:

  These scripts have not seen the necessary changes to keep them up to
  date with current KPIs and coding practices. They use I/O ports directly
  rather than any bus abstractions, use i386 (which is on the way out for
  kernel configs) as the architecture of choice for generated kernel
  configs, use ISA KPIs, use INTR_TYPE_FAST (renamed in 2000 to INTR_FAST
  and removed in 2011), and likely have other issues too that render them
  more harm than good for the uninitiated developer looking for a driver
  template. If anyone wants to invest time in modernising them they can do
  so and bring them back, but for now delete them.

  Reviewed by:	cperciva, imp, emaste
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50468

  (cherry picked from commit 8f0a6a9aadb1fe4ce87345c6d2fbb2d2b6f6cedf)


   ObsoleteFiles.inc                            |   6 +
   share/examples/Makefile                      |   7 -
   share/examples/drivers/README                |  42 ---
   share/examples/drivers/make_pseudo_driver.sh | 435 ---------------------------
   tools/build/mk/OptionalObsoleteFiles.inc     |   4 -
   5 files changed, 6 insertions(+), 488 deletions(-)

[commit 02cb2f8094baab0b4299e5fcd1694d9193be14b3]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Userland.libraries
Subject: Revert "rtld: fix allocate_module_tls() variant I fallback to static allocation"
Review: The dynamic linker (man:rtld[1]) reverts a previous change that caused incorrect TLS address calculation for dynamically loaded shared objects on non-x86 architectures. This fixes a discrepancy where General Dynamic TLS accesses and dlsym(3) returned incorrect addresses, while Initial Exec accesses worked correctly.
Body:

  This was applying a NetBSD fix to FreeBSD. However, the original code
  was correct for FreeBSD. NetBSD's obj->tlsoffset is relative to the end
  of the TCB, not the TCB itself, whilst ours is relative to the TCB[1]
  itself. For example, our allocate_tls uses (char *)tcb + obj->tlsoffset
  for the memcpy and memset calls.

  Without this reverted, for dynamically loaded shared objects, Initial
  Exec accesses to TLS variables on variant I architectures (non-x86) use
  the correct address, whilst General Dynamic and dlsym(3) use the
  incorrect address (TLS_TCB_SIZE past the start). Note that, on arm64,
  LLVM only supports TLSDESC (including LLD) and TLSDESC will use the
  static resolver if the variable ends up allocated to the static TLS
  block, even in the presence of dlopen(3), so only dlsym(3) shows the
  discrepancy there.

  Whilst here, add a comment to explain this difference to try and avoid
  the same mistake being made in future.

  [1] In the case of variant II, it's the amount to subtract, so still
      positive

  This reverts commit e9a38ed2fa61fd264a80f24ceb35f39b0ac6463d.

  Reviewed by:	kib (prior version)
  Fixes:		e9a38ed2fa61 ("rtld: fix allocate_module_tls() variant I fallback to static allocation")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50565

  (cherry picked from commit ccfb1c50e45dbb7fcadf7e1932f63cf1702ef13a)


   libexec/rtld-elf/rtld.c | 5 ++++-
   1 file changed, 4 insertions(+), 1 deletion(-)

[commit d07b82ecbe64e29668b457019081846518c0e4b5]
Date: 2025-05-28
Score: 5
Status: proposed(include=no,score=35)
Sponsor: 
Section: undecided
Subject: libc/riscv: Fix initial exec TLS mode for dynamically loaded shared objects
Review: Fixes initial exec TLS mode for dynamically loaded shared objects on RISC-V, ensuring correct thread-local storage handling in programs not linked against libthr.
Body:

  The offset here is relative to the TCB, not whatever the thread pointer
  points to, so as with powerpc and powerpc64 we need to account for that.
  However, rather than using hard-coded offsets as they did, due to
  predating machine/tls.h, we can just re-use _tcb_get().

  Note that if libthr is used, and its initialiser has been called, it
  will take a different path that uses _get_static_tls_base, which works
  just fine on riscv (adding the offset to thr->tcb). This only affects
  programs that aren't linked against libthr (or that are but manage to
  dlopen before the initialiser is called, if that's even possible).

  In future this code should be made MI by just reusing _tcb_get() and
  checking the TLS variant (since the offset here is positive even for
  variant II, where it should be subtracted), but this is a targeted fix
  that makes it clear what's changing.

  Reviewed by:	kib
  Fixes:		5d00c5a6571c ("Fix initial exec TLS mode for dynamically loaded shared objects.")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50564

  (cherry picked from commit 0e3dbc64d9f6c95cbb16dba60a32136ae116dada)


   lib/libc/riscv/static_tls.h | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit acf47e5d105ef05ea25b635672417a294a933e13]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Userland.libraries
Subject: rtld-elf/riscv: Don't allocate static TLS for dynamic TLS relocations
Review: The RISCV dynamic linker no longer incorrectly allocates static TLS for dynamic TLS relocations, which avoids unnecessary static TLS consumption and follows the correct ABI.
Body:

  Provided you don't run out of extra static TLS space this should work,
  but it's wholly unnecessary and not how things are supposed to be done.
  Only static TLS relocations should allocate static TLS.

  Reviewed by:	kib
  Fixes:		4b1859c0e943 ("Add support for RISC-V architecture.")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50563

  (cherry picked from commit 03801d449a3731cb643a51625c8c4d5d07b2e54c)


   libexec/rtld-elf/riscv/reloc.c | 17 -----------------
   1 file changed, 17 deletions(-)

[commit 8e8ae9ac48cc59615dd83d2b5fe1368036ff8808]
Date: 2025-05-06
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: rtld-elf: Fix executable's TLS module index for direct exec
Review: The dynamic linker now correctly assigns TLS module index 1 for directly executed executables, fixing a run-time failure on RISC-V and MIPS where __tls_get_addr could not find the module.
Body:

  For direct exec mode we reuse map_object, but tls_max_index is
  initialised to 1. As a result, the executable ends up being assigned
  module 2 (and the generation is pointlessly incremented, unlike in
  digest_phdr for the normal case). For most architectures this is
  harmless, since TLS linker relaxation will optimise General Dynamic
  accesses to Initial Exec or Local Exec for executables, but on RISC-V
  this relaxation does not exist, yet the linker will initialise the
  tls_index in the GOT with module 1, and at run time the call to
  __tls_get_addr will fail with:

      ld-elf.so.1: Can't find module with TLS index 1

  Fix this by making map_object use 1 for obj->tlsindex when it's loading
  the main executable, and don't bother to increment tls_dtv_generation
  either, matching digest_phdr (though that one is harmless).

  (Note this also applies to MIPS on stable/13)

  Reviewed by:	kib
  Fixes:		0fc65b0ab82c ("Make ld-elf.so.1 directly executable.")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50186

  (cherry picked from commit a08d92def20a41243d4afc97cf4a2124be5386b9)


   libexec/rtld-elf/map_object.c | 10 +++++++---
   libexec/rtld-elf/rtld.c       |  4 ++--
   libexec/rtld-elf/rtld.h       |  2 +-
   3 files changed, 10 insertions(+), 6 deletions(-)

[commit f1344d0aa816d0a2e9b316d4bd28b5f478b5d3da]
Date: 2025-05-06
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Userland.libraries
Subject: rtld-elf: Fix UB for direct exec with no extra rtld arguments
Review: The dynamic linker (rtld) no longer exhibits undefined behavior when executing directly with no extra arguments, which previously caused a segmentation fault on RISC-V architectures.
Body:

  If no extra rtld arguments are provided, rtld_argc will be 1 (for
  argv[0] and so we are shifting the entire memory range down by a single
  pointer. However, unlike argv and envp, auxp's entries are two pointers
  in size, not one, and so in this case the source and destination
  overlap, meaning simple assignment is UB (C99 6.5.16.1p3). On many
  architectures this ends up being harmless as the compiler will emit
  double machine word loads and stores, or if it splits them it may still
  schedule them such that it works in this case, but our RISC-V baseline
  does not include such instructions and LLVM ends up picking a schedule
  that copies the second word before the first word, thereby replacing the
  first word with a copy of the second word. This results in direct exec
  mode segfaulting on RISC-V when given no arguments.

  Fix this by using a temporary in the source and let the compiler safely
  elide its use.

  Reviewed by:	kib
  Fixes:		0fc65b0ab82c ("Make ld-elf.so.1 directly executable.")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50185

  (cherry picked from commit 2b04ba6e08b983d8756552286846059507bca7a3)


   libexec/rtld-elf/rtld.c | 9 +++++++--
   1 file changed, 7 insertions(+), 2 deletions(-)

[commit 79b0a953ada4c516c43f163c51d3f083da666d59]
Date: 2025-05-06
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: rtld-elf: Fix dl_iterate_phdr's dlpi_tls_data for PowerPC and RISC-V
Review: The dl_iterate_phdr function now returns correct dlpi_tls_data values for PowerPC and RISC-V architectures, fixing a bug where TLS block pointers were incorrectly offset.
Body:

  The implementation of dl_iterate_phdr abuses tls_get_addr_slow to get to
  the start of the TLS block, inlining the implementation of
  __tls_get_addr as if the tls_index's ti_offset were 0 (historically it
  called __tls_get_addr itself but changed due to locking issues). For
  most architectures, tls_index's ti_offset (relocated by DTPOFF/DTPREL
  for GOT entries) is just the offset within that module's TLS block.
  However, for PowerPC and RISC-V, which have a non-zero TLS_DTV_OFFSET
  and thus are designed assuming DTV entries are biased by that value,
  ti_offset normally has TLS_DTV_OFFSET pre-subtracted, but it's
  __tls_get_addr's responsibility to compensate for that. By using an
  offset of zero here, tls_get_addr_slow will return a pointer to the
  start of the TLS block itself, so by adding TLS_DTV_OFFSET we will point
  TLS_DTV_OFFSET past the module's TLS block.

  Fix this by removing the extra bias (the alternative would be to pass
  -TLS_DTV_OFFSET and keep the addition, which would more closely follow
  what __tls_get_addr does, but this is more direct).

  (Note this also applies to MIPS on stable/13)

  Reviewed by:	kib
  Fixes:		d36d68161517 ("rtld dl_iterate_phdr(): dlpi_tls_data is wrong")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50184

  (cherry picked from commit c02aaba1b4549c1c3b1481f7c935f6cc80b98e8d)


   libexec/rtld-elf/rtld.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e73457d194b000a53218a77564730e87b84f66af]
Date: 2025-05-06
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Userland.libraries
Subject: rtld-elf: Fix dlsym(3) for TLS symbols on PowerPC and RISC-V
Review: The dlsym(3) function now correctly resolves TLS symbols on PowerPC and RISC-V architectures, fixing a misalignment issue that could cause incorrect pointer values.
Body:

  The implementation here is meant to mirror what a GOT entry for the
  given symbol would use for ti_offset. However, on PowerPC and RISC-V,
  TLS_DTV_OFFSET is non-zero, and so the GOT entries are normally biased
  by this, but we fail to do so here. As a result we end up getting a
  pointer TLS_DTV_OFFSET past where the variable actually is.

  (Note this also applies to MIPS on stable/13)

  Reviewed by:	kib
  Fixes:		5ceeeba90c6c ("Import DragonFly BSD commit")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50183

  (cherry picked from commit 8ad9cec3a2cc643020a286ee68f70eb01225fbdd)


   libexec/rtld-elf/rtld.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 11d41989cc62c8812c5f6140d1c1877575f09aad]
Date: 2025-05-06
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.libraries
Subject: libc: Fix dl_iterate_phdr's dlpi_tls_data for PowerPC and RISC-V
Review: The dl_iterate_phdr function now returns correct dlpi_tls_data for statically-linked binaries on PowerPC and RISC-V architectures.
Body:

  The implementation of dl_iterate_phdr for statically-linked binaries
  abuses __tls_get_addr to get to the start of the TLS block. For most
  architectures, tls_index's ti_offset (relocated by DTPOFF/DTPREL for GOT
  entries) is just the offset within that module's TLS block. However, for
  PowerPC and RISC-V, which have a non-zero TLS_DTV_OFFSET and thus are
  designed assuming DTV entries are biased by that value, ti_offset
  normally has TLS_DTV_OFFSET pre-subtracted. By using an offset of zero
  here we end up getting a pointer TLS_DTV_OFFSET past what __tls_get_addr
  would return for the first TLS variable.

  Fix this by using -TLS_DTV_OFFSET to mirror what the General Dynamic GOT
  entry for the first TLS variable would be.

  (Note this also applies to MIPS on stable/13)

  Reviewed by:	kib
  Fixes:		dbd2053026a6 ("libc dl_iterate_phdr(): dlpi_tls_data is wrong")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50182

  (cherry picked from commit 78b99f369f75f5df49b506ae750659b07ab34362)


   lib/libc/gen/dlfcn.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 2ef0ba80e0b51653e62cfd5623e7f6b844399440]
Date: 2025-05-06
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: libc: Don't bias DTV entries by TLS_DTV_OFFSET
Review: The commit fixes a TLS (Thread Local Storage) offset calculation bug for static binaries on RISC-V (and MIPS on stable/13) that could cause incorrect TLS variable access when using -fPIC compilation. This resolves a regression introduced by a previous implementation of __tls_get_addr for static binaries.
Body:

  PowerPC and RISC-V have a non-zero TLS_DTV_OFFSET. The intent behind
  this in the design is that DTV entries are biased by this, as are (in
  the other direction) the DTPOFF/DTPREL entries in the GOT. However, this
  is pretty pointless in practice, and both FreeBSD and glibc's run-time
  linkers don't bother to bias DTV entries, instead just adding the bias
  back on at the end in __tls_get_addr. In libc we also have a minimal
  implementation of this for statically-linked binaries, which is only in
  practice used for code compiled with -fPIC (not -fPIE) that is also
  linked without TLS relaxation support. PowerPC supports linker
  relaxation for TLS sequences, so this likely never gets hit there, but
  RISC-V does not, and so easily does if you compile an executable with
  -fPIC. In this implementation we add TLS_DTV_OFFSET both to the DTV
  entries in __libc_allocate_tls and to the result of __tls_get_addr,
  meaning that any TLS accesses using the General Dynamic model in static
  binaries on RISC-V end up off by 0x800.

  Historically this also did not matter as __tls_get_addr was a stub that
  always returned NULL, so although 6e16d0bc4376 ("Rework alignment
  handling in __libc_allocate_tls() for Variant I of TLS layout.") added
  this DTV implementation, nothing actually read the entries. However, now
  it's a real implementation, and dl_iterate_phdr also now relies on it,
  it does matter.

  Fix this by not biasing the DTV entries, just like RTLD. We could
  instead stop adding TLS_DTV_OFFSET in __tls_get_addr, but being
  consistent between libc and RTLD seems better.

  (Note this also applies to MIPS on stable/13)

  Reviewed by:	kib
  Fixes:		ca46b5698e8a ("libc: implement __tls_get_addr() for static binaries")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50181

  (cherry picked from commit d04c93a2adccb4c3a17f7391126a9246326e3fea)


   lib/libc/gen/tls.c | 9 ++++-----
   1 file changed, 4 insertions(+), 5 deletions(-)

[commit a5ccd406ddc5b73060e154495745651646f1dcf5]
Date: 2025-02-04
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: riscv: Fix and generalise saving TP (PCPU pointer) whilst in userspace
Review: The commit fixes a kernel-level alignment and stack allocation issue for RISCV that could affect process creation and exception handling, but the change is internal and does not introduce user-visible features, removals, or configuration impacts.
Body:

  In cpu_fork, we allocate sizeof(struct pcb) + sizeof(struct trapframe)
  space on the stack, then round it for stack alignment. This not only
  fails to include the space needed for TP but also doesn't round up the
  trapframe allocation to be stack-aligned, yet TF_SIZE does, as is the
  expectation of fork_trampoline and cpu_exception_handler. Given that
  sizeof(struct pcb) + sizeof(struct trapframe) is a multiple of 16, this
  causes the saved TP to be stored in the PCB's pcb_sp (the intended
  trapframe padding aliasing pcb_ra), which is probably harmless in
  practice as the PCB isn't expected to be current, but definitely not
  intended.

  In cpu_thread_alloc, we do include the 8 bytes for TP and then stack
  align that. This again fails to include the padding for trapframe as
  present in TF_SIZE, but sizeof(struct pcb) + sizeof(struct trapframe)
  happens to be a multiple of 16, as above, so adding 8 then rounding to
  stack alignment (16) includes an extra 8 bytes of padding, giving the
  right result for the wrong reason (and could be broken by future struct
  growth).

  Extract the calculation into a shared function that rounds correctly
  regardless of the struct layouts. Also introduce a new struct kernframe
  to encapsulate and clearly document this shared state rather than using
  magic constants, and also enable it to be easily extended in future, as
  we intend to do downstream in CheriBSD.

  Reviewed by:	jhb
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D48799

  (cherry picked from commit 21c534b9f5d5de07137f9a42e016876dd6ae66c1)


   sys/riscv/include/frame.h    | 14 ++++++++++++++
   sys/riscv/riscv/exception.S  |  4 ++--
   sys/riscv/riscv/genassym.c   |  4 +++-
   sys/riscv/riscv/swtch.S      |  2 +-
   sys/riscv/riscv/vm_machdep.c | 35 ++++++++++++++++++++++++-----------
   5 files changed, 44 insertions(+), 15 deletions(-)

[commit 645c576942c9e069974a4f8fe5bb7132e8182085]
Date: 2024-12-17
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: ofw: Fix inverted bcmp in ofw_bus_node_status_okay
Review: The ofw_bus_node_status_okay function now correctly identifies nodes with status "ok" in the OpenFirmware device tree, fixing a regression that could affect hardware detection on systems using OpenFirmware.
Body:

  Otherwise this matches any two-character status except for ok.

  Fixes:		e5e94d2de987 ("Expand OpenFirmware API with ofw_bus_node_status_okay method")
  MFC after:	1 week

  (cherry picked from commit e1060f6dfd80b34cab6d439bf7420ad686ddc8f1)


   sys/dev/ofw/ofw_bus_subr.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 753dd37ab9519f181ca1272aa52aa5c733419f81]
Date: 2024-12-09
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Drivers.device
Subject: gic_v3: Correctly handle GICC GIGR Base Address case
Review: The GICv3 driver now correctly handles GICC GICR Base Address cases, preventing potential system instability on platforms like Qualcomm Snapdragon X Elite where the driver could previously walk off region mappings.
Body:

  When using the GICR Base Address field from each GICC structure instead
  of GICR structures, the field gives the address of a single
  redistributor page. However, that does not mean that they are not
  contiguous, and so GICR_TYPER.Last could be clear on them. Thus we must
  ignore GICR_TYPER.Last in this case and always treat each region as
  having a single page. Normally we'd do that as a result of checking
  against the rman's size (though that's a rather roundabout and iffy way
  of achieving it), but for whatever reason this is bigger on the Qualcomm
  Snapdragon X Elite (I assume the MADT reports GICv4 but TYPER doesn't
  report VLPIS and so there is a mismatch between the rman size and the
  stride used) and we end up walking off the region's mapping.

  Reviewed by:	andrew, phk
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D47560

  (cherry picked from commit f8c90b704189c94275d22d7cc204d1d74e821d86)


   sys/arm64/arm64/gic_v3.c      | 2 +-
   sys/arm64/arm64/gic_v3_acpi.c | 1 +
   sys/arm64/arm64/gic_v3_var.h  | 6 ++++++
   3 files changed, 8 insertions(+), 1 deletion(-)

[commit 1327039aaf1626e646516fea2c8214ceb298fe8a]
Date: 2024-11-21
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: hexdump.3: Add missing LIBRARY section
Review: The commit adds a missing LIBRARY section to the man:hexdump[3] manual page, improving consistency with other libutil man pages.
Body:

  All the other libutil section 3 manpages document this, and although
  it's heavily implied by the libutil.h header in the synopsis, we should
  still be explicit and consistent.

  PR:		280078
  Reviewed by:	jrtc27
  MFC after:	1 week

  (cherry picked from commit 169e23d41f8ff16244f4fb04924fdc9828325dce)


   lib/libutil/hexdump.3 | 2 ++
   1 file changed, 2 insertions(+)

[commit 735452dad4bf6275533e1d26fd098fbdbffd4d42]
Date: 2024-11-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sys/cdefs.h: Add comments to make #if/#else/#endif triple more obvious
Review: Only adds comments to improve code readability; no user-visible impact.
Body:

  This block has a lot of nesting, not helped by two adjacent nested
  blocks involving _POSIX_C_SOURCE, with only the inner one commented,
  looking like it's the end of the outer one. Comment the outer one as
  well so it's not quite so hard to figure out.

  MFC after:	1 week

  (cherry picked from commit 7a3af393d8ac2dfe72d24fe401344b60c4f87866)


   sys/sys/cdefs.h | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit e4f4a057772b1d5117bd54e52b8a124f7a2c4ac7]
Date: 2024-10-19
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libc/csu: Unify INIT_RELOCS across architectures
Review: Internal refactoring of libc startup code across architectures; no user-visible changes.
Body:

  Some architectures don't need any arguments, whilst others need auxargs,
  which they get by passing in env thanks to INIT_RELOCS referencing the
  local variable in __libc_start1(_gcrt) by name. This is unnecessarily
  confusing, fragile (one has to look at INIT_IRELOCS's definition to see
  that it uses env) and duplicates code between architectures.

  Instead, implement it more like rtld-elf. Each architecture provides an
  ifunc_init that takes the auxargs directly, and those that don't need it
  can just ignore it.

  Reviewed by:	kib
  MFC after:	1 month
  Differential Revision:	https://reviews.freebsd.org/D47188

  (cherry picked from commit 9684658e35ab033c79e0519e3681d9a194976b71)


   lib/libc/csu/aarch64/Makefile.inc    |  3 +--
   lib/libc/csu/aarch64/reloc.c         |  7 +++++++
   lib/libc/csu/amd64/Makefile.inc      |  3 +--
   lib/libc/csu/amd64/reloc.c           |  4 +++-
   lib/libc/csu/arm/Makefile.inc        |  3 +--
   lib/libc/csu/i386/Makefile.inc       |  3 +--
   lib/libc/csu/i386/reloc.c            |  4 +++-
   lib/libc/csu/libc_start1.c           | 28 ++++++++++++++++++++--------
   lib/libc/csu/powerpc/Makefile.inc    |  3 +--
   lib/libc/csu/powerpc64/Makefile.inc  |  3 +--
   lib/libc/csu/powerpc64/reloc.c       |  9 +--------
   lib/libc/csu/powerpcspe/Makefile.inc |  3 +--
   lib/libc/csu/riscv/Makefile.inc      |  3 +--
   lib/libc/csu/riscv/reloc.c           |  9 +--------
   14 files changed, 43 insertions(+), 42 deletions(-)

[commit 40200fae91243c772d444c8338ef870d3e7c46ab]
Date: 2024-10-18
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: depend-cleanup.sh: Clean up after riscv static binary IFUNC addition
Review: The commit addresses a build dependency issue for riscv static binary IFUNC, which is an internal build system fix without direct user-visible impact.
Body:

  reloc.c is conditionally included by libc_start1.c so existing builds
  don't feature it in the .depend file and won't know they need to rebuild
  libc_start1.c.

  MFC after:	1 week

  (cherry picked from commit d41a40f484826e90ed78dce5f006712b0eeaf501)


   tools/build/depend-cleanup.sh | 16 ++++++++++++++++
   1 file changed, 16 insertions(+)

[commit a06143795a22d8d99f1736656eaff754e81d8ab1]
Date: 2024-10-18
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: libc/csu: Support IFUNCs on riscv
Review: Static binaries on RISC-V now support IFUNC (indirect function) resolution, enabling architecture-specific optimizations in statically linked executables.
Body:

  When adding support to rtld-elf I neglected the fact that static
  binaries can have IFUNCs. Add support for this too.

  Fixes:		729d2b16b74f ("rtld-elf: Support IFUNCs on riscv")
  MFC after:	1 week

  (cherry picked from commit 1363acbf25de4c36e183cfa0b0e801d4dd9bf2ad)


   lib/libc/csu/riscv/Makefile.inc |  4 +--
   lib/libc/csu/riscv/reloc.c      | 63 +++++++++++++++++++++++++++++++++++++++++
   2 files changed, 65 insertions(+), 2 deletions(-)

[commit 6559b303a34b60b2cc2836bc376bec27f3df5b8a]
Date: 2024-10-18
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.contrib
Subject: lib/clang: Commit cleaned-up workaround for building on RISC-V
Review: The commit adds a workaround for building LLVM natively on RISC-V, resolving a long-standing static linking issue with --gc-sections that previously hindered bootstrap builds.
Body:

  There is a long-standing issue on RISC-V around --gc-sections when
  statically linking, which affects the bootstrap build of LLVM. Since
  fixing this properly has remained a TODO for years, commit the
  workaround with documentation so that building natively from source
  works out of the box.

  PR:		258358
  MFC after:	1 week

  (cherry picked from commit 7aa6667623bef7306009d50a571e5e8c7766a174)


   lib/clang/llvm.build.mk | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit 0e3963317e14ec86d0a597c91af36f043d583363]
Date: 2024-09-10
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: kldxref: Don't warn and skip file if no relocations are found
Review: The commit removes a warning when kldxref processes files with no relocations, which affects riscv64 kernel builds. This change prevents unnecessary warnings during kernel module linking.
Body:

  This case is hit for the kernel itself on riscv64, and did not used to
  be checked. Since the code here can already handle missing Elf_Rel
  and/or Elf_Rela just delete the check.

  Reviewed by:	jhb, imp
  Fixes:		0299afdff145 ("kldxref: Make use of libelf to be a portable cross tool")
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D46517

  (cherry picked from commit 05996f453de2f2c7a03437a492d9d53831fccb2e)


   usr.sbin/kldxref/ef.c | 5 -----
   1 file changed, 5 deletions(-)

[commit a39564b58f9253791446aa2709ae48b9bfdb7152]
Date: 2024-09-02
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.programs
Subject: gpart: Add u-boot-env alias for U-Boot's environment GPT partition UUID
Review: The gpart utility now recognizes the 'u-boot-env' alias for U-Boot's environment GPT partition UUID, allowing platform-independent identification of these partitions.
Body:

  This is a platform-independent UUID, and this is the name U-Boot uses.

  MFC after:	1 week

  (cherry picked from commit b162fc3f3094c50c8ed47ab50981c5448cf0052c)


   lib/geom/part/gpart.8      | 5 +++++
   sys/geom/part/g_part.c     | 1 +
   sys/geom/part/g_part.h     | 1 +
   sys/geom/part/g_part_gpt.c | 2 ++
   sys/sys/disk/gpt.h         | 3 +++
   5 files changed, 12 insertions(+)

[commit c700f3b2529833cc0de9d2ca461bee0e44afb9cc]
Date: 2024-08-22
Score: 5
Status: proposed(include=no,score=35)
Sponsor: 
Section: undecided
Subject: riscv: Add machine/ifunc.h corresponding to rtld-elf's resolver interface
Review: Adds a new header file sys/riscv/include/ifunc.h for the RISC-V architecture, providing the resolver interface for indirect functions (ifuncs) used by the runtime linker.
Body:

  Reviewed by:	kib, mhorne
  MFC after:	1 month
  Differential Revision:	https://reviews.freebsd.org/D46279

  (cherry picked from commit 8afae0caf4c4816eb56b732fcd1a4b185e86098a)


   sys/riscv/include/ifunc.h | 49 +++++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 49 insertions(+)

[commit f61eabc1f4cffaedb733262a8fd07f3011f6d827]
Date: 2024-08-22
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.libraries
Subject: rtld-elf: Support IFUNCs on riscv
Review: The dynamic linker (man:rtld[1]) now supports IFUNC (indirect function) resolution on RISC-V, enabling architecture-specific optimizations for libraries that use IFUNCs.
Body:

  GNU/Linux has historically had the following two resolver prototypes:

    1. Elf_Addr(uint64_t, void *)
    2. Elf_Addr(uint64_t, void *, void *)

  For the former, AT_HWCAP is passed in the first argument, and NULL in
  the second. For the latter, AT_HWCAP is still passed, and the second
  argument is a pointer to their home-grown __riscv_hwprobe function.
  Should they want to use the third argument in future, they'll have to
  introduce yet another prototype to allow for later expansion, and then
  all users will have to check whether the second argument is NULL to know
  if the third argument really exists. This is all rather silly and will
  surely prove fun in the face of type-checking CFI.

  Instead, be like arm64 and just define all 8 possible general purpose
  register arguments up front. To naive source code that forgets non-Linux
  OSes exist this will be compatible with prototype 1 above, since the
  second argument will be 0 and it won't look further (though should we
  start using the second argument for something that wouldn't be true any
  more and it might think it's __riscv_hwprobe, but that incompatibility
  is one we can defer committing to, and can choose to never adopt).

  Until the standard interface for querying extension information[1] is
  settled and implemented in FreeBSD there's not much you can do in a
  resolver other than use HWCAP_ISA_B, but this gets the infrastructure in
  place for when that day comes.

  [1] https://github.com/riscv-non-isa/riscv-c-api-doc/pull/74

  Reviewed by:	kib, mhorne
  MFC after:	1 month
  Differential Revision:	https://reviews.freebsd.org/D46278

  (cherry picked from commit 729d2b16b74fa5207a12aa1de190bd930432810e)


   libexec/rtld-elf/riscv/reloc.c        | 140 ++++++++++++++++++++++++++++------
   libexec/rtld-elf/riscv/rtld_machdep.h |   5 +-
   2 files changed, 122 insertions(+), 23 deletions(-)

[commit f6ff014ba52de10a3a72aa9b2e331989dda9d1e8]
Date: 2024-08-22
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Hardware.virtualization
Subject: riscv: Recognise B extension for AT_HWCAP
Review: The RISC-V hardware capability AT_HWCAP now includes the B extension alias for Zba, Zbb, and Zbs extensions.
Body:

  This was ratified earlier this year as an alias for Zba_Zbb_Zbs. Whilst
  we don't currently export multi-letter extensions, we can still export
  this alias in AT_HWCAP.

  Reviewed by:	mhorne
  MFC after:	1 month
  Differential Revision:	https://reviews.freebsd.org/D46277

  (cherry picked from commit 228a3e73e16983bc7f985b24ef20909500792d3c)


   sys/riscv/include/elf.h    | 1 +
   sys/riscv/riscv/identcpu.c | 1 +
   2 files changed, 2 insertions(+)

[commit d5d8583a16ef533dfd8e1164401c4960417014ad]
Date: 2024-08-22
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: rtld-elf: Pass parsed aux_info to ifunc_init
Review: The change refactors internal argument passing in the dynamic linker's ifunc initialization, but does not introduce any user-visible behavior change, feature, or configuration impact.
Body:

  Currently we pass the raw pointer to the on-stack auxargs. This can
  legitimately have fewer than AT_COUNT entries, so the use of
  __min_size(AT_COUNT), i.e. static AT_COUNT, is inaccurate, and also
  needlessly forces the callee to iterate over the elements to find the
  entry for a given type. Instead we can just pass aux_info like we use
  for everything else.

  Note that the argument has been left unused by every callee since its
  introduction in 4352999e0e6c ("Pass CPUID[1] %edx (cpu_feature), %ecx
  (cpu_feature2) and CPUID[7].%ebx (cpu_stdext_feature), %ecx
  (cpu_stdext_feature2) to the ifunc resolvers on x86.")

  Reviewed by:	kib
  MFC after:	1 month
  Differential Revision:	https://reviews.freebsd.org/D46276

  (cherry picked from commit 33658afd4e4d11cd71d92e52ca9da5381cdd829b)


   libexec/rtld-elf/aarch64/reloc.c   | 2 +-
   libexec/rtld-elf/amd64/reloc.c     | 2 +-
   libexec/rtld-elf/arm/reloc.c       | 2 +-
   libexec/rtld-elf/i386/reloc.c      | 2 +-
   libexec/rtld-elf/powerpc/reloc.c   | 2 +-
   libexec/rtld-elf/powerpc64/reloc.c | 2 +-
   libexec/rtld-elf/riscv/reloc.c     | 2 +-
   libexec/rtld-elf/rtld.c            | 2 +-
   libexec/rtld-elf/rtld.h            | 2 +-
   9 files changed, 9 insertions(+), 9 deletions(-)

[commit ae1f6fd47c4584d1abe5ecf26f291d282e6f6a67]
Date: 2025-11-25
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: agp: Export intel_gtt_read_pte, required by i915kms
Review: The commit exports a kernel symbol required for the i915kms driver to load when the agp module is not compiled into the kernel, ensuring compatibility for certain Intel graphics hardware.
Body:

  This isn't used by modern cards, but is needed for i915kms to load
  on a system that has agp as a module not compiled into the kernel.

  PR:		291214
  Reviewed by:	cy
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53906

  (cherry picked from commit a87c1e2dd8fc997d6ee603c252c543afe8a4d2a4)
  (cherry picked from commit 8befd2d2b6a0c5d54fa53246a89ae09009007799)


   sys/modules/agp/Makefile | 1 +
   1 file changed, 1 insertion(+)

[commit 2c8a177e9b56ec684a602dcd6c3416532e7dbb60]
Date: 2025-12-01
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: uio.h: Indent struct uio according to style(9)
Review: Only whitespace and indentation changes to struct uio in uio.h; no user-visible impact.
Body:

  Approved by:	christos (mentor)
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D54071

  (cherry picked from commit 8740d7e4d183189d259163aa30179ad14c77c0c4)


   sys/sys/uio.h | 14 +++++++-------
   1 file changed, 7 insertions(+), 7 deletions(-)

[commit 80523463ac36034945c2143a2ff184e1b922381c]
Date: 2025-10-17
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: netmap: Fix error handling in nm_os_extmem_create()
Review: The commit fixes an internal error handling issue in netmap's memory management with no direct user-visible impact.
Body:

  We bump the object reference count prior to mapping it into the kernel
  map, at which point the vm_map_entry owns the reference.  Then, if
  vm_map_wire() fails, vm_map_remove() will release the reference, so we
  should avoid decrementing it in the error path.

  Reported by:	Ilja van Sprundel <ivansprundel@ioactive.com>
  Reviewed by:	vmaffione
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53066

  (cherry picked from commit dfc1041c08ba32f24b8050b4d635a0bbbfd9b767)


   sys/dev/netmap/netmap_freebsd.c | 1 +
   1 file changed, 1 insertion(+)

[commit ff6b04c37e780e070d871dff60370a0376efde4c]
Date: 2025-11-06
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Docs.manpages
Subject: dtrace_pid.4: Document the DTrace PID provider
Review: The DTrace PID provider man page is added, documenting its usage and options.
Body:

  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51287

  (cherry picked from commit 9fe88e5503239cb65e503e3b2b7344933a888644)


   cddl/contrib/opensolaris/cmd/dtrace/dtrace.1 |  1 +
   share/man/man4/Makefile                      |  1 +
   share/man/man4/dtrace_pid.4                  | 99 ++++++++++++++++++++++++++++
   3 files changed, 101 insertions(+)

[commit d01fd1a51fd45cba3b3b3ed23913c4ea2be1462a]
Date: 2025-11-12
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: ministat: Clean up usage message, manual page, and chameleon
Review: The ministat(1) manual page is updated with corrected synopsis, improved flag descriptions, and expanded examples. Usage message and chameleon file are also cleaned up.
Body:

  In the manual page:
  - Fix synopsis and use better argument names
  - Improve description of flags.
  - In EXAMPLES, list the contents of iguana and chameleon files.
  - Use Rs to reference The Cartoon Guide to Statistics
  - Fix misc indentation and style issues
  - Tag SPDX

  MFC after:	1 week
  Reviewed by:	bcr, ziaee
  Differential Revision:	https://reviews.freebsd.org/D53710

  (cherry picked from commit 9d17b61b2fd254b418f3dd6b7a64afbc861a57f8)


   usr.bin/ministat/chameleon  |   2 +-
   usr.bin/ministat/ministat.1 | 146 +++++++++++++++++++++++++++++---------------
   usr.bin/ministat/ministat.c |   2 +-
   3 files changed, 98 insertions(+), 52 deletions(-)

[commit 2dd40f6cc09d74d59a4f04180d9174403f4f3fa3]
Date: 2025-12-04
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: rtsold: Fix a buffer leak if we fail to read the default router sysctl
Review: The commit fixes a buffer leak in man:rtsold[8] when reading the default router sysctl fails, preventing potential memory exhaustion under specific error conditions.
Body:

  MFC after:	1 week
  Reported by:	Kevin Day <kevin@your.org>

  (cherry picked from commit 792221630bf4e58fcd923547bab689f4497613d8)


   usr.sbin/rtsold/cap_sendmsg.c | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit f6ad204da856e722b4995f929a09c96ccc38d537]
Date: 2025-12-08
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: libkern: Avoid a one-byte OOB access in strndup()
Review: Fixes a one-byte out-of-bounds access in the libkern strndup() function, ensuring it adheres to its specified contract.
Body:

  If the length of the string is maxlen, we would end up copying maxlen+1
  bytes, which violates the contract of the function.  The result is the
  same since that extra byte is overwritten.

  Reported by:	Kevin Day <kevin@your.org>
  Reviewed by:	imp, kib
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D54093

  (cherry picked from commit 73586fcea630c2c4fb83e966920c039aee8a5fc9)


   sys/libkern/strndup.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 99f641267d449f26a2e13449964f29d17897c29f]
Date: 2025-11-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vm_fault: only rely on PG_ZERO when the page was newly allocated
Review: The commit modifies the kernel's page fault handling to only rely on the PG_ZERO flag for newly allocated pages, which is an internal optimization with no direct user-visible impact.
Body:

  (cherry picked from commit cff67bc43df14d492ccc08ec92fddceadd069953)


   sys/vm/vm_fault.c | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit 76dc56765afdb5d7d44df83f91585357d4757568]
Date: 2025-11-27
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vm_page.h: remove no longer defined (P) locking annotation
Review: Removes outdated locking annotations from vm_page.h, which does not affect user-visible behavior.
Body:

  (cherry picked from commit 636ee0269db04ce22a0f5e32723bab79be69443d)


   sys/vm/vm_page.h | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 33510b16e663bde5be5e4a56ccb17f848c41ef4e]
Date: 2025-12-13
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: nextboot: Reimplement missing -a option
Review: The man:nextboot[8] utility now supports the -a option to list all configured nextboot entries.
Body:

  PR:		260520
  MFC after:	3 days
  Fixes:		e307eb94ae52 ("loader: zfs should support bootonce an nextboot")


   sbin/reboot/nextboot.sh | 4 ++++
   1 file changed, 4 insertions(+)

[commit fb5c9871764fb93905d45c569ed198ee52c9c22e]
Date: 2025-12-08
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.config
Subject: noshutdown: Fix startup order
Review: The rc.d script for noshutdown now explicitly requires the FILESYSTEMS dependency, ensuring it runs after cleanvar and reliably creates the /var/run/noshutdown file.
Body:

  This rc script exists solely to create a file, so have it explicitly
  require FILESYSTEMS.  In its current form, it was as likely as not to
  end up running before cleanvar, which would undo its work.

  MFC after:	3 days
  Fixes:		384d976725a5 ("rc.d: Add precious_machine rc.conf knob to create /var/run/noshutdown")
  Reviewed by:	kib
  Differential Revision:	https://reviews.freebsd.org/D54119

  (cherry picked from commit e540e8b2c04f03b4210a3bf2f421c05b918d1b51)


   libexec/rc/rc.d/noshutdown | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit cfb6742f8a01d319b0ee91bcd0edececbd5b52e5]
Date: 2025-12-08
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: cleanvar: Fix startup order
Review: The startup order between cleanvar and FILESYSTEMS is adjusted to ensure cleanvar runs before filesystem initialization.
Body:

  Instead of having FILESYSTEMS require cleanvar, which doesn't really
  make semantic sense, say that cleanvar needs to run before FILESYSTEMS.

  MFC after:	3 days
  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D54118

  (cherry picked from commit 6ce227d6274869a95150746d2f2d8c8c5ed9a266)


   libexec/rc/rc.d/FILESYSTEMS | 2 +-
   libexec/rc/rc.d/cleanvar    | 1 +
   2 files changed, 2 insertions(+), 1 deletion(-)

[commit 718fabf1cfa5cc170efd1ef9b106389c29ae7876]
Date: 2025-12-05
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.programs
Subject: fsync: Open files in non-blocking mode
Review: The fsync utility now opens files in non-blocking mode, preventing indefinite blocking when invoked on a FIFO.
Body:

  This avoids blocking forever when invoked on a fifo.

  MFC after:	1 week
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D54084

  (cherry picked from commit 69e041521a80a0b8950f6ec25269a9c3949d6590)


   usr.bin/fsync/fsync.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit fe2d226d8febd7705370ca9933c600dfe1b1e448]
Date: 2025-12-05
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: undecided
Subject: bus: Return 0 if reading an ivar fails
Review: Internal kernel invariant handling change with no user-visible impact.
Body:

  In the non-INVARIANTS case, return 0 rather than stack garbage if
  reading an ivar fails (in the INVARIANTS case, we still panic).

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.
  Reviewed by:	jhb
  Differential Revision:	https://reviews.freebsd.org/D54078

  (cherry picked from commit 4c2295c15860e70c8bd3f05f9229d2fc40dfd50d)


   sys/sys/bus.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e1c985ccc335beb37bb34b368c5c019cc5f80f9c]
Date: 2025-09-30
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: vt: Allow VT_SETMODE with frsig=0
Review: The man:vt[4] ioctl VT_SETMODE now allows frsig=0, improving compatibility with Linux software that leaves this unused signal unset.
Body:

  Linux does not check that any of the signals in vt_mode VT_SETMODE ioctl
  (relsig, acqsig, frsig) are valid, but FreeBSD required that all three
  are valid.  frsig is unusued in both Linux and FreeBSD, and software
  typically leaves it unset.  To improve portability, allow frsig to be
  set to zero.

  PR:		289812
  Reported by:	Duan Gvozdenovi
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D52835

  (cherry picked from commit 5198c32210039d8dc92554647384eee75688848c)
  (cherry picked from commit 224d65015465d085f2e07edccef1f23a8c217b88)


   sys/dev/vt/vt_core.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit f2a21b1b483ce8c54adac59e254611dad5c25fd9]
Date: 2025-11-20
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: e1000: Don't enable ASPM L1 without L0s
Review: The e1000 driver no longer enables ASPM L1 without L0s, which resolves packet loss issues on some Intel 82583 hardware.
Body:

  Reporter noted packet loss with 82583.  NVM is down level.  The
  errata docs mention disabling this, which should be the firmware
  default, so I am not sure why we were enabling this bit.  Linux and
  OpenBSD have the same issue, while NetBSD got it right.

  Reported by:	Codin <codin@nagi.ftp.sh>
  Tested by:	Codin <codin@nagi.ftp.sh>

  (cherry picked from commit 2ead091715dee327b3e00bc9840e1a95827b8e82)


   sys/dev/e1000/e1000_82571.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 618083e96701c4c1ca197fa5d9a677471785515b]
Date: 2025-11-20
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: e1000: Bump 82574/82583 PBA to 32K
Review: The e1000 driver now sets the Packet Buffer Allocation (PBA) to 32K for 82574 and 82583 chipsets, matching Linux defaults. This improves throughput and reduces packet loss on low-power machines like Intel J1900.
Body:

  The reporter contacted me with packet loss and throughput fluctuations
  on a low power machine (Intel J1900) that got worse with the recent AIM
  algorithm in FreeBSD 14.2+.

  32K RX PBA matches Linux default.  Add a conditional path since we don't
  otherwise do a fixup for jumbo frames to retain space for two frames in
  Tx.

  With this change and an additional errata change, the throughput meets
  line rate for the reporter.

  Reported by:	Codin <codin@nagi.ftp.sh>
  Tested by:	Codin <codin@nagi.ftp.sh>

  (cherry picked from commit aa30bab9a92e1be230b9708bff9f33aae7d384e5)


   sys/dev/e1000/if_em.c | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit e56189d4436b91c2ccf915774cb2eef53c8eca0e]
Date: 2025-12-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Stormshield
Section: Drivers.device
Subject: pmc: add alderlaken model
Review: The hwpmc(4) driver now supports the Alder Lake CPU model, enabling performance monitoring for these processors.
Body:

  This commit adds alderlaken CPU model to hwpmc/libpmc. JSON event
  definitions are imported from Intel perfmon version 1.16.

  Reviewed by:	mhorne
  MFC after:	1 week
  Sponsored by:	Stormshield
  Differential Revision:	https://reviews.freebsd.org/D49229

  (cherry picked from commit ca3e47b0ea68664c7e10e1c3e28c5ac7d9932c21)


   .../arch/x86/alderlaken/adln-metrics.json          | 583 +++++++++++++++++++++
   .../pmu-events/arch/x86/alderlaken/cache.json      | 330 ++++++++++++
   .../arch/x86/alderlaken/floating-point.json        |  18 +
   .../pmu-events/arch/x86/alderlaken/frontend.json   |  26 +
   .../pmu-events/arch/x86/alderlaken/memory.json     |  81 +++
   .../pmu-events/arch/x86/alderlaken/other.json      |  38 ++
   .../pmu-events/arch/x86/alderlaken/pipeline.json   | 533 +++++++++++++++++++
   .../arch/x86/alderlaken/uncore-memory.json         | 175 +++++++
   .../arch/x86/alderlaken/uncore-other.json          |  33 ++
   .../arch/x86/alderlaken/virtual-memory.json        |  47 ++
   lib/libpmc/pmu-events/arch/x86/mapfile.csv         |   1 +
   sys/dev/hwpmc/hwpmc_intel.c                        |   4 +
   sys/sys/pmc.h                                      |   1 +
   13 files changed, 1870 insertions(+)

[commit f7129ef918b77596536107e5687a14907bda07c1]
Date: 2025-12-04
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: Stormshield
Section: Userland.contrib
Subject: pmc: add emerald rapids model
Review: The man:pmc[4] hardware performance monitoring facility now supports the Intel Emerald Rapids CPU model, adding JSON event definitions for core and uncore performance counters.
Body:

  This commit adds emerald rapids CPU model to hwpmc/libpmc. JSON event
  definitions are imported from Intel perfmon version 1.06.

  Reviewed by:	mhorne
  MFC after:	1 week
  Sponsored by:	Stormshield
  Differential Revision:	https://reviews.freebsd.org/D49228

  (cherry picked from commit 51a01f3debff8abf63c7cc21db9523c8feb53823)


   .../pmu-events/arch/x86/emeraldrapids/cache.json   |  888 +++
   .../arch/x86/emeraldrapids/floating-point.json     |  214 +
   .../arch/x86/emeraldrapids/frontend.json           |  389 ++
   .../pmu-events/arch/x86/emeraldrapids/memory.json  |  344 ++
   .../pmu-events/arch/x86/emeraldrapids/other.json   |  315 +
   .../arch/x86/emeraldrapids/pipeline.json           |  962 +++
   .../arch/x86/emeraldrapids/uncore-cache.json       | 6248 ++++++++++++++++++++
   .../arch/x86/emeraldrapids/uncore-cxl.json         |  450 ++
   .../x86/emeraldrapids/uncore-interconnect.json     | 6199 +++++++++++++++++++
   .../arch/x86/emeraldrapids/uncore-io.json          | 3617 +++++++++++
   .../arch/x86/emeraldrapids/uncore-memory.json      | 3308 +++++++++++
   .../arch/x86/emeraldrapids/uncore-power.json       |  197 +
   .../arch/x86/emeraldrapids/virtual-memory.json     |  165 +
   lib/libpmc/pmu-events/arch/x86/mapfile.csv         |    1 +
   sys/dev/hwpmc/hwpmc_intel.c                        |    4 +
   sys/sys/pmc.h                                      |    1 +
   16 files changed, 23302 insertions(+)

[commit 2635037db7702ddad40d3349bd7a56e54408fced]
Date: 2025-12-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Stormshield
Section: Drivers.device
Subject: pmc: add alderlake model
Review: The hwpmc module now supports additional Alder Lake CPU models (6-B7, 6-BA, 6-BF), allowing man:pmc[4] to function on these processors.
Body:

  The commit 601925180df4 added the models 6-B7, 6-BA, 6-BF to libpmc, but
  they must also be added to the hwpmc module to allow pmc to work on
  those CPUs.

  Reviewed by:	mhorne
  MFC after:	1 week
  Fixes:		601925180df4 ("libpmc: add more alderlake models")
  Sponsored by:	Stormshield
  Differential Revision:	https://reviews.freebsd.org/D49255

  (cherry picked from commit 057dae35ffc6b17dacc84fa21921e93a17ce12b0)


   sys/dev/hwpmc/hwpmc_intel.c | 3 +++
   1 file changed, 3 insertions(+)

[commit a717a40f84490473a3bad5fa012ddac13e9dca60]
Date: 2025-11-25
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Network.general
Subject: pf: relax sctp v_tag verification
Review: The pf firewall now correctly handles SCTP INIT retransmissions by allowing the initiate tag to be updated before the COOKIE_WAIT state, preventing endless INIT/INIT_ACK cycles.
Body:

  pf was too strict when validating SCTP tags. When a server receives a
  retransmitted INIT it will reply with a random initiate tag every time.
  However, pf saves the first initiate tag and expects every subsequent INIT_ACK
  retransmission to have the same tag. This is not the case, leading to endless
  INIT/INIT_ACK cycles.

  Allow the tag to be updated as long as we've not gone past COOKIE_WAIT.

  Add a test case to verify this.

  MFC after:	2 weeks
  See also:	https://redmine.pfsense.org/issues/16516
  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit bc3b72ff48953551e0e8bd6e5a2c718ecd973285)


   sys/netpfil/pf/pf.c          |  8 ++++--
   tests/sys/netpfil/pf/sctp.py | 67 ++++++++++++++++++++++++++++++++++++++++++++
   2 files changed, 73 insertions(+), 2 deletions(-)

[commit 0ce6b2f829dc403520f57b62dde0c52f50bd5303]
Date: 2025-12-09
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.config
Subject: rc.d/ipfilter: ipfilter must be enabled for options to take
Review: The ipfilter startup script no longer resets configuration options when ipfilter is disabled, preserving user settings from rc.conf.
Body:

  ipfilter options are erased and reset to default when ipfilter is
  disabled. This results in nullifying options from rc.conf that were
  previously set.

  8d6feaaaa26f, which added this code, was incorrect as it was for a bug in
  ipfilter 4.2.28 and no longer applies to ipfilter 5.1.2.

  Fixes:		8d6feaaaa26f

  (cherry picked from commit cc1e4aae5a67a20f3c0fff13612364e6e4404f93)


   libexec/rc/rc.d/ipfilter | 9 +++------
   1 file changed, 3 insertions(+), 6 deletions(-)

[commit 448a117d06e6c857c55830bbf30684ed31503234]
Date: 2025-12-09
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: rc.d/{ipfilter,ippool}: Fix typo in variable name
Review: Fixes a typo in variable names within the ipfilter and ippool rc.d scripts, ensuring proper variable assignment during service startup.
Body:

  (cherry picked from commit f04b23ce3547c238dcd52d4fa1a7d401ad38d1b1)


   libexec/rc/rc.d/ipfilter | 2 +-
   libexec/rc/rc.d/ippool   | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit 17bc0155cbc215683be997045cda44d3a7662014]
Date: 2025-11-24
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: irdma(4): fix potential memory leak on qhash cqp operation
Review: The irdma(4) driver fixes a potential memory leak in qhash cqp operations, preventing resource exhaustion under certain conditions.
Body:

  It was found that in some circumstances when launching
  non-waiting create qhash cqp operation the refcount on
  the cqp_request may be not properly decremented leading to a memory
  leak.

  Signed-off-by: Bartosz Sobczak <bartosz.sobczak@intel.com>

  Reviewed by:	anzhu_netapp.com
  Tested by:	mateusz.moga_intel.com
  Approved by:	kbowling (mentor)
  Sponsored by:	Intel Corporation
  Differential Revision:	https://reviews.freebsd.org/D53732

  (cherry picked from commit 7b6644e160ed63b633e7c68a3cacf2c71d216cd5)


   sys/dev/irdma/icrdma.c     |   4 +-
   sys/dev/irdma/irdma_cm.c   |  38 +------------
   sys/dev/irdma/irdma_hw.c   | 132 ++++++++++++++++++++++++++++++++++++---------
   sys/dev/irdma/irdma_main.h |   3 +-
   4 files changed, 114 insertions(+), 63 deletions(-)

[commit 7ad8cbab66f4db25be75e7a91c025a50bcab5dc2]
Date: 2025-12-10
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: certctl: Improve option processing
Review: The man:certctl[8] utility now validates that subcommands expecting no arguments receive none, preventing misuse.
Body:

  For subcommands that did not take any arguments, we never bothered to
  check that none were passed.

  Reviewed by:	allanjude
  Differential Revision:	https://reviews.freebsd.org/D54082


   usr.sbin/certctl/certctl.sh | 93 +++++++++++++++++++++++++++++++++++----------
   1 file changed, 72 insertions(+), 21 deletions(-)

[commit ce1e7a7921b27b82d8cda499058e685250cc695a]
Date: 2025-12-10
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.programs
Subject: certctl: Always copy bundle fragments
Review: The certctl utility now copies bundle fragments instead of creating symlinks when processing certificate bundles. This ensures that temporary files are properly handled and certificates remain accessible after processing.
Body:

  When processing a bundle, we split it into individual certificates
  stored in temporary files, then pass the name of each temporary file
  to the creation function.  Since the temporary files will later be
  deleted, we need to force the creation function to copy rather than
  symlink these files.

  PR:		290957
  Fixes:		986c43bd80e7 ("certctl: Add an option to copy files.")
  Reviewed by:	allanjude
  Differential Revision:	https://reviews.freebsd.org/D54081


   usr.sbin/certctl/certctl.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c8180893d7fef8557d8f8cdd5945468be5023da2]
Date: 2025-11-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: nfs_nfsdstate.c: Add sanity checks for lock stateids
Review: The NFS server now validates stateid types in Lock and LockU operations, preventing crashes from malformed client requests. This improves stability when using NFSv4 with various clients.
Body:

  Bugzilla PR reported a crash caused by a synthetic client
  doing a Lock operation request with a delegation stateid.

  This patch fixes the problem by adding sanity checks
  for the type of stateid provided as an argument to the
  Lock and LockU operations.

  It has been tested with the FreeBSD, Linux and Solaris 11.4
  clients.  Hopefully, other NFSv4 clients will work ok
  as well.

  PR:	291080

  (cherry picked from commit aa1cf240887ddcca66dfb969fdc5a8d545396037)


   sys/fs/nfsserver/nfs_nfsdstate.c | 14 ++++++++++++++
   1 file changed, 14 insertions(+)

[commit 63b77ab1554eb642ad28c35339f08ccfeaab13e5]
Date: 2025-11-27
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: kgssapi: Remove broken MOD_UNLOAD code
Review: The kgssapi module no longer panics when unloading is attempted, as the unsupported unload code is disabled. This prevents a kernel panic for users who try to unload the module.
Body:

  The module panicked at unload with "recursing but non-recursive rw".
  There is a comment that "Unloading of the kgssapi module is not
  currently supported" and the MOD_UNLOAD case falls through to returning
  EOPNOTSUPP anyway.  Just #if 0 the code in the unload path, leaving it
  as a hint in case someone implements unload support later on.

  PR:		291249
  Reviewed by:	rmacklem
  Fixes: ad704a34bc2c ("Use syscall_helper_register(9) rather than syscall_register().")
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53949

  (cherry picked from commit 6901376f59b870ddbb0d922e3455a388333cd460)
  (cherry picked from commit ab4f4f4efaac85bbf235e60f2ced4876a9e916f2)


   sys/kgssapi/gss_impl.c | 4 ++++
   1 file changed, 4 insertions(+)

[commit b2d547abb76fb4e88c0fb58b50b8dfaf5447d737]
Date: 2025-12-01
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Orange Business Services
Section: Network.general
Subject: pfsync: fix incorrect unlock during destroy
Review: The pfsync(4) driver no longer incorrectly releases a lock during cleanup, preventing assertion failures when there are pending deferred packets.
Body:

  During pfsync_clone_destroy() we clean up pending packets. This
  may involve calling pfsync_undefer() or callout_drain(). We may not
  hold the bucket lock during callout_drain(), but must hold it during
  pfsync_undefer().

  We incorrectly always released the lock, leading to assertion failures
  during cleanup if there were pending deferred packets.

  MFC after:	1 week
  Sponsored by:	Orange Business Services

  (cherry picked from commit 639e65144aa71cb03b5431861803f528308760dc)


   sys/netpfil/pf/if_pfsync.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 5f9b7cde517ecd0d821b9730f37ebbdc25dbd349]
Date: 2025-10-28
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: NVIDIA
Section: Drivers.device
Subject: linuxkpi: gracefully handle page lookup failure in lkpi_vmf_insert_pfn_prot_locked
Review: The LinuxKPI driver now gracefully handles page lookup failures, preventing a kernel page fault when starting KDE6 in Wayland mode.
Body:

  Currently lkpi_vmf_insert_pfn_prot_locked will check the page iter to
  find a usage of the page. If no page was found, it continues on to
  try using PHYS_TO_VM_PAGE() to get a page. Currently it does not check
  if a valid page was found before passing it to vm_page_busy_acquire,
  which can cause a kernel page fault as vm_page_busy_acquire expects
  a valid page pointer.

  This can easily be triggered while starting KDE6 in wayland mode, which
  many users have been reporting. With this change plasma6 starts properly
  in wayland mode.

  Sponsored by:	NVIDIA
  PR:		288565
  Reviewed by:	markj, kbowling (mentor)
  Differential Revision:	https://reviews.freebsd.org/D53412
  Fixed conflicts during MFC, re-reviewed by kbowling

  (cherry picked from commit 03b214a35db1ebdc7575cad8d695c65daf2817bf)


   sys/compat/linuxkpi/common/src/linux_page.c | 2 ++
   1 file changed, 2 insertions(+)

[commit 5287dd47b5b643baba645cde51bf39f787c738d6]
Date: 2025-10-28
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: NVIDIA
Section: Drivers.device
Subject: linuxkpi: add stub implementation of pm_vt_switch_(un)register
Review: The commit adds stub implementations of pm_vt_switch_register and pm_vt_switch_unregister in the LinuxKPI compatibility layer, which is used by the nvidia-drm driver. This change enables better compatibility with NVIDIA graphics drivers, potentially improving support for suspend/resume operations involving VT switches.
Body:

  This adds empty implementations of pm_vt_switch_(un)register which
  are used by nvidia-drm. We do not need to specify anything here as
  a VT switch always happens on suspend/resume.

  Sponsored by:	NVIDIA
  Reviewed by:	kbowling (mentor), emaste
  Differential Revision:	https://reviews.freebsd.org/D53400

  (cherry picked from commit 75aa13c64aba71f6f26d05e8fcf96e3862d44cde)


   sys/compat/linuxkpi/common/include/linux/pm.h | 14 ++++++++++++++
   1 file changed, 14 insertions(+)

[commit 9b1cd02f363f4b9c1ebcafef41b99c0898bb8d7c]
Date: 2025-12-06
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: The FreeBSD Foundation
Section: Userland.contrib
Subject: release: Include comms/usbmuxd to DVD to ensure ipheth(4) works
Review: The usbmuxd utility is now included on the installation DVD, enabling ipheth(4) tethering support for iPhone and iPad devices during installation.
Body:

  PR:		291370
  Reviewed by:	emaste, aokblast, dch
  MFC after:	3 days
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D54074

  (cherry picked from commit 90eda629964cbe4c2472aa3f1b8a427e60e78834)


   release/scripts/pkg-stage.sh | 1 +
   1 file changed, 1 insertion(+)

[commit 045e89153c96dd2a26ec1c0d5c36d2d6c0fd1af3]
Date: 2025-09-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: geom/zero: Add support for unmapped I/O
Review: The gzero(4) device driver now supports unmapped I/O, which can improve performance by avoiding unnecessary page mapping operations when kern.geom.zero.clear is enabled.
Body:

  This patch adds support for unmapped I/O to gzero(4).

  Let's consider the following script to illustrate the change in
  gzero(4)'s behavior:

  ```
  dd="dd if=/dev/gzero of=/dev/null bs=512 count=100000"
  dtrace -q -c "$dd" -n '
      fbt::pmap_qenter:entry,
      fbt::uiomove_fromphys:entry,
      fbt::memset:entry
      /execname == "dd"/
      {
  	@[probefunc] = count();
      }
  '
  ```

  Let's run that script 4 times:

  ```
  ==> 1: unmapped I/O not supported (fallback to mapped I/O), kern.geom.zero.clear=1
  51200000 bytes transferred in 1.795809 secs (28510829 bytes/sec)
    pmap_qenter                                                  100000
    memset                                                       400011

  ==> 2: unmapped I/O not supported (fallback to mapped I/O), kern.geom.zero.clear=0
  51200000 bytes transferred in 0.701079 secs (73030337 bytes/sec)
    memset                                                       300011

  ==> 3: unmapped I/O supported, kern.geom.zero.clear=1
  51200000 bytes transferred in 0.771680 secs (66348750 bytes/sec)
    uiomove_fromphys                                             100000
    memset                                                       300011

  ==> 4: unmapped I/O supported, kern.geom.zero.clear=0
  51200000 bytes transferred in 0.621303 secs (82407407 bytes/sec)
    memset                                                       300011
  ```

  If kern.geom.zero.clear=0, then nothing really changes as no copying takes
  place. Otherwise, we see by adding unmapped I/O support we avoid calls to
  pmap_qenter(), which was called by GEOM to turn unmapped I/O requests into
  mapped ones before passing them for processing to gzero(4).

  Reviewed by:	bnovkov, markj
  Approved by:	bnovkov (mentor), markj (mentor)
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D52998

  (cherry picked from commit d01183fddf37b15da7ab3d69039e7759ae144451)


   sys/geom/zero/g_zero.c | 82 ++++++++++++++++++++++++++++++++++++++------------
   1 file changed, 63 insertions(+), 19 deletions(-)

[commit f69bf8f994e56104fb42abdce169ed3841ac63c9]
Date: 2025-11-07
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: dtrace_priv.4: Document the DTrace priv provider
Review: The DTrace priv provider is documented in man:dtrace_priv[4], describing static tracing for privilege checking.
Body:

  Fixes:	6efcc2f26ab0 Add static tracing for privilege checking
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D53630

  (cherry picked from commit 7bcd3a04c8695d797665289ed48ff2d84afb8ac4)


   cddl/contrib/opensolaris/cmd/dtrace/dtrace.1 |  3 +-
   share/man/man4/Makefile                      |  1 +
   share/man/man4/dtrace_priv.4                 | 59 ++++++++++++++++++++++++++++
   share/man/man9/priv.9                        |  3 +-
   4 files changed, 64 insertions(+), 2 deletions(-)

[commit a409ba2e30d517841e8d6aafafd472f59fa50b63]
Date: 2025-12-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ipsec: Fix typos in references to IPsec's ESP
Review: Fixes typographical errors in documentation and comments related to IPsec ESP terminology, correcting 'Encapsulated Security Payload' to 'Encapsulating Security Payload'.
Body:

  ESP is "Encapsulating Security Payload",
  not "Encapsulated Security Payload".

  This patch fixes all the place in the tree I could find
  with `grep -i encapsulated security`.

  MFC after:	3 days
  Reviewed by:	ae
  Differential Revision:	https://reviews.freebsd.org/D53769

  (cherry picked from commit 15afd75e67102f81c37adbf11966e48685bd7be7)


   sbin/ipfw/ipfw.8   | 4 ++--
   sbin/ipfw/ipv6.c   | 2 +-
   sbin/ping/ping.8   | 4 ++--
   sys/netipsec/esp.h | 2 +-
   4 files changed, 6 insertions(+), 6 deletions(-)

[commit 307a6241d05ab8280a821767261b2ff194662b3b]
Date: 2025-12-03
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.libraries
Subject: rtld-elf: Mark LD_SHOW_AUXV insecure
Review: The dynamic linker man:ld-elf.so.1[1] no longer allows LD_SHOW_AUXV in setugid processes, preventing memory layout disclosure.
Body:

  This prevents dumping the memory layout of setugid processes.

  MFC after:	3 days
  Reviewed by:	kib
  Differential Revision:	https://reviews.freebsd.org/D54033

  (cherry picked from commit 5242bcff202fa2a5a39895423c8d8c11c02ad76a)


   libexec/rtld-elf/rtld.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 07f9d9cb9a2f6ed94bb1db067e2ab94056b2af81]
Date: 2025-11-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: undecided
Subject: bus: Apply consistent style to prototypes
Review: This commit applies consistent style to prototypes in bus.h, which is an internal code formatting change with no user-visible impact.
Body:

  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.

  (cherry picked from commit 6facc476f3056037f8b5cdb5546554ab3a887463)


   sys/sys/bus.h | 20 ++++++++++----------
   1 file changed, 10 insertions(+), 10 deletions(-)

[commit c0aeb34d5044f2549572bd3e49468e7df6079d28]
Date: 2025-11-28
Score: 5
Status: proposed(include=no,score=15)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: undecided
Subject: bus: Add device_has_children predicate
Review: Adds a device_has_children() function to check for child devices without allocating memory, and modifies device_get_children() to allow querying the count without allocation. This provides more efficient device tree queries for kernel developers.
Body:

  Add a device_has_children() function which can be used to check if a
  device has children without allocating a list of them which we aren't
  going to use, or even counting them.

  Also modify device_get_children() so it can be used to query the count
  without allocating a list.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.
  Reviewed by:	imp, markj
  Differential Revision:	https://reviews.freebsd.org/D53918

  (cherry picked from commit 330d4437f2100fc05e576763f4f6a7198080663a)


   share/man/man9/Makefile              |  1 +
   share/man/man9/device_get_children.9 | 47 ++++++++++++++++++++++++++++++------
   sys/kern/subr_bus.c                  | 18 ++++++++++++++
   sys/sys/bus.h                        |  1 +
   4 files changed, 59 insertions(+), 8 deletions(-)

[commit 8787b699b036bdd99ee42a98577a7a291da9ab91]
Date: 2025-11-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Klara, Inc.
Section: undecided
Subject: libc: Simplify __get_locale()
Review: Internal refactoring of locale handling with no user-visible impact.
Body:

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	fuz
  Differential Revision:	https://reviews.freebsd.org/D53908

  (cherry picked from commit 5af240c54bd2d9548536c904e841499e1651bcc8)


   lib/libc/locale/xlocale_private.h | 6 ++----
   1 file changed, 2 insertions(+), 4 deletions(-)

[commit 1869d604e22d88c8c7487cd8a547de42847a40be]
Date: 2025-11-26
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.libraries
Subject: strfmon: Fix negative sign handling for C locale
Review: The man:strfmon[3] function now correctly handles negative sign formatting for the C locale, aligning with POSIX requirements. This ensures consistent monetary formatting output in the C locale.
Body:

  If the locale's positive_sign and negative_sign values would both be
  returned by localeconv() as empty strings, strfmon() shall behave as if
  the negative_sign value was the string "-".

  This occurs with the C locale.  The implementation previously assigned
  "0" to sign_posn (parentheses around the entire string); now it assigns
  it to "1" (sign before the string) when it is undefined (CHAR_MAX).

  Austin Group Defect 1199[1] is applied, changing the requirements for
  the '+' and '(' flags.

  [1]: https://www.austingroupbugs.net/view.php?id=1199

  Reviewed by:	kib
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53913

  (cherry picked from commit cf85e7034ad5640b18a3b68d6b291b7bf89bfc80)


   lib/libc/stdlib/strfmon.c            | 2 +-
   lib/libc/tests/stdlib/strfmon_test.c | 6 +++---
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit 8dc8e3011d05bdadb3e62fe99fbb054e33bfd8f2]
Date: 2025-11-26
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.libraries
Subject: strfmon: EINVAL if the '+' flag and both signs are empty
Review: The man:strfmon[3] function now returns EINVAL when the '+' flag is used and both positive_sign and negative_sign locale values are empty strings, aligning with POSIX specifications.
Body:

  According to the Open Group Base Specifications Issue 8[1], strfmon(3)
  should return EINVAL when the '+' flag was included in a conversion
  specification and the locale's positive_sign and negative_sign values
  would both be returned by localeconv(3) as empty strings.

  Austin Group Defect 1199[2] is applied, adding the [EINVAL] error.

  [1]: https://pubs.opengroup.org/onlinepubs/9799919799/functions/strfmon.html
  [2]: https://www.austingroupbugs.net/view.php?id=1199

  Reviewed by:	kib
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53912

  (cherry picked from commit 1fd018972a18b682521bb8f004dfd162327e5db2)


   lib/libc/stdlib/strfmon.3            | 12 +++++++++++-
   lib/libc/stdlib/strfmon.c            |  4 +++-
   lib/libc/tests/stdlib/strfmon_test.c |  8 ++++----
   3 files changed, 18 insertions(+), 6 deletions(-)

[commit 7745ece2819e3613308974c5c547b7d1218b3856]
Date: 2025-11-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: strfmon: Add tests for Austin Group Defect 1199
Review: Adds tests for strfmon locale formatting, which may affect currency output formatting when locale definitions are updated in the future.
Body:

  Add tests for The Open Group Base Specifications Issue 8[1], Austin
  Group Defect 1199[2].

  Items marked with XXX represent an invalid output.  These items will be
  fixed in subsequent commits.

  Notice that an existing test is now considered invalid.

  Our locale definitions do not include int_p_sep_by_space nor
  int_n_sep_by_space[3].  Those will be addressed in a subsequent commit.
  However, the CLDR project defines them as "0", which causes the output
  to appear as "USD123.45".  If our locale definitions were to set the
  international {n,p}_sep_by_space to "1", the output would display as the
  expected "USD 123.45".

  While here, use the SPDX license identifier and add my name to the
  file.

  [1]: https://pubs.opengroup.org/onlinepubs/9799919799/functions/strfmon.html
  [2]: https://www.austingroupbugs.net/view.php?id=1199
  [3]: https://unicode-org.atlassian.net/browse/CLDR-237

  Reviewed by:	kib
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53911

  (cherry picked from commit 19e153004fb63c32eba0ef40249f5ede61a93170)


   lib/libc/tests/stdlib/strfmon_test.c | 80 +++++++++++++++++++++++++-----------
   1 file changed, 57 insertions(+), 23 deletions(-)

[commit f830e53fc0850e58790ee8c58552a9f049244fd4]
Date: 2025-11-23
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: strfmon: Fix typo s/poistion/position/
Review: Fixes a typographical error in a comment within the strfmon library function, which has no user-visible impact.
Body:

  MFC after:	1 week

  (cherry picked from commit 91e7f19ec4056587a85c1461a4f34a6d5d4b7b52)


   lib/libc/stdlib/strfmon.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 38eec1fc77cd15377f8908ce9937c9982d4ea9d1]
Date: 2025-11-26
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.config
Subject: ipfilter: Load optionlist prior to ippool invocation
Review: The ipfilter rc script now loads the ipfilter_optionlist before ippool invocation, allowing the htable_size_max tunable to take effect for large hash tables. This prevents legitimate large ippool hash tables from failing to load due to a previous safety limit.
Body:

  As a safety precaution df381bec2d2b limits ippool hash table size to 1K.
  This causes any legitimely large hash table to fail to load. The
  htable_size_max ipf tuneable adjusts this but the adjustment is made
  in the ipfilter rc script, invoked after the ippool script (because it
  depends on ippool). Let's load the ipfilter_optionlist in ippool as well.
  ipfilter_optionlist load will also occur in the ipfilter rc script in case
  the user uses ipfilter without ippool.

  Fixes:		df381bec2d2b

  (cherry picked from commit d5d005e9bf4933d5680dd0bb5d42bdf440122aa4)


   libexec/rc/rc.d/ippool | 3 +++
   1 file changed, 3 insertions(+)

[commit 7e356823ac3aa648ddb42703b6a7254472d4bb81]
Date: 2025-11-27
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: bsd.lib.mk: document INTERNALLIB and PRIVATELIB
Review: The commit adds documentation for INTERNALLIB and PRIVATELIB variables in bsd.lib.mk, which is an internal build system file. This is a documentation-only change with no direct user-visible impact on system behavior, features, or configuration.
Body:

  (cherry picked from commit e60861eb41ca9d141a0d967db3ecbe2b2909c300)


   share/mk/bsd.lib.mk | 14 ++++++++++++++
   1 file changed, 14 insertions(+)

[commit feac4c32a5f87434a17a804d8148cea78f81ebea]
Date: 2025-11-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: vm_object_page_remove(): clear pager even if there is no resident pages
Review: The commit fixes a kernel memory management issue that could lead to incorrect pager behavior when removing pages from a vm_object. This ensures proper handling of memory objects, potentially preventing system instability or data corruption.
Body:

  (cherry picked from commit 72a447d0bc768c7fe8a9c972f710c75afebd581b)


   sys/vm/vm_object.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit a009793a5e5fad0b42cb0a158dcbccd5eff40d9f]
Date: 2025-11-15
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Network.general
Subject: pf: handle divert packets
Review: The pf firewall now handles divert packets correctly, preventing a kernel crash when pf_test_state() returns PF_PASS without setting a state pointer.
Body:

  In a divert setup pf_test_state() may return PF_PASS, but not set the state
  pointer. We didn't handle that, and as a result crashed immediately afterwards
  trying to dereference that NULL state pointer.

  Add a test case to provoke the problem.

  PR:		260867
  MFC after:	2 weeks
  Submitted by:	Phil Budne <phil.budne@gmail.com>
  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit 66f2f1c83247f05a3a599d7e88c7e7efbedd16b5)


   sys/netpfil/pf/pf.c               | 20 +++++++++++-------
   tests/sys/netpfil/pf/divert-to.sh | 44 +++++++++++++++++++++++++++++++++++++--
   2 files changed, 54 insertions(+), 10 deletions(-)

[commit 4c10ec9bd43feb86394dc2dc1c16f1c15d4b0285]
Date: 2025-11-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: beep: Sort usage and man page options
Review: The commit only sorts usage and man page options, fixes punctuation, and cleans up documentation without any user-visible functional changes.
Body:

  Sort usage and man page options, mention possible minimum and maximum
  values, fix punctuation marks, and cleanup the man page.

  PR:		291092
  Reviewed by:	pauamma_gundo.com, christos
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53827

  (cherry picked from commit 55d98b024f25403f60efe04f90a391014b6bc388)


   usr.bin/beep/beep.1 | 55 ++++++++++++++++++++++++++++-------------------------
   usr.bin/beep/beep.c | 19 +++++++++---------
   2 files changed, 39 insertions(+), 35 deletions(-)

[commit f28019f570cc1bbfe0f0597dc2f46cfd9438359a]
Date: 2025-11-10
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Docs.manpages
Subject: ix.4: Document E610 debug dump
Review: The commit documents how to collect E610 device debug dump data using sysctl for troubleshooting with Intel Customer Support.
Body:

  Explain how to collect E610 device debug dump data with sysctl for
  troubleshooting with Intel Customer Support.

  Fixes:			2170400142b9 (Add support for debug dump)
  Reviewed by:		bcr, erj (previous version), ziaee
  Signed-off-by:		Yogesh Bhosale <yogesh.bhosale@intel.com>
  Differential Revision:	https://reviews.freebsd.org/D52990

  (cherry picked from commit 8225ed665eea69b3df3ea57009cf8fe61863c1fc)


   share/man/man4/ix.4 | 29 +++++++++++++++++++++++++++++
   1 file changed, 29 insertions(+)

[commit e7da904b73abb8f3e2f1eb52ad7015ca731feff8]
Date: 2025-11-10
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: ix.4: Add E610 to HARDWARE section
Review: The man:ix[4] manual page now includes the Intel Ethernet E610 family in the HARDWARE section.
Body:

  Reviewed by:		ziaee
  Fixes:			dea5f973d0c8 (new Intel Ethernet E610 family)
  Differential Revision:	https://reviews.freebsd.org/D52990

  (cherry picked from commit abd53b16c03f77c12bb8b77d9e2e4cf392745361)


   share/man/man4/ix.4 | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit d6a05d33239403065463b12375045f9245a0eb3c]
Date: 2025-10-10
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: ix(4): Add support for debug dump for E610 adapters
Review: The ix(4) driver now supports debug dump functionality for Intel E610 Ethernet adapters, allowing users to capture runtime register values and device configuration snapshots for debugging purposes via ioctl and sysctl interfaces.
Body:

  This is part 2 of the support for the new Intel Ethernet E610 family of devices.

  Intel E610 Ethernet Controller devices feature a debug dump capability
  that allows you to capture runtime register values directly from the
  hardware, with assistance from the firmware. These registers are
  organized into clusters based on their function, enabling targeted
  debugging. This information is consolidated into a single dump file,
  facilitating the debugging of complex issues encountered in the field.
  The debug dump provides a snapshot of the device's current hardware
  configuration, including switch tables, transmit scheduler tables, and
  other relevant data. It captures the state of specified clusters and
  serves as a stateless snapshot of the entire device.

  This update introduces ioctl and sysctl support for the debug dump feature.

  Signed-off-by: Yogesh Bhosale yogesh.bhosale@intel.com
  Co-developed-by: Krzysztof Galazka krzysztof.galazka@intel.com

  Approved by:	kbowling (mentor), erj (mentor)
  Tested by:	gowtham.kumar.ks_intel.com
  Sponsored by:   Intel Corporation
  Differential Revision:	https://reviews.freebsd.org/D50934

  (cherry picked from commit 2170400142b99c0eb604403b74ebd88c05dd7ed4)


   sys/dev/ixgbe/if_ix.c          | 521 +++++++++++++++++++++++++++++++++++++++++
   sys/dev/ixgbe/ixgbe.h          |  52 ++++
   sys/dev/ixgbe/ixgbe_features.h |   1 +
   3 files changed, 574 insertions(+)

[commit 40a6ada9e614c1a6fd93e4164f7de416af1a23b2]
Date: 2025-11-17
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: igb(4): Fix VLAN support on VFs
Review: The man:igb[4] driver now correctly supports VLANs on Virtual Functions (VFs) by assuming VLAN hardware filtering is always enabled and forwarding VLAN tag requests to the Physical Function driver.
Body:

  Virtual Functions are considered untrusted and have no control
  over VLAN filtering configuration in HW. To allow using
  VLANs on VF intreface driver has to assume that VLAN HW Filtering
  is always enabled and pass requests for adding or removing VLAN
  tags to Physical Function driver using Mailbox API.

  Signed-off-by: Krzysztof Galazka <krzysztof.galazka@intel.com>

  Approved by:	kbowling (mentor)
  Reviewed by:	erj (previous version)
  Tested by:	gowtham.kumar.ks_intel.com
  Sponsored by:   Intel Corporation
  Differential Revision:	https://reviews.freebsd.org/D53245

  (cherry picked from commit 1839526b7315cae62efbd2d1493e6243439effcb)


   sys/dev/e1000/if_em.c | 34 ++++++++++++++++++++--------------
   1 file changed, 20 insertions(+), 14 deletions(-)

[commit 5a2f81012ab56436813a6c86fb578cc3a686f078]
Date: 2025-11-19
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.contrib
Subject: local-unbound: Read a tab separated resolv.conf
Review: The local-unbound setup script now correctly reads tab-separated entries in resolv.conf, improving compatibility with resolv.conf files that use tabs as delimiters.
Body:

  Use [[:space:]] rather than a white space character to delimit the keys
  and the values in the resolv.conf file.

  PR:		236079
  Reviewed by:	des
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53811

  (cherry picked from commit 0628400590e025b7db1c0905e6ee488a24ef3f60)


   usr.sbin/unbound/setup/local-unbound-setup.sh | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit f8bf6f81d6c2b73b065befedddac3bf29f2963de]
Date: 2025-11-18
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: kevent: Hold the knlist mutex when invoking f_event(NOTE_FORK)
Review: The commit fixes a locking protocol in the kqueue subsystem, which may affect stability for applications using NOTE_FORK events, but it is an internal fix with no direct user-visible change.
Body:

  In general f_event is supposed to be called with the knlist mutex held,
  so lock it earlier to follow this protocol.  Also make sure that the
  update to kn_fflags is synchronized.

  Lock the kqueue itself earlier in the case where the knote is activated,
  to avoid locking and unlocking the kqueue twice.

  PR:		291005
  Reported by:	Qiu-ji Chen <chenqiuji666@gmail.com>
  Reviewed by:	kib
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53762

  (cherry picked from commit d795c753e262b97a93dc353aa66b858e1b1969d1)


   sys/kern/kern_event.c | 16 ++++++++++++----
   1 file changed, 12 insertions(+), 4 deletions(-)

[commit 58eacc815513ceecbeb08783475e1b9375c7370a]
Date: 2025-11-17
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Drivers.device
Subject: if_ovpn: use IFT_TUNNEL
Review: The if_ovpn driver now uses IFT_TUNNEL instead of IFT_ENC, which may affect packet filtering behavior with pf.
Body:

  IFT_ENC has special behaviour in pf we don't desire, and this also ensures that
  for all interface types there is N:1:1 correspondence between if_type:dlt:header len.

  Requested by:	glebius
  MFC after:	1 week

  (cherry picked from commit ff9f76a206c80c263050816735d537a151ee2999)


   sys/net/if_ovpn.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 00e4b169f4090e3b4bf1454c989df82d94b7d62e]
Date: 2025-11-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.contrib
Subject: openssh: Don't attempt to connect to unsupported addresses
Review: OpenSSH now skips unsupported address types when connecting, preventing connection attempts to addresses that the kernel cannot handle.
Body:

  When iterating over known addresses for the requested target host name,
  skip those that are not supported by the running kernel.

  MFC after:	1 week
  PR:		195231
  Reviewed by:	emaste
  Differential Revision:	https://reviews.freebsd.org/D53588

  (cherry picked from commit 5818b6ee552b302f5300934f9b8cb94881867a5f)


   crypto/openssh/FREEBSD-upgrade | 7 +++++++
   crypto/openssh/sshconnect.c    | 9 +++++++++
   2 files changed, 16 insertions(+)

[commit 7f691e07efe63ea01273833e44fd03ee00106b2b]
Date: 2025-11-19
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: sh: Don't assume EINTR means SIGALRM
Review: The man:sh[1] builtin read command now handles EINTR correctly and improves timeout parsing. It accepts more complex time formats like '1h30m15s' but no longer accepts informal units like '1hour' or '5sec'.
Body:

  While waiting for input in the read builtin, if select() is interrupted
  but there is no pending signal, we act like we timed out, and return the
  same status as if we had been interrupted by SIGALRM, instead of looping
  until we actually do time out.

  * Replace the single select() call with a ppoll() loop.

  * Improve validation of the timeout value.  We now accept things like
    "1h30m15s", which we used to silently truncate to "1h".  The flip side
    is that we no longer accept things like "1hour" or "5sec".

  * Modify the existing `read -t 0` test case to verify that read returns
    immediately when there is input and fails immediately when there isn't.

  * Add a second test case which performs the same tests with a non-zero
    timeout value.

  PR:		290844
  MFC after:	1 week
  Fixes:          c4539460e3a4 ("sh: Improve error handling in read builtin:")
  Reviewed by:	jilles, bdrewery
  Differential Revision:	https://reviews.freebsd.org/D53761

  (cherry picked from commit 3c2643a7dbac370b7232f4e5ac15fd77b9ff396d)


   bin/sh/miscbltin.c             | 83 +++++++++++++++++++++++++++++-------------
   bin/sh/sh.1                    |  6 ++-
   bin/sh/tests/builtins/Makefile |  1 +
   bin/sh/tests/builtins/read11.0 | 19 +++++++++-
   bin/sh/tests/builtins/read12.0 | 32 ++++++++++++++++
   5 files changed, 112 insertions(+), 29 deletions(-)

[commit e9019e777ca3bbb3217df7b54590dcb075430f4e]
Date: 2025-11-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sh tests: Fix racy test11.0
Review: The commit fixes a race condition in a shell test, which is an internal test suite change with no user-visible impact.
Body:

  This was sometimes exiting while the child fifo was created resulting in
  [ENOTEMPTY] from rm.  The child fifo isn't needed, just sleep.

  PR:	290837
  Fixes:	e31fb97148f ("read builtin: Empty variables on timeout")
  MFC after:	3 days

  (cherry picked from commit 5d55553e160a93788372785300f5bd07c2451f93)


   bin/sh/tests/builtins/read11.0 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 646c0a2fe64651dc6315ff4b0ed6ba00924ca080]
Date: 2025-10-21
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: Add guards against empty user data
Review: The nuageinit utility now handles empty user data files gracefully, preventing potential errors when the first line or contents are empty.
Body:

  Add guards against attempting to process a user data file with an empty
  first line or contents.

  PR:		290395
  Reviewed by:	bapt (earlier), dtxdf, markj
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D53239

  (cherry picked from commit 57d25b6333523491ac7a3e869bd5d16127203eed)


   libexec/nuageinit/nuageinit | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit 9eca9724b8706cd185f99ed5a638fad9ce9abe1b]
Date: 2025-10-21
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: nuageinit: Silence luacheck warnings and fix typos
Review: No functional change; only linting fixes and typo corrections.
Body:

  No functional change intended.

  Reviewed by:	bapt, dtxdf, kevans
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D53238

  (cherry picked from commit 81af04b081402d131c7e34b30c88b7c337271fad)


   libexec/nuageinit/nuage.lua          |  6 ++----
   libexec/nuageinit/nuageinit          | 24 +++++++++++-------------
   libexec/nuageinit/tests/addfile.lua  |  2 +-
   libexec/nuageinit/tests/nuageinit.sh |  2 +-
   4 files changed, 15 insertions(+), 19 deletions(-)

[commit e9a7a3e810db7889f34e0826b5fd5083d66e9197]
Date: 2025-11-21
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: isp.4: Fix a typo in the manual page
Review: Fixes a typo in the man:isp[4] manual page.
Body:

  - s/Chanel/Channel/

  (cherry picked from commit 8158b813d90f01368b2045709feee1980a323198)


   share/man/man4/isp.4 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 37432fae629f566a6dc5ae416fe98de5a5367c26]
Date: 2025-11-19
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: lpr(1): Fix a typo in a debug message
Review: Fixes a typo in a debug message in man:lpr[1].
Body:

  - s/unexpect/unexpected/

  (cherry picked from commit 66d4a37bc389bf19ebf2210b0fff762baa659c32)


   usr.sbin/lpr/lpr/lpr.1 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit ad81800724fb078d8a99d7db82731f5e666c69ce]
Date: 2025-11-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: mpool(3): Fix a typo in statistical message
Review: Fixes a typo in a statistical message from the mpool(3) library.
Body:

  - s/cacheing/caching/

  (cherry picked from commit d76ea20f99965e8f3b9dbfcb41ca148711d528bb)


   lib/libc/db/mpool/mpool.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 1780b0d53712184762b01835f5a2cc34db164020]
Date: 2025-11-19
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: ypldap(8): Fix a typo in a debug message
Review: Fixes a typo in a debug message in ypldap(8).
Body:

  - s/unexpect/unexpected/

  (cherry picked from commit 843a4ad5814fe4344b245819880d423343b2d5ab)


   usr.sbin/ypldap/ldapclient.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 25587b30c30afe8219c2cd34d8e3877418a3612e]
Date: 2025-11-20
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.contrib
Subject: ntpd: Fix segfault when same IP on multiple interfaces
Review: Fixes a segmentation fault in man:ntpd[8] that occurs when the same IP address is configured on multiple network interfaces.
Body:

  Use the protype socket to obtain the IP address for an error message.
  Using the resultant socket address, a NULL because create_interface()
  had failed, results in SIGSEGV.

  To reproduce this bug,

  ifconfig bridge100 create
  ifconfig bridge100 10.10.10.10/24
  ifconfig bridge101 create
  ifconfig bridge101 10.10.10.10/24
  ntpd -n

  PR:		291119

  (cherry picked from commit ac1f48b4a7be104d222dea60f1da946fcb345fb1)


   contrib/ntp/ntpd/ntp_io.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b409b786b8a42b05f006dfe7c0ac70923d5fbc70]
Date: 2025-08-28
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: freebsd-update: Add some diagnositic information for a failure case
Review: The freebsd-update utility now provides additional diagnostic output when encountering a specific integrity check failure, aiding in troubleshooting.
Body:

  Users report freebsd-update failing with "The update metadata index is
  correctly signed, but failed an integrity check."  Add a hint at which
  of the cases is failing to help track down the issue.

  PR:		264205
  Reviewed by:	dch
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D52222

  (cherry picked from commit af4ba95daf75cf1b1624dd57038cfaa3ed2753e7)
  (cherry picked from commit d653eca0ef889a8e3fa1e370d2b3ce7b031441a2)


   usr.sbin/freebsd-update/freebsd-update.sh | 16 ++++++++--------
   1 file changed, 8 insertions(+), 8 deletions(-)

[commit d06b14106a376ab1658ea7917ba32c43e377ba2a]
Date: 2025-02-05
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: mtree: Add missing flua/freebsd/sys entry
Review: The commit adds a missing mtree entry for flua/freebsd/sys, ensuring proper directory creation during installation. This is a minor internal fix with no direct user-visible impact.
Body:

  Reviewed by:	imp
  Approved by:	emaste (mentor)
  Fixes:	de1d7d7b87cf ("flua: add freebsd module implementing kldload/kldunload")
  Differential Revision:	https://reviews.freebsd.org/D48838

  (cherry picked from commit c587e4c7e4c28354634b4e13f30743ccdd3fbf91)


   etc/mtree/BSD.debug.dist | 4 ++++
   1 file changed, 4 insertions(+)

[commit 465c30c4f202b02cd9cb12f12d9ea856c84c5203]
Date: 2025-10-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: ConnectWise
Section: Drivers.device
Subject: nvme: add support for DIOCGIDENT
Review: The nvme(4) driver now supports the DIOCGIDENT ioctl on controller and namespace device nodes, providing direct access to identification information without requiring mapping to nda(4) device nodes.
Body:

  Add support for the DIOCGIDENT ioctl to both nvme controller device
  nodes and namespace device nodes.

  This information was already available via the nda(4) device node.
  However, mapping /dev/nvmeX to /dev/ndaY device nodes is not
  straightforward, so it's better to get it directly from the /dev/nvme
  device node.

  PR:		290259
  Sponsored by:	ConnectWise
  Submitted by:	imp (mostly)
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1875

  (cherry picked from commit 6d0001d44490becdd20d627ce663c72a30b9aac3)


   sys/dev/nvme/nvme_ctrlr.c   | 24 ++++++++++++++++++++++++
   sys/dev/nvme/nvme_ns.c      |  5 +++++
   sys/dev/nvme/nvme_private.h |  1 +
   3 files changed, 30 insertions(+)

[commit dbf10fb83839c3aa97b878cdc2f8f0d001b3a63d]
Date: 2025-10-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: ConnectWise
Section: undecided
Subject: tests/sys/netpfil/pf/sctp: make use of required.kmods
Review: The commit modifies a test script to use required.kmods for skipping tests that cannot run, which speeds up test execution but does not affect user-visible functionality.
Body:

  This greatly speeds up skipping a test that can't be run.

  Sponsored by:	ConnectWise
  Reviewed by:	kp
  Differential Revision: https://reviews.freebsd.org/D53215

  (cherry picked from commit 7648d2ebda22fe21ed385cc7d76813a1a9c17c99)


   tests/sys/netpfil/pf/sctp.sh | 18 +++++++++++-------
   1 file changed, 11 insertions(+), 7 deletions(-)

[commit cd81f86919c146fb9da4425a2a424e1447e3b355]
Date: 2025-10-19
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Userland.programs
Subject: find: fix pathnames printed by the SIGINFO handler
Review: The SIGINFO handler in man:find[1] no longer duplicates the last component of the pathname when printing progress.
Body:

  Don't duplicate the last component.

  PR:		290362
  Reported by:	John F. Carr <jfc@mit.edu>
  Fixes:		d06a00963b7
  Reviewed by:	jilles, Goran Meki <meka@tilda.center>
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1878

  (cherry picked from commit f6d767fe862964f704baf4eb388a30ed8227bb65)


   usr.bin/find/find.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit f6688f9ed5db710e0026053f2f6b73051f87bc16]
Date: 2025-10-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: fusefs: Fix intermittency in the BadServer.ShortWrite test case
Review: The commit fixes an intermittent test failure in the fusefs test suite by adding a separate bit to handle kernel unmount scenarios. This change is internal to the test framework and does not affect user-visible behavior, system functionality, or configuration.
Body:

  We were using the m_quit bit for two similar but distinct uses:

  * To instruct the server to quit
  * To cope with the kernel forcibly unmounting the fs

  Fix the intermittent test failure by adding a separate bit,
  m_expect_unmount, to handle cases like the latter.

  Reported by:	Siva Mahadevan <me@svmhdvn.name>
  Revied by:	Siva Mahadevan <me@svmhdvn.name>
  Differential Revision: https://reviews.freebsd.org/D53357

  (cherry picked from commit d86025c1d49c84c4dc8c3635c83c078ad56e5a53)


   tests/sys/fs/fusefs/bad_server.cc | 8 ++++----
   tests/sys/fs/fusefs/mockfs.cc     | 5 +++--
   tests/sys/fs/fusefs/mockfs.hh     | 3 +++
   3 files changed, 10 insertions(+), 6 deletions(-)

[commit 3b8ac7895d7bcb66aaa83d2667b8e3de17f02ede]
Date: 2025-10-25
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: fusefs: fix page fault triggered by async notification when unmounted
Review: Fixes a page fault in fusefs when asynchronous notifications arrive while the file system is not mounted or already unmounted.
Body:

  A FUSE daemon can send asynchronous notification to the kernel in order
  to, for example, invalidate an inode's cache.  Fix a page fault that can
  happen if the file system isn't yet mounted, or is already unmounted,
  when that notification arrives.

  PR:		290519
  Reviewed by:	emaste
  Differential Revision: https://reviews.freebsd.org/D53356

  (cherry picked from commit 5d42c8813976af484fd3e9a896c7839ba27ca764)


   sys/fs/fuse/fuse_device.c     |  6 +++++
   tests/sys/fs/fusefs/mockfs.cc |  4 +++-
   tests/sys/fs/fusefs/mockfs.hh |  4 +++-
   tests/sys/fs/fusefs/notify.cc | 56 +++++++++++++++++++++++++++++++++++++++++++
   4 files changed, 68 insertions(+), 2 deletions(-)

[commit e53590238a3dd39c9620100276c4633feb43de01]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: fusefs: fix intermittency in the BadServer.ShortWrite test
Review: The commit fixes a flaky test case in the fusefs test suite, which does not affect user-visible behavior or functionality.
Body:

  This test implicitly depended on the order in which two threads
  completed.  If the test thread finished first, the test would pass.  But
  if the mock file system thread did, it would attempt to read from an
  unmounted file system, and fail.  As a result, the test would randomly
  fail once out of every several thousand executions.  Fix it by telling
  the mock file system's event loop to exit without attempting to read any
  more events.

  Reported by:	Siva Mahadevan <me@svmhdvn.name>
  Reviewed by:	Siva Mahadevan <me@svmhdvn.name>
  Differential Revision: https://reviews.freebsd.org/D53080

  (cherry picked from commit d1bd541b385d49d2ae3a8bad9df72779b606e208)


   tests/sys/fs/fusefs/bad_server.cc | 5 +++++
   1 file changed, 5 insertions(+)

[commit 09e1d6fc41ab1e9c820e9d62dda416785bf1bb71]
Date: 2025-11-19
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libexec/lua: Fix two typos in the manual pages
Review: Fixes two typos in manual pages for lua libraries.
Body:

  - s/environnement/environment/
  - s/interger/integer/

  (cherry picked from commit 58b86e40ce76de649db19d9d1f8571d5c942d44b)


   libexec/flua/libfreebsd/kenv/freebsd.kenv.3lua             | 2 +-
   libexec/flua/libfreebsd/sys/linker/freebsd.sys.linker.3lua | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit bc97e62961e6f204582951051fa643e4cb1caddd]
Date: 2025-11-19
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: nuageinit: Fix a typo in an error message
Review: Fixes a typo in an error message of man:nuageinit[8].
Body:

  - s/outout/output/

  (cherry picked from commit 73a026d5e9778ac182be4a5876771eefa2cd6f41)


   libexec/nuageinit/nuageinit | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 9437a4d37e57b3d986af25379b2e171c25564b0e]
Date: 2025-11-19
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: exit.3: Fix a typo in the manual page
Review: Fixes a typo in the man:exit[3] manual page.
Body:

  - s/avaliable/available/

  (cherry picked from commit 9334fa3ef5e19de7d3dcdbefdaa3f6b6b653475a)


   lib/libc/stdlib/exit.3 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5705569f3c00fdaedfa7c0ced2d1c51c8d3d2370]
Date: 2025-11-19
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: stand/lua: Fix two typos in the manual pages
Review: Typographical errors in the man:lua[8] and man:loader.lua[8] manual pages are corrected.
Body:

  - s/Additionnaly/Additionally/
  - s/commmand/command/

  (cherry picked from commit 6f14b6025a6f6475522697362aaf6c84514b85bf)


   stand/lua/config.lua.8 | 2 +-
   stand/lua/loader.lua.8 | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit cf95eabb5572368c80d72c151ebebca8cf6b2dbc]
Date: 2025-10-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: netlink: in snl_init_writer() don't overwrite error in case of failure
Review: The commit fixes an internal error handling bug in the netlink subsystem without any user-visible change in behavior, configuration, or features.
Body:

  PR:	290050
  (cherry picked from commit 488718ff42346888243496c00cbeb42ba004171e)


   sys/netlink/netlink_snl.h | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 6ceab1c42853c42d7a1aca018ffbd58b65c94081]
Date: 2025-11-21
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: dmesg.8: Index kern.msgbuf_show_timestamp
Review: The man:page for dmesg(8) now marks the kern.msgbuf_show_timestamp sysctl with the Va macro, making it searchable via apropos Va=kern.msg.
Body:

  This is the only place this important debugging tunable is documented.
  Mark it up with the Va macro according to style.mdoc(5) so that people
  can find it via `apropos Va=kern.msg`, the standard syntax to search
  the FreeBSD manual for sysctls and tunables.

  Fixes:	6910fee62e77 (dmesg: Document kern.msgbuf_show_timestamp)
  (cherry picked from commit e13664f6a44b4970ea5e8378b8e1a4879fa5d5a0)


   sbin/dmesg/dmesg.8 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit f6736196721420caff102724b461e3a5211cfa09]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: The FreeBSD Foundation
Section: Userland.deprecated
Subject: fdisk: Bump removal to FreeBSD 16.0
Review: The fdisk utility is scheduled for removal in FreeBSD 16.0, affecting users who rely on it for disk partitioning.
Body:

  Removal did not happen prior to 15.0.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit f817f6e7f4a8dc507f3e1b1603dfd2d81093e3bd)
  (cherry picked from commit 739750ae7c63c653025ad84cac6ba7cb6756dcf8)
  (cherry picked from commit 2be4c64a0d27a9136cc05c9bdf7a45162339aa69)


   sbin/fdisk/fdisk.8 | 4 ++--
   sbin/fdisk/fdisk.c | 2 +-
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit b4a6b62e683b9f1d86525d921e4abc9c48d195e7]
Date: 2025-11-15
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Kernel.general
Subject: NOTES: Add iwm
Review: The commit adds iwm to the kernel configuration NOTES file, which makes the Intel Wireless driver available as a kernel module option for users building custom kernels.
Body:

  (cherry picked from commit b1039bbe185bbadea24207b600f4bea065a2dbee)


   sys/x86/conf/NOTES | 1 +
   1 file changed, 1 insertion(+)

[commit fcca6e11694dbfc24abed7b484fe8cc8fc9affa1]
Date: 2025-11-15
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Use install instead of cp to copy bootstrap tools
Review: The commit changes the build system to use install -p instead of cp to copy bootstrap tools, which avoids issues with preserving flags on NFS-mounted OBJROOT and ensures compatibility across different host systems. This may affect users building FreeBSD on NFS or cross-building, but the change is internal to the build process with no direct user-visible impact.
Body:

  We need to preserve modification times on bootstrap tools, but `cp -p`
  also tries to preserve flags, which fails if OBJROOT is on NFS.  A -N
  option was added to cp for this purpose, but trying to use that would
  break cross-building on hosts that don't have that option.  The best
  remaining option is `install -p`, which we already assume is present.

  PR:		275030
  Reviewed by:	imp, emaste
  Differential Revision:	https://reviews.freebsd.org/D53751

  (cherry picked from commit f3cf4c0af5af6ce95065a615f998117ec1cd63aa)


   Makefile.inc1        | 2 +-
   tools/build/Makefile | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit fa1337393b84203bbf9431057e2a5671d6198aaa]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=5)
Sponsor: 
Section: Docs.manpages
Subject: efirt.9: Fix a typo in the manual page
Review: Fixes a typo in the man:efirt[9] manual page.
Body:

  - s/retireved/retrieved/

  (cherry picked from commit 1a28455cb5f59de98cd6085fce500b457eb80847)


   share/man/man9/efirt.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 35dc35e3b28907617f855ad52e49794e1e674ed8]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=5)
Sponsor: 
Section: Docs.manpages
Subject: copy.9: Fix a typo in the manual page
Review: Fixes a typographical error in the man:copy[9] manual page.
Body:

  - s/heterogenous/heterogeneous/

  (cherry picked from commit ad7bbe691b453039980df729f32fffaf02ffd21c)


   share/man/man9/copy.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a35f62fcd4d0384971046a1713998e42f2cb399f]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: isci(4): Fix two typos in a log messages
Review: Fixes two typos in log messages for the isci(4) driver.
Body:

  - s/suspeneded/suspended/

  (cherry picked from commit 7b11940d4a66589069c21534dd0b969f79ae79df)


   sys/dev/isci/scil/scic_sds_remote_node_context.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit df8a1f9863fcafd05dbab0075d08c3ddbda120ff]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: mfi(4): Fix a typo in a KASSERT message
Review: Fixes a typo in a KASSERT message in the mfi(4) driver. This change has no user-visible impact.
Body:

  - s/dissappeared/disappeared/

  (cherry picked from commit a25172844edaaa7e18c1dcecb6df8b8832456334)


   sys/dev/mfi/mfi.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 2c7e44d93139d2331e3d86b60e4d736a5056b3bc]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: igc(4): Fix a typo in a sysctl description
Review: Fixes a typo in a sysctl description for the igc(4) driver.
Body:

  - s/Recevied/Received/

  (cherry picked from commit defe77554d134964d7c197a2f3ca552778e8b41a)


   sys/dev/igc/if_igc.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit aba5152d983e42d5d755c35cb32a0c4fbc78b7fa]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: ciss(4): Fix a typo in a debug messsage
Review: Fixes a typo in a debug message in the ciss(4) driver.
Body:

  - s/unspported/unsupported/

  (cherry picked from commit 84d75bb018e1800d610760191ff64c3eebcb46d7)


   sys/dev/ciss/ciss.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 27ef84d447aa304ac5119630151e9c0bcdb118c0]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: cesa: Fix a typo in a device messsage
Review: Fixes a typo in a device driver message.
Body:

  - s/exhaused/exhausted/

  (cherry picked from commit 081aa26778f3facdd836c28b2e3fed5de2f8b7b4)


   sys/dev/cesa/cesa.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 08e65097a1f3fb155e98a0ae9b9a7098cea8ffd4]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: bwi(4): Fix a typo in a panic messsage
Review: Fixes a typo in a panic message in the bwi(4) driver.
Body:

  - s/unsupport/unsupported/

  (cherry picked from commit 404af374b10ca56c6f82510a5bb23232a9f25c34)


   sys/dev/bwi/if_bwi.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5054789b93fac7625a46d51ce58e1a104dcd2d28]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ath(4): Fix a typo in a device messsage
Review: Fixes a typo in a device message displayed by the ath(4) driver.
Body:

  - s/Orignal/Original/

  (cherry picked from commit 3eaa2a852b475c7f063bbf677fa536e76514d309)


   sys/dev/ath/ath_hal/ar5416/ar5416_cal_iq.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a24f891d999cd6f2a91bd80af139cd329cd02115]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vnic: Fix a typo in a device messsage
Review: Fixes a typo in a device driver message.
Body:

  - s/interrups/interrupts/

  (cherry picked from commit 74a44a0bc8ab965d28d1ce804d3f0aead035faf0)


   sys/dev/vnic/nicvf_main.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c1500bede861e36ab48132bf54821c3657523f30]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: oce(4): Fix a couple of typos in a sysctl descriptions
Review: Fixes typos in sysctl descriptions for the oce(4) driver.
Body:

  - s/Fragements/Fragments/
  - s/Recived/Received/
  - s/Alignmnet/Alignment/

  (cherry picked from commit 542f5985a8c2e7cccc9beb9801ec166082bb7e68)


   sys/dev/oce/oce_sysctl.c | 12 ++++++------
   1 file changed, 6 insertions(+), 6 deletions(-)

[commit 07792c725bb4c974222c61bb79ba80dbe70e018b]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: amdtemp(4): Fix typo in a sysctl description
Review: Fixes a typo in the sysctl description for the amdtemp driver.
Body:

  - s/temparature/temperature/

  (cherry picked from commit 85d6c86f4b53e6ac2a9b163c553b48466638f394)


   sys/dev/amdtemp/amdtemp.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e8785943e769708c15009ea2e04a2f9b0ea4c7ec]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ale(4): Fix typo in a kernel message
Review: Fixes a typo in a kernel message for the ale(4) driver.
Body:

  - s/sequnce/sequence/

  (cherry picked from commit a675f3bb63774a63f668749c6c3c8dfbb6be1cd6)


   sys/dev/ale/if_ale.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5d82245e983e5d610d6060e70735b7a620ce6c00]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: acpi(4): Fix typo in a panic message
Review: Fixes a typo in a panic message in the ACPI subsystem.
Body:

  - s/depenedent/dependent/

  (cherry picked from commit f51fb91d616d49e91f3c2c706263a38b98176911)


   sys/dev/acpica/acpi_pcib_acpi.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 18e3b0c3cd4ffc5e2a0b20de4d327ca37d51c568]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: tegra210: Fix typo in a kernel message
Review: Fixes a typo in a kernel message for the Tegra210 voltage regulator driver.
Body:

  - s/volatge/voltage/

  (cherry picked from commit 6a02851a0e346cbff074dab87807c9ee9d1e8d94)


   sys/arm64/nvidia/tegra210/max77620_regulators.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 88b980ad94746c58a43dbf0f92e3e8c56f578d1a]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: arm/ti: Fix typo in a KASSERT message
Review: Typo fix in a kernel assertion message only; no user-visible impact.
Body:

  - s/patcket/packet/

  (cherry picked from commit 862024c00f3126220ac425f9ec1f3d4286064688)


   sys/arm/ti/cpsw/if_cpsw.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a7ce2f34b43e102595b7eb31248726b5d8da63e0]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: arm/mv: Fix typo in a kernel error message
Review: Fixes a typo in a kernel error message for the Marvell CP110 interrupt controller driver.
Body:

  - s/Unkown/Unknown/

  (cherry picked from commit b074d146969d3097c1e144623360b36083d74927)


   sys/arm/mv/mv_cp110_icu.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 179fa1d81c73ab7ef231e17da73f230e4f8ee5a2]
Date: 2025-11-14
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: quot: Rewrite -n mode input parser
Review: The man:quot[8] utility's -n mode input parser is rewritten to handle invalid input consistently, ignoring non-numeric lines and warning on out-of-range inode numbers.
Body:

  The existing parser was needlessly complicated and wildly inconsistent
  in how it handled invalid input.  Rewrite using getline() and treat
  invalid input consistently: silently ignore lines that don't begin with
  a number, and print a warning if the inode number is out of range.

  PR:		290992
  MFC after:	1 week
  Reviewed by:	obrien
  Differential Revision:	https://reviews.freebsd.org/D53726

  (cherry picked from commit fa272a5276865a97b01823fe6546940eaaf1b164)


   usr.sbin/quot/quot.8             |  3 ++-
   usr.sbin/quot/quot.c             | 47 ++++++++++++++++++++++------------------
   usr.sbin/quot/tests/quot_test.sh | 19 ++++++++++++++++
   3 files changed, 47 insertions(+), 22 deletions(-)

[commit b41551753a2baff6646e2958acb4a7fcd205b69c]
Date: 2025-10-17
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: quot: Add tests
Review: The man:quot[8] utility now sorts users with equal filesystem usage by UID and includes an undocumented option to keep numerical UIDs instead of names. The first output line is now identical whether a mountpoint or device is specified.
Body:

  To facilitate the task, we change the comparison function so that users
  with equal filesystem usage are sorted by UID, and add an undocumented
  option that prevents quot from replacing numerical UIDs with names.  We
  also switch from getfsfile(3) to getmntpoint(3) so the first line is
  identical regardless of whether we pass quot a mountpoint or a device.

  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D53133

  (cherry picked from commit aa870a1935bccb66e02c4c31630706768a3e7d74)
  (cherry picked from commit b5f3f1a661ab69986c3379fa4c9c2b38785933db)


   etc/mtree/BSD.tests.dist         |   2 +
   usr.sbin/quot/Makefile           |   5 +-
   usr.sbin/quot/quot.c             |  11 ++++-
   usr.sbin/quot/tests/Makefile     |   4 ++
   usr.sbin/quot/tests/quot_test.sh | 101 +++++++++++++++++++++++++++++++++++++++
   5 files changed, 120 insertions(+), 3 deletions(-)

[commit 99ee702464b7a579600e784d2d3ae272fe3e3934]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: geom(4): Fix typo in a kernel message
Review: Fixes a typo in a kernel message.
Body:

  - s/supressing/suppressing/

  (cherry picked from commit 57b78a557b3ce07b1589c9c21debe97d45599391)


   sys/geom/geom_vfs.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6561d5296fb96f921ca61f504e2e295fe963a146]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: usb(4): Fix typos in upgt(4) and zyd(4)
Review: Fixes typos in man:upgt[4] and man:zyd[4] driver documentation.
Body:

  - s/frequence/frequency/
  - s/finsihed/finished/

  (cherry picked from commit 679976d8162004f879a1a0d5ca0c5d2ade5fa1bd)


   sys/dev/usb/wlan/if_upgt.c | 6 +++---
   sys/dev/usb/wlan/if_zyd.c  | 2 +-
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit 1a1eae617d3f3bf9e2bb48519d9f5abe204ba727]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: audit(4): Fix a typo in an kernel error message
Review: Fixes a typo in an audit(4) kernel error message.
Body:

  - s/Authenticateion/Authentication/

  (cherry picked from commit 63af953e09ccd11f2f5b4d83b10cc231f691de46)


   sys/security/audit/bsm_errno.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit dac93faa4265b68d9435bb229077463a52357376]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: aic7xxx: Fix a couple of typos in device messages
Review: Typographical errors in device driver messages are corrected.
Body:

  - s/Reseting/Resetting/
  - s/staus/status/
  - s/referrenced/referenced/

  (cherry picked from commit d1e39f3d6e5fce1a30a5713d522f87d83654c4bd)


   sys/dev/aic7xxx/aic79xx.c | 6 +++---
   sys/dev/aic7xxx/aic7xxx.c | 4 ++--
   2 files changed, 5 insertions(+), 5 deletions(-)

[commit 17f4fc2bdbef631aa9e2812907615f4dd1400872]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: nfsclient: Fix a typo in a panic message
Review: Fixes a typo in an NFS client panic message, which does not affect functionality or user experience.
Body:

  - s/eroneous/erroneous/

  (cherry picked from commit 08a6620093dc2786051bf6ae6f40ae048027021b)


   sys/fs/nfsclient/nfs_clrpcops.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit f48472795049ea612dc062d1de04dabd41e3fdfb]
Date: 2025-10-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: cam: Fix three typos in kernel messages
Review: Fixes typos in kernel messages for CAM subsystem components.
Body:

  - s/maximun/maximum/
  - s/queing/queueing/
  - s/exhausing/exhausting/

  (cherry picked from commit adfe14dcc2747a20dff961044d6817c507087327)


   sys/cam/ctl/ctl.c           | 2 +-
   sys/cam/scsi/scsi_enc.c     | 2 +-
   sys/cam/scsi/scsi_enc_ses.c | 2 +-
   3 files changed, 3 insertions(+), 3 deletions(-)

[commit 8f381ddfa4fc9943c1b7c1e75fd2eb0020e9caa6]
Date: 2025-10-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ocs_fc(4): Fix a couple of typos in kernel messages
Review: Fixes typos in kernel messages for the ocs_fc(4) driver.
Body:

  - s/unexpectd/unexpected/
  - s/Unexected/Unexpected/
  - s/niether/neither/
  - s/sucessfully/successfully/
  - s/Inavlid/Invalid/
  - s/toplogy/topology/

  (cherry picked from commit aa0cd9e5b4d21b11097e1c21a3c0eb23525c15c3)


   sys/dev/ocs_fc/ocs_device.c  | 2 +-
   sys/dev/ocs_fc/ocs_els.c     | 4 ++--
   sys/dev/ocs_fc/ocs_gendump.c | 4 ++--
   sys/dev/ocs_fc/ocs_ioctl.c   | 2 +-
   sys/dev/ocs_fc/ocs_scsi.c    | 2 +-
   sys/dev/ocs_fc/ocs_xport.c   | 4 ++--
   6 files changed, 9 insertions(+), 9 deletions(-)

[commit 28fd874b5628699590207f16fbb76a7862bced7a]
Date: 2025-10-28
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: hyper-v: Fix a couple of typos in kernel messages
Review: Fixes typos in Hyper-V kernel messages, improving clarity of diagnostic output.
Body:

  - s/tranparent/transparent/
  - s/Unknow/Unknown/
  - s/qury/query/

  (cherry picked from commit 1ef6fef9d5c82a106ba8e42c1e087f9b5d1dfec6)


   sys/dev/hyperv/netvsc/if_hn.c                   | 6 +++---
   sys/dev/hyperv/storvsc/hv_storvsc_drv_freebsd.c | 2 +-
   sys/dev/hyperv/utilities/hv_kvp.c               | 2 +-
   3 files changed, 5 insertions(+), 5 deletions(-)

[commit 305382935a4f9fb687f02d36efc2814c5bf88fb7]
Date: 2025-10-28
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: arm/nvidia/tegra: Fix a couple of typos in kernel messages
Review: Fixes typos in kernel messages for NVIDIA Tegra drivers.
Body:

  - s/intialization/initialization/
  - s/Cannott/Cannot/
  - s/ivalid/invalid/
  - s/wating/waiting/

  (cherry picked from commit b87836e824ea40793317d551eb13a8e2814f83f9)


   sys/arm/nvidia/tegra_ahci.c | 2 +-
   sys/arm/nvidia/tegra_lic.c  | 4 ++--
   sys/arm/nvidia/tegra_mc.c   | 2 +-
   sys/arm/nvidia/tegra_xhci.c | 4 ++--
   4 files changed, 6 insertions(+), 6 deletions(-)

[commit 727a1f189d2871bb3a45d28e9d286e534930622c]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: vn_fullpath.9: Fix two typos in the manual page
Review: Fixes two typographical errors in the man:vn_fullpath[9] manual page.
Body:

  - s/resulting/resulting/
  - s/initally/initially/

  (cherry picked from commit 3b79697040a7d3f9a4a21fb2e66d9031feb6af84)


   share/man/man9/vn_fullpath.9 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 695ff7a3a56278d642fb74677770c98060c320dd]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: seqc.9: Fix a typo in the manual page
Review: Fixes a typographical error in the man:seqc[9] manual page.
Body:

  - s/changees/changes/

  (cherry picked from commit fe45f7ddb53f16198a60cd015c20f5fc524aed89)


   share/man/man9/seqc.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b709dbfe4875e3ac8bd2d25d8c500886668e0d23]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: refcount.9: Fix a typo in the manual page
Review: Fixes a typographical error in the man:refcount[9] manual page.
Body:

  - s/sucessfully/successfully/

  (cherry picked from commit 40fae644ba9a27227ca6f7c290e54fcef462b341)


   share/man/man9/refcount.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 35c612fbabd8a6fd23e65881595873d0797da4b8]
Date: 2025-11-12
Score: 5
Status: added(include=yes,score=85)
Sponsor: Klara, Inc.
Section: Storage.general
Subject: tarfs: Fix support for large files
Review: The tarfs filesystem now correctly handles large files exceeding 4 GB and 8 GB limits. It fixes decompression errors when seeking beyond 4 GB in zstd-compressed tarballs and properly processes extended header records for files larger than 8 GB.
Body:

  * When fast-forwarding through a zstd frame, we incorrectly used the
    min() inline function instead of the MIN() macro.  The function
    truncates the result to unsigned int, resulting in a decompression
    error when trying to seek more than 4 GB into the frame.

  * POSIX states that a size extended header record overrides the size
    field in the header if present, and that one must be included if the
    size of the file exceeds 8 GB (the size field maxes out at 64 GB).

  * Reduce repetition in the exthdr parser by deduplicating the syntax
    error handler.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Fixes:		69d94f4c7608 ("Add tarfs, a filesystem backed by tarballs.")
  Reviewed by:	allanjude
  Differential Revision:	https://reviews.freebsd.org/D53718

  (cherry picked from commit a34a57d4b4eba88dfa5541d7d77b63b01c1a1a9a)


   sys/fs/tarfs/tarfs_io.c          |  2 +-
   sys/fs/tarfs/tarfs_vfsops.c      | 48 +++++++++++++++++++---------------------
   tests/sys/fs/tarfs/tarfs_test.sh | 27 ++++++++++++++++++++++
   3 files changed, 51 insertions(+), 26 deletions(-)

[commit b0abbe05dfa144ff6ceabeb317e9493a13c0917d]
Date: 2025-11-11
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.programs
Subject: date: Improve nanosecond support
Review: The man:date[1] utility now supports a field width specifier for nanoseconds in format strings, defaulting to 9 digits if unspecified or zero. If the width is not exactly 9, digits are truncated or zero-padded accordingly; a dash selects a width based on the clock's reported resolution, aligning with GNU coreutils behavior.
Body:

  Add support for a field width, which defaults to 9 if unspecified or
  zero.  If the width is not exactly 9, we have to either cut off digits
  or append zeroes to make up the difference.  If the width is a dash,
  we pick a width based on the clock's reported resolution.  This brings
  us in line with GNU coreutils.

  PR:		287080
  MFC after:	1 week
  Reviewed by:	0mp
  Differential Revision:	https://reviews.freebsd.org/D53667

  (cherry picked from commit 38839c872e7af6a1424009bf07d6b4450e9ca61d)


   bin/date/date.1                      |  50 ++++++++++--
   bin/date/date.c                      | 148 ++++++++++++++++++++++++-----------
   bin/date/tests/format_string_test.sh |   2 +
   3 files changed, 147 insertions(+), 53 deletions(-)

[commit c00ad4a56c7861aae85db455854c3e786f496ff8]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=5)
Sponsor: 
Section: Docs.manpages
Subject: pci.9: Fix a typo in the manual page
Review: Fixes a typographical error in the man:pci[9] manual page.
Body:

  - s/maxmimum/maximum/

  (cherry picked from commit a859a5c6978de121efc7771351d32550ee430b7c)


   share/man/man9/pci.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b20d8a0ba40215569405f6f79131bb001623da98]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: ofw_bus_is_compatible.9: Fix a typo in the manual page
Review: Fixes a typo in the man:ofw_bus_is_compatible[9] manual page.
Body:

  - s/compatibile/compatible/

  (cherry picked from commit b1f96b1c4c95df5c04e067c638e52c9652f86721)


   share/man/man9/ofw_bus_is_compatible.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a05a924995ae4bc98db31c2dfd6d96148cd96382]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: nvmem.9: Fix multiple typos in the manual page
Review: Fixes typos in the man:nvmem[9] manual page.
Body:

  - s/sucess/success/

  (cherry picked from commit 005603cd3dee7610587f1193f9529eb2a42781d7)


   share/man/man9/nvmem.9 | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 3319c8d1e4decbec638e3437d7b347b5c93026bf]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: Docs.manpages
Subject: gone_in.9: Fix a typo in the manual page
Review: Fixes a typo in the man:gone_in[9] manual page.
Body:

  - s/Initializaiton/Initialization/

  (cherry picked from commit 576e735efb85cae5213621981ed33ced8878a352)


   share/man/man9/gone_in.9 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit fef3a18a0b55d62d0a6e0411e0bcef7724bc5847]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=5)
Sponsor: 
Section: Docs.manpages
Subject: domain.9: Fix a typo in the manual page
Review: Fixes a typo in man:domain[9].
Body:

  - s/exprimental/experimental/

  (cherry picked from commit e17c87d4a27509ed8324e69056b06dec878db064)


   share/man/man9/domain.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 29f2f316a179cf6c4c7bd9b45b6637bea05c67b1]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: crypto_request.9: Fix a typo in the manual page
Review: Fixes a typo in the man:crypto_request[9] manual page.
Body:

  - s/througput/throughput/

  (cherry picked from commit a1e76a3af8d64b400100d8ab595eeb32cd79d358)


   share/man/man9/crypto_request.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4539d9f3b4731d489f5018ef9dec627683aea33d]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: bus_dma.9: Fix two typos in the manual page
Review: Fixes two typographical errors in the man:bus_dma[9] manual page.
Body:

  - s/decribes/describes/
  - s/Muliple/Multiple/

  (cherry picked from commit 5215760811a5ce75d77f9017e392445014e6b1bb)


   share/man/man9/bus_dma.9 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit b92d5b797f05e695fa33e86891ae1dab00cc05e1]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: bhnd.9: Fix a typo in the manual page
Review: Fixes a typo in the man:bhnd[9] manual page.
Body:

  - s/devce/device/

  (cherry picked from commit 3ceaf4d80401fab49895a5ac3bb1fe602f588da8)


   share/man/man9/bhnd.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit af45b1efc9b55ddf1a623b94b81d09b4bdac3b05]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: atomic.9: Fix a typo in the manual page
Review: Fixes a typo in the man:atomic[9] manual page.
Body:

  - s/constrast/contrast/

  (cherry picked from commit 2f263badccf842470323b64613eccb0c0b9a12c1)


   share/man/man9/atomic.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 9eae326a58ebfcd30f44f6e2cf88bb0efd02fd7e]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: PCI_IOV_ADD_VF.9: Fix a typo in the manual page
Review: Fixes a typographical error in the man:PCI_IOV_ADD_VF[9] manual page.
Body:

  - s/initializating/initializing/

  (cherry picked from commit d81fe0b206325b40e13625f5684ec8d19fdccf04)


   share/man/man9/PCI_IOV_ADD_VF.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e39f64a7a3ebb39e47b62c84ebd5c8e40d08b99d]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: pmcstat(8): Fix a typo in an error message
Review: Fixes a typo in an error message of man:pmcstat[8].
Body:

  - s/evalation/evaluation/

  (cherry picked from commit 780a50c729c7bc0ac1750947223feadd918b17e8)


   usr.sbin/pmcstat/pmcstat.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 906934ac391c815f0cd23406545c15ba5c79ea6d]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: rtlbtfw(8): Fix a typo in an error message
Review: Fixes a typo in an error message displayed by man:rtlbtfw[8].
Body:

  - s/Parseing/Parsing/

  (cherry picked from commit 39d43543b306ac686aa684303ae972c386ccea12)


   usr.sbin/bluetooth/rtlbtfw/main.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a2754976efe2f8989dd056f6126020a4bbfc4e32]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: nvmecontrol(8): Fix a typo in an error message
Review: Fixes a typo in an error message of man:nvmecontrol[8].
Body:

  - s/speciifed/specified/

  (cherry picked from commit 44004bcffabc3372d6812c2e0c4bf90386919e21)


   sbin/nvmecontrol/perftest.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b12f5537df397d40ae02adf2c9ecaa7cd0b5a512]
Date: 2025-11-17
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Storage.general
Subject: zfs: fix aarch64 build after zfs-2.2.9
Review: The commit removes two lines from the ZFS module's Makefile to fix the aarch64 build after an update to zfs-2.2.9. This change resolves a build failure on aarch64 systems, ensuring ZFS can be compiled and used on that architecture.
Body:

  (cherry picked from commit fb709935d64d5fd4ad21cf8c69faf580760999e4)


   sys/modules/zfs/Makefile | 2 --
   1 file changed, 2 deletions(-)

[commit 2d2d945440ff3baa3475c13b3be43b06bc1fa587]
Date: 2025-11-19
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Storage.general
Subject: zfs: update zfs_config.h and zfs_gitrev.h to zfs-2.2.9
Review: OpenZFS has been updated to version 2.2.9.
Body:


   sys/modules/zfs/zfs_config.h | 23 +++++++++++++++++++----
   sys/modules/zfs/zfs_gitrev.h |  2 +-
   2 files changed, 20 insertions(+), 5 deletions(-)

[commit 18391412cecfc338fd4ac747e766fbc0721ca3f8]
Date: 2025-11-09
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Docs.manpages
Subject: geom_zero.4: Document
Review: The commit adds a new man page for the GEOM ZERO class, documenting its features and usage.
Body:

  PR:	250593
  Reviewed by:	bcr, ziaee
  Thanks to:	imp, markj
  MFC after:	1 week
  Fixes:	3843eba85d98 Add unmapped BIO support to GEOM ZERO
  Fixes:	24e1fdcd1a69 Allow to specify the byte which will be used for filling read buffer
  Fixes:	565bc101112c Add a very simple and small GEOM class - ZERO

  (cherry picked from commit 39acb7fd86eda721df402c2f1368b78cede161c3)


   share/man/man4/Makefile    |   2 +
   share/man/man4/geom_zero.4 | 174 +++++++++++++++++++++++++++++++++++++++++++++
   share/man/man4/zero.4      |   3 +-
   3 files changed, 178 insertions(+), 1 deletion(-)

[commit 7d43404485bf2e306e54bdfdb0ae937d6921df39]
Date: 2025-11-04
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: dtrace_callout_execute.4: Document the DTrace callout_execute provider
Review: Adds man:dtrace_callout_execute[4] manual page documenting the DTrace callout_execute provider.
Body:

  MFC after:	2 weeks
  Fixes:		91dd9aae1ab8 Add explicit static DTrace tracing to the callout mechanism
  Differential Revision:	https://reviews.freebsd.org/D51397

  (cherry picked from commit 3ccb2d9513e6a2e046e635c186da68acf8f8498b)


   cddl/contrib/opensolaris/cmd/dtrace/dtrace.1 |  1 +
   share/man/man4/Makefile                      |  1 +
   share/man/man4/dtrace_callout_execute.4      | 68 ++++++++++++++++++++++++++++
   share/man/man9/callout.9                     |  4 +-
   4 files changed, 73 insertions(+), 1 deletion(-)

[commit f363f4a8fa8b7d7beb79d2f6f70479aad30e7d6f]
Date: 2025-11-06
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Kernel.general
Subject: kern_thread: thread_suspend_check(1) must never suspend
Review: The thread_suspend_check(1) function now ensures that a thread is never suspended, preventing potential deadlocks in kernel thread management.
Body:

  PR:	290843

  (cherry picked from commit e1c6f4cb9bd29358c2b2fe249af9a2f9626b0670)


   sys/kern/kern_thread.c | 15 +++++++++++----
   1 file changed, 11 insertions(+), 4 deletions(-)

[commit 45197d29ced2f57941a771dc8ec37243a52b9a7e]
Date: 2025-10-22
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.libraries
Subject: Fix getmntpoint(3) to operate as it is documented in its manual page.
Review: The man:getmntpoint[3] function now correctly prepends /dev/ to device names that do not begin with a '/', aligning its behavior with the documented API.
Body:

  The -libutil function getmntpoint(3) is documented as accepting a device
  name with or without /dev/ prepended to it but did not attempt to
  prepend /dev/. This patch corrects the problem by prepending /dev/ to
  names that do not begin with a '/'.

  Reported-by: Dag-Erling Smrgrav
  Differential Revision: https://reviews.freebsd.org/D53185
  Sponsored-by: Netflix

  (cherry picked from commit 99bf680a8499dea71db5da705dfe41f4bb5e00ab)


   sbin/mount/getmntopts.c | 53 ++++++++++++++++++++++++++++++++++---------------
   1 file changed, 37 insertions(+), 16 deletions(-)

[commit 321a153806685dff031c6ab2d453f077914910ec]
Date: 2025-07-26
Score: 5
Status: added(include=yes,score=85)
Sponsor: 
Section: Hardware.virtualization
Subject: bhyve: Report SVM as disabled on AMD
Review: bhyve now reports SVM as disabled in the VM control register, preventing hangs on AMD systems with recent Windows guests.
Body:

  bhyve with a Windows 2025 guest will hang/freeze with the message
      rdmsr to register 0xc0010114
  on a system with an AMD Ryzen 5. Evidently, recent versions of Windows
  ignore the CPUID bits and still read this MSR.

  Fix is to report Secure Virtual Machine (SVM) mode as disabled in the VM CR.

  PR:		288308

  (cherry picked from commit 92dfc3fbcd79422a4586590edabe483f361b7e0e)


   usr.sbin/bhyve/amd64/xmsr.c | 9 +++++++++
   1 file changed, 9 insertions(+)

[commit 511e33d209257eadeb5487bcff91389c3ff6d5eb]
Date: 2025-10-13
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: Add --libxo support for geom status and list sub commands.
Review: The geom(8) status and list subcommands now support the --libxo option, enabling JSON, XML, and HTML output formats for scripting and automation.
Body:

  Submitted-by: Johan Sllvander
  Differential Revision: https://reviews.freebsd.org/D37615
  Differential Revision: https://reviews.freebsd.org/D53110
  Differential Revision:	https://reviews.freebsd.org/D53180
  Differential Revision: https://reviews.freebsd.org/D53313

  (cherry picked from commit 0d4642a67e59f8da5e00a05001c342bdad2a806f)
  (cherry picked from commit 2168e15ee89b4206d8e65a4ea04e4721f60f4060)
  (cherry picked from commit 2f461ddd784b4abdb7f88701d20fc45f658c42f5)
  (cherry picked from commit c174f518c9c8cf3a567c5f60414508ac951a2ae4)


   sbin/geom/Makefile    |   2 +-
   sbin/geom/core/geom.c | 254 +++++++++++++++++++++++++++++++++++---------------
   2 files changed, 179 insertions(+), 77 deletions(-)

[commit 3602181372abc0aa164b5024c6269720e7896b10]
Date: 2025-11-09
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: newfs_msdos: Improve error messages
Review: The man:newfs_msdos[8] utility now provides more specific error messages when encountering overly long OEM strings and reports underlying system call failures with error strings.
Body:

  - Report overly long OEM string as too long, not just "bad".

  - Use warn instead of warnx for open or ftruncate failure to report the
  error string.

  Reviewed by:	se
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53649

  (cherry picked from commit dbb34d496708a37763d3d8bf6782991dee10d17e)
  (cherry picked from commit cf3e1dc5f59e13252ef314bd4f72e19c38115840)


   sbin/newfs_msdos/mkfs_msdos.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit dc8adef239445fe84acda2b0671f086e3dfb030b]
Date: 2025-11-06
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: dtrace.1: Document DTRACE_DEBUG
Review: The man:dtrace[1] manual page now documents the DTRACE_DEBUG environment variable, which controls debug output from DTrace.
Body:

  Reviewed by:	markj
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53627

  (cherry picked from commit f811c0a555546e4154dfa159e8f56b3ba1c70d0d)


   cddl/contrib/opensolaris/cmd/dtrace/dtrace.1 | 10 +++++++++-
   1 file changed, 9 insertions(+), 1 deletion(-)

[commit 0f910af019691bb829ebc8aef868e1d97c379462]
Date: 2025-11-10
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Storage.general
Subject: cd9660: Unbreak symbolic links
Review: The cd9660 filesystem now correctly reports the size of symbolic links, fixing a regression where all symlinks appeared with zero size.
Body:

  Since the introduction of permission masks, cd9660_getattr() returns a
  size of zero for all symbolic links, because the code to retrieve the
  length of the link target (as required by POSIX) is dead, since we strip
  away the type bits before we try to use them to identify the file as a
  link.  Address this by checking the vnode type instead.

  PR:		290556
  MFC after:	3 days
  Fixes:		82f2275b73e5 ("cd9660: Add support for mask,dirmask,uid,gid options")
  Reviewed by:	olce
  Differential Revision:	https://reviews.freebsd.org/D53598

  (cherry picked from commit 978aaa72f3196f5489630052762cac5a7863e774)


   sys/fs/cd9660/cd9660_vnops.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 3078279c33369c81b5391410936572b70715fcd8]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Docs.manpages
Subject: dtrace_io.4: Use bio_length instead of bio_bcount in examples
Review: The commit updates man:dtrace_io[4] examples to use bio_length instead of bio_bcount for I/O tracing accuracy, affecting users who rely on DTrace for storage I/O analysis.
Body:

  Tracing bio_bcount makes little sense for some devices like for example
  md(4), as it is set to "0" instead of to the actual I/O length.

  markj@ suggested the following DTrace one-liner to identify some cases
  where bio_length is set but bio_bcount is not:

      dtrace -n 'io:::start /args[0]->bio_length != args[0]->bio_bcount/{printf("%d %d", args[0]->bio_length, args[0]->bio_bcount); stack();}'

  For future reference in the context of bio_length vs bio_bcount,
  phk@ mentioned in the code review that:

  > the original intent was to get rid of of bio_bcount

  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D53365

  (cherry picked from commit db25448ab9ffa8bfe52d852674cc466494b849d1)


   share/man/man4/dtrace_io.4 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 794a904b454b22c27cea04d209a5fc74972b0fa6]
Date: 2025-10-22
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Network.general
Subject: ipfilter: Don't trust userland supplied iph_size
Review: The ipfilter kernel module now validates user-supplied iph_size values to prevent integer overflow and potential kernel memory corruption. This mitigates a security vulnerability where direct ioctl calls with malicious parameters could cause denial of service or privilege escalation.
Body:

  ipf_htable_create() trusts a user-supplied iph_size from iphtable_t
  and computes the allocation size as iph->iph_size * sizeof(*iph->iph_table)
  without checking for integer overflow. A sufficiently large iph_size
  causes the multiplication to wrap, resulting in an under-sized allocation
  for the table pointer array. Subsequent code (e.g., in ipf_htent_insert())
  can then write past the end of the allocated buffer, corrupting kernel
  memory and causing DoS or potential privilege escalation.

  This is not typically a problem when using the ipfilter provided
  userland tools as calculate the correct lengths. This mitigates a
  rogue actor calling ipfilter ioctls directly.

  Reported by:		Ilja Van Sprundel <ivansprundel@ioactive.com>
  Reviewed by:		markj
  Differential revision:	https://reviews.freebsd.org/D53286

  (cherry picked from commit df381bec2d2b73697a3d163177df042dd272022d)


   sbin/ipf/libipf/interror.c               | 2 ++
   sys/netpfil/ipfilter/netinet/ip_htable.c | 9 +++++++++
   2 files changed, 11 insertions(+)

[commit 2d71662b74b062bd61da91b9fbd471a7a2b6a677]
Date: 2025-10-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: ipfilter: Add an htable max size tuneable.
Review: Adds a runtime option to adjust the maximum hash table size for ipfilter, defaulting to 1024 entries. This allows administrators to limit memory usage and potential performance impacts from large hash table configurations.
Body:

  Add an ipfilter runtime option (ipf -T) to adjust the default
  maximum hash table size. Default it to 1024 entries. It will be
  used by a subsequent commit to limit any damage due to excessively
  large hash table input by the user.

  Reviewed by:		markj
  Differential revision:	https://reviews.freebsd.org/D53284

  (cherry picked from commit f3b94f47f55c502e8983f9bd294e963e75b2963a)


   sys/netpfil/ipfilter/netinet/ip_htable.c | 7 +++++++
   sys/netpfil/ipfilter/netinet/ip_htable.h | 2 ++
   2 files changed, 9 insertions(+)

[commit 3b38b65cd03afafb9e34a1e92af62eb6727efeac]
Date: 2025-10-22
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Network.general
Subject: ipfilter: Add htable (hash table) tunable
Review: The ipfilter subsystem adds a hash table tunable parameter, allowing administrators to adjust hash table size for performance tuning.
Body:

  This is in preparation for addition of a hash table max size.

  Reviewed by:		markj
  Differential revision:	https://reviews.freebsd.org/D53283

  (cherry picked from commit c57262716b08717b6a9c5533941d4e0a2d180d46)


   sys/netpfil/ipfilter/netinet/ip_htable.c | 27 +++++++++++++++++++++++++++
   1 file changed, 27 insertions(+)

[commit e73527950d5d18568ea0d5f668e63d6058702cca]
Date: 2025-10-22
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ipfilter: Calculate the number of elements in ipf_errors
Review: The commit removes manual management of IPF_NUM_ERRORS by calculating it automatically, which is an internal refactoring with no user-visible impact.
Body:

  It serves no purpose to manually manage the IPF_NUM_ERRORS count.
  Calculate it instead.

  Reviewed by:		emaste, markj
  Differential revision:	https://reviews.freebsd.org/D53308

  (cherry picked from commit ab3c9853285b4907dac147ce2f818e3fb44df5a3)


   sbin/ipf/libipf/interror.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 498a4c7f48a33c60b1768b8a6daf519bad84e18d]
Date: 2025-11-14
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: aio: fix alignment of struct (o)aiocb32 on non-amd64
Review: The alignment of the 32-bit aio control block struct (o)aiocb32 is corrected for non-amd64 architectures, fixing a mismatch that broke the aio interface for armv7 binaries running under aarch64.
Body:

  Only i386 has a four-byte alignment for uint64_t, others have
  eight-byte alignment.  This causes the structure to mismatch
  on armv7 binaries running under aarch64, breaking the aio interface.

  Fixes:		3858a1f4f501d00000447309aae14029f8133946
  Approved by:	markj (mentor)
  Reported by:	Mark Millard <marklmi26-fbsd@yahoo.com>
  Discussed with:	jrtc27
  PR:		290962
  MFC after:	immediately (for 15.0)

  (cherry picked from commit f0af21824331648a41b4e5d3323bea9216bcb7e2)


   sys/kern/vfs_aio.c | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit 079ba86d71571bf997ff688da061d8c4aa2fd052]
Date: 2025-10-16
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Userland.contrib
Subject: Tag zfs-2.2.9
Review: OpenZFS updated to version 2.2.9.
Body:

  META file and changelog updated.

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>


   META | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5a77c19c8f4a7e1b8457baf98e6939e6c410b9ee]
Date: 2025-11-10
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Storage.general
Subject: BRT: Fix ranges to blocks conversion math
Review: The commit fixes a bug in the BRT (Block Reference Table) ranges-to-blocks conversion that could cause memory corruption on large storage devices. This correction ensures proper operation for vdevs larger than 64TB.
Body:

  BRT_RANGESIZE_TO_NBLOCKS() takes number of ranges as its argument.
  To get number of blocks we should multiply it by the entry size,
  not divide by it, as it was due to missing parentheses.

  Before #17875 this could cause small memory corruptions for vdevs
  bigger than 64TB, but the change made the bug more noticeable.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Closes #17886
  Closes #17915

   include/sys/brt_impl.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5f8b3fbe56efc92ee9f71c95910a768e5c67d045]
Date: 2025-11-05
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: CI: Update FreeBSD versions and ci-type handling
Review: The commit updates CI workflow scripts and GitHub Actions configurations to add FreeBSD 15.0-STABLE and 16.0-CURRENT as test targets and introduces CI type specifications for ZFS testing. This change affects automated testing infrastructure and does not directly impact FreeBSD users, system behavior, or user-visible features.
Body:

  Update FreeBSD versions:
  - add FreeBSD 15.0-STABLE
  - add FreeBSD 16.0-CURRENT

  So we use the latest versions of each line now:
    - Freebsd 14.3 (RELEASE)
    - FreeBSD 15.0 (STABLE)
    - FreeBSD 16.0 (CURRENT)

  In commits - you may specify which type of CI should run:
  - ZFS-CI-Type: quick
  - ZFS-CI-Type: linux
  - ZFS-CI-Type: freebsd
  - ZFS-CI-Type: full

  Reviewed-by: Alexx Saver <lzsaver@users.noreply.github.com>
  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes #17896

   .github/workflows/scripts/generate-ci-type.py | 10 ++++---
   .github/workflows/scripts/qemu-2-start.sh     | 20 ++++++++------
   .github/workflows/zfs-qemu-packages.yml       |  2 +-
   .github/workflows/zfs-qemu.yml                | 38 +++++++++++++++++----------
   4 files changed, 44 insertions(+), 26 deletions(-)

[commit 6e4acd7893d22c79b755baf2ad22da27a359178d]
Date: 2025-11-07
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Kernel.general
Subject: zstd: disable intrinsics
Review: The aarch64 NEON SIMD intrinsics and optimized prefetch instructions are disabled for kernel builds to avoid FPU register handling issues. This change removes the need for a workaround that undefines the __aarch64__ macro.
Body:

  Disable the aarch64 NEON SIMD intrinsics for kernel builds.  Safely
  using them in the kernel context requires saving/restoring the FPU
  registers which is not currently done.

  Additionally, remove the aarch64 optimized PREFETCH_L1 and PREFETCH_L2
  instruction.  Rely on the more portable compiler built ins.

  This lets us remove the problematic workaround in the aarch64_compat.h
  header which undefines the __aarch64__ macro.

  Reviewed-by: Rob Norris <robn@despairlabs.com>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #17904
  Closes #17852


   module/Kbuild.in                       |  3 +--
   module/Makefile.bsd                    | 24 ----------------------
   module/zstd/include/aarch64_compat.h   | 37 ----------------------------------
   module/zstd/lib/common/compiler.h      |  3 ---
   module/zstd/lib/common/zstd_internal.h |  9 +++++++++
   5 files changed, 10 insertions(+), 66 deletions(-)

[commit 3a2b089a9acb0d70a028cdf0136dca2da49733bd]
Date: 2025-11-05
Score: 5
Status: proposed(include=no,score=65)
Sponsor: 
Section: undecided
Subject: Linux 6.17 compat: Fix broken projectquota on 6.17
Review: The commit fixes a Linux kernel compatibility issue that was causing projectquota tests to fail on Linux 6.17. This ensures that projectquota functionality works correctly on newer Linux kernels.
Body:

  We need to specifically use the FX_XFLAG_* macros in zpl_ioctl_*attr()
  codepaths, and the FS_*_FL macros in the zpl_ioctl_*flags() codepaths.
  The earlier code just assumes the FS_*_FL macros for both codepaths.
  The 6.17 kernel add a bitmask check in copy_fsxattr_from_user() that
  exposed this error via failing 'projectquota' ZTS tests.

  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17884
  Closes #17869


   cmd/zfs/zfs_project.c                 | 36 +++++++++++---
   include/sys/zfs_project.h             | 10 ++--
   lib/libspl/include/Makefile.am        |  1 +
   lib/libspl/include/os/linux/sys/vfs.h | 33 +++++++++++++
   module/os/linux/zfs/zpl_file.c        | 93 +++++++++++++++++++++++++++++------
   5 files changed, 143 insertions(+), 30 deletions(-)

[commit b991b25ed35a15ab03d61fabf4b7f2c3b1178982]
Date: 2025-08-27
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.programs
Subject: makefs: Calculate indirect block count properly for large files on ffs
Review: The man:makefs[8] utility now calculates indirect block counts correctly for large files on FFS images, resulting in more accurate image sizes.
Body:

  When building an ffs image containing large file(s), space requirements
  were calculated incorrectly yielding a bigger image than necessary.
  The reason is that amount of indirect blocks estimation was done wrong:

  - single indirect block was treated as it can hold just 12 data blocks
  - nested indirect blocks were not taken into account at all

  Add support for indirect blocks and fix another tiny bug with
  underestimated space requirement for files with size between
  (UFS_NDADDR-1)*blksz+fragsz ... (UFS_NDADDR)*blksz requesting N>1
  fragments instead of a whole block.

  Reviewed by:	kib
  Differential Revision: https://reviews.freebsd.org/D52120

  (cherry picked from commit 9ce29249ec5d7d1d0a9f5f7655e1b37d54622665)


   usr.sbin/makefs/ffs.c | 94 +++++++++++++++++++++++++++++++++++++++++----------
   1 file changed, 76 insertions(+), 18 deletions(-)

[commit ad17166c57bb0ccd683b3136c170d8f66304d5b2]
Date: 2025-11-07
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: bsdinstall: Use fat32 EFI system partition for ZFS
Review: The bsdinstall installer now creates a FAT32 EFI system partition for ZFS installations, matching the behavior of UFS installations and other operating systems.
Body:

  This is consistent with other operating systems and with bsdinstall's
  UFS config and with bsdinstall's ZFS config prior to commit
  0b7472b3d8d2.

  PR:		290857
  Fixes: 0b7472b3d8d2 ("Mount the EFI system partition (ESP) on newly-installed systems.")
  Reviewed by:	imp
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53642

  (cherry picked from commit 4109cdf0f817162cf3032aa589dd180dfa910025)
  (cherry picked from commit 65e347d315449e8c28dbcb0c5bb64f79d822d024)


   usr.sbin/bsdinstall/scripts/zfsboot | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3ced4a2b482f50672bba26de3f26273a73f75b9c]
Date: 2025-11-07
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: bsdinstall: Fix newfs bsddialog menu
Review: The bsdinstall partition tool now correctly selects default newfs options in the dialog menu.
Body:

  The second and third members of struct bsddialog_menuitem are `bool on`
  and `unsigned int depth`. The newfs dialog options in bsdinstall's
  partition tool had these two swapped, so the default selection did not
  work.

  PR: 290857
  Reviewed by: asiciliano
  Fixes: 50e244964e9b ("bsdinstall/partedit: Replace libdialog with libbsddialog")
  Sponsored by: The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53639

  (cherry picked from commit 4e36942420712c2ab6ebc2c646e61d47b2b68e7b)
  (cherry picked from commit 980aa8d4cfdf57a1f99401fa4160c0d82c927d7c)


   usr.sbin/bsdinstall/partedit/gpart_ops.c | 14 +++++++-------
   1 file changed, 7 insertions(+), 7 deletions(-)

[commit e69669bcd7decb1866484c454c45fd9d7fc4167d]
Date: 2023-03-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: partedit: make minimum FreeBSD install size just under 1 GiB
Review: The installer's minimum required partition size is reduced slightly to allow installation on a 1 GiB disk image without a misleading error.
Body:

  1 GiB is a convenient disk image size for testing.  It is also the
  installer's minimum size, but the minimum applies to the partition
  rather than the whole disk.  Testing with a 1 GiB image resulted in the
  counterintuitive error "There is not enough free space on <disk> to
  install FreeBSD (1.0 GB free, 1.0 GB required)."

  Reduce the installer's minimum size slightly to support this case.

  Reviewed by:	brd
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D38881

  (cherry picked from commit 57e12d397387542b13f175d4c0b8b5adca198690)


   usr.sbin/bsdinstall/partedit/part_wizard.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6c185061a63b6db6676c6a24e6bf0802774a07fa]
Date: 2025-11-05
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: Klara, Inc.
Section: Docs.manpages
Subject: date.1: Lint with mandoc
Review: Fixes rendering issues in man:date[1] by correcting mandoc macros.
Body:

  Specifically, remove Tn macors, replace Li with Ql, and escape %N to
  address date.1's rendering issues on man.freebsd.org.

  PR:		290801
  Reported by:	jinwookjeongg@gmail.com
  MFC after:	1 week
  Sponsored by:	Klara, Inc.

  (cherry picked from commit e878ba8eea7206b3a435338c6eed0e4264e0ce14)


   bin/date/date.1 | 35 ++++++++++++++++++-----------------
   1 file changed, 18 insertions(+), 17 deletions(-)

[commit 52df18d91b83038d870c595799a47d983d7da645]
Date: 2025-11-10
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: vtnet: fix enabling/disabling tso
Review: The vtnet driver now enforces that transmit segment offloading (TSO) requires transmit checksum offloading, fixing a bug where TSO could be incorrectly enabled.
Body:

  Transmit segment offloading depends on transmit checksum offloading.
  Enforce that constraint. This also fixes a bug, since if_hwassist bits
  are from the CSUM_ space, not from the IFCAP_ space.

  PR:			290773
  Reviewed by:		Timo Vlker
  Tested by:		lg@efficientip.com
  Differential Revision:	https://reviews.freebsd.org/D53629

  (cherry picked from commit 4c50ac68166caf7e08c5a9984d63fa91490fa50d)


   sys/dev/virtio/network/if_vtnet.c | 28 ++++++++++++++++++++++++----
   1 file changed, 24 insertions(+), 4 deletions(-)

[commit ca38822e05d7343aa0eab86ebed3685f15f5ac31]
Date: 2025-11-10
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Drivers.device
Subject: vtnet: don't provide VIRTIO_NET_HDR_F_DATA_VALID
Review: The vtnet driver no longer sets the VIRTIO_NET_HDR_F_DATA_VALID flag, aligning with the virtio specification version 1.3. This may affect checksum offloading behavior for virtio network devices.
Body:

  According to section 5.1.6.2.1 of version 1.3 of the virtio
  specification, the driver MUST NOT set VIRTIO_NET_HDR_F_DATA_VALID in
  the flags. So don't do that.

  Reviewed by: 		Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D53650

  (cherry picked from commit 836b3cd9d7910aff5225e9e58189067ca03fae30)


   sys/dev/virtio/network/if_vtnet.c | 7 +------
   1 file changed, 1 insertion(+), 6 deletions(-)

[commit 7cd81bf4e74f39b784f97afe1a5c4a251f1fd39f]
Date: 2025-11-07
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: improve comments in the syncache code
Review: Only comment changes and typo fixes with no user-visible impact.
Body:

  Add a comment explaining why syncache entries are dropped and fix a
  typo in a comment.

  Reviewed by:		rrs, glebius
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D53564

  (cherry picked from commit 17fb082104ee281365b72bd5135604cea5051df2)


   sys/netinet/tcp_syncache.c | 13 ++++++++++++-
   1 file changed, 12 insertions(+), 1 deletion(-)

[commit 21780b009b398949c7c23dc7f8371f38cd3af02c]
Date: 2025-11-03
Score: 5
Status: proposed(include=no,score=15)
Sponsor: Netflix, Inc.
Section: undecided
Subject: ddb: provide inp_flags2 when printing inpcbs
Review: The inpcb printing in the kernel debugger (ddb) now includes inp_flags2, providing more detailed information for debugging network connections.
Body:

  Reviewed by:		markj, Peter Lei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D53542

  (cherry picked from commit 5f43b0cb7c3cb7c3209598f8c0818cb47cd9de96)


   sys/netinet/in_pcb.c | 3 +++
   sys/netinet/in_pcb.h | 7 +++++++
   2 files changed, 10 insertions(+)

[commit b1ed408e034655e89be91d91d5677f7e90224024]
Date: 2025-11-03
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: drop SYN ACK segment for listening sockets
Review: The TCP stack now drops SYN ACK segments received for listening sockets instead of resetting the connection, preventing a denial-of-service attack that could kill connections during SYN-cache handling.
Body:

  When a SYN ACK is received for a listening socket, just drop it
  instead of killing the SYN-cache entry and send a RST.
  This closes the possibility to kill a TCP connection during its
  handling in the SYN-cache.

  Reviewed by:		Nick Banks, Peter Lei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D53540

  (cherry picked from commit 239464e99321ede07664782426ec4e54cd8a618d)


   sys/netinet/tcp_input.c    |  5 ++---
   sys/netinet/tcp_syncache.c | 17 -----------------
   sys/netinet/tcp_syncache.h |  1 -
   3 files changed, 2 insertions(+), 21 deletions(-)

[commit 1ccc6de2d215647b074a45462c86a09c65cf467c]
Date: 2025-11-02
Score: 5
Status: proposed(include=no,score=20)
Sponsor: Netflix, Inc.
Section: undecided
Subject: ddb: use %b when showing flags for an inp
Review: The commit changes the debugger output format for network connection flags to be more compact, which is only visible to users of the kernel debugger (man:ddb[4]).
Body:

  This is much more compact. Thanks to markj@ for suggesting the change.

  Reviewed by:		markj
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D53507

  (cherry picked from commit e8c50058e8d03af17b7458bb560ddee29062082f)


   sys/netinet/in_pcb.c | 160 ++-------------------------------------------------
   sys/netinet/in_pcb.h |  14 +++++
   2 files changed, 18 insertions(+), 156 deletions(-)

[commit 3f75cdcd397995262f9e8a2a59250d43cd88d459]
Date: 2025-11-02
Score: 5
Status: proposed(include=no,score=20)
Sponsor: Netflix, Inc.
Section: undecided
Subject: ddb: use %b when showing flags for a tcpcb
Review: The commit changes the debug output format for TCP control blocks in the kernel debugger, making it more compact. This affects users who rely on man:ddb[4] for debugging TCP connections.
Body:

  This is much more compact. Thanks to markj@ for suggesting the change.

  Reviewed by:		markj, Peter Lei, imp, Nick Banks
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D53510

  (cherry picked from commit 8e8956f7f99759b21bc07e884ad89d1927c39e8d)


   sys/netinet/tcp_usrreq.c | 257 +----------------------------------------------
   sys/netinet/tcp_var.h    |  29 ++++++
   2 files changed, 33 insertions(+), 253 deletions(-)

[commit 8236a5ef891067d79f68eaa2273babddd7375015]
Date: 2025-10-31
Score: 5
Status: proposed(include=no,score=15)
Sponsor: Netflix, Inc.
Section: undecided
Subject: ddb: improve printing of inp_flags
Review: The man:ddb(4) debugger now correctly prints additional inp_flags (INP_BINDANY, INP_INHASHLIST, INP_RESERVED_0, INP_BOUNDFIB) and removes the incorrect INP_ORIGDSTADDR flag from its output.
Body:

  Add four missing flags (INP_BINDANY, INP_INHASHLIST, INP_RESERVED_0,
  INP_BOUNDFIB) used in inp_flags and remove one flag (INP_ORIGDSTADDR),
  which is actually a flag used in inp_flags2 and not in inp_flags.

  Reviewed by:		markj
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D53498

  (cherry picked from commit fee2e6b9fae277d383b129573df2528ce0407efa)


   sys/netinet/in_pcb.c | 20 ++++++++++++++++----
   1 file changed, 16 insertions(+), 4 deletions(-)

[commit 117e70a21f7a950395e97f6b352867b6767f5dbc]
Date: 2025-10-31
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Netflix, Inc.
Section: Userland.programs
Subject: ddb: optionally print inp when printing tcpcb
Review: The ddb debugger commands show tcpcb and show all tcpcbs gain a /i option to print the associated t_inpcb. This provides additional debugging information for kernel developers and users troubleshooting TCP connections.
Body:

  Add /i option to the ddb commands show tcpcb and show all tcpcbs,
  which enables the printing of the t_inpcb.

  Reviewed by:		markj
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D53497

  (cherry picked from commit 9aa5a79e2af9a6a8930bbe8a7a024df2cf44e433)


   share/man/man4/ddb.4     | 12 +++++++++---
   sys/netinet/in_pcb.c     |  2 +-
   sys/netinet/in_pcb.h     |  3 +++
   sys/netinet/tcp_usrreq.c | 21 ++++++++++++++-------
   4 files changed, 27 insertions(+), 11 deletions(-)

[commit c64b00a1fa8ce7f53ec33949a418adfa6f816ee7]
Date: 2025-10-31
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: ddb: whitespace change
Review: No functional change; only whitespace adjustments.
Body:

  No functional change intended.

  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 3adaacad117b23abaf93a5332d538037420e1daa)


   sys/netinet/in_pcb.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 27aaff3c09f2ec058e108faff5ea138ef5fc3c23]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: chroot.2: Remove fchroot reference
Review: The commit removes a reference to fchroot from the chroot(2) man page, correcting documentation that does not apply to stable/14.
Body:

  fchroot does not exist in stable/14.

  Sponsored by:	The FreeBSD Foundation


   lib/libc/sys/chroot.2 | 4 +---
   1 file changed, 1 insertion(+), 3 deletions(-)

[commit 04bb91e9c5f73bf6637a5cdb0840363e926d85df]
Date: 2025-11-03
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: dtrace_vfs.4: Document the DTrace vfs provider
Review: The commit adds a new manual page man:dtrace_vfs[4] documenting the DTrace vfs provider.
Body:

  Reviewed by:	bcr
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51317

  (cherry picked from commit 2020e76450e2705d33d673a3d183c8f0a3910e28)


   cddl/contrib/opensolaris/cmd/dtrace/dtrace.1 |  3 +-
   share/man/man4/Makefile                      |  3 +-
   share/man/man4/dtrace_vfs.4                  | 97 ++++++++++++++++++++++++++++
   share/man/man9/VFS.9                         |  3 +-
   4 files changed, 103 insertions(+), 3 deletions(-)

[commit 6fad1ff852506ec36ff5ef3d188a8a68b2ef26de]
Date: 2025-11-07
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: dtrace.1: Fix mdoc macros around -x
Review: Fixes a formatting issue in the man:dtrace[1] manual page.
Body:

  There should be no space between -x's "arg" and "=value".

  MFC after:	3 days

  (cherry picked from commit 753cef701dbea03627c1fe11dd5556e74df415b2)


   cddl/contrib/opensolaris/cmd/dtrace/dtrace.1 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 773f6ce92eb0b5f0f17eb80f0a07840ae37e1f1d]
Date: 2025-11-06
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Docs.manpages
Subject: ports.7: Add /var/db/ports to FILES
Review: The man:ports[7] manual page now includes /var/db/ports in the list of directories used by the ports system, improving documentation of the ports infrastructure.
Body:

  PR:		272426
  MFC after:	3 days
  Co-authored-by: Piotr Smyrak <ps.ports@smyrak.com>

  (cherry picked from commit b8ff8a11c0d1d1f1b3bd1e60fae9c05ada7b28c5)


   share/man/man7/ports.7 | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit ef75e3c9b5e147cd06e81942e0fdcc1c36c48ca5]
Date: 2025-10-30
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kern/subr_syscalls.c: declare 'traced' local variables boolean
Review: The commit changes internal variable declarations to boolean type, which is a code cleanup with no user-visible impact.
Body:

  (cherry picked from commit a6a9d97708ec18bf307b01141d84aabd01289159)


   sys/kern/subr_syscall.c | 10 +++++-----
   1 file changed, 5 insertions(+), 5 deletions(-)

[commit fe5f45696edd6e00657b339e8f2cf554a5f8ede1]
Date: 2025-09-26
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: atomic.9: provide fine details about CAS memory model MD semantic
Review: The man:atomic[9] manual page now includes detailed information about the CAS (Compare-and-Swap) memory model semantics.
Body:

  (cherry picked from commit 269b1c238806c7fb8835a0510b224c466ca3efa0)


   share/man/man9/atomic.9 | 27 +++++++++++++++++++++++++++
   1 file changed, 27 insertions(+)

[commit ed278aabc26c218d842837b86a7ab332c95a9e95]
Date: 2025-10-05
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: atomic.9: fix description of acquire and release
Review: The commit updates the man:atomic[9] manual page to correct the description of atomic acquire and release operations, improving documentation accuracy for developers using atomic operations.
Body:

  (cherry picked from commit f26382dd72dfc710a8cc7159364a8166e22a4254)


   share/man/man9/atomic.9 | 27 +++++++++++++++++----------
   1 file changed, 17 insertions(+), 10 deletions(-)

[commit fc5a01f8e9eace6a6fa7a0c98a70f878f4e196ea]
Date: 2025-11-07
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: The FreeBSD Foundation
Section: Hardware.virtualization
Subject: release: Comply with Azure Marketplace requirements for aarch64
Review: Azure aarch64 VM images now reserve the first 1 MB of the OS disk as required by Azure Marketplace certification. The BOOTPARTSOFFSET suffix is also appended for aarch64 images.
Body:

  Azure requires the first 1 MB (2,048 sectors) of the OS disk to remain
  empty for VM images:

    https://learn.microsoft.com/partner-center/marketplace-offers/azure-vm-certification-faq#vm-images-must-have-1-mb-of-free-space

  Also append the BOOTPARTSOFFSET suffix for aarch64 images, which only
  has an ESP partition for booting.

  Co-authored-by:	Brad Davis <brd@FreeBSD.org>
  Approved by:	cperciva
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53628

  (cherry picked from commit 36095c942031f7f1613eec554f1c7615cbd891fd)


   release/tools/vmimage.subr | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit 036a6955db6aa75afa3fea15e8d974eed2f28ca2]
Date: 2025-07-14
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: dtrace.1: Document evaltime
Review: The man:dtrace[1] manual page now documents the evaltime option.
Body:

  Reviewed by:	christos, ziaee
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51301

  (cherry picked from commit 1fe7af0635810a96a292638d11d25ddbe95bd581)


   cddl/contrib/opensolaris/cmd/dtrace/dtrace.1 | 46 ++++++++++++++++++++++++++++
   1 file changed, 46 insertions(+)

[commit e001b49074758ac649ec7f6f03e90892bc3a4a3c]
Date: 2025-07-15
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: vnode.9: Fix a typo in sys/tools/vnode_if.awk path name
Review: Fixes a typo in the path to sys/tools/vnode_if.awk in the man:vnode[9] manual page.
Body:

  Fixes:	e01826567938 vnode.9: Document vnode_if.awk and vnode_if.src
  MFC after:	1 week

  (cherry picked from commit 0abee387e1dfd0bf09becadb39b9bc9fef240d95)


   share/man/man9/vnode.9 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 23f613c6974069270a3e14c1d6b7ac793489fc51]
Date: 2025-07-16
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: md(4): Stop symlinking vn.4 to md.4
Review: The man:md(4) manual page no longer symlinks to man:vn(4). This removes the outdated symlink and updates references to reflect that md(4) is the primary documentation for memory disks.
Body:

  We've done the same in the past to the vnconfig.8->mdconfig.8 link in:
      eb5f4569819 Remove ancient vnconfig symlink

  Reviewed by:	bcr, markj, ziaee
  Approved by:	markj (mentor)
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D27122

  (cherry picked from commit 56eb7566c41902a14d4392f8a01c045dbde6de7e)


   ObsoleteFiles.inc       | 3 +++
   share/man/man4/Makefile | 1 -
   share/man/man4/md.4     | 4 ++--
   sys/dev/md/md.c         | 6 +++---
   4 files changed, 8 insertions(+), 6 deletions(-)

[commit 5fd09ddf790b47ac80223e9c82b1ec38bc110d9c]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: gpart.8: Document one of gpart destroy diagnostic message
Review: The man:gpart[8] manual page now documents a diagnostic message from the gpart destroy command.
Body:

  Reviewed by:	ziaee
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D52992

  (cherry picked from commit a08b38dfcea3c61718dfa40b003518fa3d9adac4)


   lib/geom/part/gpart.8 | 22 +++++++++++++++++++++-
   1 file changed, 21 insertions(+), 1 deletion(-)

[commit 4d5583b9021fd227cbed25dc6d25c1d158e1dcf3]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: deadfs.9: Document
Review: Adds man:deadfs[9] manual page documenting the dead filesystem.
Body:

  Reviewed by:	kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D53334

  (cherry picked from commit daa6660f899309f832bba0c7ac72dada125cfed5)


   share/man/man9/Makefile |  1 +
   share/man/man9/deadfs.9 | 36 ++++++++++++++++++++++++++++++++++++
   2 files changed, 37 insertions(+)

[commit fd0893974db1a83b25685fe36d4b74719314b55d]
Date: 2025-11-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: buf.9: Sprinkle with mdoc macros
Review: The commit only adds mdoc macros to a man page, which is an internal formatting change with no user-visible impact on functionality, behavior, or documentation content.
Body:

  I did not bump the date here as the manual page looks more like a draft
  and I'm not sure if it is actually up-to-date considering that it's
  current Dd dates back to 1998.

  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D52770

  (cherry picked from commit fc7f5452c6ff1a9d01a9d8d0638da593ae4f080c)


   share/man/man9/buf.9 | 97 ++++++++++++++++++++++++++++++++++++++--------------
   1 file changed, 72 insertions(+), 25 deletions(-)

[commit 81a5e32a6a72cd1e5c6fe9943542b324bace3790]
Date: 2025-10-31
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Drivers.device
Subject: usb/u3g: add Quectel EM060K
Review: The usb/u3g driver now supports the Quectel EM060K USB modem.
Body:

  PR: 290688
  MFC After: 3 days

  (cherry picked from commit 6968897a8048aee2c72efdfbe23a7b64bdebcdbc)


   sys/dev/usb/serial/u3g.c | 1 +
   sys/dev/usb/usbdevs      | 1 +
   2 files changed, 2 insertions(+)

[commit 911f2a5416f488f7bed1f97fcb3a84f23a47325d]
Date: 2025-10-22
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: Add support for Sierra Wireless EM7590 modem.
Review: The Sierra Wireless EM7590 modem is now supported by the u3g driver.
Body:

  PR: 290421
  MFC After: 3 days

  (cherry picked from commit 00ebecd4a09db84fb6c5002b082400d8f8a97407)


   sys/dev/usb/serial/u3g.c | 1 +
   sys/dev/usb/usbdevs      | 1 +
   2 files changed, 2 insertions(+)

[commit a83a049d1c63e33cacf1cd62d0bbb7c9d9bd73bd]
Date: 2025-10-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: if_vxlan: fix byteorder of source port
Review: The vxlan(4) driver now correctly byte-swaps the source port in VXLAN encapsulation, ensuring proper packet handling.
Body:

  Fix the htons byteorder of vxlan packets after
  `vxlan_pick_source_port` picks a source port during encapsulation.

  Reviewed by:	zlei, kp, adrian
  Differential Revision:	https://reviews.freebsd.org/D53022

  (cherry picked from commit 1cc316727ebae157b3d035d9fb1ad38310a80698)


   sys/net/if_vxlan.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 37989ef996a55bd6ebb4b3daa85ac19dda90d594]
Date: 2025-07-14
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: mkdir.2: Correct HISTORY
Review: The commit only corrects a minor historical note in a man page, which does not constitute a significant user-visible change.
Body:

  PR:		286064
  MFC after:	3 days
  Reviewed by:	mckusick

  (cherry picked from commit 26069bca2d64a76cfafb92d61d58c90140c1b28f)


   lib/libc/sys/mkdir.2 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d4824d1d50407c29d9c1d162219cf678a3cca10f]
Date: 2025-07-14
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: find.1: Correct HISTORY grammar typo
Review: Corrects a grammar typo in the man:find[1] manual page.
Body:

  PR:		286292
  MFC after:	3 days
  Reviewed by:	ziaee

  (cherry picked from commit b87dcd7004993417cf711f20a0924e3a768ae116)


   usr.bin/find/find.1 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 920c94b71043012c5ebad1b68a7349d5e11eac0d]
Date: 2025-11-06
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: sysrc.8: Rewrite examples for mdoc conformance
Review: The man:sysrc[8] manual page examples are rewritten for mdoc conformance, improving formatting and consistency.
Body:

  Tag SPDX while here. This is not a content change, so do not bump date.

  PR:		274164
  MFC after:	3 seconds

  (cherry picked from commit 3f0dd7724658126dcfde488a994cf7698353a82c)


   usr.sbin/sysrc/sysrc.8 | 89 +++++++++++++++++++++++---------------------------
   1 file changed, 41 insertions(+), 48 deletions(-)

[commit fa168bb244eea0e436ae7c14cca513590e648889]
Date: 2025-11-06
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: ciss.4: Add p440ar to HARDWARE
Review: The man: ciss[4] man page now includes the p440ar controller in the hardware compatibility list.
Body:

  PR:		290425
  MFC after:	3 seconds, this fixes the HW relnotes
  Reported by:	jwb

  (cherry picked from commit a41ffaa330f5dbfc6b10f32ea2879755e07ba932)


   share/man/man4/ciss.4 | 9 ++++++---
   1 file changed, 6 insertions(+), 3 deletions(-)

[commit 7c8717183536b99f455d6fefefb762f1d7e6f030]
Date: 2025-11-06
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: dumpon(8): Add a SYSCTL VARIABLES section
Review: The dumpon(8) manual page now includes a SYSCTL VARIABLES section documenting debug.minidump and machdep.dump_retry_count.
Body:

  Document debug.minidump and machdep.dump_retry_count sysctl variables.

  PR:			259393
  MFC after:		3 seconds
  Reviewed by:		gbe (previous), markj, ziaee
  Differential Revision:	https://reviews.freebsd.org/D32618

  (cherry picked from commit 850841edf6c0867a170d2637f3dacfda33d5f3dd)


   sbin/dumpon/dumpon.8 | 15 +++++++++++++++
   1 file changed, 15 insertions(+)

[commit c23a589aa145d2f14e7141601fec1b38bce9a6bd]
Date: 2025-11-02
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: cron: Use reallocarray() to prevent integer overflow
Review: The commit replaces manual size calculations with reallocarray() in cron's environment handling to prevent integer overflow, enhancing security without changing user-visible behavior.
Body:

  Apply OpenBSD env.c,v 1.24 and 1.25, which replaces manual size
  calculations with reallocarray() to prevent possible integer
  overflow.

  (cherry picked from commit 40d21618382108fefa84f8576b14302f65452718)


   usr.sbin/cron/lib/env.c | 5 ++---
   1 file changed, 2 insertions(+), 3 deletions(-)

[commit b775b191b6bf02bab3322ffe7a2c2396a54e9f7b]
Date: 2025-10-29
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: truss: Properly display first argument to nmount
Review: The man:truss[1] utility now correctly displays the first argument to nmount(2) as an nvlist, improving debugging and system call tracing.
Body:

  The first argument to nmount(2) is an nvlist in the form of an iovec,
  which truss already knows how to decode.  Set the correct flag so
  this happens automatically.

  MFC after:	1 week
  PR:		290667

  (cherry picked from commit b9f848ecbafce4e56ba9c8b7993b85347e83484a)


   usr.bin/truss/syscalls.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6985b90cd0fcdd6a6ddff23a87f5609d1113a187]
Date: 2025-11-05
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.contrib
Subject: blocklist: Update the blacklistd-helper script
Review: The blacklistd-helper script now better detects the active packet filter, improving reliability for blocklist management.
Body:

  Update the blacklistd-helper script, it provides a better mechanism for
  detecting the active packet filter.

  This is a direct commit to stable/14, as blacklist has been renamed to
  blocklist.

  PR:		290645


   contrib/blocklist/libexec/blacklistd-helper | 172 +++++++++++++++++++++++++---
   1 file changed, 155 insertions(+), 17 deletions(-)

[commit 0bd5fb421a1e85e75deb461660d8cfe6d139f1c4]
Date: 2025-09-23
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: mksnap_ffs: fix running unded chroot
Review: The mksnap_ffs utility now correctly handles overlapping strings when running under a chroot, preventing potential crashes or incorrect behavior.
Body:

  Fix "run-under-chroot" workaround by replacing strlcpy(2) with
  memmove(2) since strings overlap.

  Reviewed by:	arrowd
  Differential Revision:	https://reviews.freebsd.org/D52670

  (cherry picked from commit 60be0d71daab4247dc61c323777b0c593eb76975)


   sbin/mksnap_ffs/mksnap_ffs.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5b062c9458e8c6733bc916cbbfe317178a38356b]
Date: 2025-11-04
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: Sippy Software, Inc.
Section: Network.general
Subject: ng_nat: fix potential crash when attaching to L2 directly
Review: The ng_nat module no longer crashes when attaching directly to layer 2 (Ethernet) during TCP checksum calculation.
Body:

  Fix potential crash in the ng_nat module when attaching directly
  to the layer 2 (ethernet) while calculating TCP checksum.

  The issue is due to in_delayed_cksum() expecting to access IP
  header at the offset 0 from the mbuf start, while if we are
  attached to the L2 directly, the IP header at going to be at the
  certain offset.

  Reviewed by:	markj, tuexen
  Approved by:	tuexen
  Sponsored by:	Sippy Software, Inc.
  Differential Revision:	https://reviews.freebsd.org/D49677

  (cherry picked from commit f74c0dc583d69400b9cea41e2f009d8c4757ce26)


   sys/netgraph/ng_nat.c | 95 ++++++++++++++++++++++++++++++---------------------
   1 file changed, 57 insertions(+), 38 deletions(-)

[commit 7f4c2bf8ea6cdbdcca1eccce9508206e2cf05cce]
Date: 2025-08-25
Score: 5
Status: proposed(include=no,score=35)
Sponsor: Sippy Software, Inc.
Section: undecided
Subject: netinet: provide "at offset" variant of the in_delayed_cksum() API
Review: The in_delayed_cksum() API now includes an "at offset" variant, allowing checksum recalculation after network address translation (NAT) transformations when processing mbufs directly from layer 2. This supports NAT implementations that require checksum adjustments at specific packet offsets.
Body:

  The need for such a variant comes from the fact that we need to
  re-calculate checksum aftet ng_nat(4) transformations while getting
  mbufs from the layer 2 (ethernet) directly.

  Reviewed by:	markj, tuexen
  Approved by:	tuexen
  Sponsored by:	Sippy Software, Inc.
  Differential Revision:	https://reviews.freebsd.org/D49677

  (cherry picked from commit 5feb38e37847c10af86f5c75dc768518973c6aaa)


   sys/netinet/ip_output.c | 13 ++++++++++---
   sys/netinet/ip_var.h    |  1 +
   2 files changed, 11 insertions(+), 3 deletions(-)

[commit dca645cd3112feefee2dce8cab029b1b779823b8]
Date: 2025-10-28
Score: 5
Status: added(include=yes,score=85)
Sponsor: Google
Section: Drivers.device
Subject: nvme: Add handling for bar5
Review: The NVMe driver now supports BAR5 for Table BIR and PBA BIR, enabling FreeBSD on Google Compute Engine C4 machines.
Body:

  The NVMe spec allows the Table BIR (TBIR) and PBA DIR (PBIR) to
  be 0, 4, or 5. The existing NVMe driver basically only has support
  for 4, perhaps under the assumption that BAR4 is 64-bit and also
  occupies BAR5.

  This change adds support for BAR5, covering the case where BAR4
  and BAR5 might both be present and 32-bit, where the Table BIR
  might be 4 and the PBA BIR might be 5, or vice versa.

  The NVMe spec (in the SR-IOV section) also permits VFs to use BIR=2,
  so I haven't added stricter checks on which BIR will be permitted
  by the driver.

  This enables FreeBSD on Google Compute Engine C4 Machines.

  MFC after:		3 days
  Reviewed by:		imp
  Sponsored by:		Google
  Co-authored-by:		Matt Delco <delco@google.com>
  Signed-off-by:		Jasper Tran O'Leary <jtranoleary@google.com>
  Differential Revision:	https://reviews.freebsd.org/D53140

  (cherry picked from commit 7b32f4f0a7fe9b1b2f5a3905ca15f656713255ad)


   sys/dev/nvme/nvme_ctrlr.c   |  9 +++++++--
   sys/dev/nvme/nvme_pci.c     | 48 ++++++++++++++++++++++++++++++++++-----------
   sys/dev/nvme/nvme_private.h |  6 ++++--
   3 files changed, 48 insertions(+), 15 deletions(-)

[commit c64b594a306480b567ed7132947459af9cc6aec5]
Date: 2025-11-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: id: Fix WITHOUT_AUDIT build
Review: The commit fixes a build issue when WITHOUT_AUDIT is set, but this is an internal build fix with no user-visible impact.
Body:

  Rather than add more ifdefs, trust the compiler to optimize Aflag away.

  Fixes:		70b72ede982f ("id: Clean up")
  PR:		290740
  MFC after:	3 days

  (cherry picked from commit 92a533ed1d3c81a772815f90cc9aff9237a4429c)


   usr.bin/id/id.c | 10 ++--------
   1 file changed, 2 insertions(+), 8 deletions(-)

[commit 763f18140d37d848aa6647e88f36dc468207c41d]
Date: 2025-10-27
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Kernel.general
Subject: net: Validate interface group names in ioctl handlers
Review: The kernel validates interface group names in ioctl handlers to ensure they are nul-terminated, preventing potential security issues.
Body:

  The handlers were not checking that the group names are nul-terminated.
  Add checks for this.

  Reported by:	Ilja Van Sprundel <ivansprundel@ioactive.com>
  Reviewed by:	zlei
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D53344

  (cherry picked from commit 32919a34f17ac1af99dec7376f22a8393c251602)


   sys/net/if.c | 34 ++++++++++++++++++++++++++--------
   1 file changed, 26 insertions(+), 8 deletions(-)

[commit 9769eb9282ea7cd27210076adf1946b9235aa916]
Date: 2025-10-27
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Network.general
Subject: altq: Clear stats structures in get_class_stats()
Review: The commit fixes a potential information leak in ALTQ traffic shaping statistics by clearing uninitialized stack bytes before copying to userspace. This prevents kernel memory disclosure to userland processes.
Body:

  These structures are copied out to userspace, and it's possible to leak
  uninitialized stack bytes since these routines and their callers weren't
  careful to clear them first.  Add memsets to avoid this.

  Reported by:	Ilja Van Sprundel <ivansprundel@ioactive.com>
  Reviewed by:	kp, emaste
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D53342

  (cherry picked from commit ff08916e9ac689e6ce734de72325fc2bd9495a35)


   sys/net/altq/altq_cbq.c   | 2 ++
   sys/net/altq/altq_fairq.c | 2 ++
   sys/net/altq/altq_priq.c  | 2 ++
   3 files changed, 6 insertions(+)

[commit deb684f9d1d6a3681e451d3af31f768c567f7dbe]
Date: 2025-11-01
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Network.general
Subject: ipfw: pmod: avoid further rule processing after tcp-mod failures
Review: The ipfw packet modifier (pmod) now stops rule processing after a TCP modification failure, preventing potential incorrect packet acceptance when the mbuf chain is freed.
Body:

  m_pullup() here will have freed the mbuf chain, but we pass back an
  IP_FW_DENY without any signal that the outer loop should finish.  Thus,
  rule processing continues without an mbuf and there's a chance that we
  conclude that the packet may pass (but there's no mbuf remaining)
  depending on the rules that follow it.

  PR:		284606
  Reviewed by:	ae

  (cherry picked from commit c0382512bfce872102d213b9bc2550de0bc30b67)


   sys/netpfil/ipfw/pmod/tcpmod.c | 25 ++++++++++++++++---------
   1 file changed, 16 insertions(+), 9 deletions(-)

[commit 91f3622a2c5f5ee6ea001fb9ea8948f1f497dc83]
Date: 2025-07-30
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Storage.general
Subject: Faster checksum benchmark on system boot
Review: The ZFS checksum benchmark during system boot now only runs the needed 256KiB tests, reducing boot time. The full benchmark is still available on demand via sysctl or Linux procfs.
Body:

  While booting, only the needed 256KiB benchmarks are done now.

  The delay for checking all checksums occurs when requested via:
  - Linux: cat /proc/spl/kstat/zfs/chksum_bench
  - FreeBSD: sysctl kstat.zfs.misc.chksum_bench

  Reported by: Lahiru Gunathilake <gunathilakebllg@gmail.com>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Co-authored-by: Colin Percival <cperciva@tarsnap.com>
  Closes #17563
  Closes #17560

   module/zfs/zfs_chksum.c | 69 ++++++++++++++++++++++++++++---------------------
   1 file changed, 40 insertions(+), 29 deletions(-)

[commit a5ba57ad823fa9f9a05d90e34c9a55925301f335]
Date: 2025-07-09
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: Validate mountpoint on path-based unmount using statx
Review: The man:zfs[8] unmount command now validates mountpoints using statx for path-based unmounts, aligning behavior with dataset-based unmounts and preventing unmounts if the mountpoint does not match the MNTTAB entry.
Body:

  Use statx to verify that path-based unmounts proceed only if the
  mountpoint reported by statx matches the MNTTAB entry reported by
  libzfs, aborting the operation if they differ. Align
  `zfs umount /path` behavior with `zfs umount dataset`.

  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Signed-off-by: Ameer Hamza <ahamza@ixsystems.com>
  Closes #17481

   cmd/zfs/zfs_main.c                     | 19 ++++++++++++++++++
   config/user-statx.m4                   | 34 ++++++++++++++++++++++++++++++++
   config/user.m4                         |  1 +
   lib/libspl/include/os/linux/sys/stat.h |  5 +++++
   lib/libspl/os/linux/getmntany.c        | 36 ++++++++++++++++++++++++++++------
   5 files changed, 89 insertions(+), 6 deletions(-)

[commit a7d6dff421eaef4fac417366a81df8babaef438e]
Date: 2025-06-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: pyzfs: Update ax_python_devel.m4 to serial 37
Review: Fixes a typo in an internal build macro without user-visible impact.
Body:

  Fixes an obvious typo, where a variable was missing the required
  leading dollar sign ($)

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Martin Regg <martin.rueegg@metaworx.ch>
  Closes #17480


   config/ax_python_devel.m4 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 1ced0ff5de5d021bda4ea02af5a2af00a40fb220]
Date: 2025-06-11
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: iXsystems, Inc.
Section: Storage.general
Subject: Reduce zfs_dmu_offset_next_sync penalty
Review: The man:dmu_offset_next[9] function now synchronizes fewer transaction groups (TXGs) when checking for clean dnodes, improving performance for simultaneous writes and seeks on HDD pools by 7-14%.
Body:

  Looking on txg_wait_synced(, 0) I've noticed that it always syncs
  5 TXGs: 3 TXG_CONCURRENT_STATES + 2 TXG_DEFER_SIZE.  But in case
  of dmu_offset_next() we do not care about deferred frees. And even
  concurrent TXGs we might not need sync all 3 if the dnode was not
  dirtied in last few TXGs.

  This patch makes dmu_offset_next() to sync one TXG at a time until
  the dnode is clean, but no more than 3 TXG_CONCURRENT_STATES times.
  My tests with random simultaneous writes and seeks over many files
  on HDD pool show 7-14% performance increase.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Rob Norris <robn@despairlabs.com>
  Signed-off-by:	Alexander Motin <mav@FreeBSD.org>
  Sponsored by:	iXsystems, Inc.
  Closes #17434

   module/zfs/dmu.c | 16 ++++++++++------
   1 file changed, 10 insertions(+), 6 deletions(-)

[commit 82cf2452216304e9de69d4164b2a402a908f5d2f]
Date: 2024-12-14
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Ports.packaging
Subject: build: use correct bashcompletiondir on arch
Review: The commit fixes a build configuration issue for bash completion installation paths, which may affect users building ZFS from source.
Body:

  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: poscat <poscat@poscat.moe>
  Closes #16861


   config/zfs-build.m4 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4f1d6b4861c42bd8df832bd8b61711fa1b36ec5c]
Date: 2024-07-16
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: Add building support for Artix Linux (#16265)
Review: Adds build support for Artix Linux, enabling init script installation similar to Gentoo Linux with openrc. This allows ZFS to be built and installed on Artix Linux systems.
Body:

  Artix Linux is systemd free distribution based on Arch Linux, with
  openrc dinit runit s6 as init alternatives. This patch will make
  init scripts installation work the way Gentoo Linux with openrc.

  The scripts tweaking for other init will be left to packager.

  Signed-off-by: Yongming Zhao <ming.zym@gmail.com>
  Reviewed-by: Rob Norris <robn@despairlabs.com>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>


   config/zfs-build.m4 | 10 +++++++---
   1 file changed, 7 insertions(+), 3 deletions(-)

[commit 2910b5f5ca5bb6b7ec3f0d14dc71ec7d63e37cf8]
Date: 2025-07-21
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Storage.general
Subject: enforce arc_dnode_limit
Review: The ZFS dnode cache now respects the arc_dnode_limit by calling arc_evict when the limit is exceeded, preventing memory pressure from dnode overflows.
Body:

  Linux kernel shrinker in the context of null/root memcg does not scan
  dentry and inode caches added by a task running in non-root memcg. For
  ZFS this means that dnode cache routinely overflows, evicting valuable
  meta/data and putting additional memory pressure on the system.

  This patch restores zfs_prune_aliases as fallback when the kernel
  shrinker does nothing, enabling zfs to actually free dnodes. Moreover,
  it (indirectly) calls arc_evict when dnode_size > dnode_limit.

  Reviewed-by: Rob Norris <robn@despairlabs.com>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Gionatan Danti <g.danti@assyoma.it>
  Closes #17487
  Closes #17542

   include/sys/arc_impl.h           |  2 +-
   module/os/linux/zfs/zfs_vfsops.c | 65 ++++++++++++++++++++++++++++++++++++++++
   module/zfs/arc.c                 | 22 +++++++-------
   3 files changed, 78 insertions(+), 11 deletions(-)

[commit 10208765ead21cc91e4c611e44808573319c2a0d]
Date: 2024-08-08
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: iXsystems, Inc.
Section: Storage.general
Subject: Soften pruning threshold on not evictable metadata
Review: The commit changes the ZFS ARC metadata pruning behavior to reduce load spikes on systems with many dnodes. Pruning now increases gradually as unevictable metadata grows above the threshold, which may stabilize performance.
Body:

  Previous code pruned 10% of dnodes once 3/4 of metadata appeared
  unevictable.  On workloads with many millions of dnodes and little
  other metadata it creates significant load spikes for many seconds
  straight.  This change instead gradually increases pruning as
  unevictable metadata grow above the 3/4, which may allow it to
  stabilize at some level.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by:	Alexander Motin <mav@FreeBSD.org>
  Sponsored by:	iXsystems, Inc.
  Closes #16401

   module/zfs/arc.c | 31 +++++++++++++++++++++++--------
   1 file changed, 23 insertions(+), 8 deletions(-)

[commit 67ea51710a598188d474fb911026593d6cfd5a4a]
Date: 2024-07-25
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: iXsystems, Inc.
Section: Storage.general
Subject: Several improvements to ARC shrinking (#16197)
Review: The commit improves ARC memory management under memory pressure on Linux and FreeBSD, adding a new zfs_arc_shrinker_seeks parameter on Linux to balance eviction cost relative to other caches.
Body:

  - When receiving memory pressure signal from OS be more strict
  trying to free some memory.  Otherwise kernel may come again and
  request much more.  Return as result how much arc_c was actually
  reduced due to this request, that may be less than requested.
   - On Linux when receiving direct reclaim from some file system
  (that may be ZFS) instead of ignoring request completely, just
  shrink the ARC, but do not wait for eviction.  Waiting there may
  cause deadlock.  Ignoring it as before may put extra pressure on
  other caches and/or swap, and cause OOM if nothing help.  While
  not waiting may result in more ARC evicted later, and may be too
  late if OOM killer activate right now, but I hope it to be better
  than doing nothing at all.
   - On Linux set arc_no_grow before waiting for reclaim, not after,
  or it may grow back while we are waiting.
   - On Linux add new parameter zfs_arc_shrinker_seeks to balance
  ARC eviction cost, relative to page cache and other subsystems.
   - Slightly update Linux arc_set_sys_free() math for new kernels.

  Signed-off-by:	Alexander Motin <mav@FreeBSD.org>
  Sponsored by:	iXsystems, Inc.
  Reviewed-by: Rob Norris <rob.norris@klarasystems.com>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>


   include/sys/arc_impl.h         |   4 +-
   man/man4/zfs.4                 |   7 +++
   module/os/freebsd/zfs/arc_os.c |  13 +++--
   module/os/linux/zfs/arc_os.c   |  88 ++++++++++++++++++----------------
   module/zfs/arc.c               | 105 ++++++++++++++++++++++++-----------------
   5 files changed, 123 insertions(+), 94 deletions(-)

[commit c63166a2aff488314be4c2a75493ed30597a91d4]
Date: 2025-10-31
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: bsd.prog.mk: Skip warnings if compiler.mk was not included
Review: The commit fixes a build warning that could cause buildworld to fail when certain src.conf options are used, but it is an internal build system fix with no direct user-visible impact.
Body:

  We emit a warning if src.conf options WITH_RETPOLINE or INIT_ALL are
  in use, and the compiler or linker does not support the feature.

  For targets like `cleandir` we skip including bsd.compiler.mk, which
  leaves COMPILER_FEATURES unset and spurious warnings were emitted in
  early buildworld stages, if these options are in use.

  Commit 0837b2ebd570 ("pkg: Die if make -V BRANCH fails") added -W to
  usr.sbin/pkg's make flags, causing it to exit on warnings.  As a result
  buildworld failed when these src.conf options were in use.

  Clean this up by omitting the warning if the magic
  _NO_INCLUDE_COMPILERMK flag is set, which indicates that
  COMPILER_FEATURES is not set.

  Reviewed by:	imp
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53501

  (cherry picked from commit e4f2a350955406ffd58dd3f0bb7610df0f36d647)
  (cherry picked from commit 1471af5110fc3bb6b1f1548e056f1717fb844ffd)


   share/mk/bsd.prog.mk | 6 ++++++
   1 file changed, 6 insertions(+)

[commit 05120af690fbae7b6d91b2d2ad856086611ff67e]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: revoke.2: Remove mention of block special device files
Review: The revoke(2) man page no longer mentions block special device files, reflecting that block devices are not used in FreeBSD.
Body:

  Block devices are a thing of a past in FreeBSD.

  Reviewed by:	ziaee
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D53332


   lib/libc/sys/revoke.2 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit d481c3db42dc59bbe679ecc5aead161a8739466b]
Date: 2025-10-29
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Network.general
Subject: pf: improve DIOCRCLRTABLES validation
Review: The pf(4) ioctl validation is improved to prevent crashes from unterminated strings in DIOCRCLRTABLES operations.
Body:

  Unterminated strings in the anchor or name could cause crashes.
  Validate them, and add a test case.

  Reported by:	Ilja Van Sprundel <ivansprundel@ioactive.com>
  MFC after:	3 days
  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit 1da3c0ca5b1decaa9cf55859cd134bdcd1218116)


   sys/netpfil/pf/pf_ioctl.c               | 11 +++++++++++
   tests/sys/netpfil/pf/ioctl/validation.c | 33 +++++++++++++++++++++++++++++++++
   2 files changed, 44 insertions(+)

[commit 70154de06926aadf7efb50591e21a82aaf1b619a]
Date: 2025-10-29
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Network.general
Subject: pf: improve add state validation
Review: The pf(4) firewall improves validation for state table additions via DIOCADDSTATE ioctl and pfsync packets, enhancing security against invalid state entries.
Body:

  Both for the DIOCADDSTATE ioctl and for states imported through pfsync packets.
  Add a test case to exercise this code path.

  Reported by:	Ilja Van Sprundel <ivansprundel@ioactive.com>
  MFC after:	3 days
  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit faacc0d968816cf8714c974b6d8df6191cfb0e0d)


   sys/netpfil/pf/if_pfsync.c              |  3 +++
   tests/sys/netpfil/pf/ioctl/validation.c | 26 ++++++++++++++++++++++++++
   2 files changed, 29 insertions(+)

[commit 420eed4f45920511af403d069bb37076f8d56003]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: igb(4): Fix out-of-bounds register access on VFs
Review: The igb(4) driver now prevents out-of-bounds register access on Virtual Functions, avoiding potential kernel panics.
Body:

  Virtual Functions have access to a limited number of registers,
  and their bus space size is lower. Use KASSERT to detect out-of-bounds
  access and eliminate them to avoid kernel panics in production
  environment.

  Signed-off-by: Krzysztof Galazka <krzysztof.galazka@intel.com>

  Reviewed by:	jmg
  Tested by:	mateusz.moga_intel.com
  Approved by:	kbowling (mentor), erj (mentor)
  Sponsored by:   Intel Corporation
  Differential Revision:	https://reviews.freebsd.org/D52976

  (cherry picked from commit 2c02e6ca7154593d214b62578f67d9fe7db23d70)


   sys/dev/e1000/e1000_osdep.h | 46 ++++++++++++++++++-------
   sys/dev/e1000/if_em.c       | 83 +++++++++++++++++++++++++--------------------
   2 files changed, 80 insertions(+), 49 deletions(-)

[commit b2b2a4788f7925f41d902df6b7f3d19bccd6f42f]
Date: 2025-10-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: ixl(4): fix multicast promiscuous mode state tracking and filter management
Review: The ixl(4) driver now correctly tracks multicast promiscuous mode state and avoids corrupting multicast filters when the hardware limit is exceeded.
Body:

  This change reapplies the improvements from commit 89e7335 and adds
  additional fixes and code optimizations on top of it.

  The ixl driver supports up to 128 multicast filters in hardware. When this
  limit is exceeded, the driver should enable multicast promiscuous mode.
  When the count drops below 128, it should disable promiscuous mode and
  restore individual filters.

  The driver previously had problems that could corrupt multicast filters list.
  The main issue was that ixl_dis_multi_promisc() would attempt to disable
  promiscuous mode without checking if it was actually enabled, potentially
  corrupting existing filters. There was also no state tracking across driver
  functions, leading to redundant operations.

  This change adds an IXL_FLAGS_MC_PROMISC flag to track the multicast
  promiscuous mode state. The flag is set when enabling promiscuous mode and
  cleared when disabling it. Early return checks prevent redundant operations
  when the mode is already in the desired state, avoiding filter corruption
  and unnecessary hardware calls.

  Signed-off-by: Yogesh Bhosale yogesh.bhosale@intel.com

  PR:		283820
  Approved by:	kbowling (mentor)
  Tested by:	gowtham.kumar.ks_intel.com
  Sponsored by:   Intel Corporation
  Differential Revision:	https://reviews.freebsd.org/D52549

  (cherry picked from commit 46a8a1f08f88c278e60ebb6daa7a551eb641c67b)


   sys/dev/ixl/if_ixl.c      |  27 +++++++++++-
   sys/dev/ixl/ixl.h         |   1 +
   sys/dev/ixl/ixl_pf_main.c | 110 +++++++++++++++++++++++++++++++++++++++-------
   3 files changed, 120 insertions(+), 18 deletions(-)

[commit e092f2e0cc7b276c2c1fe5a51cc95eed77df07f9]
Date: 2025-10-27
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: ice(4): Add support for E835-XXV-4 adapter
Review: The ice(4) driver now supports the Intel E835-XXV-4 network adapter.
Body:

  Add subdevice ID and branding string for E835-XXV-4
  adapter.

  Signed-off-by: Krzysztof Galazka <krzysztof.galazka@intel.com>

  Approved by:	kbowling (mentor), erj (mentor)
  Sponsored by:   Intel Corporation
  Differential Revision:	https://reviews.freebsd.org/D53319

  (cherry picked from commit 09b48f811b4bf3a17485680b4720d1c0a81bbe07)


   sys/dev/ice/ice_drv_info.h | 3 +++
   1 file changed, 3 insertions(+)

[commit 1f682efc1d6db347ca4c39c321cddf6a542183c1]
Date: 2025-10-22
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: bsd-family-tree: add OpenBSD 7.8 release
Review: The bsd-family-tree file is updated to include OpenBSD 7.8 release information.
Body:

  (cherry picked from commit cdc1990393084fb00a85abc7557f9a92a2059ea2)


   share/misc/bsd-family-tree | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit c376c535c602a0736e788516b5d87526690d62f0]
Date: 2025-09-13
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: bsd-family-tree: add FreeBSD 16 -current
Review: The commit updates the bsd-family-tree file to include FreeBSD 16 -current, which is a minor documentation update with no direct user-visible impact.
Body:

  (cherry picked from commit 3eed21505fa15ea8ba837307fc766774fe510e5c)


   share/misc/bsd-family-tree | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit f446a58c0b1bbd67dcd8e5b3373fe0b4b8727b04]
Date: 2025-08-10
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: bsd-family-tree: improve EOL section with FreeBSD references
Review: The commit updates the bsd-family-tree file to improve the EOL section with FreeBSD references, which is a documentation change within the base system.
Body:

  Reported by:	Herbert J. Skuhra <herbert@gojira.at>

  (cherry picked from commit c8cf8d851cd4e9bd4add7f8dad22b53f3d2d923a)


   share/misc/bsd-family-tree | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit f053379eeae612a1ab85f82906a8e639db6caf19]
Date: 2025-08-10
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: bsd-family-tree: add End-of-Life (EOL) section
Review: The bsd-family-tree file is updated to include an End-of-Life (EOL) section, which may be of interest to users tracking historical BSD lineage.
Body:

  (cherry picked from commit 5bffa1d2069a05c8346eb34e17a39085fe0bf09b)


   share/misc/bsd-family-tree | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 2b1e1ec871f4c0ed6dd3ed84c03f6056d7275437]
Date: 2025-08-10
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: bsd-family-tree: add End-of-life (EOL) section
Review: The bsd-family-tree file in share/misc is updated to include an End-of-life (EOL) section, providing users with information about discontinued BSD variants.
Body:

  (cherry picked from commit 71d65d2595c8bea69875742da997625be1d4922e)


   share/misc/bsd-family-tree | 7 +++++++
   1 file changed, 7 insertions(+)

[commit 4b555b56edfdd714df9010bbbb630d3d3a32f6d0]
Date: 2025-10-27
Score: 5
Status: proposed(include=no,score=15)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: improve credential handling in syncache
Review: The commit improves credential handling in the TCP syncache to prevent potential use-after-free issues, but it is an internal kernel fix with no direct user-visible impact.
Body:

  When adding a syncache entry, take a reference count of the
  credentials while the inp is still locked.
  Thanks to markj@ for providing a hint regarding the root cause.

  Reported by:		David Marker
  Reviewed by:		glebius
  Tested by:		David Marker
  Fixes:			cbc9438f0505 ("tcp: improve ref count handling when processing SYN")
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D53380

  (cherry picked from commit 44cb1e857f048d2326bdc1a032ccd2c04d2bcdc9)


   sys/netinet/tcp_syncache.c | 14 +++++++++-----
   1 file changed, 9 insertions(+), 5 deletions(-)

[commit 984a58c13166f9fffe1c7b03d89e3f3d790d07cb]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: udp: honor IPV6_TCLASS cmsg for UDP/IPv4 packets
Review: The IPV6_TCLASS control message is now honored for UDP/IPv4 packets sent on AF_INET6 sockets, allowing traffic class settings to be applied consistently across IPv4 and IPv6.
Body:

  Honor the IPPROTO_IPV6-level cmsg of type IPV6_TCLASS when sending
  an UDP/IPv4 packet on an AF_INET6 socket.

  Reviewed by:		bz
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D53347

  (cherry picked from commit d3a3854fdc6e8da3bc6c1c13aab8d371445d2914)


   sys/netinet/udp_usrreq.c | 17 +++++++++++++++++
   1 file changed, 17 insertions(+)

[commit 3aa6981e658b84aa0fee879697ae69b70f8c8f9d]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: udp: honor IPV6_TCLASS socket option for UDP/IPv4 packets
Review: The IPV6_TCLASS socket option is now honored for UDP/IPv4 packets sent on AF_INET6 sockets, allowing traffic class marking for IPv4 traffic on dual-stack sockets.
Body:

  Honor the IPPROTO_IPV6-level socket option IPV6_TCLASS when sending
  an UDP/IPv4 packet on an AF_INET6 socket.

  Reviewed by:		bz, glebius
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D53346

  (cherry picked from commit 3535546a86846ddb0ca5fe4a0689ac635b504459)


   sys/netinet/udp_usrreq.c | 12 ++++++++++++
   1 file changed, 12 insertions(+)

[commit 6c31df0a2faad343ae3b0f004ad2c3b55f6eccdd]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: save progress timeout cause in connection end status
Review: The TCP progress timeout cause is now saved in the connection end status, making it visible in blackbox logging alongside the persist timeout cause.
Body:

  TCP stats are currently incremented for the persist and progress
  timeout conditions, but only the persist cause was saved in the
  connection end info status, which in turn is logged in the
  blackbox "connection end" event.

  Reviewed by:	tuexen
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 1a61a673a3700c0ebdb0c5847b5923d0e3641f89)


   sys/netinet/tcp_timer.c | 7 +++++--
   1 file changed, 5 insertions(+), 2 deletions(-)

[commit c63d587365eb1bb434e223ce011a5704be540bff]
Date: 2025-10-23
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp over udp: don't copy more bytes than avaiable
Review: The commit fixes a buffer over-read in TCP over UDP handling, which is disabled by default. This prevents potential memory corruption for users who enable TCP over UDP support.
Body:

  When copying the data in the first mbuf to get rid of the UDP
  header, use the correct length. It was copying too much (8 bytes,
  the length of the UDP header).
  This only applies to handling TCP over UDP packets. The support for
  TCP over UDP is disabled by default.

  Reported by:		jtl
  Reviewed by:		Peter Lei
  Sponsored by:		Netflix, Inc.

  (cherry picked from commit bfda98a42027417b2fa74738c63327532013e93b)


   sys/netinet/tcp_subr.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a0b91ae49c190d2976b2b5f0b41177b4e5da30ff]
Date: 2025-10-23
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: netstat: add support for UDP-Lite endpoints
Review: The man:netstat[1] utility now displays UDP-Lite endpoints by default alongside other network connections.
Body:

  With this patch UDP-Lite endpoints are also shown per default.

  Reviewed by:		Nick Banks
  Differential Revision:	https://reviews.freebsd.org/D53252

  (cherry picked from commit c2b08c13c20d44c3368bcbf738624e5fac461314)


   usr.bin/netstat/inet.c | 37 ++++++++++++++++++++++++++-----------
   usr.bin/netstat/main.c |  4 ++++
   2 files changed, 30 insertions(+), 11 deletions(-)

[commit 63d9216a69681ce1f036206998a9f3d476451a04]
Date: 2025-10-23
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: UDP-Lite: export pcblist via sysctl interface
Review: The sysctl interface now exports the list of pcbs for UDP-Lite, allowing man:sockstat[1] and man:netstat[1] to display UDP-Lite socket information.
Body:

  Export the list of pcbs for UDP-Lite to be consumed by sockstat and
  netstat.

  Reviewed by:		Peter Lei, Nick Banks
  Differential Revision:	https://reviews.freebsd.org/D53229

  (cherry picked from commit be93b27483680c7e741b1627cc96a131bc99436c)


   sys/netinet/in_proto.c   | 2 ++
   sys/netinet/udp_usrreq.c | 5 +++++
   sys/netinet/udp_var.h    | 1 +
   3 files changed, 8 insertions(+)

[commit 9f4289611fa29ac8ca70eabc58533b886c3f3d8e]
Date: 2025-10-21
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: fix typo in comment
Review: Typo fix in a comment only; no user-visible impact.
Body:

  Reviewed by:	tuexen
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit daac364e611532c7bfd4bb20f9fea8d365496aa1)


   sys/netinet/tcp_syncache.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit f7a7c2026ccb13f1ae76d1b0b3a2c60faa99e320]
Date: 2025-10-09
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Netflix, Inc.
Section: Userland.programs
Subject: sockstat: show path state column only when useful
Review: The man:sockstat[1] utility now hides the path state column unless there is at least one SCTP endpoint in a state other than CLOSED or LISTEN, reducing unnecessary output clutter.
Body:

  Showing the path state column is only useful, if there is at least one
  SCTP endpoint shown, which is not in the state CLOSED or LISTEN.
  Don't show it when it is not useful.

  Reviewed by:		rrs
  MFC after:		3 days
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52986

  (cherry picked from commit 746eadecaa7dc8913721cbaa9be4e603bd36ea49)


   usr.bin/sockstat/sockstat.1 | 3 ++-
   usr.bin/sockstat/sockstat.c | 7 +++++--
   2 files changed, 7 insertions(+), 3 deletions(-)

[commit c19f161f5f65d61c0152587000eff7cae9492843]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: write.2: explain the atomicity guarantees of the writes
Review: The man:write[2] manual page now includes a new section describing the atomicity guarantees of write operations.
Body:

  (cherry picked from commit 1c8d7bb4cf7a6b19262333b2a9b1dacf3094b938)


   lib/libc/sys/write.2 | 20 ++++++++++++++++++++
   1 file changed, 20 insertions(+)

[commit a83f433a9d0ef5774e398cf3518834f47323ab2a]
Date: 2025-10-24
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: x86 LAPIC: force edge-triggered mode for !bootverbose as well
Review: The LAPIC timer is configured to use edge-triggered mode for both bootverbose and non-bootverbose cases, ensuring consistent timer behavior during boot.
Body:

  (cherry picked from commit cf59dabe161f956ac7d36fbb91b7edeab9d0f6c3)


   sys/x86/x86/local_apic.c | 9 ++++++---
   1 file changed, 6 insertions(+), 3 deletions(-)

[commit dbdb47165ad3cb1b23625510cf4a9d872b93c48c]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Kernel.general
Subject: vfs_syscalls.c::flags_to_right(): O_DSYNC should be allowed for CAP_FSYNC
Review: The man:rights[4] capability CAP_FSYNC now allows O_DSYNC, enabling processes with that capability to use data integrity synchronization.
Body:

  (cherry picked from commit 5e85f383da6661bf29ca6054a330406889d8ac60)


   share/man/man4/rights.4 | 3 ++-
   sys/kern/vfs_syscalls.c | 2 +-
   2 files changed, 3 insertions(+), 2 deletions(-)

[commit 084dbefacbce68be5faa588743605b2169cb7f36]
Date: 2025-10-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: insmntque.9: Refer to vnode operations vector correctly
Review: Corrects a typographical error in a man page comment, with no user-visible impact.
Body:

  The comment in sys/vnode.h describes
  the v_op member as "vnode operations vector",
  so use "operations" instead of "operation" here.

  Reviewed by:	bcr
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D53333

  (cherry picked from commit 24a6e040fc2e84234c684abcf3e1668a5a9467eb)


   share/man/man9/insmntque.9 | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit a342aef47dfc57f5e4240ae5f47b50de7a1ad492]
Date: 2025-10-28
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: tuning.7 stats.7: Cross-reference
Review: The man:stats[7] and man:tuning[7] manual pages now cross-reference each other.
Body:

  MFC after:	3 days

  (cherry picked from commit b2c5686755757535a6c3223b31fb96b64a961f15)


   share/man/man7/stats.7  | 3 ++-
   share/man/man7/tuning.7 | 3 ++-
   2 files changed, 4 insertions(+), 2 deletions(-)

[commit d9112ce561d2565832fd8114e7532f21f6ea2c09]
Date: 2025-10-28
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: getvfsbyname.3 mount.8: Reference lsvfs(1)
Review: The man:getvfsbyname(3) and man:mount(8) man pages now reference the lsvfs(1) utility for listing virtual filesystems.
Body:

  MFC after:	3 days
  Reviewed by:	ziaee
  Differential Revision:	https://reviews.freebsd.org/D53411

  (cherry picked from commit cb1315c15acf7d3fae66b2c5631e076776683f96)


   lib/libc/gen/getvfsbyname.3 | 3 ++-
   sbin/mount/mount.8          | 3 ++-
   2 files changed, 4 insertions(+), 2 deletions(-)

[commit 31e456e012e5dc59dbe5ea8829db97153d0cab16]
Date: 2025-09-27
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Storage.general
Subject: geom: zero: Let sysctls .byte and .clear to be settable in loader
Review: The sysctls kern.geom.zero.byte and kern.geom.zero.clear are now settable as tunables in the loader, allowing users to configure the behavior of the geom:zero device at boot time.
Body:

  There is no reason to not allow kern.geom.zero.byte and
  kern.geom.zero.clear to be settable as a tunable.

  Reviewed by:	imp, markj
  Approved by:	markj (mentor)
  MFC after:	1 week
  Event:		EuroBSDCon 2025
  Differential Revision:	https://reviews.freebsd.org/D52763

  (cherry picked from commit ae17bca63f0a03e6e46ea679a5be7f8851f82099)


   sys/geom/zero/g_zero.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit defef25b22aac7ab651e5cc322287516b077e38c]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: acpi_battery.4: Fix a typo in the manual page
Review: Fixes a typo in the man:acpi_battery[4] manual page.
Body:

  - s/rechargable/rechargeable/

  (cherry picked from commit e47c294d005c7789f120d80b566c25f90e431278)


   share/man/man4/acpi_battery.4 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 10abf3b57f3137790dd62c70f4513407d16cceeb]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: queue.3: Fix a typo in the manual page
Review: Fixes a typo in the man:queue[3] manual page.
Body:

  - s/overriden/overridden/

  (cherry picked from commit f5a3d790c78682506888b2bb4e67fa08cf5d8bd4)


   share/man/man3/queue.3 | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 8da8e31b7b6053651f41f2898b2735c9ccadf690]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: Docs.manpages
Subject: mac_do.4: Fix a typo in the manual page
Review: Fixes a typo in the man:mac_do[4] manual page.
Body:

  - s/occurences/occurrences/

  (cherry picked from commit 72a9bfcfab08da5a00e2ec3fba580157173c6a15)


   share/man/man4/mac_do.4 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit ff7e2517af717469071a3b6ff172badb5134d02d]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: bce.4: Fix a typo in the manual page
Review: Fixes a typo in the man:bce[4] manual page.
Body:

  - s/activitiy/activity/

  (cherry picked from commit dc9fd0f379becb94cfa3adb3a53a8a42da336d52)


   share/man/man4/bce.4 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit f56fc21398738f8ff7a339eb936c2a2d8cf28873]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: p9fs.4: Fix a typo in the manual page
Review: Fixes a typographical error in the man: p9fs[4] manual page.
Body:

  - s/recommented/recommended/

  (cherry picked from commit 5a739b74650b0746334ddcd92ef73369f0c18c54)


   share/man/man4/p9fs.4 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit bd0e6e0d60f96d9338b7a981d5d613e12f3d118a]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=5)
Sponsor: 
Section: Docs.manpages
Subject: iwlwifi.4: Fix a typo in the manual page
Review: Fixes a typographical error in the man:iwlwifi[4] manual page.
Body:

  - s/incosistent/inconsistent/

  (cherry picked from commit 7c8c5ac82e27a4d4246574bc1a636b05b1d0937f)


   share/man/man4/iwlwifi.4 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6a8940dc9666ff04d4191be0069de100ff55616c]
Date: 2025-10-26
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: siginfo.3: Fix a typo in the manual page
Review: Fixes a typo in the man: siginfo[3] manual page.
Body:

  - s/Sychronous/Synchronous/

  (cherry picked from commit 1447a221338c070130d7e990733486ed142267a1)


   share/man/man3/siginfo.3 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 7a5208998bc927be3939331a433f44a9ee16712e]
Date: 2025-10-28
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Storage.general
Subject: nfs_clrpcops.c: NFSM_DISSECT() reply for each dir separately
Review: The NFS client now parses each directory reply separately in NFSv4 mount operations, which prevents issues with mount paths containing many directories.
Body:

  Without this patch, the entire reply for all directories in
  the NFSv4 mount path are parsed at once.  This could cause
  problems for mount paths with many directories in the path.

  This patch fixes the problem by parsing each directory
  reply in a loop.

  Spotted while fixing other cases that could do large
  NFSM_DISSECT() sizes.

  (cherry picked from commit 9d13c87afdb35c0014aa6f43c5652e946c18b756)


   sys/fs/nfsclient/nfs_clrpcops.c | 10 +++++++---
   1 file changed, 7 insertions(+), 3 deletions(-)

[commit 9a4da735ca97f87e6b0ef55b6f457197c3abae1d]
Date: 2025-10-28
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: nfs_commonsubs.c: Add a sanity check for nid_ngroup
Review: Adds a sanity check for the number of groups passed to the kernel by nfsuserd(8) to protect against a misbehaving daemon in a jail.
Body:

  The nfsuserd(8) daemon passes user credentials
  (uid + gids) into the kernel for users and groups
  identified by name (received from a NFSv4 server).

  This patch add a sanity check for the number of
  groups (nid_ngroup) passed in.

  It's only purpose is to protect against a bogus
  nfsuserd(8) running in a jail.

  (cherry picked from commit 4672adcea4cf3c0c626d186f1f41c69552d915f1)


   sys/fs/nfs/nfs_commonsubs.c | 13 +++++++++----
   1 file changed, 9 insertions(+), 4 deletions(-)

[commit 89fd2ff35c3f4d70d8c93c3a3075dd2dab23cd3a]
Date: 2025-10-09
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: uio.9: Improve description of uio_rw flags
Review: The man:uio[9] manual page now provides clearer documentation about the UIO_READ and UIO_WRITE flags, improving developer understanding of data transfer direction in the uio(9) subsystem.
Body:

  The direction of the data transfer in uio(9) can be confusing,
  so state explicitly the difference between UIO_READ and UIO_WRITE.

  Reviewed by:	ziaee
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D52996

  (cherry picked from commit 0625f470e0956a3a337e4999f6712ec7b7d872e5)


   share/man/man9/uio.9 | 14 +++++++++-----
   1 file changed, 9 insertions(+), 5 deletions(-)

[commit e37fbc13eedf606bfdc9db5a55ce89009399b45b]
Date: 2025-10-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: style.mdoc.5: Point readers to style(9) regarding copyright headers
Review: The commit updates the style.mdoc.5 man page to refer to style(9) for copyright header guidelines and adjusts the header formatting, but these are documentation corrections without user-visible functional impact.
Body:

  While here, fix the ordering of the elements in the copyright header per
  style(9) and remove the text of the license as we already have the SPDX
  tag here.

  MFC after:	3 days

  (cherry picked from commit 3cc7d67155dad57e0d10f02a584fda6c8f2ea0b2)


   share/man/man5/style.mdoc.5 | 30 ++++++------------------------
   1 file changed, 6 insertions(+), 24 deletions(-)

[commit 1350158e1af27e751a5b1670eb9512bf5c603a81]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: examples/mdoc: Remove text of BSD-2-Clause from mdoc examples
Review: The commit updates mdoc example files to use SPDX license identifiers instead of full BSD-2-Clause license text, aligning with current documentation practices. This change affects users who reference these examples for creating manual pages.
Body:

  We live in the SPDX world now and our example manual pages should
  reflect that.

  Also, fix the order of the SPDX and copyright lines as per style(9).

  Reviewed by:	ziaee
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D53335

  (cherry picked from commit 83ac79599f6b94c57321ce3738fc28d1fa6a6c60)


   share/examples/mdoc/example.1 | 23 +----------------------
   share/examples/mdoc/example.3 | 23 +----------------------
   share/examples/mdoc/example.4 | 23 +----------------------
   share/examples/mdoc/example.9 | 23 +----------------------
   4 files changed, 4 insertions(+), 88 deletions(-)

[commit 45aa148a3126b6bfebfaa69c619443d91e4bfa22]
Date: 2025-10-26
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: g_bio.9: Reference dtrace_io(4)
Review: The commit adds a reference to man:dtrace_io[4] in the g_bio.9 man page, which improves documentation cross-referencing for users interested in tracing I/O operations.
Body:

  MFC after:	3 days

  (cherry picked from commit 3559b8e98341d7087771516b1d8f9560a5c555b4)


   share/man/man9/g_bio.9 | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit c071bcda44b792d8abc36d1315a9b4152c5cbda2]
Date: 2025-10-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: id: Add -d and -s options
Review: The man:id[1] utility gains -d and -s options to print the user's home directory and shell, respectively. These options cannot be combined with other options.
Body:

  These options may not be combined with any other options and print the
  current or specified user's home directory and shell respectively.

  Reviewed by:	imp, bcr
  Differential Revision:	https://reviews.freebsd.org/D53301

  (cherry picked from commit f41b1eb637f576634be0df9d657f46aa57afea59)


   usr.bin/id/id.1 | 28 +++++++++++++++++++++++++---
   usr.bin/id/id.c | 48 +++++++++++++++++++++++++++++++++++++++++++++---
   2 files changed, 70 insertions(+), 6 deletions(-)

[commit 20412331d31c165c1ca3c4c23b3417563d02c103]
Date: 2025-10-28
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: id: Clean up
Review: No user-visible changes; commit is a cleanup with no functional impact.
Body:

  No functional change intended.

  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D53300

  (cherry picked from commit 70b72ede982f3aebe03a2bf7a8245ee6bcde352c)


   usr.bin/id/id.c | 114 +++++++++++++++++++++++++++-----------------------------
   1 file changed, 55 insertions(+), 59 deletions(-)

[commit 299eb433369202502ba7ceccb3fd2b3f6fdb1afe]
Date: 2025-08-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: id: revert to historical and documented behavior for `id`
Review: The man:id[1] utility now uses the current process credentials for the gid when displaying credentials without arguments, matching the documented behavior and other implementations.
Body:

  The manpage claims that we display the credentials for the calling
  process if no user/flags are specified, but this has not been true since
  r145628 / 68b9b81e792a9108d.  Currently, we display:

   - uid from the calling process
   - gid from /etc/passwd
   - egid from the calling process, if different from that gid
   - supplementary groups from the calling process

  This doesn't really match the description in the manpage, and it doesn't
  match other implementations.  Fix it to use the current process
  credentials for the gid as well.

  Drop the extra arguments to id_print(), since these facts can be derived
  from whether we're displaying live data (`pw == NULL`) or not.

  Reviewed by:	olce
  Differential Revision:	https://reviews.freebsd.org/D51689

  (cherry picked from commit 90b315233a3362b7427e2d2649eaa8acf0da197a)


   usr.bin/id/id.c | 33 +++++++++++++++++----------------
   1 file changed, 17 insertions(+), 16 deletions(-)

[commit af13a06ab206b7009f689bf082ecbc776887ecee]
Date: 2025-10-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: rc.subr: Fix slow shutdown issue
Review: The rc.subr script now uses the -p option of pwait to obtain a list of processes that have not terminated, which fixes a slow shutdown issue. This change improves the speed of service shutdowns during system halt or reboot.
Body:

  Instead of sleeping after pwait returns, use its new -p option to
  obtain the list of processes that still have not terminated.

  MFC after:	3 days
  PR:		290357
  Fixes:		5953e7c98427 ("rc.subr: Move the sleep in wait_for_pids")
  Reviewed by:	0mp, markj
  Differential Revision:	https://reviews.freebsd.org/D53294

  (cherry picked from commit 22cff1f3e9d82b48aad440c52f883bfd4995359c)


   libexec/rc/rc.subr | 29 ++++++++---------------------
   1 file changed, 8 insertions(+), 21 deletions(-)

[commit cacba7a15e35857da7adece3bc3cf1a3a2679b9c]
Date: 2025-10-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: pwait: Add an option to print remaining processes
Review: The man:pwait[1] utility gains a -p option to print the PIDs of processes that are still running when pwait exits.
Body:

  * On startup, insert all valid PIDs into a tree.
  * In our main loop, whenever a process terminates, remove its PID
    from the tree.
  * On exit, if the -p flag was specified, print the remaining PIDs.

  MFC after:	3 days
  Reviewed by:	bcr, markj
  Differential Revision:	https://reviews.freebsd.org/D53293

  (cherry picked from commit 3d73146baeb933fe955c7496572b483a9f92914c)


   bin/pwait/pwait.1             |  6 ++-
   bin/pwait/pwait.c             | 98 ++++++++++++++++++++++++++++---------------
   bin/pwait/tests/pwait_test.sh | 38 +++++++++++++++++
   3 files changed, 107 insertions(+), 35 deletions(-)

[commit 4e06e622b1070b618ecb37afa5ba5876f913a682]
Date: 2025-10-10
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: pwait: Avoid calling getpid(2) for each proc.
Review: The commit reduces overhead by caching the process ID, but this is a minor internal optimization with no user-visible impact.
Body:

  (cherry picked from commit ab4abce6c2c2091a3b9ea1f38cbef94ee7a68090)


   bin/pwait/pwait.c | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit 38a172d3c6b703402d3befd37be24cb83d98a6b6]
Date: 2025-10-25
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ffs.3: Add a STANDARDS section to the manual page
Review: The commit adds a STANDARDS section to the man:ffs[3] manual page, documenting conformance to POSIX standards. This is a minor documentation update with no functional change.
Body:

  The ffs() function conforms to IEEE Std 1003.1-2008 ("POSIX.1").
  The ffsl() and ffsll() functions conform to IEEE Std 1003.1-2024 ("POSIX.1").

  Reviewed by:	ziaee
  Differential Revision:	https://reviews.freebsd.org/D53352

  (cherry picked from commit f1cb4e9962d715ec85ba26d7019ab83adea1ffb7)


   lib/libc/string/ffs.3 | 14 +++++++++++++-
   1 file changed, 13 insertions(+), 1 deletion(-)

[commit f262601ebaffafa4d258844071e16a63fb5eb43d]
Date: 2025-10-27
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Storage.general
Subject: nfs_clrpcops.c: Check for too large a write reply
Review: The NFS client now validates the reply length for Write operations to prevent issues with broken servers sending oversized replies.
Body:

  The "rlen" reply length for a Write operation/RPC
  could cause trouble if a broken server replies with
  too large a value.

  Improve the sanity check for "rlen" to avoid this.

  (cherry picked from commit 2c82cdd2e29f8ba00d4289f36f8baa1598a1ad9b)


   sys/fs/nfsclient/nfs_clrpcops.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 4f7bd8c77981704759f731b5b84896f90b28fa6a]
Date: 2025-10-27
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: nfs_clrpcops.c: Fix two possible large NFSM_DISSECT()s
Review: The commit fixes a potential issue in the NFS client's RPC operations code, but it does not introduce any user-visible changes, new features, or configuration impacts; it is a minor internal fix without behavioral effect.
Body:

  There are two cases in nfs_clrpcops.c where it was possible
  for the code to attempt to NFSM_DISSECT() a large size,
  which is not allowed by nfsm_dissct().

  This patch fixes them.

  Reducing the maximum stripecnt should be no problem,
  since there in no extant NFSv4.n server that does striped
  File Layout pNFS and current development is centered
  around the Flex File layout.

  (cherry picked from commit b9e6206f593385c80436d267ab759319c1e94e43)


   sys/fs/nfsclient/nfs_clrpcops.c | 11 ++++++-----
   1 file changed, 6 insertions(+), 5 deletions(-)

[commit 1d37ea5e58e88442b7e9061c8cdfc90b864f840a]
Date: 2025-10-27
Score: 5
Status: proposed(include=no,score=35)
Sponsor: 
Section: undecided
Subject: nfs_clrpcops.c: Add sanity checks for the slot cnts
Review: Adds sanity checks for NFSv4 session slot counts to prevent invalid values from being used, improving reliability of NFSv4 client operations.
Body:

  The reply to CreateSession includes the slot cnt for
  both fore and back slots. It should never be larger
  than the argument specified and the fore slot cnt
  should always be at least 1.

  Without this patch, the replied slot cnts were not
  being sanity checked.

  While here, replace 64 with NFSV4_SLOTS (which is 64).

  (cherry picked from commit 3053b2a3dcab6e05311c3b696bee4c9e5698d93a)


   sys/fs/nfsclient/nfs_clrpcops.c | 9 ++++++++-
   1 file changed, 8 insertions(+), 1 deletion(-)

[commit 7c9d801ed27885af0f96b89b8b44480ee9808ea5]
Date: 2025-10-27
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Network.general
Subject: nfs_nfsdserv.c: Add a sanity check for layout commit cnt
Review: The NFS server adds a sanity check for the layout commit count in pNFS operations to prevent potential issues with bogus client requests.
Body:

  If a client were to send a LayoutCommit (seldom
  used and only for a pNFS server) with a bogus
  cnt, there could be problems with a malloc() call
  that uses it.

  This patch adds a sanity check for the cnt. Note
  that RFC8881 does not specify any upper bound
  on the cnt.

  (cherry picked from commit 1a679fb907962843f01b103ec672136a8f8d8edb)


   sys/fs/nfsserver/nfs_nfsdserv.c | 5 +++++
   1 file changed, 5 insertions(+)

[commit 848075bff4dec6d9a1a992ec339ea1342b3c5bc5]
Date: 2025-10-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: ipfw: Remove more unused IP_FW_* cases
Review: Removes unused internal IP_FW_* cases in ipfw, with no user-visible impact.
Body:

  All of the do_cmd() calls are in dummynet.c and specify the socket
  option at compile time; none of these removed cases are used in ipfw
  after the v3 work.

  Reviewed by:	markj
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53378

  (cherry picked from commit 0e2e0fb955adf15a217949bc4cc337d53d2c7259)
  (cherry picked from commit 6b1e5d4d20a94b5bebd726eb6d1df8dca2738f8e)


   sbin/ipfw/ipfw2.c | 6 +-----
   1 file changed, 1 insertion(+), 5 deletions(-)

[commit 27ee6b7240cc29f8a348196ba09fe7b38efe4a23]
Date: 2025-10-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: ipfw: Remove IP_DUMMYNET_GET case
Review: The ipfw(1) utility no longer uses the IP_DUMMYNET_GET constant, which is an internal cleanup with no user-visible impact.
Body:

  IP_DUMMYNET_GET is no longer used in ipfw(1).

  Reviewed by:	markj
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53348

  (cherry picked from commit 28e52dea96809c7904e498759ee1f79bda929a82)
  (cherry picked from commit 73c105268cc6138015241b080bc7945c6cde0fa6)


   sbin/ipfw/ipfw2.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 97875c1c30f9d8e9f607f52cee50a3f1627000a7]
Date: 2025-10-25
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: ipfw: Correct error message
Review: The commit corrects an error message string in ipfw(8) but does not introduce any user-visible functional change, configuration impact, or new capability.
Body:

  The failed allocation in the error pertains to IP_FW_XADD, not
  IP_FW_ADD.

  Reviewed by:	ae
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53359

  (cherry picked from commit 498e56142660c8dd864c878e820252358c9a15cf)
  (cherry picked from commit c22437c8b574878241a3c897a095ae6939e66743)


   sbin/ipfw/ipfw2.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6b546a10d61cf4051114b3c1e89c3ed1d79cbe3a]
Date: 2025-10-24
Score: 5
Status: proposed(include=no,score=30)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: ipfw: Update warning/error setsockopt references
Review: The ipfw firewall and dummynet traffic shaper now correctly reference the IP_DUMMYNET3 socket option in warning and error messages, ensuring consistency with the updated dummynet v3 implementation.
Body:

  Dummynet v3 switched to IP_DUMMYNET3 but did not update these
  warnings/errors.

  Fixes: cc4d3c30ea28 ("Bring in the most recent version of ipfw and dummynet, developed")
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: sbin/ipfw/ipfw2.c

  (cherry picked from commit 1f95a517880bae5fc0a9fe4463a8f2ec36ed734a)
  (cherry picked from commit a5dd21c7dd1f3c8103c2fc6a1caa5635d70671aa)


   sbin/ipfw/dummynet.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit cb2921924549b8068c67c6e35331d72b9b71e658]
Date: 2025-10-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: sys/arm64: fix COMPAT_FREEBSD32 __syscall()
Review: The fix resolves a regression where 32-bit compatibility syscalls on arm64 would incorrectly cause SIGSYS due to an endianness issue, restoring proper 32-bit syscall operation.
Body:

  It seems like _QUAD_LOWWORD was incorrectly expanded into 1,
  which is correct for big endian but not little endian.  This
  means we always grab the padding word for the syscall number,
  which is usually 0, causing SIGSYS to be delivered to the caller.
  Reintroduce _QUAD_LOWWORD to fix the syscall.

  PR:		290411
  MFC after:	1 week
  Discussed with:	jrtc27
  Reviewed by:	cognet, emaste
  Approved by:	markj (mentor)
  Fixes:		8c9c3144ccfa3061879b8cec015ee7d1010e4766
  Differential Revision:	https://reviews.freebsd.org/D53250

  (cherry picked from commit 1ca09538d94273601dac08204c1d0b3ca9115864)


   sys/arm64/arm64/elf32_machdep.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 0da1b6cfcc1dc211d377bf87df9723b4228232e2]
Date: 2025-10-17
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.libraries
Subject: sys/arm: add fp[gs]et* prototypes to <ieeefp.h>
Review: Adds fp[gs]et* prototypes to <ieeefp.h> on ARM, enabling compilation of legacy ports that rely on these hard float functions.
Body:

  We have provided implementations for hard float of these for
  a while now.  Add them to the header to make things official.
  This is required for a bunch of legacy programs in ports.

  Approved by:	markj (mentor)
  MFC after:	1 week
  Differential Revision: https://reviews.freebsd.org/D53156

  (cherry picked from commit a8079d40ae7f3cee17c94e61e43c24780a64a010)


   sys/arm/include/ieeefp.h | 10 ++++++++++
   1 file changed, 10 insertions(+)

[commit 4b69237639bf5472e01e21f6c4cdbe753375727d]
Date: 2025-10-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix
Section: Kernel.general
Subject: x86: support sending non-fatal MCA messages to syslog
Review: Non-fatal Machine Check Architecture (MCA) error messages can now be sent to syslog instead of the console to avoid performance disruption during error storms. Fatal errors are still logged to the console.
Body:

  Currently, all MCA messages are logged to the console. However, this
  can have performance implications which can turn a storm of correctable
  errors into a disruptive event.

  Provide an option to direct non-fatal messages to syslog. Note that
  we will always log to the console for fatal errors.

  Reviewed by:	markj
  Sponsored by:	Netflix
  Differential Revision:	https://reviews.freebsd.org/D12278

  (cherry picked from commit 55c28005f544282b984ae0e15dacd0c108d8ab12)


   sys/x86/x86/mca.c | 43 ++++++++++++++++++++++++++++++++-----------
   1 file changed, 32 insertions(+), 11 deletions(-)

[commit 40b2111cfaa1ea9c7ae3487e536e8f75debba700]
Date: 2025-10-06
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Netflix
Section: Kernel.general
Subject: x86: Add a way to inject artificial MCA events for testing
Review: Adds a sysctl to inject artificial Machine Check Architecture (MCA) events for testing purposes. This allows developers and testers to simulate hardware errors and verify system response without requiring physical hardware faults.
Body:

  Reviewed by:	glebius
  Sponsored by:	Netflix
  Differential Revision:	https://reviews.freebsd.org/D52942

  (cherry picked from commit 1c2fc62e4a9689961169be7836038acd5f757be1)


   sys/x86/x86/mca.c | 29 ++++++++++++++++++++++++++++-
   1 file changed, 28 insertions(+), 1 deletion(-)

[commit fda981d41491ba61a1fa24c65d6b16f4426ee29d]
Date: 2025-10-06
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: Netflix
Section: Kernel.general
Subject: x86: Allow MCA messages to be rate-limited
Review: The Machine Check Architecture (MCA) logging now rate-limits messages after the first 50 of each type, reducing overhead from excessive messages. This change may affect users monitoring MCA logs for hardware errors.
Body:

  Always print the first 50 messages of each type. After that, optionally
  rate-limit the messages. This provides a way to limit the overhead of
  processing excessive messages without suppressing the first few of any
  type.

  As part of this change, we are switching from direct printf() calls to
  collecting data in an sbuf(9). In POLLED mode (run from a task queue),
  we dynamically allocate the buffer. In the other modes (which are
  likely called from a hardware interrupt), we use a buffer allocated
  from the BSS segment and guarded by a lock. In normal operation,
  most calls to mca_log() should come from the POLLED mode, so there
  should be no contention for the new lock. If there is an interrupt
  storm which exceeds the capacity of the free list, there will be new
  contention for this lock; however, overall lock contention should
  still be lower than it was prior to e770e32aa3a0, when the mca_lock
  was almost always held for the entirety of the mca_log() call.

  This commit is partly based on a patch proposed by Loic Prylli
  <lprylli@netflix.com>.

  Reviewed by:	markj, glebius (previous version)
  Sponsored by:	Netflix
  Differential Revision:	https://reviews.freebsd.org/D52946

  (cherry picked from commit 0d14826de7d9d72e91f1d396120f1456102bccf4)


   sys/x86/x86/mca.c | 211 +++++++++++++++++++++++++++++++++++++-----------------
   1 file changed, 147 insertions(+), 64 deletions(-)

[commit f5d3c2c7d9db359f04ddaf8dbdcc1cd2f4b4dfa8]
Date: 2025-10-06
Score: 5
Status: proposed(include=no,score=25)
Sponsor: Netflix
Section: undecided
Subject: x86: Reduce amount of time the MCA lock is held while emitting records
Review: The commit reduces lock contention in the Machine Check Architecture (MCA) subsystem, which may improve system responsiveness during hardware error reporting.
Body:

  The MCA spin lock is acquired in the hardware interrupt context to
  record MCA messages. It is also acquired by a task handler to emit
  those messages.

  Reduce the amount of time the task handler holds the lock to reduce
  the maximum amount of time the hardware interrupt handler may need to
  spin on the lock.

  Reviewed by:	glebius, markj
  Sponsored by:	Netflix
  Differential Revision:	https://reviews.freebsd.org/D52938

  (cherry picked from commit e770e32aa3a017b35fcf24e7c6f14fc2a209bad5)


   sys/x86/x86/mca.c | 18 +++++++++++++++---
   1 file changed, 15 insertions(+), 3 deletions(-)

[commit f0f9b4007015ffd5b3af072dfb70bdbf1250d875]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: deadfs: Return ENXIO instead of EIO when the device is gone.
Review: The deadfs filesystem now returns ENXIO instead of EIO when a device is removed, which affects programs like man:recoverdisk[1] that treat EIO as a retryable error.
Body:

  One some systems, under some conditions, pulling a USB stick would
  read(2) returning EIO and not ENXIO, like it should and used to.

  Recoverdisk(1), which does not give up on EIO, like most programs
  would, spins furiously.

  Arguably, deadfs was always wrong in returning EIO, because once you
  get to deadfs no operation will ever work again, but we used to
  take a different path through devfs_vnops.c which got us the ENXIO.

  Something changed recently, and while testing this fix, I noticed
  that drm-kmod-66/i915kms may be the condition which trigger
  the different code-path.

  MFC to: stable/15
  Fixes: 289785
  Thanks to: imp, kib

  (cherry picked from commit 2612f1b8649bb4f069a6a064ed714daa5f10d037)


   sys/fs/deadfs/dead_vnops.c | 10 +++++-----
   1 file changed, 5 insertions(+), 5 deletions(-)

[commit 5572a45c0f6122477e218e54a4b88e63563f3359]
Date: 2025-10-23
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Userland.programs
Subject: w: Trim whitespace and commas from time and uptime
Review: The man:w[1] command now trims leading whitespace and trailing commas from human-readable time and uptime output, making the output cleaner without changing the format.
Body:

  When producing formatted output, trim leading whitespace and trailing
  commas from the human-readable time and uptime before emitting them.
  The text output remains unchanged.

  PR:		290089
  Fixes:          6e6febb54da9 ("w: Fix idle time in json output, add login/idle times to json output")
  Reviewed by:	marius.h_lden.org
  Differential Revision:	https://reviews.freebsd.org/D53167

  (cherry picked from commit 4d5789532a940144c869d66505e756ce816f8a50)


   usr.bin/w/w.c | 33 +++++++++++++++++++++++++--------
   1 file changed, 25 insertions(+), 8 deletions(-)

[commit 82b6cd5ef6547da2e3d18fbbc69393d73322df43]
Date: 2025-10-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: getrlimitusage.2: Update HISTORY section
Review: The commit updates the HISTORY section of the man:getrlimitusage[2] manual page to include version 14.2, which is a minor documentation correction with no functional change.
Body:

  Add 14.2, as this was cherry-picked prior to release.

  Reported by:	Harald Eilertsen
  Reviewed by:	kib
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D53320

  (cherry picked from commit 2387a51af235e4304c63f95465a569c878f49dcd)
  (cherry picked from commit 87795ea45407355de4e36388ed6c02ef70b9241a)


   lib/libc/sys/getrlimitusage.2 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit f9020f19119e18cba8cea1d8f7af9ac832b1aa3c]
Date: 2025-10-22
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: mtree: Remove stray an (Aironet) directory
Review: Removes stray directory entry for the removed an (Aironet) driver from man:mtree[8] configuration.
Body:

  Reviewed by:	imp
  Fixes:	663b174b5b53 ("an: Remove driver")
  MFC after:	5 days
  Differential Revision:	https://reviews.freebsd.org/D53265

  (cherry picked from commit f7ccf051016fe3989ef6fbf10adea3ce4131f91b)


   etc/mtree/BSD.include.dist | 2 --
   1 file changed, 2 deletions(-)

[commit 07889c6497498b6d40afc21e05a7cd550fa9ead2]
Date: 2025-10-22
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: mtree: Remove stray wi directory
Review: The commit removes a stray directory entry for the removed wi(4) driver from the mtree file, which affects system tree creation but has no direct user-visible impact beyond internal cleanup.
Body:

  Reviewed by:	imp, emaste
  Fixes:	a21def4d568f ("pccard: Remove wi(4) driver")
  MFC after:	5 days
  Differential Revision:	https://reviews.freebsd.org/D53264

  (cherry picked from commit f942a7465469008f7538436a70f15a44cabecbb0)


   etc/mtree/BSD.include.dist | 2 --
   1 file changed, 2 deletions(-)

[commit c24434265c7ce501646a5654b79e3a2930321366]
Date: 2025-10-22
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: mtree: Remove stray atm directory
Review: The mtree specification no longer includes the netgraph/atm directory, which was removed after ATM support was eliminated.
Body:

  ATM support for netgraph was removed in af0cc0b22362 ("NgATM: Remove
  netgraph ATM support")

  Remove the directory from the mtree specification.

  Reviewed by:	emaste
  Fixes:	21735dfaebdf ("include: Remove no longer existing netgraph/atm")
  MFC after:	5 days
  Differential Revision:	https://reviews.freebsd.org/D53260

  (cherry picked from commit 8e8ee8bbe2a112f7d1cc1b005dbdb8868522b640)


   etc/mtree/BSD.include.dist | 2 --
   1 file changed, 2 deletions(-)

[commit 64fb7033d752830458d9d401c5b03d03d4aac204]
Date: 2025-10-24
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Kernel.general
Subject: amd64: print 'EFI RT fault' line before fault CPU state
Review: The EFI runtime fault message is now printed before the CPU state dump, making debugging easier for users encountering EFI runtime faults.
Body:

  (cherry picked from commit cfb28c5ea0bce2ce95b14076bc63546049f0c16c)


   sys/amd64/amd64/trap.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit f7937053fd0899e7b808bab3a0576ff16f3e943d]
Date: 2025-10-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: arp: fix adding proxy entries for P2P interfaces
Review: The arp(8) utility now correctly adds proxy ARP entries for point-to-point interfaces when using the netlink implementation, fixing compatibility with mpd5. The '-i' option can now be used with '-S' as with '-s'.
Body:

  The old rtsock implementation used in-kernel workaround to do so.
  When route to specified destination address used P2P interface, the
  kernel did the search with ifa_ifwithnet() for most suitable network
  and then add proxy entry to this interface.

  Use similar approach with netlink implementation. We already have
  get_ether_addr() function that does almost the same thing as
  ifa_ifwithnet(). Use it when we find that destination route uses
  P2P interface and then try to guess suitable interface. This should
  fix the use of netlink-based arp(8) in mpd5.

  Rename get_ether_addr() to get_ifinfo(), since now it is used to find
  only ifindex in case when hwaddr is specified by user.
  Also make set_nl() and delete_nl() prototype similar to rtsock.
  And allow '-i' to be used with '-S', since we already allow the same
  for '-s'.

  PR:		290221
  Reported by:	eugen
  Reviewed by:	eugen
  Differential Revision:	https://reviews.freebsd.org/D53113

  (cherry picked from commit c26d6bf9da013e839d9a696746ea1741569e619e)


   usr.sbin/arp/arp.c         | 32 ++++++++++++++++++++------------
   usr.sbin/arp/arp.h         |  9 ++++-----
   usr.sbin/arp/arp_netlink.c | 20 ++++++++++++++++----
   3 files changed, 40 insertions(+), 21 deletions(-)

[commit d78f36183a26e2652228c2f7e673ad1b58b3770a]
Date: 2025-10-22
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Network.general
Subject: ipfilter: Plug ip_nat kernel information leak
Review: The ipfilter NAT implementation no longer leaks uninitialized kernel heap memory to user space, addressing a security vulnerability.
Body:

  ipf_nat_getent() allocates a variable-sized nat_save_t buffer with
  KMALLOCS() (which does not zero memory) and then copies only a subset
  of fields into it before returning the object to userland using
  ipf_outobjsz(). Because the structure is not fully initialized on all
  paths, uninitialized kernel heap bytes can be copied back to user space,
  resulting in an information leak.

  We fix this by zeroing out the data structure immediately after
  allocation.

  Reported by:		Ilja Van Sprundel <ivansprundel@ioactive.com>
  Reviewed by:		emaste
  Differential revision:	https://reviews.freebsd.org/D53274

  (cherry picked from commit 6535e9308a26e17023831fe68fb71d2febf2a002)


   sys/netpfil/ipfilter/netinet/ip_nat.c | 1 +
   1 file changed, 1 insertion(+)

[commit e190f21c98aeee4e284147eb43f8d446d585c0db]
Date: 2025-10-22
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Network.general
Subject: ipfilter: Plug ip_htable kernel information leak
Review: The ipfilter kernel module no longer leaks uninitialized kernel stack memory via the ip_htable statistics interface, preventing potential information disclosure.
Body:

  ipf_htable_stats_get() constructs an iphtstat_t on the stack and only
  initializes select fields before copying the entire structure to
  userland. The trailing padding array iphs_pad[16] is never initialized,
  so ~128 bytes of uninitialized kernel stack memory can be leaked to user
  space on each call. This is a classic information disclosure
  vulnerability that can reveal pointers and other sensitive data.

  We fix this by zeroing out the data structure prior to use.

  Reported by:		Ilja Van Sprundel <ivansprundel@ioactive.com>
  Reviewed by:		emaste
  Differential revision:	https://reviews.freebsd.org/D53275

  (cherry picked from commit 0d589ecbc7aa916537fd21c0344919491cfcb293)


   sys/netpfil/ipfilter/netinet/ip_htable.c | 2 ++
   1 file changed, 2 insertions(+)

[commit 3473db79f4b30d3080f99c5fb7c870fbedb973f6]
Date: 2025-10-22
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: kdb: Fix a typo in a source code comment
Review: Typo fix in a source code comment only; no user-visible impact.
Body:

  - s/th/the/

  (cherry picked from commit 0a53e6d8bc0b3a6332e228993d040fbf38f652fb)


   sys/kern/subr_kdb.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 075982de62fc31559d327fe68bc79283ba5f2073]
Date: 2025-10-22
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: pmcstat(8): Fix a typo in a source code comment
Review: Fixes a typo in a source code comment.
Body:

  - s/th/the/

  (cherry picked from commit 2b2a4f02e0872065c63baec8bf0069e3b677def7)


   usr.sbin/pmcstat/pmcpl_callgraph.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6fd7f979b43762ad7ee4b409cd57ee13a7711d81]
Date: 2025-10-10
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: ice(4): Add PCI IDs for E835 devices
Review: The man:ice[4] driver adds PCI IDs and branding strings for E835 adapters, enabling support for these devices with SPDM and RDMA features on 100 and 200Gbps links.
Body:

  Add device IDs and branding strings for E835 adapters.
  This is a follow up for E830 adapters with Security Protocol
  and Data Model (SPDM) support and RDMA support available
  on 100 and 200Gbps links.

  Signed-off-by: Krzysztof Galazka <krzysztof.galazka@intel.com>

  Approved by:	kbowling (mentor), erj (mentor)
  Sponsored by:   Intel Corporation
  Differential Revision:	https://reviews.freebsd.org/D52782

  (cherry picked from commit b202176dc76d862f886778439b96dd1243d8b999)


   sys/dev/ice/ice_common.c   |  9 +++++++++
   sys/dev/ice/ice_devids.h   | 18 ++++++++++++++++++
   sys/dev/ice/ice_drv_info.h | 39 +++++++++++++++++++++++++++++++++++++++
   3 files changed, 66 insertions(+)

[commit 9dda71d578ead7d3e32789060f079bfb58666d2d]
Date: 2025-10-17
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: include/stdckdint.h: make the header compatible with C++
Review: The header file include/stdckdint.h is made compatible with C++.
Body:

  PR:	290299

  (cherry picked from commit 3c052bec12fcf09f81ba0760ebecec38e196d332)


   include/stdckdint.h | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit a714ea2827b889f834b18f5f24384f39474611e5]
Date: 2025-10-09
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Docs.manpages
Subject: mount_nullfs.8: document unixbypass and nounixbypass
Review: The man:mount_nullfs[8] manual page now documents the unixbypass and nounixbypass mount options, which control whether Unix domain socket credentials are bypassed for nullfs mounts.
Body:

  (cherry picked from commit 033587a985a46e9d45fc3fb48a78754d81f0d50d)


   sbin/mount_nullfs/mount_nullfs.8 | 28 +++++++++++++++++++++++++++-
   1 file changed, 27 insertions(+), 1 deletion(-)

[commit 1c8f3ba03cccf6e14d38c2a479b889c29d0eb6bf]
Date: 2025-10-08
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: nullfs: add nounixbypass mount option
Review: The nullfs filesystem gains a new 'nounixbypass' mount option. This option prevents unprivileged users from bypassing permissions on the underlying filesystem via nullfs mounts.
Body:

  (cherry picked from commit 6fa205a6233fea7c41ba0306c778bc5cab37ce7d)


   sys/fs/nullfs/null.h        | 5 +++--
   sys/fs/nullfs/null_subr.c   | 4 +++-
   sys/fs/nullfs/null_vfsops.c | 9 +++++++++
   sys/fs/nullfs/null_vnops.c  | 8 ++++++++
   4 files changed, 23 insertions(+), 3 deletions(-)

[commit aa884cdf91edf6dc96f25db229ff70dd030b9307]
Date: 2025-10-08
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: nullfs_mount: use symbols instead of string literals for cache mount options
Review: The nullfs filesystem now uses symbolic constants for cache mount options instead of string literals. This change is internal and does not affect user-visible behavior, configuration, or functionality.
Body:

  (cherry picked from commit 8e6f6a5fbde78bd8d19445ee6ebaf00b8f4f5aa9)


   sys/fs/nullfs/null_vfsops.c | 7 +++++--
   1 file changed, 5 insertions(+), 2 deletions(-)

[commit 26285c35d1f25f9fbbcac93720eadc0cb45eda78]
Date: 2025-10-08
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: nullfs: add a helper for testing if vnode belongs to a nullfs mount
Review: Adds a helper function for testing if a vnode belongs to a nullfs mount, which may affect kernel module developers or those working with nullfs internals.
Body:

  (cherry picked from commit 419f2fe6b70b1a409bf7eca7020d7c745558690f)


   sys/fs/nullfs/null.h        | 10 ++++++++++
   sys/fs/nullfs/null_vfsops.c |  4 ++--
   sys/fs/nullfs/null_vnops.c  |  2 +-
   3 files changed, 13 insertions(+), 3 deletions(-)

[commit a67114ae32fcf91cd9442f9905bfa1f6448ed9cf]
Date: 2025-10-21
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Network.wireless
Subject: rc: Chase 052211e08c0e and bfb202c4554a, remove ifconfig down/up
Review: The hostapd rc.d script no longer uses ifconfig down/up workarounds, which were previously needed to address a wireless driver regression.
Body:

  bfb202c4554a addresses the CTRL-EVENT-SCAN-FAILED. Upstream d807e289d
  caused FreeBSD regression in driver_bsd.c, which this rc.d patch
  worked around. As of bfb202c4554a this workaround is no longer needed.

  052211e08c0e implemented this change for wpa_supplicant but not for
  hostapd.

  Reported by:	avg
  MFC after:	3 days

  (cherry picked from commit 05637c82243e681b5db5d7e9829e699515456524)


   libexec/rc/rc.d/hostapd | 9 ---------
   1 file changed, 9 deletions(-)

[commit f56da8ff57f8423f4798d6af48a735037f5d3021]
Date: 2025-07-26
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.config
Subject: dma: Don't install dma.conf world-readable
Review: The dma.conf file is no longer installed world-readable, and auth.conf is now installed into /etc.
Body:

  While here, install auth.conf into /etc as well.

  MFC after:	3 days
  PR:		288409
  Reviewed by:	ivy, bapt
  Differential Revision:	https://reviews.freebsd.org/D51529

  (cherry picked from commit a3d4ae7cf351cc283a670d8400a89518a6b31d63)


   ObsoleteFiles.inc                        | 3 +++
   libexec/dma/dmagent/Makefile             | 6 ++++--
   tools/build/mk/OptionalObsoleteFiles.inc | 2 +-
   3 files changed, 8 insertions(+), 3 deletions(-)

[commit 218b164aef21de718bc3b4fb68ac4c4b57b40cab]
Date: 2025-10-20
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: UDP: let udp_pcblist() support UDP and UDP-Lite
Review: The commit refactors internal function parameters to support both UDP and UDP-Lite in man:netstat[1] output, but does not introduce user-visible changes or new features.
Body:

  Provide the IPPROTO_UDP in the arg2 parameter of udp_pcblist() and use
  this to determine the inpcbinfo. This allows the same function to be
  used in an upcoming commit to provide the list of pcbs for UDP-Lite
  just by providing IPPROTO_UDPLITE in the arg2 parameter.

  Reviewed by:		rrs
  Differential Revision:	https://reviews.freebsd.org/D53218

  (cherry picked from commit be3c59ff508204dbab9e3616dc82ed7620f05d0c)


   sys/netinet/udp_usrreq.c | 15 ++++++++-------
   1 file changed, 8 insertions(+), 7 deletions(-)

[commit 6626f4e1a8f779cf454cea899df1220a08c833d6]
Date: 2025-10-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: cleanup of syncache_expand()
Review: Internal cleanup of TCP syncache function with no user-visible behavior change; callers only check return value, which remains consistent.
Body:

  * Consistently free the string after unlocking the sch, if possible.
  * Remove the failure handling in case of sc != NULL, since this is
    not possible anymore.
  * Remove the use of goto and instead return 0 in the three cases.
  The only change in behavior is that in three out of the four cases,
  where 0 is returned, *lsop is not set to NULL anymore. So the behavior
  is now consistent and also documented in a comment. The current in
  tree callers only look at *lsop, if and only if syncache_expand()
  returns 1.

  Reviewed by:		Peter Lei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52948

  (cherry picked from commit aafdbf83b926519cb47de8f16a1a40c1ef3c84b5)


   sys/netinet/tcp_syncache.c | 33 +++++++++++++++------------------
   1 file changed, 15 insertions(+), 18 deletions(-)

[commit c108844843423bffeed0317b722b5c3277d8dccf]
Date: 2025-10-20
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: src.conf.5: Regen
Review: The commit regenerates man:src.conf.5 to reflect recent MFCs, which updates documentation for build options related to jemalloc debugging and the ia32 loader.
Body:

  after recent MFCs:
  9d0b660e6949 ("jemalloc: Fix activating debug on WITHOUT_MALLOC_PRODUCTION")
  ac5378d93ce0 ("Add build option for the ia32 loader")

  Sponsored by:	The FreeBSD Foundation


   share/man/man5/src.conf.5 | 18 ++++++++++++++----
   1 file changed, 14 insertions(+), 4 deletions(-)

[commit 34943c3c2a3bbc68fabe99367e24d2fe28eb2472]
Date: 2025-09-07
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: undecided
Subject: src.opts.mk: Remove REPRODUCIBLE_BUILD from the default list
Review: The commit removes REPRODUCIBLE_BUILD from the default list in src.opts.mk, correcting a duplication after it was added to bsd.opts.mk. This change affects build configuration defaults but does not introduce user-visible behavior changes, new features, or removals.
Body:

  It was added to the list in bsd.opts.mk in commit 4f81c42fbd76, so
  should have been removed here.

  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.

  (cherry picked from commit b2f5dc591ef2547ee2e9b68e58a263cd34948db1)
  (cherry picked from commit 7626ba028089b97b5bb204b5203ee8fa24f63c48)

  PR:		290427


   share/mk/bsd.opts.mk | 2 +-
   share/mk/src.opts.mk | 1 -
   2 files changed, 1 insertion(+), 2 deletions(-)

[commit 3b9b7e09e359ac20f83d4dd972271ff950b62da6]
Date: 2025-10-15
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Userland.libraries
Subject: libc: Add "Z" as TZ designator for strptime.
Review: The strptime(3) function now accepts 'Z' as a time zone designator for UTC, following ISO 8601. The man page is updated accordingly.
Body:

  ISO 8601 allows use of "Z" as the time zone designator. Update the
  strptime parser to allow this usage.

  While we are at it, update the manpage to reflect that both UTC and Z
  are now valid options.

  Reviewed by:	des
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53083

  (cherry picked from commit 79e57ea662d92ffcbe7d65854a284aefac6a332d)


   lib/libc/stdtime/strptime.3 | 2 +-
   lib/libc/stdtime/strptime.c | 3 ++-
   2 files changed, 3 insertions(+), 2 deletions(-)

[commit f55b7464144e631560a51319c37bef449601442b]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: Debian rules: install scripts/objtool-wrapper.in into dkms tree
Review: Debian packaging rules now install scripts/objtool-wrapper.in into the DKMS tree, affecting DKMS-based builds.
Body:

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Attila Flp <attila@fueloep.org>
  Signed-off-by: Shengqi Chen <harry-chen@outlook.com>
  Closes #17633
  Closes #17646


   contrib/debian/rules.in | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3515c887153c60458e1e1547db61368541d09c02]
Date: 2025-08-16
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: objtool-wrapper: Update Debian packaging
Review: Fixes a Debian packaging issue that was causing module build failures in DKMS source installations.
Body:

  6cf17f65 (#17456) introduced a change to `configure.ac` which
  breaks the patching done in the Debian packages DKMS source
  installation phase. This results in a failed module build.

  Adapt the awk script doing the patching to handle the added
  `AC_CONFIG_FILE` entry.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Tested-by: Shengqi Chen <harry-chen@outlook.com>
  Signed-off-by: Attila Flp <attila@fueloep.org>
  Closes #17633
  Closes #17646


   contrib/debian/rules.in | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 0d6a0e50122c0c10dfbdd057cbb7f918c5799a22]
Date: 2025-07-15
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: objtool wrapper: use absolute path to call the wrapper
Review: The commit fixes a build issue for older kernel versions by using an absolute path to the objtool wrapper, preventing build failures when make is run outside the build directory.
Body:

  Older kernel versions run make outside of the build directory. This
  works since all paths are absolute. Relative paths will fail in such
  a scenario.

  Use an absolute path to the objtool wrapper as well, since the
  relative path breaks the build on older kernels.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Attila Flp <attila@fueloep.org>
  Closes #17541

   module/Makefile.in | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 7272e2d029c20c3144d7aa49500dc86d70344030]
Date: 2025-10-22
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: so_reuseport_lb_test: Add a test case for connected UDP sockets
Review: The commit adds a test case for connected UDP sockets with SO_REUSEPORT load balancing, which is internal testing infrastructure and has no direct user-visible impact.
Body:

  Approved by:	so

  (cherry picked from commit 1dd66c6ac2c146f540b2ff825fbee442354aeee5)


   tests/sys/netinet/so_reuseport_lb_test.c | 148 +++++++++++++++++++++++++++++++
   1 file changed, 148 insertions(+)

[commit e276759b368701a49e543c45d5d6ea08ed4fbc38]
Date: 2025-10-06
Score: 5
Status: proposed(include=yes,score=95)
Sponsor: 
Section: Network.general
Subject: inpcb: Ignore SO_REUSEPORT_LB on connected sockets
Review: The man:in_pcb[4] subsystem now ignores SO_REUSEPORT_LB on connected UDP sockets, preventing datagrams from unintended sources from being delivered. This addresses a security vulnerability (CVE-2025-24934).
Body:

  While TCP disallows connect()ing a socket with SO_REUSEPORT_LB, UDP does
  not.  As a result, a connected UDP socket can be placed in the lbgroup
  hash and thus receive datagrams from sources other than the connected
  host.

  Reported by:	Amit Klein <amit.klein@mail.huji.ac.il>
  Reported by:	Omer Ben Simhon <omer.bensimhon@mail.huji.ac.il>
  Reviewed by:	glebius
  Approved by:	so
  Security:	FreeBSD-SA-25:09.netinet
  Security:	CVE-2025-24934

  (cherry picked from commit 320ad3dec5ff1b37f6907a47961c18b9d77e6a53)


   sys/netinet/in_pcb.c | 13 ++++++++++---
   1 file changed, 10 insertions(+), 3 deletions(-)

[commit 2f744885ea09b7d44c7955aaaf740cb024e4312e]
Date: 2025-10-08
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: rc tests: Add a test to check for warnings from rcorder
Review: Adds a test to check for warnings from rcorder, which may help detect issues in rc scripts during development but has no direct user-visible impact.
Body:

  Reviewed by:	des
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D52954

  (cherry picked from commit 04d47c7cde54cc325cca3f47113976f5500dc58f)


   libexec/rc/tests/rc_subr_test.sh | 12 ++++++++++++
   1 file changed, 12 insertions(+)

[commit 1508441e71f13b3d66c854677216a4a8c8ca5e03]
Date: 2025-10-15
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Kernel.general
Subject: imgact_elf: Check note body sizes
Review: The ELF image activator now validates note data sizes to prevent out-of-bounds reads during program loading.
Body:

  In parse_notes we validate that the note name fits within the note
  buffer, but we do not do the same for the note data, so there is some
  potential for an OOB read in the note handler.  Add a bounds check.

  Reported by:	Ilja Van Sprundel <ivansprundel@ioactive.com>
  Reviewed by:	kib, emaste
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53063

  (cherry picked from commit c86af2cc4cd12fb0174843b22d737c3b5b5d55d0)


   sys/kern/imgact_elf.c | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit b951c7fd7799710141cde2066f2ed4d36e093a22]
Date: 2025-10-15
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Userland.libraries
Subject: libnv: Fix a length check in nvpair_unpack_string_array()
Review: Fixes a buffer underflow vulnerability in libnv's nvpair_unpack_string_array() function when handling malformed data.
Body:

  A string array is represented by a set of nul-terminated strings
  concatenated together.  For each string, we check to see if there's a
  nul terminator at the end, taking care to avoid going past the end of
  the buffer.  However, the code fails to handle the possibility that
  size == 0 at the end of an iteration, leading to underflow.

  Fix the length check.

  Reported by:	Ilja van Sprundel <ivansprundel@ioactive.com>
  Reviewed by:	emaste
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53069

  (cherry picked from commit 937693fc9e4ff4045cc674a14902f0d53e84ec98)


   sys/contrib/libnv/bsd_nvpair.c | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit fdc683e8630917abe4d110e21e3244e038ae6422]
Date: 2025-09-25
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Storage.general
Subject: dnode_next_offset: backtrack if lower level does not match
Review: The commit fixes a bug in the ZFS dnode search algorithm that could cause panics during sync or prevent freeing of objects in certain race conditions. This change ensures that the search correctly handles cases where higher-level block pointers match but lower-level ones do not, preventing data corruption and system crashes.
Body:

  This changes the basic search algorithm from a single search up and down
  the tree to a full depth-first traversal to handle conditions where the
  tree matches at a higher level but not a lower level.

  Normally higher level blocks always point to matching blocks, but there
  are cases where this does not happen:

  1. Racing block pointer updates from dbuf_write_ready.

     Before f664f1ee7f (#8946), both dbuf_write_ready and
     dnode_next_offset held dn_struct_rwlock which protected against
     pointer writes from concurrent syncs.

     This no longer applies, so sync context can f.e. clear or fill all
     L1->L0 BPs before the L2->L1 BP and higher BP's are updated.

     dnode_free_range in particular can reach this case and skip over L1
     blocks that need to be dirtied. Later, sync will panic in
     free_children when trying to clear a non-dirty indirect block.

     This case was found with ztest.

  2. txg > 0, non-hole case. This is #11196.

     Freeing blocks/dnodes breaks the assumption that a match at a higher
     level implies a match at a lower level when filtering txg > 0.

     Whenever some but not all L0 blocks are freed, the parent L1 block is
     rewritten. Its updated L2->L1 BP reflects a newer birth txg.

     Later when searching by txg, if the L1 block matches since the txg is
     newer, it is possible that none of the remaining L1->L0 BPs match if
     none have been updated.

     The same behavior is possible with dnode search at L0.

     This is reachable from dsl_destroy_head for synchronous freeing.
     When this happens open context fails to free objects leaving sync
     context stuck freeing potentially many objects.

     This is also reachable from traverse_pool for extreme rewind where it
     is theoretically possible that datasets not dirtied after txg are
     skipped if the MOS has high enough indirection to trigger this case.

  In both of these cases, without backtracking the search ends prematurely
  as ESRCH result implies no more matches in the entire object.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Akash B <akash-b@hpe.com>
  Signed-off-by: Robert Evans <evansr@google.com>
  Closes #16025
  Closes #11196

   module/zfs/dnode.c | 65 +++++++++++++++++++++++++++++++++++++++++++++---------
   1 file changed, 54 insertions(+), 11 deletions(-)

[commit 6dfca589ea75b9350af783c0b58eb632b0c752b5]
Date: 2025-10-14
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: ipfw: Check for errors from sooptcopyin() and sooptcopyout()
Review: The commit adds error checking for socket option copy operations in ipfw NAT code, which may affect error handling for NAT configuration commands. However, the commit message notes that the code may be unused and the changes are internal error handling improvements without clear user-visible impact.
Body:

  Note, it looks like this code may be unused since commit 4a77657cbc01
  ("ipfw: migrate ipfw to 32-bit size rule numbers").  In particular, it
  looks like the ipfw_nat_*_ptr pointers are unused now.

  Reviewed by:	ae
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D53068

  (cherry picked from commit 2df39ce5d4a8836ef5fd3c2666f48041042eff42)


   sys/netpfil/ipfw/ip_fw_nat.c | 12 +++++++-----
   1 file changed, 7 insertions(+), 5 deletions(-)

[commit 2078f67215e934cb9c43b93586ba79fd6fbcee8e]
Date: 2025-10-14
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: exec: Check for errors when mapping the shared object
Review: The commit fixes a refcount leak in the VDSO mapping for non-ASLR cases, which could lead to resource exhaustion over time.
Body:

  In the non-ASLR case, there is no check for an error from
  vm_map_fixed().  Restore it, it was dropped in commit 939f0b6323e0a.
  This bug could result in a refcount leak of the object used to map the
  VDSO page.

  Reviewed by:	kib
  Reported by:	Ilja Van Sprundel <ivansprundel@ioactive.com>
  MFC after:	1 week
  Fixes:	939f0b6323e0 ("Implement shared page address randomization")
  Differential Revision:	https://reviews.freebsd.org/D53065

  (cherry picked from commit 7117c86fcb7ebee4483097cefa9b143de8d78ee0)


   sys/kern/kern_exec.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 2203f41697b3701dd722ded99c717a029c1149ae]
Date: 2025-10-16
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: [zfs-2.2.9] Fix zpl_ctldir.c checkstyle
Review: This commit is a style-only fix with no user-visible impact.
Body:

  Move a bracket '{' to make checkstyle happy

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>


   module/os/linux/zfs/zpl_ctldir.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 689145a01ac36716ba825096b989ed3d5adfdee8]
Date: 2025-10-06
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: zvol: verify IO type is supported
Review: ZVOLs now verify supported IO request types and explicitly reject unsupported types, including secure erase operations.
Body:

  ZVOLs don't support all block layer IO request types.  Add a check for
  the IO types we do support.  Also, remove references to
  io_is_secure_erase() since they are not supported on ZVOLs.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17803

   module/os/linux/zfs/zvol_os.c                      | 77 ++++++++++++++--------
   .../functional/zvol/zvol_misc/zvol_misc_trim.ksh   |  7 ++
   2 files changed, 56 insertions(+), 28 deletions(-)

[commit 6a02c099426d75bab31fda6e871b67b6dc256e2c]
Date: 2025-09-29
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Storage.general
Subject: zvol: Fix blk-mq sync
Review: The commit fixes a bug where zvol blk-mq incorrectly handled FLUSH and TRIM commands, ensuring sync writes function correctly. This affects users relying on synchronous write operations for data integrity.
Body:

  The zvol blk-mq codepaths would erroneously send FLUSH and TRIM
  commands down the read codepath, rather than write.  This fixes
  the issue, and updates the zvol_misc_fua test to verify that
  sync writes are actually happening.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Reviewed-by: Ameer Hamza <ahamza@ixsystems.com>
  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17761
  Closes #17765

   include/os/linux/kernel/linux/blkdev_compat.h      | 18 ----------
   module/os/linux/zfs/zvol_os.c                      | 23 ++++++++++++-
   .../functional/zvol/zvol_misc/zvol_misc_fua.ksh    | 40 +++++++++++++++++++++-
   3 files changed, 61 insertions(+), 20 deletions(-)

[commit ea5d37a1b94611038be99903bcb4b1bf4a33aaa3]
Date: 2025-02-15
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ZTS: make uses of mktemp consistent
Review: This commit only modifies test scripts within the ZFS test suite to use mktemp consistently. It does not affect any user-facing functionality, production code, or configuration.
Body:

  In all cases, rely on mktemp itself to make the best decision about
  where to place the file or directory. In all cases, that decision will
  be $TMPDIR, which we have set globally.

  Sponsored-by: https://despairlabs.com/sponsor/
  Signed-off-by: Rob Norris <robn@despairlabs.com>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: Igor Kozhukhov <igor@dilos.org>


   tests/zfs-tests/tests/functional/acl/off/posixmode.ksh                | 2 +-
   tests/zfs-tests/tests/functional/arc/dbufstats_001_pos.ksh            | 4 ++--
   tests/zfs-tests/tests/functional/arc/dbufstats_002_pos.ksh            | 2 +-
   .../zfs-tests/tests/functional/cli_root/zfs_send/zfs_send_007_pos.ksh | 4 ++--
   .../functional/cli_root/zpool_import/zpool_import_rename_001_pos.ksh  | 2 +-
   tests/zfs-tests/tests/functional/redacted_send/redacted_panic.ksh     | 2 +-
   tests/zfs-tests/tests/functional/snapshot/snapshot_002_pos.ksh        | 2 +-
   tests/zfs-tests/tests/functional/snapshot/snapshot_006_pos.ksh        | 2 +-
   .../zfs-tests/tests/functional/user_namespace/user_namespace_004.ksh  | 2 +-
   tests/zfs-tests/tests/functional/zvol/zvol_misc/zvol_misc_fua.ksh     | 4 ++--
   tests/zfs-tests/tests/functional/zvol/zvol_misc/zvol_misc_trim.ksh    | 4 ++--
   tests/zfs-tests/tests/functional/zvol/zvol_stress/zvol_stress.ksh     | 2 +-
   12 files changed, 16 insertions(+), 16 deletions(-)

[commit 824d156a55e76fb2a6ee5af6544a7026ce90bc8e]
Date: 2025-09-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Linux 6.17 compat: META
Review: The commit updates the META file to note compatibility with Linux kernel 6.17, which is an internal metadata change without user-visible impact.
Body:

  Update the META file to reflect compatibility with the 6.17
  kernel.

  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Reviewed-by: Rob Norris <robn@despairlabs.com>
  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #17789

   META | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5e10fb6d7288927205a62ac2662f9863e7911bb9]
Date: 2025-09-25
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Storage.general
Subject: Add interface to interface spa_get_worst_case_min_alloc() function
Review: The ZFS pool configuration now includes "min_alloc" and "max_alloc" keys that help users estimate potential wasted capacity when setting recordsize. The man:zfs[8] utility warns when an inefficient block size is requested.
Body:

  Provide an interface to retrieve the lowest and highest minimum
  allocation size for the normal allocation class.  This can be used
  by external consumers of the DMU to estimate potential wasted
  capacity when setting the recordsize for an object.

  The new "min_alloc" and "max_alloc" keys are added to the pool
  configuration and used by default_volblocksize() to warn when
  an ineffecient block size is requested.  For older kmods which
  don't yet include the new keys fallback to the previous logic.

  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #17758


   cmd/zfs/zfs_main.c      | 28 +++++++++++++++++++++-------
   include/sys/fs/zfs.h    |  2 ++
   include/sys/spa.h       |  1 +
   include/sys/spa_impl.h  |  1 +
   module/zfs/spa_config.c |  2 ++
   module/zfs/spa_misc.c   | 15 +++++++++++++++
   module/zfs/vdev.c       | 15 ++++++++-------
   module/zfs/vdev_label.c |  2 ++
   8 files changed, 52 insertions(+), 14 deletions(-)

[commit 3167b0db10c03b8bac122079c875533077a23cc4]
Date: 2025-09-25
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Storage.general
Subject: Fix 'zpool add' safety check corner cases
Review: The 'zpool add' command now warns users when adding vdevs to a pool with mismatched replication levels in previously missed corner cases, including pools with mixed file and disk vdevs, active dRAID distributed spares, or active hot spares.
Body:

  Three cases were discovered where 'zpool add' would fail to
  warn when adding vdevs to a pool with a mismatched replication
  level.  These are:

    1. When a pool contains mixed file and disk vdevs.
    2. When a pool contains an active dRAID distributed spare
    3. When a pool contains an active hot spare

  The lack of warnings are caused by get_replication() assessing
  the current pool configuration an inconsistent and disabling
  the mismatched replication check for the new pool configuration
  after 'zpool add'.  This change updates get_replication() to
  be slightly more tolerant in the non-fatal case.

  The zpool_add_010_pos.ksh test case was split in to separate
  tests: zpool_add_warn_create.ksh, pool_add_warn_degraded.ksh,
  and zpool_add_warn_removal.  These test were extended to
  include coverage for dRAID pools and the three scenarios
  described above.

  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #17780


   cmd/zpool/zpool_vdev.c                             |  26 +--
   tests/runfiles/common.run                          |   3 +-
   tests/zfs-tests/tests/Makefile.am                  |   4 +-
   .../functional/cli_root/zpool_add/zpool_add.kshlib |  42 +++++
   ...l_add_010_pos.ksh => zpool_add_warn_create.ksh} | 100 ++---------
   .../cli_root/zpool_add/zpool_add_warn_degraded.ksh | 195 +++++++++++++++++++++
   .../cli_root/zpool_add/zpool_add_warn_removal.ksh  | 117 +++++++++++++
   7 files changed, 391 insertions(+), 96 deletions(-)

[commit edeff9b3f5ef5a7e926c1cda87d3da6c40e80ab6]
Date: 2025-10-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: quot: Fix benign buffer overflow
Review: The man:quot[8] utility no longer risks a buffer overflow when displaying numeric UIDs for users without a password entry, improving robustness for systems with very large UIDs.
Body:

  If it encounters an inode whose owner does not have a pw entry, quot
  allocates a 7-byte buffer (8 in practice, since that is the minimum
  allocation size) and uses it to store the numeric uid preceded by a
  hash character.  This will overflow the allocated buffer if the UID
  exceeds 6 decimal digits.  Avoid this by using asprintf() instead.

  While here, simplify the common case as well using strdup().

  Reported by:	Igor Gabriel Sousa e Souza <igor@bsdtrust.com>
  MFC after:	3 days
  Reviewed by:	obiwac, emaste
  Differential Revision:	https://reviews.freebsd.org/D53129

  (cherry picked from commit 5854d1cbab1073d78519e7ad9a6eb5726341d587)


   usr.sbin/quot/quot.c | 8 ++------
   1 file changed, 2 insertions(+), 6 deletions(-)

[commit 4ab2e9d4feec969a634f26924822da94efabab7c]
Date: 2025-10-13
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Klara, Inc.
Section: Docs.manpages
Subject: realpath: Belatedly document POSIX conformance
Review: The man:realpath[3] manual page now documents that the implementation conforms to POSIX.1-2008, reflecting changes made earlier to align with the standard.
Body:

  We've been mostly POSIX-conforming since r236400 and fully since r240410,
  which fixed a corner case where a missing non-leaf directory would be
  reported as ENOTDIR instead of ENOENT.

  Sponsored by:	Klara, Inc.
  Fixes:		7877ed7ce33e ("Avoid mapping ENOENT to ENOTDIR for non-existent path components.")
  Reviewed by:	ziaee, markj
  Differential Revision:	https://reviews.freebsd.org/D53027

  (cherry picked from commit 7c66667d45e95af59f59e41ef169119a974a6be1)


   lib/libc/stdlib/realpath.3 | 12 ++++++------
   1 file changed, 6 insertions(+), 6 deletions(-)

[commit bebae0e231290833b04935e4c18e25931e766587]
Date: 2025-10-13
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Klara, Inc.
Section: Userland.libraries
Subject: realpath: Report correct path on failure
Review: The man:realpath[3] function now reports the correct path when lstat() fails due to EACCES or ENOTDIR, returning the parent directory path instead of the child path.
Body:

  If lstat() fails with EACCES or ENOTDIR, the path we need to return in
  the caller-provided buffer is that of the parent directory (which is
  either unreadable or not a directory; the latter can only happen in the
  case of a race) rather than that of the child we attempted to stat.

  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D53025

  (cherry picked from commit 1406de21e176d8700240ac9e473df007cd41eec1)


   lib/libc/stdlib/realpath.c          | 14 ++++++++++++--
   lib/libc/tests/gen/realpath2_test.c | 11 ++---------
   2 files changed, 14 insertions(+), 11 deletions(-)

[commit c81b5640aabd7fb6cd8111c884c3388a21532b42]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc.
Section: undecided
Subject: realpath: Additional test cases
Review: The commit adds test cases for the realpath function, which does not affect user-visible behavior or functionality.
Body:

  * Passing NULL should result in EINVAL
  * Passing an empty path should result in ENOENT
  * Failure with a non-null buffer should leave a partial result.  As
    pointed out in a comment in the test case, this reveals a discrepancy
    between the documentation and reality.

  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D53024

  (cherry picked from commit f3386dfeb429faaa30a915a4a422a25e07c8bf39)


   lib/libc/tests/gen/realpath2_test.c | 113 ++++++++++++++++++++++++++++++++----
   1 file changed, 101 insertions(+), 12 deletions(-)

[commit 829e479a0a37eb72023ce361f5b2379d82f8bc2a]
Date: 2025-10-17
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: bsdinstall: Fix typos
Review: Fixes typos in bsdinstall scripts.
Body:

  Reviewed by:	emaste
  MFC after:	2 days
  Differential Revision:	https://reviews.freebsd.org/D53170

  (cherry picked from commit 4ee348e27143b857445fd261cbe6695d6d57c836)


   usr.sbin/bsdinstall/scripts/auto       | 2 +-
   usr.sbin/bsdinstall/scripts/bootconfig | 2 +-
   usr.sbin/bsdinstall/scripts/jail       | 2 +-
   usr.sbin/bsdinstall/scripts/keymap     | 2 +-
   usr.sbin/bsdinstall/scripts/script     | 2 +-
   usr.sbin/bsdinstall/scripts/zfsboot    | 2 +-
   6 files changed, 6 insertions(+), 6 deletions(-)

[commit d8ddea0d4b0ad316000970987d26307e84ce1efc]
Date: 2025-10-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.config
Subject: rc: dmesg: Allow umask to be configurable
Review: The umask for man:dmesg[8] is now configurable via the rc.conf variable dmesg_umask. This allows users to control the file permissions of /var/run/dmesg.boot, which is useful when the kernel message buffer is restricted to privileged users.
Body:

  Allow umask to be configurable.

  Being able to set the umask via an rc variable is useful when setting:

      security.bsd.unprivileged_read_msgbuf=0

  As it allows a user to configure:

      dmesg_umask="066"

  Without modifying the rc script, and preventing the contents of the
  $dmesg_file (/var/run/dmesg.boot) from being publicly readable.

  PR:		272552
  Reviewed by:	netchild
  MFC after:	2 days
  Differential Revision:	https://reviews.freebsd.org/D53169

  (cherry picked from commit edadbc6ee95570627679f3bc14a1d5476d0ce339)


   libexec/rc/rc.conf    | 1 +
   libexec/rc/rc.d/dmesg | 2 +-
   2 files changed, 2 insertions(+), 1 deletion(-)

[commit 907cb4ac5fea8f249e10f14316289e7c4f4fdea0]
Date: 2025-10-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: rc.conf: Fix typo interferring -> interfering
Review: Fixes a typo in a comment in rc.conf.
Body:

  Reviewed by:	emaste
  MFC after:	2 days
  Differential Revision:	https://reviews.freebsd.org/D53168

  (cherry picked from commit 982d70ca2e6333b7e8ccf828b004ccf20a9cc550)


   libexec/rc/rc.conf | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 9e40b536cb589a1f54b58c1e53b6e5ec682dd4df]
Date: 2025-10-17
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: manpages: Use canonical names for Linux filesystems
Review: The commit updates man page references to use canonical names for Linux filesystems linprocfs and linsysfs, ensuring consistency with other filesystem documentation.
Body:

  The manpages of linprocfs(5) and linsysfs(5) document incomplete names without
  "fs" suffix. Make them identical to other filesystems.

  PR:		283079
  MFC after:	3 days
  Reviewed by:	ziaee, markj
  Differential Revision:	https://reviews.freebsd.org/D53155

  (cherry picked from commit 88b9ca860ef332d4d32e97e0f8a166f12cffc8e3)


   share/man/man5/linprocfs.5 | 4 ++--
   share/man/man5/linsysfs.5  | 4 ++--
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit 30f3a41464667f763b8cceabd23a9b3e466e521a]
Date: 2019-09-06
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.config
Subject: login.conf: Remove never used ignoretime/ignoretime@
Review: The ignoretime and ignoretime@ capabilities are removed from login.conf, affecting login class configuration.
Body:

  PR:		240378
  Reviewed by:	otis (mentor), glebius (src committer)
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D52991

  (cherry picked from commit 4835fc45efe8b593fa49786ec4bfb6ce5050756c)


   usr.bin/login/login.conf | 4 ----
   1 file changed, 4 deletions(-)

[commit 7d7ae8979acff0bde9963bd80c0c9433e986c33e]
Date: 2025-07-31
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Linux 6.17: d_set_d_op() is no longer available
Review: The commit adjusts ZFS compatibility code for Linux kernel 6.17, removing a deprecated kernel interface. This change is internal to the ZFS module's build and does not introduce any user-visible features, fixes, or configuration changes.
Body:

  We only have extremely narrow uses, so move it all into a single
  function that does only what we need, with and without d_set_d_op().

  Sponsored-by: https://despairlabs.com/sponsor/
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Signed-off-by: Rob Norris <robn@despairlabs.com>
  Closes #17621


   config/kernel-dentry-operations.m4            | 10 +++--
   include/os/linux/kernel/linux/dcache_compat.h | 26 -------------
   module/os/linux/zfs/zpl_ctldir.c              | 55 +++++++++++++++++++++++----
   3 files changed, 55 insertions(+), 36 deletions(-)

[commit e1a807b50d1c74cd01016f1980db95ebc2ebafc2]
Date: 2025-08-09
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: linux/zvol_os: fix crash with blk-mq on Linux 4.19
Review: The commit fixes a crash in the Linux kernel module for ZFS zvol when using blk-mq on older kernels (specifically Linux 4.19). It modifies the CPU selection logic to avoid indexing with an invalid CPU ID, preventing a kernel panic.
Body:

  03987f71e3 (#16069) added a workaround to get the blk-mq hardware
  context for older kernels that don't cache it in the struct request.
  However, this workaround appears to be incomplete.

  In 4.19, the rq data context is optional. If its not initialised, then
  the cached rq->cpu will be -1, and so using it to index into mq_map
  causes a crash.

  Given that the upstream 4.19 is now in extended LTS and rarely seen,
  RHEL8 4.18+ has long carried "modern" blk-mq support, and the cached
  hardware context has been available since 5.1, I'm not going to huge
  lengths to get queue selection correct for the very few people that are
  likely to feel it. To that end, we simply call raw_smp_processor_id() to
  get a valid CPU id and use that instead.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Reviewed-by: Paul Dagnelie <paul.dagnelie@klarasystems.com>
  Signed-off-by: Rob Norris <rob.norris@klarasystems.com>
  Sponsored-by: Klara, Inc.
  Sponsored-by: Wasabi Technology, Inc.
  Closes #17597

   module/os/linux/zfs/zvol_os.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 3a8e23d0f81809b2f95488a53f81d77580b189d2]
Date: 2025-08-01
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: Skip dbuf_evict_one() from dbuf_evict_notify() for reclaim thread
Review: The commit addresses an internal deadlock in the ZFS memory reclaim path, which may prevent system hangs under memory pressure. This change is not directly user-visible but could affect system stability during heavy memory usage.
Body:

  Avoid calling dbuf_evict_one() from memory reclaim contexts (e.g. Linux
  kswapd, FreeBSD pagedaemon). This prevents deadlock caused by reclaim
  threads waiting for the dbuf hash lock in the call sequence:
  dbuf_evict_one -> dbuf_destroy -> arc_buf_destroy

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Signed-off-by: Kaitlin Hoang <kthoang@amazon.com>
  Closes #17561

   include/os/freebsd/spl/sys/misc.h |  5 +++++
   include/os/linux/spl/sys/misc.h   |  6 ++++++
   include/sys/zfs_context.h         |  5 +++++
   module/os/freebsd/spl/spl_misc.c  |  9 +++++++++
   module/os/linux/spl/spl-thread.c  | 12 ++++++++++++
   module/zfs/dbuf.c                 | 10 +++++++++-
   6 files changed, 46 insertions(+), 1 deletion(-)

[commit 46bc182a5dc1d177233e53d86550a88896b64c71]
Date: 2025-06-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Linux 6.16: remove writepage and readahead_page
Review: The commit removes Linux-specific kernel compatibility code for writepage and readahead_page operations, which affects ZFS on Linux compatibility but has no direct user-visible impact on FreeBSD systems.
Body:

  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Rob Norris <robn@despairlabs.com>
  Closes #17443

   config/kernel-pagemap-readahead-page.m4            | 23 ++++++++++++++
   ...kernel-readpages.m4 => kernel-vfs-readpages.m4} |  0
   config/kernel-vfs-writepage.m4                     | 24 +++++++++++++++
   config/kernel.m4                                   |  4 +++
   include/os/linux/Makefile.am                       |  1 +
   include/os/linux/kernel/linux/pagemap_compat.h     | 36 ++++++++++++++++++++++
   module/os/linux/zfs/zpl_file.c                     |  9 +++---
   7 files changed, 93 insertions(+), 4 deletions(-)

[commit 01ddee5df44a15c721dab4e732745a5aeac64294]
Date: 2025-06-16
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Ports.packaging
Subject: Linux build: handle CONFIG_OBJTOOL_WERROR=y
Review: The ZFS build now includes an objtool wrapper script to ignore warnings when building with Linux 5.16, preventing build failures due to known objtool warnings.
Body:

  Linux 5.16 by default fails the build on objtool warnings. We have
  known and understood objtool warnings we can't fix without
  involving Linux maintainers.

  To work around this we introduce an objtool wrapper script which
  removes the `--Werror` flag.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Attila Flp <attila@fueloep.org>
  Closes #17456


   config/kernel-objtool.m4   | 17 +++++++++++++++++
   config/zfs-build.m4        | 40 ++++++++++++++++++++++++++++++++++++++++
   configure.ac               |  2 ++
   module/Makefile.in         |  1 +
   scripts/.gitignore         |  1 +
   scripts/objtool-wrapper.in | 36 ++++++++++++++++++++++++++++++++++++
   6 files changed, 97 insertions(+)

[commit 52233a725317e6e75fb93a2522f7803ec4c89f00]
Date: 2025-10-14
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: CI: Fix FreeBSD 15.0 by staying on ALPHA4 due to broken ALPHA5 image
Review: The commit adjusts a CI script to avoid a broken FreeBSD 15.0-ALPHA5 image by staying on ALPHA4 and setting IGNORE_OSVERSION, which is an internal CI workaround without user-visible impact.
Body:

  FreeBSD 15.0-ALPHA5 image fails to boot on cloud VMs due to missing
  /boot/efi mount point, causing the system to drop to single user mode
  where SSH cannot start. Work around this by staying on ALPHA4 and
  setting IGNORE_OSVERSION=yes to bypass pkg's kernel version mismatch
  prompt during bootstrap. This allows CI to proceed with ALPHA4 until we
  have a stable FreeBSD 15.0 image.

  Signed-off-by: Ameer Hamza <ahamza@ixsystems.com>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Closes #17846

   .github/workflows/scripts/qemu-2-start.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 91f7bd02d353ced779aeb56c4175abefb5f5b31d]
Date: 2025-10-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: CI: Switch FreeBSD 15 to 15.0-ALPHA4 and add FreeBSD 16
Review: The commit updates CI scripts to reference FreeBSD 15.0-ALPHA4 and adds FreeBSD 16, but this is an internal CI configuration change without user-visible impact.
Body:

  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes #17815

   .github/workflows/scripts/qemu-2-start.sh | 9 ++++++++-
   .github/workflows/zfs-qemu.yml            | 2 +-
   2 files changed, 9 insertions(+), 2 deletions(-)

[commit 46ee121c39cc9097b4e688ad5eef0d3244215fb0]
Date: 2025-10-01
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: docs: fix a few small typos (#17804)
Review: Minor typographical fixes in documentation files have no user-visible impact.
Body:

  Signed-off-by: Shreshth Srivastava <shreshthsrivastava2@gmail.com>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>

   .github/ISSUE_TEMPLATE/feature_request.md | 2 +-
   contrib/intel_qat/readme.md               | 2 +-
   etc/init.d/README.md                      | 2 +-
   3 files changed, 3 insertions(+), 3 deletions(-)

[commit c2a641e4b8e746b501a07bf988592351ec8430c3]
Date: 2025-09-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: CI: Add ZTS -O option, log Setup Testing Machines step
Review: The commit adds a -O option to zfs-test.sh for debugging test timeouts and logs the 'Setup Testing Machines' step. These changes are specific to the ZFS test suite and do not affect production userland or kernel behavior.
Body:

  Add a -O option to zfs-test.sh to dump debug information on test
  timeout.  The debug info includes:

  - 30 lines from 'top'
  - /proc/<PID>/stack output of process with highest CPU usage
  - Last lines strace-ing process with highest CPU usage
  - /proc/sysrq-trigger kernel stack traces

  All debug information gets dumped to /dev/kmsg (Linux only).

  In addition, print out the VM console lines from the "Setup Testing
  Machines" step.  We have often see VMs timeout at this step and don't
  know why.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17753

   .github/workflows/scripts/qemu-3-deps-vm.sh |  9 +++--
   .github/workflows/scripts/qemu-5-setup.sh   | 25 ++++++++----
   .github/workflows/scripts/qemu-6-tests.sh   |  2 +-
   scripts/zfs-tests.sh                        |  9 ++++-
   tests/test-runner/bin/test-runner.py.in     | 61 +++++++++++++++++++++++++++++
   5 files changed, 93 insertions(+), 13 deletions(-)

[commit 9d48e0150ce69624b96996c7fda8242d2ab2aff9]
Date: 2025-09-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: CI: Switch FreeBSD 15 to 15.0-ALPHA3
Review: The commit updates a CI script to reference FreeBSD 15.0-ALPHA3, which is an internal CI configuration change without user-visible impact.
Body:

  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Closes #17795

   .github/workflows/scripts/qemu-2-start.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit bc21a1c2c38c085c8bbb27b5d86396ac0026e700]
Date: 2025-09-26
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: CI: Remove Buildbot references
Review: Removes references to the deprecated Buildbot CI infrastructure, which has been fully replaced by GitHub Actions.
Body:

  The Buildbot CI infrastructure has been fully replaced by GitHub
  Actions.  Remove any lingering references from the repository.

  Reviewed-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #17794

   .github/PULL_REQUEST_TEMPLATE.md                   | 5 -----
   contrib/pyzfs/libzfs_core/test/test_libzfs_core.py | 2 +-
   2 files changed, 1 insertion(+), 6 deletions(-)

[commit 323e7ee2e4f85ab7e043fdd62b2e3b86bd41c128]
Date: 2025-09-25
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: CI: update perf and bpftools with the kernel packages
Review: The commit updates a CI script to ensure matching perf and bpftool packages are installed with an experimental kernel, but this is an internal CI workflow change with no direct user-visible impact on FreeBSD users.
Body:

  When updating a Fedora instance to an experimental kernel make sure
  to include the matching versioned perf and bpftool packages.  This
  helps ensure there are no unexpected conflicts which would prevent
  the new packages from being installed.

  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #17791

   .github/workflows/scripts/qemu-3-deps-vm.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 62e871a98bdd0bb7ce6f4ea627241768c5c90667]
Date: 2025-09-15
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: CI: Switch FreeBSD 15 to 15.0-ALPHA2
Review: The commit updates a CI script version reference from 15.0-ALPHA1 to 15.0-ALPHA2, which is an internal CI/build infrastructure change without user-visible impact.
Body:

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Signed-off-by: Alexander Motin <alexander.motin@TrueNAS.com>
  Closes #17749

   .github/workflows/scripts/qemu-2-start.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6eca9f33e9894320856b718bc2d03d40c73fd3e3]
Date: 2025-09-10
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: CI: Increase setup timeout to 20min, add timestamps
Review: Changes are internal to CI workflows and debugging tools; no user-visible impact.
Body:

  - Increase qemu-1-setup.sh timeout to 20min since it sometimes
    fails to complete after 15min.

  - Timestamp all qemu-1-setup.sh lines to look for hangs.

  - Add a 'watchdog' process to print out the top running process every
    30sec to help with debugging.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17714

   .github/workflows/scripts/qemu-1-setup.sh | 10 ++++++++++
   .github/workflows/zfs-qemu.yml            |  8 ++++++--
   2 files changed, 16 insertions(+), 2 deletions(-)

[commit 2617d6271709d7392f8836a5c742936df766c270]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ci: fix syntax issues in zfs-qemu.yml
Review: Fixes syntax issues in a GitHub Actions workflow file for ZFS QEMU testing.
Body:

  Otherwise it might become `if [ == "" ]` which is ill-formed.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Signed-off-by: Shengqi Chen <harry-chen@outlook.com>
  Closes #17695


   .github/workflows/zfs-qemu.yml | 7 +++----
   1 file changed, 3 insertions(+), 4 deletions(-)

[commit a70e507b5933707d8b48e58b64d3702bbb43af9e]
Date: 2025-09-05
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: CI: Increase 'Setup QEMU' timeout to 15 minutes
Review: The commit adjusts a CI workflow timeout and has no user-visible impact.
Body:

  We've seen Fedora 42 still setting up after 10 min.  Change the timeout
  to 15 min.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17697

   .github/workflows/zfs-qemu.yml | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 2b486e15212809be96ad72343f3312628b91ecd5]
Date: 2025-08-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: CI: Add Debian 13 to the FULL_OS runner list
Review: The commit updates CI workflows to include Debian 13 as a test environment, but this is an internal CI configuration change with no direct user-visible impact on FreeBSD functionality.
Body:

  This commit adds Debian 13 alias Trixie to the checked operating
  systems. The image needs to be run with UEFI support.

  Current Debian version overview:
  - Debian 11 (Bullseye) -> "oldoldstable"
  - Debian 12 (Bookworm) -> "oldstable"
  - Debian 13 (Trixie) -> new "stable"

  The CI will be run on Debian 12 and Debian 13 now.
  Debian 11 is kept, but won't be used automatically.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes #17648

   .github/workflows/scripts/qemu-2-start.sh   | 14 +++++++++++++-
   .github/workflows/scripts/qemu-3-deps-vm.sh |  2 +-
   .github/workflows/scripts/qemu-5-setup.sh   | 14 ++++++++++++--
   .github/workflows/zfs-qemu.yml              |  6 +++---
   4 files changed, 29 insertions(+), 7 deletions(-)

[commit 5a5bff98f73dfd8e017e8c55544b2d82f1cd98f5]
Date: 2025-08-15
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: CI: Add optional patch level, fix hostname on F42
Review: The commit modifies internal GitHub Actions scripts for building ZFS packages on QEMU VMs. These changes are specific to the development and packaging infrastructure of the ZFS project and have no direct user-visible impact on FreeBSD users, system behavior, or configuration.
Body:

  In the past there have been times when we need to generate new RPMs
  for an existing ZFS release.  Typically this happens when a new RHEL
  version comes out and the kernel symbols no longer match.  To get
  users to auto-update we just bump the patch number.  For example, we
  had to create zfs-2.1.13-1 for EL8.8 and zfs-2.1.13-2 for EL8.9.

  This commit adds an optional patch level text box to the github
  package builder runner.

  In addition, this commit also uses `hostnamectl` instead of `hostname`
  for F42+ compatibility, if available.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17638

   .github/workflows/scripts/qemu-4-build-vm.sh | 23 ++++++++++++++++++++---
   .github/workflows/zfs-qemu-packages.yml      | 13 ++++++++++++-
   2 files changed, 32 insertions(+), 4 deletions(-)

[commit 387886009163d13d735c854c64c2825db622000a]
Date: 2025-08-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: FreeBSD 15.0 is now "PRERELEASE"
Review: The commit updates a URL in a GitHub Actions script, which is an internal build tool change with no user-visible impact.
Body:

  Chase URL change from the FreeBSD project.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Colin Percival <cperciva@tarsnap.com>
  Closes #17617

   .github/workflows/scripts/qemu-2-start.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 03825197eda434f32b0574d45875437f95266a97]
Date: 2025-08-05
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: CI: match and trim out internal timestamp for test prefix
Review: The commit adjusts test script regexes to handle timestamps, which is an internal change with no user-visible impact.
Body:

  Adjust the regexes to match the test line with timestamps, then remove
  them for the summary. The internal timestamp is still in the full logs.

  Sponsored-by: Klara, Inc.
  Sponsored-by: Wasabi Technology, Inc.
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Signed-off-by: Rob Norris <rob.norris@klarasystems.com>
  Closes #17045


   .github/workflows/scripts/qemu-6-tests.sh | 6 ++++--
   1 file changed, 4 insertions(+), 2 deletions(-)

[commit 629108efc9d7b2f7ac53ba6357a3e3284bf14714]
Date: 2025-07-30
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Add CodeQL mismatched dsl_dataset_hold/_rele pairs check
Review: Adds a CodeQL static analysis check for mismatched dsl_dataset_hold/_rele pairs within the same stack frame, which may help developers identify potential resource management issues in ZFS code.
Body:

  This check is currently limited to checking mismatches that occur in the
  same stack frame. It does not detect across stack frames.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Signed-off-by: Richard Yao <richard@ryao.dev>
  Closes #17352

   .github/codeql-cpp.yml                             |  1 +
   .../cpp/dslDatasetHoldReleMismatch.ql              | 34 ++++++++++++++++++++++
   2 files changed, 35 insertions(+)

[commit 82d516c2f4f66f75c70a7a42558454edc63e6382]
Date: 2025-07-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: CI: Remove Debian backports
Review: The commit removes a broken Debian backports repository from CI scripts, which is an internal build system change with no user-visible impact.
Body:

  The latest Debian 11 image includes bullseye-backports as a default
  repository in the /etc/apt/sources.list.  However, this repository
  has gone end of life which effectively breaks the default install.

  We shouldn't need anything in backports so lets unconditionally
  remove backports on all Debian builders to resolve the issue.

  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #17569

   .github/workflows/scripts/qemu-3-deps-vm.sh | 1 +
   1 file changed, 1 insertion(+)

[commit c6a32e57caa7d0bd44c49e8a4b6ed03fa7229212]
Date: 2025-07-09
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: ZTS: Fix FreeBSD 15.0 ksh errors
Review: The commit updates a test script to replace 'ksh93' with 'ksh', reflecting the package name change in FreeBSD. This ensures compatibility with FreeBSD 15.0 and maintains functionality on versions 13 and 14.
Body:

  The package ksh93 is replaced by ksh now.
  This works for FreeBSD 13 and 14 also.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes #17523

   .github/workflows/scripts/qemu-3-deps-vm.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3c5e1bae38671dbc822ce8a0c0550507b8d582d0]
Date: 2025-07-09
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: CI: Switch from FreeBSD 13.4 to 13.5
Review: Updates CI scripts to use FreeBSD 13.5 instead of the EOL 13.4.
Body:

  FreeBSD 13.4 is EOL since June 30, 2025.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Signed-off-by:	Alexander Motin <mav@FreeBSD.org>
  Closes #17519

   .github/workflows/scripts/qemu-2-start.sh | 8 --------
   .github/workflows/zfs-qemu.yml            | 4 ++--
   2 files changed, 2 insertions(+), 10 deletions(-)

[commit 9abb79767792e6e26e4e469f0523fc0e1f31aa2f]
Date: 2025-07-03
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: CI: run ztest on compressed zpool
Review: The commit modifies CI workflow configuration to use a compressed ZFS dataset for ztest, which is an internal testing change without user-visible impact.
Body:

  When running ztest under the CI a common failure mode is for the
  underlying filesystem to run out of available free space.  Since
  the storage associated with a GitHub-hosted running is fixed, we
  instead create a pool and use a compressed ZFS dataset to store
  the ztest vdev files.  This significantly increases the available
  capacity since the data written by ztest is highly compressible.
  A compression ratio of over 40:1 is conservatively achieved using
  the default lz4 compression.  Autotrimming is enabled to ensure
  freed blocks are discarded from the backing cipool vdev file.

  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #17501

   .github/workflows/zloop.yml | 24 ++++++++++++------------
   1 file changed, 12 insertions(+), 12 deletions(-)

[commit 9dbaa04128ee24f598c69bbcbae931650b2ed7d4]
Date: 2025-06-18
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ZTS: Use FreeBSD cloudinit images
Review: The commit updates CI workflows to use FreeBSD cloudinit images for testing, which may affect automated testing environments but does not introduce user-visible changes to the FreeBSD base system.
Body:

  FreeBSD provides CI-IMAGES since some time. These images are
  based on nuageinit, which does not support fqdn and sudo for
  example. So we need currently some workarounds to get it
  working.

  The FreeBSD images will be more compatible with cloud-init in
  some near future. Then we can remove the workaround things.

  These versions are used for testing:
  - freebsd13-4r (RELEASE)
  - freebsd14-3s (STABLE)
  - freebsd15-0c (CURRENT)

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes #17462

   .github/workflows/scripts/qemu-2-start.sh | 143 ++++++++++++++++++++----------
   .github/workflows/zfs-qemu.yml            |  10 +--
   2 files changed, 99 insertions(+), 54 deletions(-)

[commit d2c80ed5c42066bd74132d9fcd390cd2c884fcb9]
Date: 2025-10-16
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: tools: Update sysctl to its new name
Review: Updates documentation and tools to reflect the renaming of kern.ipc.somaxconn to kern.ipc.soacceptqueue, which occurred in FreeBSD 10.0.
Body:

  The kern.ipc.somaxconn sysctl has been replaced with
  kern.ipc.soacceptqueue since FreeBSD 10.0.

  Reviewed by:	emaste
  MFC after:	1 hour
  Differential Revision:	https://reviews.freebsd.org/D34598

  (cherry picked from commit 84333aada464296c1e28126b5c91ae2fb3f79eef)


   tools/tools/netrate/tcpp/README  | 2 +-
   tools/tools/sysdoc/tunables.mdoc | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit 20103d288e80e299a76c5d3e5f5c8b3eee4e4b47]
Date: 2025-10-16
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: nanobsd: rescue: Update legacy sysctls
Review: Updates legacy sysctl names in the nanobsd rescue environment's ZFS creation script to reflect current sysctl naming conventions.
Body:

  Reviewed by:	emaste
  MFC after:	1 hour
  Differential Revision:	https://reviews.freebsd.org/D34598

  (cherry picked from commit 93ee9bb424619f0189b3454380588c955222b89b)


   tools/tools/nanobsd/rescue/Files/root/ZFS_Create.txt | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 258cde4b2e4832bfaa49c800754aec8800a388c7]
Date: 2025-10-09
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp lro: use the flowid only when it has hash properties
Review: The TCP LRO implementation now uses the flowid only when it has hash properties, preventing performance issues with drivers that set flowid inconsistently.
Body:

  When a packet is provided to LRO using tcp_lro_queue_mbuf(), a
  sequence number is computed based on the m_pkthdr.flowid provided
  by he driver. The implicit assumption is that the m_pkthdr.flowid
  has hash properties.
  The recent use of tcp_lro_queue_mbuf() in iflib exposed a bug in at
  least one driver (igc) , which
  * reports always that is uses M_HASHTYPE_OPAQUE.
  * sets in some cases m_pkthdr.flowid not consistently for packets
    belonging to the same TCP connection.
  This results in severe performance problems for the base TCP stack,
  since it handles the packets in the wrong sequence, although they were
  received in the correct sequence.
  To protect against such misbehaving drivers, just take the
  m_pkthdr.flowid only into account, if it has hash properties.
  The performance problems were observed by gallatin@ and analyzed
  together with rrs@.

  Reviewed by:		gallatin
  Tested by:		gallatin
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52989

  (cherry picked from commit 73f56fa542ecf6ea6819c9e17fc60962eeb726d8)


   sys/netinet/tcp_lro.c | 9 +++++----
   1 file changed, 5 insertions(+), 4 deletions(-)

[commit 9d53ea06b32097a648fedbaf4abbe8ee54951225]
Date: 2024-10-12
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: arp(8): Complete libxo transition
Review: The arp(8) utility now uses libxo for structured output, affecting scripts that parse its output.
Body:

  Reviewed by:	des
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D41408

  (cherry picked from commit 417842f908619336dd4c739a92c326ade2c35770)


   usr.sbin/arp/arp.c         | 11 ++++++-----
   usr.sbin/arp/arp_netlink.c |  5 ++---
   2 files changed, 8 insertions(+), 8 deletions(-)

[commit 057bc783c67e8196d0b8c8c60a7eee6f7dc05805]
Date: 2024-05-05
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.programs
Subject: arp(8): allow -i with -s
Review: The man:arp[8] utility now allows adding static ARP entries for IP addresses not configured on local interfaces when using the '-i' option to specify the interface. This enables static ARP entries to be configured for proxy ARP scenarios, such as for local jails using /32 routes.
Body:

  arp(8) usually disallows adding a static ARP entry for an IP address
  which is not configured on a local interface.

  Change this to allow such ARP entries to be added if '-i' is provided to
  specify the interface the ARP entry relates to.

  Due to limitations in the kernel lltable, this still requires that a
  host route exists for the target address, but allows static ARP entries
  to be configured to proxy ARP for, e.g., local jails which use an IPv4
  address with a /32 route.

  Reviewed by: imp, zlei
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1220

  (cherry picked from commit 2356b60be7024b10ddc4361fc22f96205b55fbbb)


   usr.sbin/arp/arp.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 3bcb5b7adc77085580817b2543d3e6a4cdffb94b]
Date: 2024-05-09
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: arp.8: don't document a syntax that doesn't exist
Review: The man:arp[8] manpage no longer documents the unsupported 'pub' flag for the 'arp -d' command.
Body:

  The arp.8 manpage documents 'arp -d <addr> pub', but the 'pub' flag is
  not accepted by the arp command.  Remove this incorrect documentation.

  Reviewed by: imp, gleb, mp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1215

  (cherry picked from commit cd917a17bc39991bb1ee11b90716bcabfcd42791)


   usr.sbin/arp/arp.8 | 10 +---------
   1 file changed, 1 insertion(+), 9 deletions(-)

[commit cf650aba2ddfb8bfeedae9df5e7a2083f4af6aea]
Date: 2024-05-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: arp(8): fix a typo in error message for -s/-S
Review: Fixes a typo in an error message for the arp(8) command's -s and -S options.
Body:

  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1214

  (cherry picked from commit 0ad9b235e1eaef36e07247c8c7635a8eac98f4b1)


   usr.sbin/arp/arp_netlink.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 520abb95e1168cea585aebd4af9cc78addd44c61]
Date: 2024-04-11
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: usr.sbin: Remove repeated words
Review: Removes repeated words in comments and strings across several userland utilities, improving readability but not changing functionality.
Body:

  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/887

  (cherry picked from commit ec8a394d9c676b3c4fd2cd721cf554e073736fc1)


   usr.sbin/arp/arp.c                    | 2 +-
   usr.sbin/bhyve/amd64/spinup_ap.c      | 2 +-
   usr.sbin/bhyve/pci_emul.c             | 2 +-
   usr.sbin/bhyve/virtio.h               | 2 +-
   usr.sbin/crunch/crunchgen/crunchgen.c | 2 +-
   usr.sbin/fstyp/hammer2_disk.h         | 2 +-
   usr.sbin/kldxref/kldxref.c            | 2 +-
   usr.sbin/newsyslog/newsyslog.c        | 2 +-
   usr.sbin/nscd/config.h                | 2 +-
   usr.sbin/nscd/parser.c                | 2 +-
   usr.sbin/nscd/query.c                 | 2 +-
   usr.sbin/pmcstat/pmcpl_callgraph.c    | 2 +-
   usr.sbin/ppp/arp.c                    | 2 +-
   usr.sbin/sesutil/eltsub.h             | 2 +-
   14 files changed, 14 insertions(+), 14 deletions(-)

[commit a728b96686e69cc3237f94b07f3bced44eeed8e9]
Date: 2025-08-19
Score: 5
Status: added(include=yes,score=95)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: ix/ixv: Add support for new Intel Ethernet E610 family devices
Review: The ix and ixv drivers add support for the Intel Ethernet E610 family of devices, including new PCI IDs for backplane, SFP, 10 GbE, 2.5 GbE, and SGMII variants. This enables link speeds of 2.5G, 5G, and 10G on supported hardware.
Body:

  This is part 1 of the support for the new Intel Ethernet E610 family of devices.

  Introduce new PCI device IDs:
   57AE: Intel(R) E610 (Backplane)
   57AF: Intel(R) E610 (SFP)
   57B0: Intel(R) E610 (10 GbE)
   57B1: Intel(R) E610 (2.5 GbE)
   57B2: Intel(R) E610 (SGMII)

  Key updates for E610 family:
   Firmware manages Link and PHY
   Implement new CSR-based Admin Command Interface (ACI) for SW-FW interaction
   Tested exclusively for x64 operating systems on E610-XT2/XT4 (10G) and E610-IT4 (2.5G)
   Enable link speeds above 1G: 2.5G, 5G and 10G
   NVM Recovery Mode and Rollback support

  Signed-off-by: Yogesh Bhosale yogesh.bhosale@intel.com
  Co-developed-by: Krzysztof Galazka krzysztof.galazka@intel.com

  Approved by:	kbowling (mentor), erj (mentor)
  Tested by:	gowtham.kumar.ks_intel.com
  Sponsored by:   Intel Corporation
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50067

  (cherry picked from commit dea5f973d0c8d29a79b433283d0a2de8f4615957)


   sys/conf/files                  |    2 +
   sys/dev/ixgbe/if_ix.c           |  231 +-
   sys/dev/ixgbe/if_ixv.c          |    6 +
   sys/dev/ixgbe/ixgbe.h           |   11 +
   sys/dev/ixgbe/ixgbe_api.c       |   16 +
   sys/dev/ixgbe/ixgbe_api.h       |    1 +
   sys/dev/ixgbe/ixgbe_common.c    |   25 +-
   sys/dev/ixgbe/ixgbe_e610.c      | 5567 +++++++++++++++++++++++++++++++++++++++
   sys/dev/ixgbe/ixgbe_e610.h      |  224 ++
   sys/dev/ixgbe/ixgbe_osdep.c     |   26 +
   sys/dev/ixgbe/ixgbe_osdep.h     |   31 +
   sys/dev/ixgbe/ixgbe_type.h      |   69 +-
   sys/dev/ixgbe/ixgbe_type_e610.h | 2278 ++++++++++++++++
   sys/dev/ixgbe/ixgbe_vf.c        |    3 +-
   sys/modules/ix/Makefile         |    2 +-
   sys/modules/ixv/Makefile        |    2 +-
   16 files changed, 8458 insertions(+), 36 deletions(-)

[commit d2d987b67919044955d851a5072d1b74131bf39f]
Date: 2025-10-08
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: cryptocheck: Be friendlier when testing software crypto backends
Review: The cryptocheck utility now includes more drivers in its test list and provides a clearer error message when it cannot modify the kern.crypto.allow_soft sysctl.
Body:

  - Fail loudly if we can't change the kern.crypto.allow_soft sysctl.
  - Add more drivers to the list.

  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D52490

  (cherry picked from commit e63bf6aa523eb9a865b7ce34d01e75a13818b367)


   tools/tools/crypto/cryptocheck.c | 9 +++++++--
   1 file changed, 7 insertions(+), 2 deletions(-)

[commit c3005b65b2c14ed082bf2d558990c7346bc82b5a]
Date: 2025-10-08
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: Userland.libraries
Subject: pw: pw_mkdb(3) does not set errno
Review: The man:pw_mkdb[3] function now sets errno on failure, allowing callers to distinguish error conditions.
Body:

  MFC after:	1 week
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.

  (cherry picked from commit b464c7a75e30e6149906458075b7eaf0841c7222)


   usr.sbin/pw/pwupd.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 57bf745be96462355350fa18ec1dadfa9f04a10d]
Date: 2025-10-05
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Kernel.general
Subject: vfs offset: fix assertion failure in face of racing ffofset and setfl locking
Review: Fixes a race condition between man:ffofset[2] and man:setfl[2] locking that could cause an assertion failure.
Body:

  Both use the same 16 bit var to store their locked and waiters bits,
  then this in file_v_unlock:

          state = atomic_load_16(flagsp);
          if ((state & lock_wait_bit) == 0 &&
              atomic_cmpset_rel_16(flagsp, state, state & ~lock_bit))
                  return;

  can fail if for example foffset is being unlocked while setfl is getting
  locked.

  Afterwards the code assumes there are blocked waiters on foffset.

  Reviewed by: kib, markj
  Sponsored by:	Rubicon Communications, LLC ("Netgate")
  Differential Revision: https://reviews.freebsd.org/D52915


   sys/kern/vfs_vnops.c | 18 ++++++++++++------
   1 file changed, 12 insertions(+), 6 deletions(-)

[commit ac19e85c60accb4673b5bae93840346c08a2b635]
Date: 2025-10-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: Cirrus-CI: Use nproc instead of sysctl -n hw.ncpu
Review: The commit changes a Cirrus-CI configuration file to use nproc instead of sysctl -n hw.ncpu for determining CPU count, which may affect CI build parallelism but is an internal CI infrastructure change without direct user impact.
Body:

  It is available on all supproted FreeBSD versions.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 5bba547a678beb280bf4080375f45b04ceb44fc5)
  (cherry picked from commit f283515a1015b5e02dee2b3f4504e7a5ca1a5cfe)


   .cirrus.yml | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 439909c48b0e8b0e8dda03b9a359b73dcabb546e]
Date: 2025-10-10
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.libraries
Subject: libm: remainder: make sure x is zero
Review: The libm remainder function now correctly handles sign for small negative x when |n*y| > |x|, ensuring mathematical correctness.
Body:

  Make sure the entirety of x is zero before flipping the sign bit.
  Otherwise the sign would be wrong for small values of x when x is
  negative and |n*y| > |x|

  Reported by:	alfredo
  PR:		251091
  Reviewed by:	kargl
  MFC after:	3 days
  Differential Revision: https://reviews.freebsd.org/D53023

  (cherry picked from commit 25cca51ed294890d20a3c0290814cd26875db686)


   lib/msun/src/e_remainder.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 83a1049fcfb6cb5a1fd6cbeb4a193c41cd59ae54]
Date: 2025-10-13
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: UPDATING: Fix typo objump should be objdump
Review: Fixes a typo in the UPDATING file where 'objump' is corrected to 'objdump'.
Body:

  Approved by:	emaste (mentor)
  Fixes:		86edb11e7491 ("Always install llvm-objdump as objdump")
  MFC after:	1 day

  (cherry picked from commit 376508ef2f794a57606a791166f1ce7f20d3ccaf)


   UPDATING | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e1ea6b7b70cf5204979f6c6112ad54c0036a9f7e]
Date: 2025-10-09
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.libraries
Subject: MFC: libbz2: add pkg-config file (bzip2.pc)
Review: libbz2 now provides a pkg-config file (bzip2.pc) for easier detection and linking by third-party software.
Body:

  Add generation of a bzip2.pc file for use with pkg-config and create
  a basic template as bzip2.pc.in.

  This allows other software to easily locate and link against libbz2
  using standard pkg-config mechanisms instead of manual compiler and
  linker flags.

  The version number is extracted automatically from bzlib.h to keep
  it consistent with the library sources.

  Tested:	pkg-config --exists --print-errors "bzip2 >= 1.0.9" (fail, expected)
  	pkg-config --exists --print-errors "bzip2 >= 1.0" (succeeded)
  	pkg-config --libs bzip2 (-lbz2)
  	pkg-config --cflags bzip2 ()

  (cherry picked from commit 586319793368cbc664b48187bda60d27e171753a)


   lib/libbz2/Makefile    | 13 +++++++++++++
   lib/libbz2/bzip2.pc.in | 11 +++++++++++
   2 files changed, 24 insertions(+)

[commit 0c7c1c27ea9eed8aefa236daa13eabb5bd050cfc]
Date: 2025-09-15
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: vm_fault_busy_sleep(): update comment after addition of allocflags arg
Review: The commit only updates a comment in the kernel's virtual memory fault handling code, with no user-visible changes.
Body:

  (cherry picked from commit f1b656f14464c2e3ec4ab2eeade3b00dce4bd459)


   sys/vm/vm_fault.c | 9 ++++-----
   1 file changed, 4 insertions(+), 5 deletions(-)

[commit d1cdb4a087e69e1515a855a928ced8a18f9b75f9]
Date: 2025-08-05
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: vm_fault: assert that first_m is xbusy
Review: The commit adds an assertion in the VM fault handling code, which is an internal debugging aid and does not produce any user-visible change in behavior, performance, or configuration.
Body:

  (cherry picked from commit a38483fa2b3a26414d3409b12dd35ac406c44cea)


   sys/vm/vm_fault.c | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit 94ea60483bcc0681e351901d1e466547a275a6da]
Date: 2025-07-23
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: vm_fault: try to only share-busy page for soft faults
Review: The vm_fault() function now attempts to share-busy pages only for soft faults, which may improve performance by reducing unnecessary page locks during page faults.
Body:

  (cherry picked from commit 149674bbac5842ac883414a6c1e75d829c70d42b)


   sys/vm/vm_fault.c | 108 ++++++++++++++++++++++++++++++++++++++++++++++--------
   1 file changed, 93 insertions(+), 15 deletions(-)

[commit f4d5c6d65168d3d9b99a2332d854c14b231188e6]
Date: 2025-07-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vm_fault: add helper vm_fault_can_cow_rename()
Review: The commit adds an internal helper function for copy-on-write rename operations, which is an implementation detail with no direct user-visible impact.
Body:

  (cherry picked from commit 3f05bbdbd80f2eefb647e595dc73e80d6186d6a5)


   sys/vm/vm_fault.c | 20 +++++++++++---------
   1 file changed, 11 insertions(+), 9 deletions(-)

[commit e7422f7dfd0e4c1f0db5560f171260d78bad9383]
Date: 2025-08-14
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: vm_fault: add vm_fault_might_be_cow() helper
Review: The commit adds a helper function for copy-on-write fault handling, which is an internal kernel refactoring with no direct user-visible impact.
Body:

  (cherry picked from commit 5bd4c04a4e7f7bda657e6027e64675d0caf50715)


   sys/vm/vm_fault.c | 16 +++++++++++-----
   1 file changed, 11 insertions(+), 5 deletions(-)

[commit 4b938ed09069e24e6c2714b62b4b5559081da67b]
Date: 2025-08-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vm_fault_busy_sleep(): pass explicit allocflags for vm_page_busy_sleep()
Review: The commit changes internal VM fault handling to pass explicit allocation flags, which is an implementation detail with no direct user-visible impact.
Body:

  (cherry picked from commit c6b79f587f27649f90e00bc131d37bafa50ffc62)


   sys/vm/vm_fault.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 3126c57163fbbeb0d013d9c04d87a44a458b3f07]
Date: 2025-07-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vm_fault: drop never-true busy_sleep test
Review: The commit removes an internal condition check in the VM fault handling code, which has no user-visible impact.
Body:

  (cherry picked from commit 2d6185cf87e815d4951a9ddcf5c535ebd07a8815)


   sys/vm/vm_fault.c | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit 5f4168fa9f29a2985a16c34a5571c20c6775f622]
Date: 2025-08-07
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: vm/vm_fault.c: cleanup includes
Review: Internal cleanup with no user-visible impact.
Body:

  (cherry picked from commit 0854b4f569e1e68032e431b1efb45b9fd9849194)


   sys/vm/vm_fault.c | 2 --
   1 file changed, 2 deletions(-)

[commit 84b51272045564ef63787423105334176aa6014e]
Date: 2025-09-13
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: pdgetpid(2): switch back returning EBADF for non-procdesc fd
Review: The man:pdgetpid[2] system call now returns EBADF when passed a file descriptor that is not a process descriptor, restoring documented behavior.
Body:

  (cherry picked from commit a85525a5c8b28f1516d49e5d6ae5842873c24643)


   sys/kern/sys_procdesc.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3bd1780213bf53f6229ea2f00b1b975b18652836]
Date: 2025-09-07
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Kernel.general
Subject: kern: replace several EBADF with EINVAL
Review: The commit changes error codes from EBADF to EINVAL in kernel event and process descriptor syscalls, which may affect error handling in user programs using these interfaces.
Body:

  (cherry picked from commit fd9e09cb2ab07993e8dc783c802f273329e70bb8)


   sys/kern/kern_event.c   | 2 +-
   sys/kern/sys_procdesc.c | 4 ++--
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit f0f57fde342d79aec17ef56406aa08bb1eaa1f79]
Date: 2025-10-01
Score: 5
Status: proposed(include=no,score=35)
Sponsor: 
Section: undecided
Subject: kern_exit.c: do not leak reaper bitmap busy bits
Review: The commit fixes a kernel resource leak in the process exit path, preventing potential exhaustion of busy bits in the reaper bitmap.
Body:

  PR:	289917

  (cherry picked from commit f19ef352ec63f9fcc10076a263b8ce402ba31379)


   sys/kern/kern_exit.c | 46 +++++++++++++++++++++++-----------------------
   1 file changed, 23 insertions(+), 23 deletions(-)

[commit 051c12a5d90ab84ac92abca929ccbb6ad363d266]
Date: 2025-09-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Defenso
Section: undecided
Subject: libcasper: explicit cast in cap_fileargs header
Review: An explicit cast is added to the cap_fileargs header to resolve C++ compatibility issues when using standard compiler options.
Body:

  The implicit cast is incompatible with standard compiler options in a
  C++ project, making the library difficult to use.

  Signed-off-by: Quentin Thbault <quentin.thebault@defenso.fr>
  Sponsored by: Defenso
  MFC after: 3 days
  Discussed with: kevans
  Reviewed by: emaste, vexeduxr
  Pull request: https://github.com/freebsd/freebsd-src/pull/1857

  (cherry picked from commit 349da4dbff722a58affd13d84729b1d399b41fb3)
  (cherry picked from commit 998dd4a11a2b4857a55af8e656feaebc4fc78fe8)


   lib/libcasper/services/cap_fileargs/cap_fileargs.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 54a72bbaee2eeed26f8a06bb28a1fc52f24789f7]
Date: 2025-09-12
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Userland.programs
Subject: netstat: Fix -ia missing multicast addresses on some interfaces
Review: The man:netstat[1] utility now correctly displays multicast addresses for all interfaces when using the -ia option.
Body:

  sdl_data isn't always NULL terminated

  Signed-off-by: nreilly@qnx.com

  PR:		288958
  Reviewed by:	markj
  MFC after:	1 week

  (cherry picked from commit 0952943a680dca12fe8f65f8813a9dca0783ce88)


   usr.bin/netstat/if.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 07f4fa7a0db931c47cc78c711e05d5d51a4e2448]
Date: 2025-10-06
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: ahci: Don't fail attach if the MSI-X BARs cannot be allocated
Review: The ahci driver now falls back to MSI or INTx interrupts if MSI-X BAR allocation fails, preventing attach failures on some hardware.
Body:

  If the MSI-X table and/or PBA live in separate BAR(s) and those BAR(s)
  cannot be allocated, fall back to using MSI or INTx instead of failing
  attach.

  PR:		289748
  Reported by:	Vitalij Satanivskij <satan@Ukr.net>
  Reviewed by:	avg, imp
  Differential Revision:	https://reviews.freebsd.org/D52889

  (cherry picked from commit b658158e9396848d3963e9555d356d0f4ca6900a)


   sys/dev/ahci/ahci_pci.c | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 5672349164252f091d174a5f10bd48385240ddb8]
Date: 2025-10-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ahci: Use pci_msix_*_bar instead of reading config registers directly
Review: The commit refactors internal AHCI PCI interrupt handling to use helper functions, which does not introduce any user-visible changes in behavior, features, or configuration.
Body:

  Reported by:	avg
  Reviewed by:	avg, imp
  Differential Revision:	https://reviews.freebsd.org/D52888

  (cherry picked from commit 762f1c7c6cded9242956c2c35c772dff9b5d155b)


   sys/dev/ahci/ahci_pci.c | 38 +++-----------------------------------
   1 file changed, 3 insertions(+), 35 deletions(-)

[commit 4b7c2a0193dd92b72628bc1c614d779cf77eef5d]
Date: 2025-10-09
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: nfsuserd: Fix OOB access on membership of too many groups, take 2
Review: The nfsuserd daemon now correctly resets the group count after getgrouplist() calls, preventing an out-of-bounds access that could occur when a user belongs to many groups.
Body:

  Forgot to reset 'ngroup' after one of the calls to getgrouplist() in the
  previous commit with same title (referenced also below).

  MFC after:      1 hour
  Fixes:          e6c623c86ab4 ("Add support for the "-manage-gids" option to the nfsuserd daemon.")
  Fixes:          bb339adfb2a2 ("nfsuserd: Fix OOB access on membership of too many groups")
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 75eb6846269bb9bec1eaf4f0ad93d7525715b550)


   usr.sbin/nfsuserd/nfsuserd.c | 1 +
   1 file changed, 1 insertion(+)

[commit 5fe22e3d09bd9e1f00913445bcf48a49ae0a1c6b]
Date: 2025-10-09
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: nfsuserd: Fix OOB access on membership of too many groups
Review: nfsuserd now correctly handles users with many groups and provides a clearer error message when the group list exceeds the internal limit.
Body:

  getgrouplist() sets the variable containing the allocated length in
  input to the full effective group list length, not the number of slots
  that were actually filled in case the passed array is too small to
  contain it.

  While here, on this condition, improve the error message by outputting
  the corresponding user name.

  MFC after:      1 hour
  Fixes:          e6c623c86ab4 ("Add support for the "-manage-gids" option to the nfsuserd daemon.")
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit bb339adfb2a26c5bb71cd4275dff80f615534ab6)


   usr.sbin/nfsuserd/nfsuserd.c | 15 +++++++++++----
   1 file changed, 11 insertions(+), 4 deletions(-)

[commit 25624850a77babddc9e288639a3ced0f032a6ff2]
Date: 2025-10-09
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: initgroups.3: Clarify that ENOMEM is a possible value for 'errno'
Review: The man:initgroups[3] man page clarifies that ENOMEM is a possible errno value and mentions setgroups(2) as a system call.
Body:

  The current phrasing could be interpreted as meaning that initgroups(3)
  could return ENOMEM instead of -1, which it actually did until I fixed
  it in commit 0b018cfd81d8 ("initgroups(3): Fix return value on
  allocation failure").

  While here, mention setgroups(2) as a system call rather than a library
  function.

  MFC with:       0b018cfd81d8 ("initgroups(3): Fix return value on allocation failure")
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit c36a44e1cdab1c67a98132676818f473cc4e5c03)


   lib/libc/gen/initgroups.3 | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit dbfdd93a188b089b35bee251ad3b60b50fc00117]
Date: 2025-10-08
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: getgrouplist.3: Insist on the value returned in 'ngroups'; Minor changes
Review: The commit updates the man:getgrouplist[3] man page to clarify the behavior of the 'ngroups' parameter and improve terminology, but it does not introduce any user-visible functional changes.
Body:

  Emphasize the peculiar treatment of 'ngroups', through which the
  effective group list's size is returned, even if the passed allocated
  size is not big enough, in which case the output 'groups' array is
  completely filled with the effective group list's first elements.

  Use the precise POSIX term for the group associated to the user in the
  password database ("initial numerical group ID"), consistently with what
  was done in initgroups.3.

  Use "length" instead of "size" to refer to the number of elements of an
  array (in contrast with its actual size in bytes).

  Perform some minor simplifications on top of the last rework.

  MFC after:      1 hour
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit f5544556754ec6b33c1d13c7648a354fef645b2f)


   lib/libc/gen/getgrouplist.3 | 33 ++++++++++++++++++++-------------
   1 file changed, 20 insertions(+), 13 deletions(-)

[commit 5fa6b203e186ae5d77fea778916bea59a3599066]
Date: 2025-09-29
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: share/man/man9: Fix compilation
Review: Fixes a compilation error in the man:vn_fullpath[9] man page build, ensuring the manual page can be generated correctly.
Body:

  I goofed in the previous commit.

  Fixes:          05e5de00b9ea ("vn_fullpath.9: Add missing links for described functions")
  MFC after:      3 days
  Event:          EuroBSDCon 2025
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit c87a9f51a0debf707cb4fc9a5e3b4425b08d154d)


   share/man/man9/Makefile | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b0f448f3e3215a37498164a59a3e40dde81a8cf1]
Date: 2025-09-29
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: vn_fullpath.9: Add missing links for described functions
Review: The commit adds missing cross-references in the man:vn_fullpath[9] manual page, improving documentation navigation.
Body:

  To reflect all the functions that are now described in the manual page.

  Fixes:          9f269a0a771a ("MAC/do: Check executable path ...")
  MFC after:      3 days
  Event:          EuroBSDCon 2025
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 05e5de00b9ea048f868522ff0bdae4e388685ddf)


   share/man/man9/Makefile | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit b025aa9f5abc44a19a6437bea17fcc80a7747200]
Date: 2025-09-27
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: MAC/do: Check executable path from the current jail's root
Review: The MAC/do module now checks the executable path from the current jail's root instead of the global root, preventing a potential security issue where chroot(2) could affect authorization decisions.
Body:

  Contrary to my initial belief, vn_fullpath() does return a vnode's path
  from the current chroot, and not from the global root (which would have
  been a bug also, but without security consequences).  This enables
  a "confused deputy"-like scenario where a chroot(2) can change which
  executable can be authorized by MAC/do, which is even more problematic
  for unprivileged chroot(2).

  This was found by re-examining the code following two close events:
  1. Shawn Webb sent a mail to freebsd-hackers@ on 08/05 saying that in
     HardenedBSD they had added a check on P2_NO_NEW_PRIVS (in
     mac_do_priv_grant()), which I responded to on 08/20 saying that
     P2_NO_NEW_PRIVS was not necessary for mac_do(4), with a correct
     reasoning but based on the wrong above-mentioned assumption about
     vn_fullpath().
  2. I reviewed some code by Kushagra Srivastava (GSoC 2025 student
     working on mac_do(4)/mdo(1)) adding the ability to specify which
     executables can spawn processes that mac_do(4) may decide to
     authorize (others are simply ignored), which currently is hardcoded
     to '/usr/bin/mdo'.

  MFC after:      3 days
  Event:          EuroBSDCon 2025
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52758

  (cherry picked from commit 9f269a0a771aff4f0a735211907a52c52fc0661b)


   sys/security/mac_do/mac_do.c | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit 2b5cc1e0e09592f36302d2cb5c6de1e159ea61ac]
Date: 2025-09-26
Score: 5
Status: proposed(include=no,score=15)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: vfs cache: Add vn_fullpath_jail(), factor out common code
Review: Adds vn_fullpath_jail() function to return a path relative to the current jail's root, documented in man:vn_fullpath[9]. This is a low-level kernel API addition primarily for use by other subsystems like mac_do(4).
Body:

  Introduce vn_fullpath_jail(), which returns a path to the passed vnode
  relative to the current jail's root.  It will be used by mac_do(4) in
  a subsequent commit.

  Factor out common code between the new variant and vn_fullpath().  While
  here, rework the comments a bit.

  Add vn_fullpath_jail() to the vn_fullpath.9 manual page.  While here,
  document all the existing public vn_fullpath*() functions.

  Reviewed by:    kib (except latest manual page changes)
  MFC after:      3 days
  Event:          EuroBSDCon 2025
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52757

  (cherry picked from commit c5a813c9f486da49551c3be2e7700ca0cb0a489a)


   share/man/man9/Makefile      |   1 +
   share/man/man9/vn_fullpath.9 | 120 +++++++++++++++++++++++++++++++++++--------
   sys/kern/vfs_cache.c         |  52 ++++++++++++++++---
   sys/sys/vnode.h              |   1 +
   4 files changed, 144 insertions(+), 30 deletions(-)

[commit 995d37ecd3b64f3d5c0689540357617e93b8566c]
Date: 2025-09-28
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: mac_do.4: Mention "from" part's GID can also match supplementary groups
Review: The man:mac_do[4] manual page now clarifies that the 'from' part's GID can also match supplementary groups, providing more accurate documentation for users configuring MAC policies.
Body:

  MFC after:      3 days
  Event:          EuroBSDCon 2025
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit c1d5fc4e0cfc63d23379457ac0b51c59c60b27c7)


   share/man/man4/mac_do.4 | 10 ++++++----
   1 file changed, 6 insertions(+), 4 deletions(-)

[commit 92155298945f260fa41645ed19047d35e488cabd]
Date: 2025-08-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: stress2: Fix removal of supplementary groups
Review: The commit fixes a bug in the stress2 test suite by correcting the removal of supplementary groups, which ensures test compatibility with older FreeBSD versions. This change is internal to the test infrastructure and does not affect users or system behavior.
Body:

  To this end, call setgroups(0, NULL) instead of passing the effective
  GID.  This stance is fully compatible with older versions of FreeBSD.

  Fixes:          9da2fe96ff2e ("kern: fix setgroups(2) and getgroups(2) to match other platforms")
  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52290

  (cherry picked from commit de4832289625f3c1cea4200d8eb7b4c753b90648)


   tools/test/stress2/misc/fdatasync.sh  | 2 +-
   tools/test/stress2/misc/fdatasync2.sh | 2 +-
   tools/test/stress2/misc/fifo2.sh      | 2 +-
   tools/test/stress2/misc/ftruncate.sh  | 2 +-
   tools/test/stress2/misc/ftruncate2.sh | 2 +-
   tools/test/stress2/misc/kevent7.sh    | 2 +-
   tools/test/stress2/misc/killpg.sh     | 2 +-
   tools/test/stress2/misc/killpg2.sh    | 2 +-
   tools/test/stress2/misc/killpg3.sh    | 2 +-
   tools/test/stress2/misc/maxproc.sh    | 2 +-
   tools/test/stress2/misc/mlockall3.sh  | 2 +-
   tools/test/stress2/misc/mlockall7.sh  | 2 +-
   tools/test/stress2/misc/mountu.sh     | 2 +-
   tools/test/stress2/misc/msync.sh      | 2 +-
   tools/test/stress2/misc/pread.sh      | 2 +-
   tools/test/stress2/misc/sched.sh      | 2 +-
   tools/test/stress2/misc/sigreturn3.sh | 2 +-
   tools/test/stress2/misc/sigreturn4.sh | 2 +-
   tools/test/stress2/misc/syscall4.sh   | 2 +-
   tools/test/stress2/misc/tmpfs16.sh    | 2 +-
   20 files changed, 20 insertions(+), 20 deletions(-)

[commit 3638aba1ceb99b8d687834af349fb73e33b1b0b3]
Date: 2025-08-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: tools/regression/priv: Don't call setgroups() with the effective GID
Review: The commit fixes a regression test for setgroups(2) to ensure it works consistently across FreeBSD versions, but it does not affect user-visible behavior or functionality.
Body:

  The 'setgroups(0, NULL);' stance works the same on all versions of
  FreeBSD, getting rid of all supplementary groups.  The replaced code
  would force the effective GID to also be a supplementary group.

  Fixes:          9da2fe96ff2e ("kern: fix setgroups(2) and getgroups(2) to match other platforms")
  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52289

  (cherry picked from commit ff7252cdafbd9dab104a5e7b33b8bb84117a8789)


   tools/regression/priv/main.c | 6 ++----
   1 file changed, 2 insertions(+), 4 deletions(-)

[commit ac18468f3c4a5da4a7c8224151656d2391a5b262]
Date: 2025-08-29
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: group.5: Add a reference to setcred(2)
Review: The man:group[5] manual page now includes a reference to man:setcred[2] for modifying group membership.
Body:

  Reviewed by:    gbe
  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52287

  (cherry picked from commit 313d769e995c4fa4c5e3ae2470af16a8fbeaa3c1)


   share/man/man5/group.5 | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 67cf21e16faf17caa51a53efd4b2fd004dae6821]
Date: 2025-08-30
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: getgroups.2: Clarify, mention ascending order, add SECURITY CONSIDERATIONS
Review: The man:getgroups[2] manual page is updated to clarify the behavior of getgroups(2), including that it reports supplementary groups in strictly ascending order (since FreeBSD 14.3) and adds a SECURITY CONSIDERATIONS section contrasting FreeBSD 15's behavior with the current one.
Body:

  Clarify and be more precise about the behavior of getgroups(2), in
  particular with respect to 'gidsetlen'.

  Prefer a terminology close to POSIX terms, i.e., use "effective groups"
  instead of "group access list".

  Say that getgroups(2) reports the supplementary groups in strictly
  ascending order (and mention this has been the case since FreeBSD 14.3).

  Add a new SECURITY CONSIDERATIONS section, in particular contrasting
  FreeBSD 15's behavior with the current one.

  While here, fix some style.

  Reviewed by:    gbe (older version)
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52286

  (cherry picked from commit 4be38acc826f260e4c7d3ebbb9de534db449782e)

  As indicated in the original commit message, the manual page was
  specifically modified as stable/14's getgroups(2) still has the old
  behavior.

  The original commit message above was reworked to reflect the actual
  commit content.


   lib/libc/sys/getgroups.2 | 94 ++++++++++++++++++++++++++++++++++++------------
   1 file changed, 71 insertions(+), 23 deletions(-)

[commit 7d5b7157e91970c11315d753c48aa6bdcd3aa9a2]
Date: 2025-08-29
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: setgroups.2: Add SECURITY CONSIDERATIONS, rework
Review: The setgroups(2) manual page now includes a SECURITY CONSIDERATIONS section explaining the behavior difference between FreeBSD 14 and 15, and updates terminology to use POSIX terms like 'effective group list'.
Body:

  Add a new SECURITY CONSIDERATIONS section contrasting the current
  behavior with the new one in force starting from FreeBSD 15.

  Prefer a terminology referring to POSIX terms, i.e., use "effective
  group list" instead of "group access list".

  While here, fix some style.

  Fixes:          9da2fe96ff2e ("kern: fix setgroups(2) and getgroups(2) to match other platforms")
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52284

  (cherry picked from commit 6d22cd6b5f8b5604f1fe9e70930b1506f990e31e)

  As indicated in the original commit message, the manual page was
  specifically modified as stable/14's setgroups(2) still
  has the old behavior.

  The original commit message above was reworked to reflect the actual
  commit content.


   lib/libc/sys/setgroups.2 | 110 ++++++++++++++++++++++++++++++++++-------------
   1 file changed, 81 insertions(+), 29 deletions(-)

[commit 587263cb1ddb4c5a506852d675c2d873586155e2]
Date: 2025-08-29
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: getgrouplist.3: Rework, use more appropriate terminology
Review: The commit updates the man:getgrouplist[3] man page to use more precise terminology, aligning with NSS conventions and POSIX terms, which clarifies documentation for users and developers.
Body:

  Bring up to date with NSS by substituting "file" with "database".

  Describe more precisely which database is accessed, i.e., only the group
  database, which value should be used and where it lands in the result.

  Prefer a terminology referring to POSIX terms, i.e., use "effective
  group list" instead of "group access list".

  Reviewed by:    gbe
  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52283

  (cherry picked from commit 9294eb44eecb71f573f29ff84ce1bd3aa93c077c)


   lib/libc/gen/getgrouplist.3 | 29 +++++++++++++++++++----------
   1 file changed, 19 insertions(+), 10 deletions(-)

[commit 06e0e31f8698d49b692bbd56d7ac355b677b4b5d]
Date: 2025-08-29
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: initgroups.3: Revamp, mention FreeBSD 15's change in behavior
Review: The man:initgroups[3] manual page is updated to document a behavior change in FreeBSD 15 and includes a new SECURITY CONSIDERATIONS section.
Body:

  Update the manual page with the upcoming change in behavior in FreeBSD
  15.  Add a "SECURITY CONSIDERATIONS" section that mentions some property
  of the current behavior, and refer to the same manual page in 15 for
  more details.

  While here, revamp the manual page, in particular to use the exact POSIX
  terminology where possible.

  Reviewed by:    kib
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52282

  (cherry picked from commit 9dc1ac8691966480ff8bd9c37dd405b981b41dd5)

  As indicated in the original commit message, only the manual page was
  MFCed and then specifically modified as stable/14's setgroups(2) still
  has the old behavior.

  The original commit message above was reworked to reflect the actual
  commit content.


   lib/libc/gen/initgroups.3 | 90 +++++++++++++++++++++++++++++++++++++++--------
   1 file changed, 75 insertions(+), 15 deletions(-)

[commit faa9bcee15407bf8fc0985fbc759897290d79ca5]
Date: 2025-09-16
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Userland.libraries
Subject: initgroups(3): Fix return value on allocation failure
Review: The man:initgroups(3) function now returns -1 with errno set to ENOMEM on allocation failure, aligning with the manual page and other implementations.
Body:

  We must not return ENOMEM, but rather -1 with 'errno' set to ENOMEM, as
  described in the manual page and as other implementations are doing.
  A malloc() failure actually already sets ENOMEM for us.  Add comments
  indicating which function set 'errno' each time we return.

  While here, improve style and remove useless headers.

  Reviewed by:    kib, emaste
  Fixes:          54404cfb13d4 ("In preparation for raising NGROUPS and NGROUPS_MAX, ...")
  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52580

  (cherry picked from commit 0b018cfd81d8fdd64af3fe94c6989a82c0d3afa9)


   lib/libc/gen/initgroups.c | 11 ++++-------
   1 file changed, 4 insertions(+), 7 deletions(-)

[commit 1086299d7abf67440668513bf387f03a8c667c21]
Date: 2025-08-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: linux: getsockopt(): Simplify exporting groups a bit
Review: No functional change intended; commit is internal refactoring with no user-visible impact.
Body:

  No functional change (intended).

  Go through conversion to a 'l_gid_t' before copying out in order to cope
  with differing group types (except for not representable values, of
  course).  This is what is done, e.g., for getgroups() in 'linux_misc.c'.
  As Linux's group type is the same as ours on all architectures, we could
  as well just stop bothering and copy out our memory representation,
  eliminating the loop here.  Whatever the choice, though, it has to be
  consistent here and there.

  Introduce 'out' of type 'l_gid_t' to avoid performing "by hand" array
  arithmetics when copying out.

  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52280

  (cherry picked from commit 10b789d7e14862c77f77f07e8af84d73d73012c6)


   sys/compat/linux/linux_socket.c | 12 ++++++------
   1 file changed, 6 insertions(+), 6 deletions(-)

[commit 22006b4525224f17908634488d39938790061df5]
Date: 2025-08-28
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: linux: setgroups16(): Pre-extend the groups array
Review: No functional change intended; only internal optimization.
Body:

  For the size we know we will need in the end.

  No functional change (intended).

  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52279

  (cherry picked from commit b1326edddb302a28fc9418ab60df6210513cc07c)


   sys/compat/linux/linux_uid16.c | 1 +
   1 file changed, 1 insertion(+)

[commit 216460b806742c8c0a97aec2c9a689a17c564beb]
Date: 2025-08-28
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: linux: setgroups(): Avoid allocation under the process lock
Review: The commit is a minor internal fix with no user-visible functional change, as explicitly stated in the commit message.
Body:

  This was missed in commit 838d9858251e ("Rework the credential code to
  support larger values of NGROUPS (...)").

  No functional change (intended).

  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52278

  (cherry picked from commit b7a87d7c0dd19016e82f5d33f2c5ec90479c31fe)


   sys/compat/linux/linux_misc.c | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit 560c1bb21fe2da4fe5c9a1186262c035b2ece9c5]
Date: 2025-08-27
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: cr_canseeothergids(): Make the logic easier to grasp
Review: The commit is a code refactoring with no functional change, intended only to improve readability. There is no user-visible impact.
Body:

  Invert the initial test on whether the policy is in force so that, if
  there are no restrictions, the function bails out early, allowing to
  de-indent the rest of the code and have it finish with a non-zero (deny)
  'return'.

  No functional change (intended).

  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52272

  (cherry picked from commit f75d0dc533923345c653dcdcd5ebd1e53377a7c5)


   sys/kern/kern_prot.c | 23 +++++++++++++----------
   1 file changed, 13 insertions(+), 10 deletions(-)

[commit 563771ecdd0c6608d82a268b5624eb77520af012]
Date: 2025-09-15
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: libc: compat.h: Remove a superfluous blank line at end
Review: No user-visible change; commit removes only a blank line with no functional impact.
Body:

  No functional change (intended).

  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 580d2d429598e6eb3549f9ea7490d10e19904f7c)


   lib/libc/include/compat.h | 1 -
   1 file changed, 1 deletion(-)

[commit 6e888a22743f67d3b130dd0a9b9849bcee160d2f]
Date: 2025-09-01
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: jail.2: Mention EPERM is returned on open directories
Review: The jail(2) manual page now explicitly documents that EPERM can be returned when attempting to open directories, clarifying behavior that previously required consulting chroot(2) documentation.
Body:

  The manual page does not directly mention this reason for getting EPERM,
  instead referring the reader to chroot(2).  We have had some questions
  about it recently, in part due to a bug (fixed), and this case is not an
  obvious permission/problem, so let's be more explicit.

  PR:             280809
  Reviewed by:    jamie
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52319

  (cherry picked from commit ef2f36be8fce8cf7a62ce7d33ab1c4a181fac3e2)


   lib/libc/sys/jail.2 | 5 ++++-
   1 file changed, 4 insertions(+), 1 deletion(-)

[commit 47acc6846564609d4fe01a94357e81044e055842]
Date: 2025-09-09
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sys: NOTES, GENERIC*: Re-order 'wlan_tkip'
Review: The commit reorders kernel configuration entries for wlan_tkip and wlan_ccmp in NOTES and GENERIC* files, but explicitly states no functional change. This is a cosmetic or organizational change with no user-visible impact.
Body:

  Re-order the devices in order of appearance of the related technologies,
  so 'wlan_tkip' before 'wlan_ccmp'.

  No functional change (intended).

  Reviewed by:    adrian, emaste
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52444

  (cherry picked from commit c1eff1d745a1193c199f735733e376161c69b12c)

  The original commit has been modified not to include the changes related
  to 'wlan_gcmp', which are not in stable/14.

  The original commit message above was reworked to reflect the actual
  commit content.


   sys/amd64/conf/GENERIC       | 2 +-
   sys/arm/conf/TEGRA124        | 2 +-
   sys/conf/NOTES               | 4 ++--
   sys/i386/conf/GENERIC        | 2 +-
   sys/powerpc/conf/GENERIC64   | 2 +-
   sys/powerpc/conf/GENERIC64LE | 2 +-
   6 files changed, 7 insertions(+), 7 deletions(-)

[commit fce5d401a80377b8f2195280051348958d81698c]
Date: 2025-10-06
Score: 5
Status: added(include=yes,score=85)
Sponsor: 
Section: Bootloader.general
Subject: release/RPI: Add RPI Zero 2W device tree blob dtb
Review: The Raspberry Pi Zero 2W device tree blob is now included on the release SD card images, enabling support for this hardware model.
Body:

  Enable Pi 02W support on the release SD card images by including the
  device tree.

  PR:		278816
  MFC after:	3 days
  Approved by:	cperciva (re)

  (cherry picked from commit e41e099ef199de096abd9a93289bdacfd83a5f48)


   release/arm64/RPI.conf | 5 +++--
   1 file changed, 3 insertions(+), 2 deletions(-)

[commit 8f38f734c8d0bfb836463342a48430221d1dba74]
Date: 2024-04-25
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Bootloader.general
Subject: release: remove the RPI CM4s .dtb
Review: The commit removes the RPI CM4s .dtb from the release image because it is not packaged by the sysutils/rpi-firmware port, affecting users building or using RPI release images for the CM4s.
Body:

  This isn't actually packaged by the sysutils/rpi-firmware port, so we
  cannot include it in the image.  Fix the RPI release build until an
  interested party adds it to the port and packages are available.

  Reported by:	cperciva

  (cherry picked from commit 9245ced9c8357d876141975a6431ce34143d2753)


   release/arm64/RPI.conf | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a3721403a384b6e44205b926b6eb620b18001b3d]
Date: 2024-04-19
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Hardware.virtualization
Subject: add dtb support for RPI CM4, CM4s, CM4_ioBoard
Review: Adds Device Tree Blob (DTB) support for Raspberry Pi Compute Module 4, Compute Module 4S, and Compute Module 4 IO Board variants. This enables proper hardware detection and configuration for these systems.
Body:

  Signed-off-by: Klaus Kchemann <maciphone2@googlemail.com>
  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1182
  (cherry picked from commit 1bd4f769caf8ffda35477e3c0b2c92348cf2fd5d)


   release/arm64/RPI.conf | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit b339da5b23e8871dd2b56f510ba3db1e09223be3]
Date: 2025-10-07
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: Netflix, Inc.
Section: Userland.programs
Subject: sockstat: support reporting of BBLog state
Review: The sockstat utility now includes a -b option to report BBLog state for TCP sockets.
Body:

  Add a -b option to print the BBLog state for TCP sockets.
  Manually tweaked for stable/14.

  Reviewed by:		jtl, rrs
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52944

  (cherry picked from commit d801cc2d8542854a5dee9bfb25a15af6fa1dafad)


   usr.bin/sockstat/sockstat.1 | 11 +++++++--
   usr.bin/sockstat/sockstat.c | 54 +++++++++++++++++++++++++++++++++++++++++++--
   2 files changed, 61 insertions(+), 4 deletions(-)

[commit 182eef99ee7ba237f7f302ac4a2cda7b9babac23]
Date: 2025-10-08
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: https://www.patreon.com/bsdivy
Section: Ports.packaging
Subject: Makefile: Force DISTDIR=/ for (update-)packages
Review: The DISTDIR variable is forced to '/' for make packages and update-packages targets to avoid conflicts with ports settings, preventing build failures when DISTDIR is set in /etc/make.conf.
Body:

  The make(1) variable DISTDIR is used by both ports and src with a
  different meaning.  Some users may set DISTDIR in /etc/make.conf
  for ports, which previously worked fine when building src since
  the src targets which used this variable were not very commonly
  used (mainly, make distributeworld).

  Unfortunately, with pkgbase becoming the default, this is no longer
  true since make (update-)packages invokes make stageworld, which is
  sensitive to DISTDIR, and these users find that their build now fails.

  A correct fix for this probably requires renaming one or both of
  the DISTDIR variables, but for now, work around the problem by
  setting DISTDIR=/ for the user-facing pkgbase targets, packages
  and update-package.  Since setting DISTDIR doesn't work for these
  targets anyway, this should not break any existing configurations.

  MFC after:	1 week
  PR:		290010
  Reported by:	Oleh Vinichenko <moonlapse81@gmail.com>
  Reviewed by:	imp, bapt
  Sponsored by:	https://www.patreon.com/bsdivy
  Differential Revision:	https://reviews.freebsd.org/D52929

  (cherry picked from commit f7dc7d7af3683836fcca68018a678b242d2e2620)


   Makefile | 5 ++++-
   1 file changed, 4 insertions(+), 1 deletion(-)

[commit 049010b03a98b4ec004a629318f548b0f4e076cc]
Date: 2025-10-03
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: Netflix
Section: Kernel.general
Subject: x86: Defer non-fatal MCA message output from the HW interrupt context
Review: Machine Check Architecture (MCA) error messages for recoverable events are now logged from a task queue instead of in hardware interrupt context, reducing potential system latency during error handling.
Body:

  When processing recoverable MCA events in a hardware interrupt context,
  defer logging the messages to a task queue.

  Reviewed by:	markj
  MFC after:	2 weeks
  Sponsored by:	Netflix
  Differential Revision:	https://reviews.freebsd.org/D12275

  (cherry picked from commit 5e1611a37a02076180ccea1506713b8c9628779e)


   sys/x86/x86/mca.c | 41 ++++++++++++++++++++++++++++++++++-------
   1 file changed, 34 insertions(+), 7 deletions(-)

[commit 8b6bbdb80fc0c1d429320fa1c369df86b17c6a3e]
Date: 2025-10-03
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix
Section: Kernel.general
Subject: x86: Close race condition on MCA task queues at startup
Review: The commit fixes a race condition in the Machine Check Architecture (MCA) handling during system startup, preventing potential crashes from uninitialized task queues when an MCA arrives early.
Body:

  Currently, the CMCI handler checks the cold variable to determine
  whether it can schedule a task. The task queue is setup as part of the
  mca_startup() function, which is run well after the configure_final()
  function sets the cold variable to 0. Therefore, if an MCA arrives
  in the window between configure_final() and mca_startup() running,
  the code could try to schedule a task on an unintitalized task queue.

  Close the race by specifically checking whether the mca_startup()
  function has run.

  Reviewed by:	markj
  MFC after:	1 week
  Sponsored by:	Netflix
  Differential Revision:	https://reviews.freebsd.org/D12276

  (cherry picked from commit 4a5d8670a7d58b04913fd90aae85a1e35236ca3d)


   sys/x86/x86/mca.c | 6 ++++--
   1 file changed, 4 insertions(+), 2 deletions(-)

[commit 1b00e2ad86b3b5823de805f6b56792edcacb0fc9]
Date: 2025-09-24
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Netflix
Section: Kernel.general
Subject: x86: Keep cumulative MCA statistics in the kernel
Review: The kernel now maintains cumulative Machine Check Architecture (MCA) error statistics, providing users with accurate counts of CPU-reported errors through a more efficient interface than processing full MCA logs.
Body:

  Keeping cumulative MCA statistics in the kernel provides a way for
  users to get an accurate count of various kinds of errors reported
  by the CPU.

  After ca8929d2a3e9b9df31d2e487377f99d7c39aa01d, it is possible that
  the kernel will drop the record of some MCA interrupts. Moreover, this
  provides a cheaper interface to obtain statistics if that is the only
  reason a user is processing MCA logs.

  Reviewed by:	markj
  Sponsored by:	Netflix
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D52709

  (cherry picked from commit 5f1f7d8457d4fc28c6cff7e26a629a2d6ee3fc61)


   sys/x86/include/mca.h | 25 +++++++++++++++++++++++++
   sys/x86/x86/mca.c     | 43 ++++++++++++++++++++++++++++++++++++++++---
   2 files changed, 65 insertions(+), 3 deletions(-)

[commit 12ee292aaee20d190125d58d73da80907435ea03]
Date: 2023-02-28
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: ipfilter/ippool: Dump a copy of ippool dstlist data in "new" format
Review: The ippool utility now dumps dstlist data in the "new" format, which may affect scripts or tools that parse its output.
Body:

  As with 7531c434a593, which dumped ippool table data in the "new"
  format, print dstlist data in the "new" format.

  (cherry picked from commit eee36ffa0d874f1c8aca912f7c2a8eba34509927)


   sbin/ipf/libipf/printdstl_live.c   | 3 +++
   sbin/ipf/libipf/printdstlist.c     | 2 ++
   sbin/ipf/libipf/printdstlistdata.c | 5 ++---
   3 files changed, 7 insertions(+), 3 deletions(-)

[commit ee01d543bf0068274b200b79187e9157ecced96a]
Date: 2022-11-01
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.contrib
Subject: ipfilter/ippool: Dump a copy of ippool hash data in "new" format
Review: The ippool utility now dumps hash data in the "new" format, improving consistency with table data output.
Body:

  As with 7531c434a593, which dumped ippool table data in the "new"
  format, print hash data in the "new" format.

  (cherry picked from commit 2f30b43fa269bc63086b0428f45c79e982abb02f)


   sbin/ipf/libipf/printhash_live.c |  8 ++++++--
   sbin/ipf/libipf/printhashdata.c  | 17 +++++++++++++++--
   2 files changed, 21 insertions(+), 4 deletions(-)

[commit ce85861e680d5af37e35cdda168de5b66013fd46]
Date: 2022-11-01
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: ipfilter ippool: Prefix deleted entries with "#"
Review: The man:ippool[8] utility now prefixes deleted entries with "#" in its output, maintaining consistency with list functions.
Body:

  To maintain consistency with ippool list functions, prefix deleted
  entries with "#".

  (cherry picked from commit f3ff6abb9d816a68e65af5ed55552d152a58b5e4)


   sbin/ipf/libipf/printhashdata.c | 2 ++
   1 file changed, 2 insertions(+)

[commit 1ea48931d415cecff119a71d1186929f333a8fc3]
Date: 2022-11-01
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: ipfilter ippool: Flag deleted entries with "#"
Review: The ipfilter ippool utility now flags deleted entries with a '#' prefix in its output, making it consistent with other ippool list functions.
Body:

  List deleted entries prefixed by "#". This is consistent with other
  ippool list functions.

  Fixes:		7531c434a593

  (cherry picked from commit 94758e72fdbd6b218e79884e22347eb357a7e51d)


   sbin/ipf/libipf/printpooldata.c | 2 ++
   1 file changed, 2 insertions(+)

[commit c2fd9060f32d21f60195af010973e5bc8d4d81ee]
Date: 2025-10-08
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: undecided
Subject: nvme: Tweak completion timeout loop
Review: Minor internal refactoring of the NVMe driver completion timeout loop; no user-visible impact.
Body:

  * Rename delta_t to avoid misleading simplistic syntax highlighters
  * Simplify the increment calculation

  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.
  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D52973

  (cherry picked from commit 4070ae0e9a60715199f83004e7ebdfb169fc8cfc)


   sys/dev/nvme/nvme_private.h | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 4fe1317fd9865c23c3424467d07cdfc1eaebd640]
Date: 2025-10-08
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: rcorder: Fix grammar in warning about loops
Review: Fixes a grammar error in a warning message from man:rcorder[8].
Body:

  MFC after:	1 week
  Reviewed by:	ae
  Differential Revision:	https://reviews.freebsd.org/D52951

  (cherry picked from commit d96f9a4688668ececc09c61dcf6b539a55112cc0)


   sbin/rcorder/rcorder.c | 8 +++++---
   1 file changed, 5 insertions(+), 3 deletions(-)

[commit 1a7f745833dd53bcd400f77dec11d414cf6d8cf8]
Date: 2025-10-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc.
Section: undecided
Subject: tarfs: Simplify sameness checks
Review: The commit refactors internal code for tarfs without changing user-visible behavior, so it should not be included in relnotes.
Body:

  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D52928

  (cherry picked from commit 1b0fce2944e3ff570b11de05c6a03977ee5b95e6)


   tests/sys/fs/tarfs/tarfs_test.sh | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit f5060534b4f186e430fd5ce17de641f35dae32cd]
Date: 2025-10-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc.
Section: undecided
Subject: ln: Simplify sameness checks
Review: The commit only simplifies internal checks in the ln test script without any user-visible impact.
Body:

  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D52927

  (cherry picked from commit 18997fb9eca651a7ef13e6755a4d2cdd3ddede10)


   bin/ln/tests/ln_test.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 74fa49276487afc174ff3299a034e063cd947399]
Date: 2025-10-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc.
Section: undecided
Subject: cp: Simplify sameness checks
Review: The commit refactors internal logic for sameness checks in man:cp[1] without changing user-visible behavior.
Body:

  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D52926

  (cherry picked from commit 95de78614a57733807c28c05125ed0636309d88b)


   bin/cp/tests/cp_test.sh | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 7143adb76524e09e8a0023ffe7851bfdcb6c27d0]
Date: 2025-10-07
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Klara, Inc.
Section: undecided
Subject: fts: Remove a few stray blank lines
Review: This commit removes stray blank lines in the fts.c source file, which is an internal code formatting change with no user-visible impact.
Body:

  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D52924

  (cherry picked from commit 31db1582c883cbdd151ffacb22829027f23ead40)


   lib/libc/gen/fts.c | 3 ---
   1 file changed, 3 deletions(-)

[commit ed7cdc3e354d48fea783fc870bfa5048c5062c74]
Date: 2025-10-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: tail: Tweak follow_rename test case
Review: The commit adds a brief sleep in a tail test case to improve reliability under specific timing conditions, but it is a test-only change with no user-visible impact.
Body:

  Add a brief sleep to give tail time to start following the file before
  we rename it.

  PR:		289902
  MFC after:	1 week
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D52887

  (cherry picked from commit a9c72543d287afa8dd30bec0f49873e88057c192)


   usr.bin/tail/tests/tail_test.sh | 2 ++
   1 file changed, 2 insertions(+)

[commit 8c9b3ad2ec2aaff89aa3b106fb827557dc9f941f]
Date: 2025-10-04
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: Klara, Inc. | Klara, Inc.
Section: Docs.manpages
Subject: fts: Document thread (un)safety
Review: The man:fts[3] manual page is updated to document thread safety and improve clarity, including adding subsections, return values, and clarifying behavior of fts_read().
Body:

  MFC after:	3 days
  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D52828

  (cherry picked from commit 64f8416afd4cd042b34e3e975f84fb3493397828)

  fts: Further improve the manual page

  * Add subsections for the three functions that didn't already have one.
  * Add a RETURN VALUES section.
  * Improve the grammar somewhat.
  * Clarify that fts_read() will not set errno to 0 if called again after
    having already returned NULL.

  Sponsored by:	Klara, Inc.
  Reviewed by:	bcr, markj
  Differential Revision:	https://reviews.freebsd.org/D52925

  (cherry picked from commit a802334d86c7173ddd7776a20065bd5682f25f67)


   lib/libc/gen/fts.3 | 187 ++++++++++++++++++++++++++++++++++++++++++++++-------
   1 file changed, 165 insertions(+), 22 deletions(-)

[commit b8d62b94b9942cf7787ad448baf3b49c8e625ac2]
Date: 2025-10-02
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.programs
Subject: rc: Teach netwait to wait for DAD
Review: The netwait service now waits for IPv6 Duplicate Address Detection (DAD) to complete before launching daemons, preventing failures when binding to tentative IPv6 addresses. The wait time defaults to one more than the value of net.inet6.ip6.dad_count and is disabled if IPv6 is not supported.
Body:

  In some configurations, especially in jails, it is possible for the
  system to boot so fast that we end up launching daemons while duplicate
  address detection is still ongoing.  If that happens, said daemons may
  fail to bind to IPv6 addresses, as they are still tentative.  Teach the
  netwait service to wait (up to 10 seconds, by default) for the tentative
  flag to vanish.

  MFC after:	1 week
  Reviewed by:	olce
  Differential Revision:	https://reviews.freebsd.org/D51889

  (cherry picked from commit 5ead817c3b7af6d6b5fea222ab144db2c3167b22)

  rc: Improve netwait DAD logic

  Disable if IPv6 is not supported, and instead of 10 seconds, default to
  one more than the value of net.inet6.ip6.dad_count.

  Fixes:		5ead817c3b7a ("rc: Teach netwait to wait for DAD")
  Reviewed by:	bz
  Differential Revision:	https://reviews.freebsd.org/D52905

  (cherry picked from commit ec6ad605ecea5c4a76d2e744df0265cc3f3a01b9)


   libexec/rc/rc.conf       |  3 ++
   libexec/rc/rc.d/netwait  | 86 ++++++++++++++++++++++++++++++++++--------------
   share/man/man5/rc.conf.5 | 27 ++++++++++-----
   3 files changed, 84 insertions(+), 32 deletions(-)

[commit 087fc6ae0a8c57de66ec8af4a74861595a6b347e]
Date: 2025-10-06
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: remove stray ;
Review: Removes a stray semicolon in the TCP syncache code; no user-visible impact.
Body:

  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 0faa9ca827a5e91273ba757bd87bd9e8179a0862)


   sys/netinet/tcp_syncache.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 1728dae2535836111ebb65dd4e8a6c7cba29254d]
Date: 2025-10-06
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: improve SEG.ACK validation in SYN-RECEIVED
Review: The TCP stack now sends a RST segment in response to invalid ACK segments during SYN-RECEIVED state, fixing a missing validation in the SYN-cache code and resolving a kernel panic.
Body:

  According to the fifth step in SEGMENT ARRIVES, send a RST segment in
  response to an ACK segment which fails the SEG.ACK check, but leave
  the endpoint state unchanged.
  FreeBSD handles this correctly when entering the SYN-RECEIVED state via
  the SYN-SENT state, but not in the SYN-cache code, which handles the
  SYN-RECEIVED state via the LISTEN state.

  This also fixes a panic reported by Alexander Leidinger.

  Reviewed by:		jtl, glebius
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52934

  (cherry picked from commit 8af2f06a99b10c0d3ab9021949e750852662672a)


   sys/netinet/tcp_syncache.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit b177df181541ffb412ec047ed954e748fa761234]
Date: 2025-10-06
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: remove stray ;
Review: No functional change; only a stray semicolon removed.
Body:

  No functional change intended.

  Sponsored by:		Netflix, Inc.

  (cherry picked from commit 941b8ecdc08749eeec1b88aac0442dad8cb8fb09)


   sys/netinet/tcp_syncache.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit f5936037f2f1e0bf03b8b8e16b1099f7dfe85e26]
Date: 2025-10-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: Cirrus-CI: Bump to FreeBSD 14.3 image
Review: The commit updates the Cirrus CI configuration to use FreeBSD 14.3 images for continuous integration testing.
Body:

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit cca9295dd6adc4245fbeeefbe05c13c52d089bd7)


   .cirrus.yml | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 205797b9ef9df979da489aba5466e6d4d9bc6ad9]
Date: 2025-09-27
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: Ignore non-existent groups
Review: nuageinit now ignores non-existent groups specified in user configuration, allowing user creation to proceed instead of exiting with an error.
Body:

  In cloud-init, when a group specified in the 'users.{index}.groups' parameter
  does not exist, it is ignored, but the user is created anyway. In the case of
  nuageinit, it exits with an exception, since pw(8) expects each group to exist.

  Reviewed by:		bapt@
  Approved by:		bapt@
  Differential Revision:	https://reviews.freebsd.org/D52718

  (cherry picked from commit 68691160f41bf6ce9ab70ddeeb7eeec2a7bff245)


   libexec/nuageinit/nuage.lua | 61 ++++++++++++++++++++++++++++++++++++++++++++-
   1 file changed, 60 insertions(+), 1 deletion(-)

[commit 8a76161c0df20889cc40a46bd9ce83ab8304743f]
Date: 2025-10-06
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: nss_tacplus: Fix typo MK_INSTALLIB -> MK_INSTALLLIB
Review: Fixes a build typo in the nss_tacplus module, which resolves a build failure when MK_INSTALLLIB is set.
Body:

  Reviewed by:	des
  Approved by:	emaste (mentor)
  Fixes:	6c5cdba1bafe ("Add nss_tacplus, a TACACS+ NSS module.")
  MFC after:	1 day
  Differential Revision:	https://reviews.freebsd.org/D52882

  (cherry picked from commit 75f7e003b79d4a1d1cad77cc7bbe2ccb96435cd5)


   ObsoleteFiles.inc        | 3 +++
   lib/nss_tacplus/Makefile | 2 +-
   2 files changed, 4 insertions(+), 1 deletion(-)

[commit 1cc96642675bf5029ce72dcf981d4a1cf993dee3]
Date: 2025-10-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix
Section: undecided
Subject: tcp: close two minor races with debug messages
Review: The commit fixes minor race conditions in TCP syncache debug logging, but these are internal debugging changes with no user-visible impact.
Body:

  The syncache entry is locked by the hash bucket lock. After running
  SCH_UNLOCK(), we have no guarantee that the syncache entry still
  exists.

  Resolve the race by moving SCH_UNLOCK() after the log() call which
  reads variables from the syncache entry.

  Reviewed by:	rrs, tuexen, Nick Banks
  Sponsored by:	Netflix
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D52868

  (cherry picked from commit ad38f6a0b466bf05a0d40ce1daa8c7bce0936271)


   sys/netinet/tcp_syncache.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit a7dcd4c2a9fb35cac756db04326827efbaa4589b]
Date: 2025-10-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: improve segment validation in SYN-RECEIVED
Review: TCP segment validation order is corrected in the SYN-RECEIVED state. When sequence validation fails, a challenge ACK is sent instead of a RST segment, improving RFC 9293 compliance and connection robustness.
Body:

  The validation of SEG.SEQ (first step in SEGMENT ARRIVES of RFC 9293)
  should be done before the validation of SEG.ACK (fifth step in
  SEGMENT ARRIVES in RFC 9293).
  Furthermore, when the SEG.SEQ validation fails, a challenge ACK
  should be sent instead of sending a RST-segment and moving the
  endpoint to CLOSED.

  Reported by:		Tilnel on freebsd-net
  Reviewed by:		Nick Banks
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52849

  (cherry picked from commit b7118461f9099876cb2c2923948f8fb647defd57)


   sys/netinet/tcp_syncache.c | 32 +++++++++++++++++---------------
   1 file changed, 17 insertions(+), 15 deletions(-)

[commit b0501abb4cfb8ffee7a7245ca197d290df912e22]
Date: 2025-10-01
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: cleanup syncache_expand()
Review: The commit refines internal TCP syncache handling and logging without user-visible changes.
Body:

  Only validate SEG.SEQ and SEG.ACK when processing a real SYN-cache
  entry. In the SYN-cookie case, these conditions are always true, since
  the SYN-cache entry on the stack is constructed from the incoming
  TCP segment.
  While there, fix the logging messages.

  Reviewed by:		Nick Banks
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52816

  (cherry picked from commit 3034fa3d4321fdc487428c9050711de9ce234567)


   sys/netinet/tcp_syncache.c | 52 ++++++++++++++++++++++++++--------------------
   1 file changed, 29 insertions(+), 23 deletions(-)

[commit b7b48ba8420f6203ac7165b6b07c62929bb759e8]
Date: 2025-10-02
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: keep SYN-cache entry when sending of challenge ACK fails
Review: The TCP SYN-cache entry is now retained when sending a challenge ACK fails, preventing unnecessary SYN-cache drops due to temporary transmission issues.
Body:

  Don't drop a SYN-cache entry just because a challenge ACK couldn't
  be sent. This might only be a temporary failure.

  Reviewed by:		Nick Banks, glebius, jtl
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52840

  (cherry picked from commit 7841b44f8491d69c75207d0f3a1eb34501d99edd)


   sys/netinet/tcp_syncache.c | 17 ++++-------------
   1 file changed, 4 insertions(+), 13 deletions(-)

[commit 806af8240801ccc823dc790dae802b17d8e6fb19]
Date: 2025-09-18
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: Userland.programs
Subject: pw: Add a metalog output mode
Review: The man:pw[8] utility gains a new -M option for useradd, which records newly added skeleton files in an mtree metalog. This enables non-root users to pre-create users in staged OS images while preserving a record of added files.
Body:

  When creating OS images as a non-root user, it may be useful to
  pre-create users in the staged tree.  The useradd operation adds files
  to the new user's home directory, copied from the skeleton directory
  (/usr/share/skel), which makes it inconvient for use in this scenario
  since the added files are not recorded in the mtree metalog.

  To cover this gap, this change adds a new -M <metalog> option to pw's
  useradd operation, causing pw to add mtree entries for newly added
  files.

  Extend an existing regression test to validate this mode.

  Reviewed by:	bapt, emaste
  MFC after:	1 week
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52590

  (cherry picked from commit 182ed3c0755f1bf161d8be02016b5f6cf9b57556)


   usr.sbin/pw/cpdir.c                  | 43 +++++++++++++++++++++------------
   usr.sbin/pw/pw.8                     | 16 +++++++++++++
   usr.sbin/pw/pw.c                     | 30 +++++++++++++++++++++--
   usr.sbin/pw/pw.h                     |  5 ++++
   usr.sbin/pw/pw_user.c                |  9 ++++++-
   usr.sbin/pw/pw_utils.c               | 46 ++++++++++++++++++++++++++++++++++++
   usr.sbin/pw/pwupd.h                  |  1 +
   usr.sbin/pw/tests/pw_useradd_test.sh | 20 ++++++++++++----
   8 files changed, 148 insertions(+), 22 deletions(-)

[commit bdd021191274d70bf9a2f752f45f76501321cdde]
Date: 2025-09-18
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: Userland.programs
Subject: pw: Use copy_file_range() when copying skeleton files
Review: The pw(8) utility now uses copy_file_range() for copying skeleton files, which may improve performance for large files. It also checks for I/O errors and prints them to standard error.
Body:

  As a bonus, check for I/O errors and print them to standard error.

  Reviewed by:	bapt, emaste
  MFC after:	1 week
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52588

  (cherry picked from commit a03d150a3d44c49344ebd0862defd1a5ad1f524e)


   usr.sbin/pw/cpdir.c | 12 ++++++++----
   1 file changed, 8 insertions(+), 4 deletions(-)

[commit 53b6ea81fa201a5699cf00e82a994becd858be2d]
Date: 2025-09-18
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: Userland.programs
Subject: pw: Add a missing chown() when creating dirs in mkdir_home_parents()
Review: The man:pw[8] utility now ensures that intermediate directories created when setting up a user's home directory are owned by root, matching the ownership of the final home directory.
Body:

  mkdir_home_parents() effectively performs a mkdir -p of the root home
  directory.  It chowns the home directory to 0, 0, but doesn't do so for
  the intermediate directories.  Add an explicit chown() call for those
  too.  Fix a long line while here.

  Reviewed by:	bapt
  MFC after:	1 week
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52587

  (cherry picked from commit 41b2a80353e0dd04939cc260d5763854a264c158)


   usr.sbin/pw/pw_user.c | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit f6824040125b85d049579bb6be917a1796c53da3]
Date: 2025-09-18
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: undecided
Subject: pw: Style
Review: No functional change intended; only style fixes.
Body:

  No functional change intended.

  MFC after:	1 week
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.

  (cherry picked from commit 42dc71a544a4d78d0068f70b6d4089a8c9e07cb1)


   usr.sbin/pw/pw.c | 5 ++---
   1 file changed, 2 insertions(+), 3 deletions(-)

[commit cfffe5cacc5532fb3d0159e1f3478af340cf7bd0]
Date: 2025-09-18
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: undecided
Subject: pw: Clean up a couple of errx() calls
Review: Minor formatting changes to error messages in man:pw[8] with no functional impact.
Body:

  - Remove a stray backslash.
  - Make an error message fit on one line.

  No functional change intended.

  MFC after:	1 week
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.

  (cherry picked from commit bc69d5dffa21cdf228e481b5502fd0f053d65e6d)


   usr.sbin/pw/pw.c | 7 ++++---
   1 file changed, 4 insertions(+), 3 deletions(-)

[commit 239fb1ad8e7336f4c9208828d926525be763d374]
Date: 2025-09-18
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: Userland.programs
Subject: pw: Print warnings when metadata updates fail
Review: The man:pw[8] utility now prints warnings when metadata updates fail, improving consistency in error reporting.
Body:

  We do this in most places already, but not consistently.

  MFC after:	1 week
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.

  (cherry picked from commit daa63c9417a28ad08881ff03df828fd8180dad12)


   usr.sbin/pw/cpdir.c   | 6 ++++--
   usr.sbin/pw/pw_user.c | 3 ++-
   2 files changed, 6 insertions(+), 3 deletions(-)

[commit 10909308d3eda36a7bf52dd1fa316964854be63e]
Date: 2025-09-18
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: undecided
Subject: pw: Remove duplicate lines from the pw useradd usage message
Review: The commit removes duplicate lines from the usage message of man:pw[8] when using the useradd command, but it does not change any functionality or user-visible behavior.
Body:

  No functional change intended.

  MFC after:	1 week
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.

  (cherry picked from commit 4784ca87441093328cec4e9b133608e172343f64)


   usr.sbin/pw/pw.c | 2 --
   1 file changed, 2 deletions(-)

[commit ede06b0ef3d03d9b30b6bad42c966d979aefea00]
Date: 2025-09-19
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Kernel.general
Subject: sanitizers: Provide wrappers for atomic_testandset_acq_long
Review: The commit adds missing atomic_testandset_acq_long wrappers for kernel sanitizers, which resolves a build error when using the RANDOM_FENESTRASX kernel option. This affects users building custom kernels with sanitizers enabled.
Body:

  Noticed when building a kernel with options RANDOM_FENESTRASX.

  MFC after:	1 week

  (cherry picked from commit 7ea59a07046a0bf25d4fccb456715dffaae52021)


   sys/kern/subr_asan.c | 1 +
   sys/kern/subr_msan.c | 1 +
   2 files changed, 2 insertions(+)

[commit fc39147428914cd25db9396a15f4eaf9ad9b1162]
Date: 2025-09-22
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: OptionalObsoleteFiles.inc: Add more ATF libraries
Review: The commit adds ATF libraries to OptionalObsoleteFiles.inc, which is an internal build system file for handling obsolete files during upgrades, with no direct user-visible impact.
Body:

  PR:		289653
  Reported by:	Trond Endrestl <Trond.Endrestol@ximalas.info>
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D52676

  (cherry picked from commit ceb5792d1e2e58646dd291a2dc3877aaeb73122b)


   tools/build/mk/OptionalObsoleteFiles.inc | 4 ++++
   1 file changed, 4 insertions(+)

[commit 88767665cf92b196261fe305f022c272ddcce9ea]
Date: 2025-09-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: dtrace: Deduplicate dtrace_sync() and dtrace_xcall() implementations
Review: Internal deduplication of DTrace synchronization functions across multiple CPU architectures. No user-visible functional change.
Body:

  dtrace_xcall() is just a thin wrapper around smp_rendezvous_cpus().
  There's no need for six identical implementations to live in MD layers.

  No functional change intended.

  MFC after:	2 weeks

  (cherry picked from commit bf115203bb8a61bd03ba23931ff0b5bf931b7d1b)


   .../contrib/opensolaris/uts/common/dtrace/dtrace.c | 25 ++++++++++++++++++++
   sys/cddl/dev/dtrace/aarch64/dtrace_subr.c          | 27 ----------------------
   sys/cddl/dev/dtrace/amd64/dtrace_subr.c            | 25 --------------------
   sys/cddl/dev/dtrace/arm/dtrace_subr.c              | 25 --------------------
   sys/cddl/dev/dtrace/i386/dtrace_subr.c             | 25 --------------------
   sys/cddl/dev/dtrace/powerpc/dtrace_subr.c          | 25 --------------------
   sys/cddl/dev/dtrace/riscv/dtrace_subr.c            | 27 ----------------------
   7 files changed, 25 insertions(+), 154 deletions(-)

[commit ca538dd7afeddfdc7be10fecafc5cc1f226c2de7]
Date: 2025-10-03
Score: 5
Status: proposed(include=no,score=15)
Sponsor: https://www.patreon.com/bsdivy
Section: undecided
Subject: Makefile: Fix ordering for (update-)packages
Review: The commit fixes ordering issues in the build system when using parallel builds with 'make -j8 buildworld buildkernel packages', ensuring proper dependency resolution.
Body:

  The (update-)packages targets require buildworld and buildkernel to
  run first.  Add some .ORDER statements to ensure this happens.

  This fixes 'make -j8 buildworld buildkernel packages'.

  PR:		289969
  Reported by:	yasu
  MFC after:	3 days
  Reviewed by:	yasu, emaste
  Sponsored by:	https://www.patreon.com/bsdivy
  Differential Revision:	https://reviews.freebsd.org/D52877

  (cherry picked from commit dfc9da6248491072e31f924f5ae6b6238603089a)


   Makefile | 4 ++++
   1 file changed, 4 insertions(+)

[commit d8e73f45fc5fe736ad398d15f547af593cc84e6f]
Date: 2025-09-29
Score: 5
Status: added(include=yes,score=85)
Sponsor: Netflix
Section: Bootloader.general
Subject: bsdinstall: Add loader.efi to all ESPs we create
Review: The bsdinstall installer now copies loader.efi to all ESPs created for multi-volume ZFS datasets, providing boot redundancy if the primary disk fails.
Body:

  For proper redundancy, add copies of loader.efi to each of the ESPs we
  create when we create multi-volume ZFS datasets. zfsboot creates a list
  of secondary ESPs, while bootpart doesn't create any (it's the UFS
  partitioning tool) because we don't supporg UFS over gmirror. The
  primary ESP is mounted and is what we use efibootmgr to boot from. The
  redundant copies allow the system to boot if the primary disks fails.

  Sponsored by:		Netflix
  MFC After:		2 days
  PR:			208802
  Reviewed by:		cperciva
  Differential Revision:	https://reviews.freebsd.org/D52780

  (cherry picked from commit 494de51bc0074472d1b01604f085daea0844f240)


   usr.sbin/bsdinstall/scripts/auto       |  3 ++
   usr.sbin/bsdinstall/scripts/bootconfig | 61 ++++++++++++++++++++++------------
   usr.sbin/bsdinstall/scripts/zfsboot    | 28 +++++++++-------
   3 files changed, 59 insertions(+), 33 deletions(-)

[commit f591fd26ca8e4a32048287c880bac1f7e12301e7]
Date: 2025-09-19
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Docs.manpages
Subject: vnet.9: Remove references to non-existant macros and update how to virtualize sysctls
Review: The man:vnet.9 manual page is updated to remove references to non-existent macros and clarify virtualization of sysctls.
Body:

  Approved by:	bcr, ziaee
  MFC after:	1 week
  MFC to:		stable/14, stable/15
  Sponsored by:	Rubicon Communications, LLC ("Netgate")
  Differential Revision:	https://reviews.freebsd.org/D52620

  (cherry picked from commit 22886d3af0657dae3b547b21e612642bb47e0321)


   share/man/man9/vnet.9 | 52 ++++-----------------------------------------------
   1 file changed, 4 insertions(+), 48 deletions(-)

[commit 7b980bf5e5262332c8f5679ad4dd7b17fd5db8a9]
Date: 2025-09-10
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: kern/vfs_vnops.c: generalize the lock primitive for file foffset
Review: The commit generalizes locking for file offsets in the kernel's VFS layer, which may affect performance and correctness for file operations but does not introduce user-visible features, removals, or configuration changes.
Body:

  (cherry picked from commit 94a0f9f63e164e4f3791bc7d105d6f267b4d47bc)


   sys/kern/vfs_vnops.c | 148 +++++++++++++++++++++++++++++++--------------------
   sys/sys/file.h       |   6 +--
   2 files changed, 94 insertions(+), 60 deletions(-)

[commit b363362abe61862be87b681dec3246a0e688532f]
Date: 2025-10-01
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: trim.8: update the manual with references to zpool-trim and fsck_ffs -E
Review: The man:trim[8] manual page now includes references to zpool-trim and fsck_ffs -E, improving documentation for users of the trim utility.
Body:

  (cherry picked from commit 5d8fde850768d31f722de6177204ec7cab199bd1)


   usr.sbin/trim/trim.8 | 15 ++++++++++++---
   1 file changed, 12 insertions(+), 3 deletions(-)

[commit 9d0b660e69492b3dda65735c6bc4714d259bb20a]
Date: 2025-10-02
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Userland.contrib
Subject: jemalloc: Fix activating debug on WITHOUT_MALLOC_PRODUCTION
Review: Fixes a build configuration issue that prevented enabling jemalloc debugging when MALLOC_PRODUCTION is disabled via WITHOUT_MALLOC_PRODUCTION. This restores the ability to activate debug features in jemalloc for users who need them.
Body:

  When stable/14 was branched, MALLOC_PRODUCTION wasn't moved from
  __DEFAULT_NO_OPTIONS to __DEFAULT_YES_OPTIONS but instead
  'jemalloc_FreeBSD.h' was changed to stop defining JEMALLOC_DEBUG (and
  also, strangely, to start defining MALLOC_PRODUCTION always, although
  that does not have any effect in jemalloc's code).

  While this effectively turned off jemalloc debugging, it also prevents
  people from turning it on again.  Additionally, leaving
  MALLOC_PRODUCTION in __DEFAULT_NO_OPTIONS would be confusing.  Finally,
  this puts stable/14 in line with what was done for stable/15.

  This is a direct commit to stable/14.

  Reviewed by:    markj
  Fixes:          29a16ce065db ("release: update stable/14 following branching from main")
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52850


   contrib/jemalloc/include/jemalloc/jemalloc_FreeBSD.h | 2 +-
   share/mk/src.opts.mk                                 | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit c55c8a899edcb5736df46058ac57e8d20f653991]
Date: 2025-09-30
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: apply rate limits to challenge ACKs
Review: The TCP stack now applies rate limiting to challenge ACKs sent from the SYN-cache, matching the behavior in other states. This change helps mitigate certain network-based attacks by limiting the rate of these responses.
Body:

  When sending challenge ACKs from the SYN-cache, apply the same rate
  limiting as in other states.

  Reviewed by:		cc, rrs
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52754

  (cherry picked from commit c2900b6e8255ba4f54dbd897cf42427db577ed3d)


   sys/netinet/tcp_syncache.c | 28 ++++++++++++++++++++++++----
   sys/netinet/tcp_syncache.h |  2 ++
   2 files changed, 26 insertions(+), 4 deletions(-)

[commit 3d548504c705ac9a38a0fee2e85985340c1fe488]
Date: 2025-09-30
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: vtnet: disable hardware TCP LRO by default
Review: The vtnet driver now disables hardware TCP Large Receive Offload (LRO) by default to prevent issues with IP forwarding. Software LRO remains enabled for better performance in non-forwarding scenarios. Users can re-enable hardware LRO via loader tunable if needed.
Body:

  Hardware TCP LRO results in problems in settings with IP forwarding
  being enabled. In case of nodes without IP forwarding, using
  software LRO is also beneficial in general, since it can provide better
  information about what was received on the wire.
  Therefore, disable hardware TCP LRO by default.
  By tuning the loader tunable, this can be changed.

  PR:			263229
  Reviewed by:		Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D52684

  (cherry picked from commit 6e4b811009d63f33c59d51f28fd4a030ca90843e)


   share/man/man4/vtnet.4            | 22 +++++++++++++++++-----
   sys/dev/virtio/network/if_vtnet.c |  2 +-
   2 files changed, 18 insertions(+), 6 deletions(-)

[commit 2acabc7318ac47401e078de28e7b89a38b356cb9]
Date: 2025-08-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: hkbd: remove error detection in KDSKBSTATE ioctl
Review: The hkbd(4) driver no longer fails the KDSKBSTATE ioctl when keyboard LEDs cannot be set, improving compatibility with keyboards lacking LEDs, such as in qemu. The sysctl hw.hid.hkbd.no_leds is moved out of HID_BUG, allowing users to disable LED setting.
Body:

  The KDSKBSTATE ioctl brings the LED up. However, some keyboards (like qemu
  keyboard) may not have LED or failed to set the LED due to unexpected reason.
  Therefore, removing the error check as ukbd(4) does allow the keyboard works
  correctly with kbdcontrol(4).

  Also move hw.hid.hkbd.no_leds sysctl out of HID_BUG thus users can
  disable setting LEDs

  PR:             288968
  Reviewed by:    wulf
  Tested by:      trashcan@ellael.org, marklmi26-fbsd@yahoo.com, trkellers@gmail.coom
  Approved by:    lwsu (mentor), markj (mentor)
  MFC after       1 week
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52101

  (cherry picked from commit 1685192ea1faac28f2d4feede53e70b6a380500f)
  (cherry picked from commit 6ea7e1f92882706cc8818a13e8bd55b7d2f48e27)


   sys/dev/hid/hkbd.c | 19 ++++++++++++++-----
   1 file changed, 14 insertions(+), 5 deletions(-)

[commit 77e2ddc52c59239d01d44383712bec90e7b8656d]
Date: 2025-10-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: nss_tacplus: Fix typo in Makefile
Review: Fixes a typo in the lib/nss_tacplus/Makefile with no user-visible impact.
Body:

  Reported by:	ivy@
  MFC after:	3 days

  (cherry picked from commit e98d3416916cdb6285d4d1807582baf6faa3ddcc)


   lib/nss_tacplus/Makefile | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit ff997dde8c93d07dc3f41afc502d96876a36abde]
Date: 2025-10-01
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.contrib
Subject: libucl: Fix bugs in C-style comment parser
Review: libucl updated to version 0.9.2.
Body:

  When an asterisk is encountered inside a C-style comment, we first check
  if there is at least one more character left in the buffer, and if that
  character is a slash, which would terminate the comment.  If that is not
  the case, the next two characters are consumed without being inspected.
  If one of those is a double quote, or the initial asterisk of an
  asterisk-slash pair, we end up misparsing the comment.

  MFC after:	3 days
  Reviewed by:	kevans, bofh
  Differential Revision:	https://reviews.freebsd.org/D52808

  (cherry picked from commit b5e2bd5ef38181ce4a445ec19f1fa5cb6c8ea692)


   contrib/libucl/src/ucl_parser.c | 77 ++++++++++++++++++++---------------------
   1 file changed, 38 insertions(+), 39 deletions(-)

[commit 3d91e5d58581e000932854e4acb9cc722f01826a]
Date: 2025-08-04
Score: 5
Status: proposed(include=no,score=20)
Sponsor: Chelsio Communications
Section: undecided
Subject: libucl: Add a ucl::Ucl::forced_string_value method
Review: libucl library adds a ucl::Ucl::forced_string_value method for converting UCL objects to strings.
Body:

  This is a wrapper around ucl_object_tostring_forced.

  Sponsored by:	Chelsio Communications
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1794

  (cherry picked from commit 47586ffc8bde236bab65da05ad3c0a660709ba96)


   contrib/libucl/include/ucl++.h | 5 +++++
   1 file changed, 5 insertions(+)

[commit 50df33fd0dc86d2f50269af0d3e5b463c5c20934]
Date: 2025-09-30
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: libc: Add missing MLINK for tzname(3)
Review: Adds missing MLINK for tzname(3) and fixes typo in tzset(3) man page.
Body:

  While here, fix manlint warnings and a typo in tzset(3).

  MFC after:	3 days

  (cherry picked from commit be8830612314d9afb64b5c040db689de44eb4b85)


   lib/libc/stdtime/Makefile.inc |  3 ++-
   lib/libc/stdtime/tzset.3      | 46 +++++++++++++++----------------------------
   2 files changed, 18 insertions(+), 31 deletions(-)

[commit 278c371fd2db6a534d5a553d5eb18e53e14b2a8d]
Date: 2025-09-23
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: pwait: Fix timeout unit parser
Review: The timeout parser in man:pwait[1] now correctly interprets timeout units, fixing a bug where only the first character after the number was considered.
Body:

  The timeout parser would check the first character after the number and
  ignore any subsequent ones.

  While here, switch to bool for booleans and fix some style nits.

  MFC after:	1 week
  Reviewed by:	0mp, markj
  Differential Revision:	https://reviews.freebsd.org/D52612

  (cherry picked from commit 3aac05f56620712744cb57d71a0ef42f8d8e3b52)


   bin/pwait/pwait.c | 30 ++++++++++++++++++------------
   1 file changed, 18 insertions(+), 12 deletions(-)

[commit 50f554a5475fa274d7b832e2f7fa5add0218f222]
Date: 2025-09-23
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: rc.subr: Move the sleep in wait_for_pids
Review: The commit adjusts the timing of a sleep in rc.subr to improve process reaping during service shutdown, which may affect service stop reliability.
Body:

  Instead of sleeping while constructing the list of PIDs to wait for,
  sleep briefly after pwait to give init a chance to reap the processes
  that just terminated before we loop around and start probing them.

  PR:		289630
  Reviewed by:	allanjude
  Differential Revision:	https://reviews.freebsd.org/D52619

  (cherry picked from commit 5953e7c98427e038500221e885dffa181dcc064b)


   libexec/rc/rc.subr | 5 ++++-
   1 file changed, 4 insertions(+), 1 deletion(-)

[commit 65f3a787b6d7495f1638bc064277b320b4784019]
Date: 2025-08-02
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: Userland.libraries
Subject: rc.subr: Fix wait_for_pids
Review: The man:rc.subr[8] function wait_for_pids now correctly loops and prints updates as each watched process terminates, instead of waiting for all processes to finish before reporting.
Body:

  It looks like this function was intended to loop and print an update
  whenever at least one of the waited-for processes terminates.  However,
  the default behavior of pwait is to block until none of the watched
  processes exist.  Use pwait -o instead so it only blocks until at least
  one process terminates, and add a test.

  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.
  Reviewed by:	siderop1_netapp.com, kevans
  Differential Revision:	https://reviews.freebsd.org/D51691

  (cherry picked from commit 7f04c09fe74535c1646a4af120f8f1342fe1c328)


   libexec/rc/rc.subr               |  4 ++--
   libexec/rc/tests/rc_subr_test.sh | 27 +++++++++++++++++++++++++++
   2 files changed, 29 insertions(+), 2 deletions(-)

[commit 08a2145902a71b4533f840f02a69dbdb63cb891e]
Date: 2025-09-27
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: mktemp.1: Document TMPDIR in ENVIRONMENT
Review: The man:page for man:mktemp[1] now documents the TMPDIR environment variable and uses consistent markup.
Body:

  While here, use Ev for TMPDIR consistently.

  MFC after:	3 days
  Event:		EuroBSDCon 2025

  (cherry picked from commit 6b164f18118d0e8dbf9826d7117e0e757f7eb727)


   usr.bin/mktemp/mktemp.1 | 12 ++++++++++--
   1 file changed, 10 insertions(+), 2 deletions(-)

[commit 453baca8fb7e2ca2847117bfd25ca4b84ac97cff]
Date: 2025-09-28
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: sysctl.9: Fix grammar in *TUN descriptions
Review: Fixes grammar in the sysctl.9 manual page descriptions.
Body:

  Reported by:	bcr
  Reviewed by:	bcr
  MFC after:	3 days
  Event:		EuroBSDCon 2025
  Fixes:	5eb1caa8c845 Updated SYSCTL manual pages
  Differential Revision:	https://reviews.freebsd.org/D52768

  (cherry picked from commit f34e1c76adc5efd9b603cf6b2d5827f7db8c2ed8)


   share/man/man9/sysctl.9 | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 6163ced966b4e37a987e514aa2d2a61781c98fa5]
Date: 2025-09-30
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Drivers.device
Subject: gpioc: fix race in ioctl(GPIOCONFIGEVENTS)
Review: Fixes a race condition in the gpioc(4) driver's ioctl handling that could lead to system instability or crashes when GPIO events are configured concurrently with pin configuration.
Body:

  A race can occur in gpioc_ioctl when it is called with GPIOCONFIGEVENTS
  closely followed by GPIOSETCONFIG. GPIOSETCONFIG can alter the
  priv->pins list, making it no longer empty and opening the door for
  access to priv->events while we are reallocating it. Fix this by holding
  priv->mtx while handling GPIOCONFIGEVENTS.

  Reported by:	Qiu-ji Chen
  PR:		289120
  Reviewed by:	mmel
  MFC after:	1 day
  Differential Revision:	https://reviews.freebsd.org/D52783

  (cherry picked from commit d000adfe41e6f2fe8f3dbe92d8fc2d34ae882086)


   sys/dev/gpio/gpioc.c | 29 +++++++++++++++++++----------
   1 file changed, 19 insertions(+), 10 deletions(-)

[commit 39139fec932edc313e891b0a49db61ad2c64b1fe]
Date: 2025-09-30
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: gpioc: allocate priv->events with the correct size
Review: The commit fixes a memory allocation size in the gpioc driver, but this is an internal bug fix with no direct user-visible impact, such as new features, configuration changes, or documented behavior changes.
Body:

  MFC after:	1 day

  (cherry picked from commit fa26e445544eb88f05779258e2ab9c96384fe74d)


   sys/dev/gpio/gpioc.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 555c30611c26a485e8fe17e75affd0f3c9f71319]
Date: 2025-09-25
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: rk_gpio: Fix register read/write on rk3568
Review: The rk_gpio driver now correctly handles register read/write operations on rk3568 SoCs, fixing potential GPIO functionality issues on systems using this hardware.
Body:

  Not all registers have a write mask with high/low register on rk3568.

  Reviewed by:	vexeduxr
  MFC after:	5 days
  Differential Revision:	https://reviews.freebsd.org/D52512

  (cherry picked from commit 34ec8c9ccaa473d2d0c177a92c041bb8fdb083db)


   sys/arm64/rockchip/rk_gpio.c | 99 ++++++++++++++++++++++++--------------------
   1 file changed, 54 insertions(+), 45 deletions(-)

[commit b6ad8caa24c2c6e7e1c8a844c2fd283a2fcfef3e]
Date: 2025-09-25
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: ng_tty: copy to the correct mbuf
Review: Fixes a bug in the netgraph tty node where data could be incorrectly copied, potentially causing data corruption or loss in netgraph-based serial connections.
Body:

  memcpy should copy to the current mbuf, otherwise we're copying to the
  first mbuf in the chain over and over.

  Reported by:	kevans
  Reviewed by:	glebius
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D52713

  (cherry picked from commit e05521121f05a1b1e0d7c7b5fbe79f83fc303cd0)


   sys/netgraph/ng_tty.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e05342f3618f0e7b0e6c75a513212b389714d59a]
Date: 2025-09-24
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Network.general
Subject: ng_tty: don't increment m_data
Review: The ng_tty node no longer increments m_data, allowing the callee to read the mbuf correctly.
Body:

  Stop incrementing m_data so the callee can read the mbuf.

  MFC after:	3 days
  Reviewed by:	glebius
  Differential Revision:	https://reviews.freebsd.org/D52702

  (cherry picked from commit 57d5a8feda3fd25a650eaab5998db13633d62d2d)


   sys/netgraph/ng_tty.c | 4 +---
   1 file changed, 1 insertion(+), 3 deletions(-)

[commit a98b5f3ff34e7ff851f6127a64ebd88818c8d004]
Date: 2025-09-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: vtnet: improve control of transmit offloading
Review: The vtnet driver now properly synchronizes hardware-assisted transmit checksum and segmentation offload flags with enabled capabilities, improving network performance and reliability for virtio-net devices.
Body:

  Keep the hwassist flags for transmit checksum offload and transmit
  segment offload in sync with the enabled capabilities.

  Reported by:		Timo Vlker
  Reviewed by:		Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D52765

  (cherry picked from commit f2575d56c8c9a8acad4a61a3586546dff4febce1)


   sys/dev/virtio/network/if_vtnet.c | 16 ++++++++++++----
   1 file changed, 12 insertions(+), 4 deletions(-)

[commit d83bd3bb94fe6ddc52c96e5e824607dadb1c47a4]
Date: 2025-09-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: amd64: add wrmsr_early_safe(9)
Review: The commit adds a new kernel function wrmsr_early_safe(9) for early MSR writes, which is an internal kernel development change with no direct user-visible impact.
Body:

  (cherry picked from commit a319696875451229f492b6c15e58a0ac54dbcda1)


   sys/amd64/amd64/machdep.c  | 33 +++++++++++++++++++++++++++++++++
   sys/amd64/amd64/support.S  | 16 ++++++++++++++++
   sys/amd64/include/md_var.h |  4 ++++
   3 files changed, 53 insertions(+)

[commit 7838ad85fb1a75464e53525b4cdb064ca1e97a47]
Date: 2025-09-18
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: witness: Record the first acquired file and line for recursable locks
Review: The commit improves witness lock debugging by recording the first acquired file and line for recursable locks, making lock acquisition reports more accurate for developers analyzing lock issues.
Body:

  and the last acquired file and line to witness object.

  For recursable locks, unfortunately current implementation records only
  the recurse count and the last acquired file and line, but does not
  restore the previous acquired file and line on unlock. Hence it is
  possible to report false acquired file and line, and that may mislead
  developers and make the report by users a little harder to analyse.

  Since subsequent recurse locks do not affect how witness order check,
  record the first acquired file and line so that the logic is much clear.

  Reported by:	bz
  Reviewed by:	kib (previous version), markj
  See also:	https://lists.freebsd.org/archives/freebsd-current/2025-June/007944.html
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D52496

  (cherry picked from commit 2d85bc89294baa04daf509e81ec3880bff79cc10)
  (cherry picked from commit 3dc9f96a489cd53710af8205a1f3901c11b760a5)


   sys/kern/subr_witness.c | 10 ++++------
   1 file changed, 4 insertions(+), 6 deletions(-)

[commit c16bb89bff4317d27ac81a273eb435f835606a3e]
Date: 2025-09-29
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: ftpd: blocklist: Add an extra probe
Review: The ftpd daemon now performs an additional blocklist probe when user access is denied, which may affect logging or blocking behavior for failed authentication attempts.
Body:

  Add a blocklist probe when user access is denied.

  Reviewed by:	emaste
  Approved by:	emaste (mentor)
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D52747

  (cherry picked from commit 307929b211e07f91260105211b57678e906327af)


   libexec/ftpd/ftpd.c | 1 +
   1 file changed, 1 insertion(+)

[commit 2b84c4c39148001b1f2455b0b047212d9e54d833]
Date: 2025-09-10
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Innovate UK
Section: undecided
Subject: dtrace: Use a size_t to represent a buffer size in the printm action
Review: The printm action in DTrace now uses size_t for buffer size representation, aligning with tracemem() and improving CHERI compatibility. This change is internal and does not affect user-visible behavior or functionality.
Body:

  printm is specific to the FreeBSD dtrace port.  I believe it's
  effectively the same as tracemem(), though printm apparently predates
  it.  It stores the size of the buffer of traced data inline.  Currently
  it represents that size using a uintptr_t, which isn't really right and
  poses challenges when porting to CHERI because
  `DTRACE_STORE(uintptr_t, ...`  requires the destination to be suitably
  aligned, but this isn't necessary since we're just storing a size.

  Convert to using a size_t.  This should be a no-op since
  sizeof(uintptr_t) == sizeof(size_t) on non-CHERI platforms (and besides
  that I don't see a reason to use printm() when tracemem() is available
  and is simpler to use.)

  Reviewed by:	Domagoj Stolfa, avg
  MFC after:	2 weeks
  Sponsored by:	Innovate UK
  Differential Revision:	https://reviews.freebsd.org/D52055

  (cherry picked from commit 3877025f52ee205fe99ad4ff68229933d57e4bcb)


   cddl/contrib/opensolaris/lib/libdtrace/common/dt_consume.c |  9 ++++-----
   sys/cddl/contrib/opensolaris/uts/common/dtrace/dtrace.c    | 11 ++++++-----
   2 files changed, 10 insertions(+), 10 deletions(-)

[commit 4008dd50c8f90fb076280a8ea56390f25d7519a9]
Date: 2025-09-10
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Innovate UK
Section: Drivers.device
Subject: re: Make sure re_rxeof() is called in net epoch context
Review: The re driver now ensures that re_rxeof() runs in network epoch context, preventing potential packet processing issues during watchdog timeouts.
Body:

  It may pass packets up the stack and so needs to be called in a network
  epoch.  When a watchdog timeout happens, we need to enter a section
  explicitly.

  Reviewed by:	zlei, glebius, adrian
  MFC after:	2 weeks
  Sponsored by:	Innovate UK
  Differential Revision:	https://reviews.freebsd.org/D51885

  (cherry picked from commit b653a281f5a977ba73b3d405874f8af8e8b6b50d)


   sys/dev/re/if_re.c | 3 +++
   1 file changed, 3 insertions(+)

[commit 72ac96ed8fa9415c2be1a5ceb0289b45578ba7bd]
Date: 2025-09-10
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Innovate UK
Section: Userland.libraries
Subject: libnv: Fix handling of nvlist_dump() and nvlist_send() for child nvlists
Review: The libnv library's nvlist_dump() and nvlist_send() functions now correctly handle child nvlists, preventing assertion failures or incorrect output when operating on nvlists within a parent container.
Body:

  Suppose an nvlist nvl belongs to a parent nvlist or nvlist array.  In
  this case, nvl contains a pointer to its container.  This trips up
  nvlist_send(nvl) and nvlist_dump(nvl), which intuitively should only
  operate on nvl and its nvpairs.  In particular, both of these functions
  will traverse to nvl's parent and start sending/dumping the parent's
  nvpairs, which results in assertion failures or nonsensical output,
  respectively.

  Reviewed by:	oshogbo
  MFC after:	2 weeks
  Sponsored by:	Innovate UK
  Differential Revision:	https://reviews.freebsd.org/D52360

  (cherry picked from commit 0b68e3ce6e0e437fa480b25a0ef706ee08562257)


   sys/contrib/libnv/nvlist.c | 10 ++++++++--
   1 file changed, 8 insertions(+), 2 deletions(-)

[commit de659254dcb67d5992f65f2450e5a704553e0f65]
Date: 2025-08-21
Score: 5
Status: proposed(include=no,score=20)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: undecided
Subject: newvers: Add a builddir parameter
Review: The commit adds a builddir parameter to newvers.sh to support reproducible builds by using a canonical objdir. This change affects build metadata generation but does not introduce user-visible behavior changes in the running system.
Body:

  When reproducible builds are configured, we should use /usr/obj as the
  canonical objdir.  Add a parameter to newvers.sh to ensure that build
  metadata is reproducible.

  Reviewed by:	emaste
  MFC after:	1 month
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50954

  (cherry picked from commit 3238878379d3bd4bb9796ccb41c090139bbde94f)


   sys/conf/kern.post.mk | 2 +-
   sys/conf/newvers.sh   | 8 ++++++--
   2 files changed, 7 insertions(+), 3 deletions(-)

[commit 18a65998107a01972ee74576897b36c51a1e6564]
Date: 2025-08-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: undecided
Subject: sys/conf: Remap paths for reproducibility
Review: The commit adds path remapping for reproducible builds in kernel and kernel modules, which may affect debugging and build reproducibility but has no direct user-visible impact.
Body:

  As in bsd.lib.mk and bsd.prog.mk, we need to remap paths in the kernel
  and in kernel modules when reproducible builds are configured.  Add
  directives to kern.post.mk and kmod.mk to remap the src, obj and sysroot
  dirs.

  For the sysroot, we need to pass the value of the SYSROOT variable to
  the kernel makefiles, which involves changing Makefile.inc1.  In so
  doing I reverted a portion of commit 35fb812adfc21; I can't see any harm
  in passing the SYSROOT variable down.

  MFC after:	1 month
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50953

  (cherry picked from commit eebadc7d8590ff8d38fdbcfd90651c931e713648)


   Makefile.inc1         |  2 +-
   sys/conf/kern.post.mk | 17 +++++++++++++++--
   sys/conf/kmod.mk      | 23 +++++++++++++++++++++--
   3 files changed, 37 insertions(+), 5 deletions(-)

[commit c89e5c0bfca639f39735572ee518e11f30ed8b20]
Date: 2025-08-21
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: Userland.config
Subject: share/mk: Substitute reproducible prefixes in dwarf info
Review: Builds with WITH_REPRODUCIBLE_BUILD now embed canonical paths /usr/src and /usr/obj in DWARF debug information, ensuring reproducible builds across different source directories.
Body:

  Ensure that worlds/releases built from different source paths are
  reproducible.  Currently they are not since src and obj paths are
  embedded in DWARF info.  There are some uses of __FILE__ in the src tree
  as well, and they are similarly handled by this change.

  Use /usr/src and /usr/obj as the canonical src and obj paths when
  WITH_REPRODUCIBLE_BUILD is defined.  Define a DEBUG_PREFIX variable
  which is used to ask the compiler to substitute paths in output files
  using -ffile-prefix-map.

  Compat builds (i.e., lib32) complicate things since they override
  OBJROOT to point to obj-${compat} but still refer to headers from the
  native objroot (e.g., llvm headers).

  MFC after:	1 month
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50951

  (cherry picked from commit 4f81c42fbd76e25c9fe696fa08296b79c55fbf09)


   share/mk/bsd.debug.mk | 22 ++++++++++++++++++++++
   share/mk/bsd.opts.mk  |  1 +
   2 files changed, 23 insertions(+)

[commit 8545586793f22fd7f67f8c46ec6fa12b766d0446]
Date: 2025-08-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: undecided
Subject: share/mk: Deduplicate some handling of debug info
Review: Internal build system refactoring with no user-visible changes.
Body:

  bsd.prog.mk and bsd.lib.mk contain a bunch of duplicated logic used to
  handle DEBUG_FLAGS and standalone debug file info (enabled by
  MK_DEBUG_FILES).  In anticipation of adding more duplicated logic, let's
  try factoring it out into a separate bsd.debug.mk first.

  bsd.debug.mk now handles the following:
  - MK_ASSERT_DEBUG
  - installation rules for debug files (the consumer has to set DEBUGFILE)
  - updating CFLAGS and CXXFLAGS based on DEBUG_FLAGS
  - optionally stripping installed files

  No functional change intended.

  Reviewed by:	bdrewery
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  MFC after:	1 month
  Differential Revision:	https://reviews.freebsd.org/D51805

  (cherry picked from commit 3a239e46c4aa1dc62a74b40f6a0feb030f089a0c)


   share/mk/Makefile     |  1 +
   share/mk/bsd.README   |  1 +
   share/mk/bsd.debug.mk | 46 ++++++++++++++++++++++++++++++++++++++++++
   share/mk/bsd.lib.mk   | 51 ++++++++---------------------------------------
   share/mk/bsd.own.mk   |  7 ++++++-
   share/mk/bsd.prog.mk  | 55 ++++++++++-----------------------------------------
   6 files changed, 72 insertions(+), 89 deletions(-)

[commit 29810aa6ae70a5883dcb55c09a36ee38801dcd63]
Date: 2024-03-11
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: Netflix
Section: Docs.manpages
Subject: libc: Move tzset.3 to stdtime
Review: The man page for tzset(3) is moved from the gen section to the stdtime section, which may affect users looking for documentation in the standard location.
Body:

  This really belongs in stddime, since it documents interfaces
  implemented in stdtime.

  Suggested by:	brooks
  Sponsored by:	Netflix

  (cherry picked from commit 7a0a6b276cfd7e072346842fe4746d08ee30e617)


   lib/libc/gen/Makefile.inc         | 1 -
   lib/libc/stdtime/Makefile.inc     | 4 +++-
   lib/libc/{gen => stdtime}/tzset.3 | 0
   3 files changed, 3 insertions(+), 2 deletions(-)

[commit d0e8c94631267f07c90465faf5b47dcce0e232be]
Date: 2025-09-23
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: sound: Implement COMPAT_FREEBSD32 shims
Review: The commit adds 32-bit compatibility shims for sound device ioctl calls, enabling 32-bit applications to use sound devices on 64-bit kernels.
Body:

  PR:		216568
  MFC after:	1 week
  Reviewed by:	christos, kib
  Differential Revision:	https://reviews.freebsd.org/D52509

  (cherry picked from commit 749a9266982b8e012b5ec370b2fdfef11f34c0b2)


   sys/dev/sound/pcm/dsp.c | 119 +++++++++++++++++++++++++++++++++++++++++++++++-
   1 file changed, 118 insertions(+), 1 deletion(-)

[commit a8e11e3c6208e6b569aed9eb60bd1dca32e0f5ec]
Date: 2025-09-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: dtraceall: Enable kinst for aarch64 and riscv as well
Review: The kinst DTrace provider is now enabled by default on aarch64 and riscv architectures, allowing DTrace-based kernel instruction tracing on these platforms.
Body:

  aarch64 and riscv are supported since 2023 so it should be safe to
  enable it by default.

  MFC after:	2 weeks
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D52575

  (cherry picked from commit 67f3c0d6a575f74a013974b4d4860a36e4fcc8ab)


   sys/modules/dtrace/dtraceall/dtraceall.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 503bf058cd0adfe3d5e66340b13d32b4516390cb]
Date: 2025-09-02
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: epair: add support for checksum offloading
Review: The epair(4) driver now supports TCP and UDP checksum offloading for both receive and transmit, enabled by default. Receive capabilities cannot be disabled due to packet handling requirements. Transmit capabilities are synchronized between the two ends of an epair interface.
Body:

  Add capabilities RXCSUM and RXCSUM6 as well as TXCSUM and TXCSUM6 for
  for receive and transmit checksum offloading for TCP and UDP to the
  epair interface and enable them by default.
  RXCSUM and RXCSUM6 are enabled because an epair interface may receive
  a packet with the csum_flag CSUM_DATA_VALID set, which is expected
  only if these capabilities are enabled. Since it seems not helpful to
  remove this flag, it is not possible to disable these capabilities.
  TXCSUM and TXCSUM6 are synchronized between the two epair interface
  ends. If enabled/disabled on one end, it will be enabled/disabled on
  the other end. If the sending epair interface end has TXCSUM or TXCSUM6
  enabled and the receiving end is in a bridge, it is assumed that all
  interfaces in the bridge have that capability enabled. Otherwise the
  bridge would have disabled that capability on the receiving epair
  interface end in the bridge which would have disabled that capability
  on the sending epair interface end as well due to the synchronization.

  Reviewed by:		bcr, Seyed Pouria Mousavizadeh Tehrani
  Differential Revision:	https://reviews.freebsd.org/D51639

  (cherry picked from commit e4ea162509e400340a2bc3e755071a92f3465e2d)


   share/man/man4/epair.4 | 24 +++++++++++++++++++-
   sys/net/if_epair.c     | 61 ++++++++++++++++++++++++++++++++++++++++++++++++--
   2 files changed, 82 insertions(+), 3 deletions(-)

[commit c0598ba49d2cc785a174e34e687b48298b95f8a0]
Date: 2025-09-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: vtnet: improve interface capability handling
Review: The vtnet driver now handles IPv6 receive checksum offload (IFCAP_RXCSUM_IPV6) as a pair with IPv4 receive checksum offload (IFCAP_RXCSUM). It also clarifies that both software and hardware LRO require receive checksum offload capabilities.
Body:

  Enable the handling of the IFCAP_RXCSUM_IPV6 handling by handling
  IFCAP_RXCSUM and IFCAP_RXCSUM_IPV6 as a pair. Also make clear, that
  software and hardware LRO require receive checksum offload.

  Reviewed by:		Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D52682

  (cherry picked from commit eaf619fddcb21859311b895a0836da3171a01531)


   share/man/man4/vtnet.4            |  4 +++-
   sys/dev/virtio/network/if_vtnet.c | 31 +++++++++++--------------------
   2 files changed, 14 insertions(+), 21 deletions(-)

[commit f801346706ea75401614df2dba3f85ecea2af03e]
Date: 2025-09-12
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: ip6: add SO_BINTIME support
Review: The SO_BINTIME socket option now works for IPv6 sockets, allowing high-resolution timestamping of received IPv6 packets.
Body:

  This adds support for obtaining timestamps from IPv6 packets using the
  SO_BINTIME socket option, bringing it in parity with IPv4 behavior.

  Enable testing the SO_BINTIME option in the relevant (manual) regression
  test.

  PR:		289423
  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D52504

  (cherry picked from commit cd02a8a9f8be2085d5242606a79668dc3720e7b0)


   sys/netinet6/ip6_input.c                           | 53 +++++++++++++++-------
   .../regression/sockets/udp_pingpong/udp_pingpong.c |  8 ++--
   2 files changed, 39 insertions(+), 22 deletions(-)

[commit 6cd33535a5f3b5303121378e11067fb4ef88f8a0]
Date: 2025-09-05
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: MODULE_PNP_INFO.9: tweak list indent
Review: Minor formatting fix to man:MODULE_PNP_INFO[9] to correct list indentation.
Body:

  So that it renders as intended.

  MFC after:	3 days
  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit a7340d559ee942c21ea1a037d1d60a7859dd873b)


   share/man/man9/MODULE_PNP_INFO.9 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 75f1a35ce445774c546cf333c7b0cb3ee3205006]
Date: 2025-09-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: if_re: Add PNP info for module
Review: The re(4) driver now includes PNP info, allowing devmatch(8) to automatically load it on non-x86 platforms where it is not in GENERIC.
Body:

  Add PNP info so it the module can be by devmatch(8) and automatically
  loaded. On non-x86 platforms it is not included in GENERIC.

  Reviewed by:	imp
  MFC after:	3 days
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D52557

  (cherry picked from commit e13b5298ec87be03da2231bc7b44a6a4b976b850)


   sys/dev/re/if_re.c | 2 ++
   1 file changed, 2 insertions(+)

[commit 0c946b6072ab1545af28d4bad8317b2696845adb]
Date: 2025-08-19
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: ixl(4): Fix queue MSI and legacy IRQ rearming
Review: The man:ixl[4] driver now correctly re-enables interrupts for MSI and legacy IRQ modes, preventing a condition where traffic processing could stop after interrupts are disabled and re-enabled.
Body:

  When MSI or legacy interrupt is used driver controls wheter
  queues can trigger an interrupt with the Interrupt Linked List.
  While processing traffic first index of the list is set to EOL
  value to stop queues from triggering interrupts. This index was
  not reset to the correct value when driver attempted to re-enable
  interrupts from queues, what prevented driver from processing any
  traffic. Fix that by setting correct first index in the
  ixl_if_enable_intr function.

  While at that fix the comments style and make ixl_if_enable_intr
  and ixl_if_disable_intr more consistent.

  Signed-off-by: Krzysztof Galazka <krzysztof.galazka@intel.com>

  PR:		288077
  Suggested by:	Mike Belanger <mibelanger@qnx.com>
  Approved by:	kbowling (mentor), erj (mentor)
  Tested by:	gowtham.kumar.ks_intel.com,
  Sponsored by:	Intel Corporation
  Differential Revision:	https://reviews.freebsd.org/D51331

  (cherry picked from commit 6f41c1fc39d9fa9db989a7b4f325c3ab85b8fb45)


   sys/dev/ixl/if_ixl.c | 25 +++++++++++++++++--------
   1 file changed, 17 insertions(+), 8 deletions(-)

[commit 5e4bed48699aeaa351a57c848a38138e804ed5fc]
Date: 2025-09-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: refactor tcp_send_challenge_ack()
Review: Refactoring only; no user-visible changes.
Body:

  Refactor tcp_send_challenge_ack() such that the logic checking whether
  a challenge ACK is sent or not is available in the separate function
  tcp_challenge_ack_check(). This new function will also be used for
  sending challenge ACKs in the SYN-cache code, which will be added in
  upcoming commits.
  No functional change intended.

  Reviewed by:		cc, Nick Banks, Peter Lei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52717

  (cherry picked from commit db37256ce5437e6c667a537afff0fd9f59576514)


   sys/netinet/tcp_subr.c | 42 +++++++++++++++++++++++++++---------------
   sys/netinet/tcp_var.h  |  1 +
   2 files changed, 28 insertions(+), 15 deletions(-)

[commit 994b3f20900d59fca8935525f4007de1378b2918]
Date: 2025-09-24
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: whitespace cleanup
Review: No functional change; only whitespace cleanup.
Body:

  No functional change intended.

  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 40417930f6ba50f61990fb995dd071c6fd42d080)


   sys/netinet/tcp_syncache.h | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit db0b2f107a46a1b01ca21054fe655132f2495e01]
Date: 2025-09-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: amd64 cpufunc.h: add rcs(), to read code selector
Review: The commit adds a new function rcs() to read the code selector, which is a low-level kernel interface change with no direct user-visible impact.
Body:

  (cherry picked from commit 50ee990e1874d6d40b8e3dc359c37e2ef2ebf477)


   sys/amd64/include/cpufunc.h | 9 +++++++++
   1 file changed, 9 insertions(+)

[commit a3be514dbcd1386d42887d10f49aaa3b085b7d7d]
Date: 2025-09-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: x86: directly use clflushopt mnemonic in cpufunc.h
Review: The commit changes internal header files to use a different assembly mnemonic for cache flushing, which is an implementation detail with no direct user-visible impact.
Body:

  (cherry picked from commit 5c55b2f3ba6f48575496bde2d4d86272d10a8197)


   sys/amd64/include/cpufunc.h | 2 +-
   sys/i386/include/cpufunc.h  | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit 1cf34a9ead7b3851369fe5fbb62663acb7b2aeba]
Date: 2025-09-20
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: arm/atomic.h: remove misleading comment
Review: Minor internal comment-only change with no user-visible impact.
Body:

  (cherry picked from commit 1c0465a3d32e59cd260067e87469abd013571470)


   sys/arm/include/atomic.h | 5 -----
   1 file changed, 5 deletions(-)

[commit 715f597eb2eadbf666a22a48e8431ce2f21447ce]
Date: 2025-09-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: arm, powerpc, riscv: implement atomic_set/clear_16
Review: The commit adds atomic_set/clear_16 operations for ARM, PowerPC, and RISC-V architectures, which are internal kernel atomic operations with no direct user-visible impact.
Body:

  (cherry picked from commit b31abc95eb730d566891e134ba14af852645f772)


   sys/arm/include/atomic.h     |  3 +++
   sys/powerpc/include/atomic.h | 33 ++++++++++++++++++++++++++++++++-
   sys/riscv/include/atomic.h   |  3 +++
   sys/sys/_atomic_subword.h    | 28 ++++++++++++++++++++++++++++
   4 files changed, 66 insertions(+), 1 deletion(-)

[commit ccbc722a19450df2981049777d4930deae94a840]
Date: 2025-09-24
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Kernel.general
Subject: tcp: Add CTLFLAG_VNET flag to some sysctls
Review: The sysctls net.inet.tcp.hostcache.list and net.inet.tcp.hostcache.histo are now correctly flagged as per-vnet, which affects the output of `sysctl -ANV` for these entries in vnet jails.
Body:

  The two sysctls net.inet.tcp.hostcache.list and net.inet.tcp.hostcache.histo
  are readonly and are to operate hostcache of vnet jails. Add CTLFLAG_VNET
  flag to them since they are per-vnet sysctls.

  This change does not have any impact on reading the two sysctls, but
  `sysctl -ANV net.inet.tcp.hostcache` will report them correctly.

  Reviewed by:	tuexen, #transport, #network
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D52693

  (cherry picked from commit b1f96169cfb50a7b65aee115b2c9ad2f00797bbf)
  (cherry picked from commit 032918dfd155936a79847f17ac355439e6b59027)


   sys/netinet/tcp_hostcache.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 79d114544fabd5a80198e925e4dc34f47a9f9e3a]
Date: 2025-09-24
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: tcp: Fix expiring and purging hostcache entries of vnet jails
Review: The sysctl net.inet.tcp.hostcache.purgenow is now writable from vnet jails, allowing jailed processes to expire and purge TCP hostcache entries.
Body:

  A jailed process, `sysctl -j foo` or `jexec foo sysctl`, do not have
  privilege to write to non-vnet sysctls but only to those marked as jail
  writable, aka sysctls those marked with CTLFLAG_VNET flag.

  Without this change we will get EPERM when trying to expire and purge
  hostcache entries of vnet jails via the net.inet.tcp.hostcache.purgenow
  sysctl. Fix that by adding a CTLFLAG_VNET flag.

  Reviewed by:	tuexen, #transport, #network
  Fixes:	264563806496 Add a new sysctl net.inet.tcp.hostcache.purgenow=1 to expire ...
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D52692

  (cherry picked from commit 33ceb31e256e386da5a42cc7ca2ef8d4b81b6eda)
  (cherry picked from commit fa30199a3dbfe1d4994e7e4e63ad9c582c6f8a1a)


   sys/netinet/tcp_hostcache.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 1bd02c42131a20ecc34d4d0d4acb964fc650ff67]
Date: 2025-09-22
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: ifconfig: Display the IFCAP_HWSTATS capability without netlink
Review: The man:ifconfig[8] utility now displays the IFCAP_HWSTATS capability, indicating support for hardware-based statistics on compatible NICs.
Body:

  This follows the commit 4cdc1f5421c5, which introduces the IFCAP_HWSTATS
  capability.

  Fixes:	4cdc1f5421c5 There are some high performance NICs that count statistics in hardware
  MFC after:	3 days

  (cherry picked from commit 595acb29a35f36a4fc08b89d3a476f16c1d108b4)
  (cherry picked from commit 6bcce275a5a9e10f8e5b990f8cfa2166aa49875a)


   sbin/ifconfig/ifconfig.c | 1 +
   1 file changed, 1 insertion(+)

[commit 6a2eca1b38d762776676065d72518d30d1f1f348]
Date: 2025-09-20
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: ifconfig: Fix the display of the IFCAP_MEXTPG capability without netlink
Review: The man:ifconfig[8] utility now correctly displays the IFCAP_MEXTPG capability name instead of the outdated IFCAP_NOMAP.
Body:

  Historically this capability is IFCAP_NOMAP but it was renamed to
  IFCAP_MEXTPG. Catch up with the change 3f43ada98c89.

  PR:		289545
  Fixes:		3f43ada98c89 Catch up with 6edfd179c86: mechanically rename IFCAP_NOMAP to IFCAP_MEXTPG
  MFC after:	3 days

  (cherry picked from commit 5017fdb728811fd3e15d7151524378f49a49aee1)
  (cherry picked from commit 5f472754ba6f9cc95607956c6e2ad6483c9dd157)


   sbin/ifconfig/ifconfig.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 9ed73bd78c7881698e8f600fcc34bd9634143b92]
Date: 2024-05-31
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Migrate from printb to print_bits for locally defined bit fields.
Review: The commit migrates internal bit field printing from printb to print_bits, which is a refactoring with no user-visible impact on functionality, behavior, or configuration.
Body:

  Reviewed by:	emaste
  Event:		Kitchener-Waterloo Hackathon 202406
  Differential Revision:	https://reviews.freebsd.org/D45441

  (cherry picked from commit a68e4f7a065218f0bcc5b34ff8d2e73a240b59b2)


   sbin/ifconfig/af_nd6.c   | 29 ++++++++++++-------
   sbin/ifconfig/ifconfig.c | 75 ++++++++++++++++++++++++++++++++++++++----------
   sbin/ifconfig/ifgif.c    |  7 +++--
   sbin/ifconfig/ifgre.c    |  9 ++++--
   4 files changed, 90 insertions(+), 30 deletions(-)

[commit ac91312f28a93e9d1d2a21ddbde76d6920ce8ddc]
Date: 2024-05-31
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Move print_bits to ifconfig.c and make available to other src files.
Review: The commit moves a helper function within ifconfig source files without changing user-visible behavior.
Body:

  Reviewed by:	emaste
  Event:		Kitchener-Waterloo Hackathon 202406
  Differential Revision:	https://reviews.freebsd.org/D45441

  (cherry picked from commit c3e9423743d91ae5b5865602a905900a1855055e)


   sbin/ifconfig/ifconfig.c         | 23 +++++++++++++++++++++++
   sbin/ifconfig/ifconfig.h         |  2 ++
   sbin/ifconfig/ifconfig_netlink.c | 23 -----------------------
   3 files changed, 25 insertions(+), 23 deletions(-)

[commit 112d1a5f5df0edb1e530348143413407b2659325]
Date: 2025-09-10
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: tslog: Move sysinit_tslog_shim() into kern_tslog.c
Review: Internal refactoring of kernel timestamp logging initialization; no user-visible impact.
Body:

  struct sysinit's func pointer requires its address, thus a real function
  is generated in every translation unit when the source file has SYSINITs
  declared. That results in plenty of identical sysinit_tslog_shim in the
  final kernel file, in which only one is used and others are left useless.

  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D52413

  (cherry picked from commit 5f9a05e574050c8b3f6b444311a12e8fb293ad1a)
  (cherry picked from commit bd721f6e8040f0b9d0546c293954290844b6a070)


   sys/kern/kern_tslog.c | 10 ++++++++++
   sys/sys/kernel.h      | 11 ++---------
   2 files changed, 12 insertions(+), 9 deletions(-)

[commit 94d3be2b547c133f42730e6c8692590ea32adab0]
Date: 2025-09-09
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Drivers.device
Subject: qlnxe: Report speeds in decimal format
Review: The qlnxe driver now reports bandwidth speeds in decimal format in kernel messages, making them easier to read.
Body:

  It is more natural to read the speed in decimal format than hexadecimal
  one.

  Spotted this while diagnosing PR 287445,

  ```
  [__ecore_configure_pf_max_bandwidth:6864(qlnx-0)]Configured MAX bandwidth to be 000061a8 Mb/sec
  [__ecore_configure_pf_min_bandwidth:6922(qlnx-0)]Configured MIN bandwidth to be 750 Mb/sec
  ```

  Reviewed by:	kbowling
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D52376

  (cherry picked from commit e1c5e043961ab3a5429a0c6e727265dfa819cf00)
  (cherry picked from commit 6fb046515ea6005b3958e0c3220d0e6e630af292)


   sys/dev/qlnx/qlnxe/ecore_dev.c | 6 +++---
   sys/dev/qlnx/qlnxe/ecore_mcp.c | 2 +-
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit ac4b48b6ad34a83406054c5badd0f835136ffd88]
Date: 2025-09-09
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Drivers.device
Subject: qlnxe: Support SIOCGIFXMEDIA ioctl
Review: The qlnxe driver now supports the SIOCGIFXMEDIA ioctl, allowing ifconfig(8) to correctly report extended media types for interfaces using this driver.
Body:

  ifconfig(8) will try SIOCGIFXMEDIA first and then retry SIOCGIFMEDIA if
  that fails. Since the driver reports extended media types, support
  SIOCGIFXMEDIA ioctl directly rather than doing another round.

  Reviewed by:	kbowling
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D52375

  (cherry picked from commit 6e3c8c0f709ab0b9d70e2725e58f4a4ba7a4404e)
  (cherry picked from commit 817bc700927087a52d0dd34c43e45736a867240e)


   sys/dev/qlnx/qlnxe/qlnx_os.c | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit 2cb20b25a5739fb542513571e3f6d7ffd607f346]
Date: 2025-09-09
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: qlnxe: Unconditionally enable extended media types
Review: The commit removes conditional compilation for extended media types in the qlnx driver, making them always available. This may affect driver compatibility with certain network media configurations.
Body:

  Those extended media types are available since about 2015 [1]. All
  supported branches already have them defined.

  No functional change intended.

  [1] eb7e25b22f1c ifmedia changes: Extend the number of available subtypes for Ethernet media ...

  Reviewed by:	kbowling
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D52374

  (cherry picked from commit 08356a733eb7a7bef1afe20ded2d983b55310de7)
  (cherry picked from commit 5aa49c98edfc48fbe96f7aba0e0631d4c0f29493)


   sys/dev/qlnx/qlnxe/qlnx_def.h | 16 ----------------
   sys/dev/qlnx/qlnxe/qlnx_os.c  | 21 +++++++++------------
   2 files changed, 9 insertions(+), 28 deletions(-)

[commit 629d42653584af5c1a05e2f012b62338de92f523]
Date: 2025-09-06
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: sx: Sprinkle const qualifiers where appropriate
Review: No functional change; only adds const qualifiers.
Body:

  No functional change intended.

  MFC after:	2 weeks

  (cherry picked from commit 306f0c4cf1a2f58a56993d29d666b4643326493b)


   sys/kern/kern_sx.c | 4 ++--
   sys/sys/sx.h       | 2 +-
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 79720e10b20849db722a62f14444745a53afda06]
Date: 2025-09-06
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: rwlock: Sprinkle const qualifiers where appropriate
Review: The commit adds const qualifiers to rwlock-related code with no functional change intended, so there is no user-visible impact.
Body:

  No functional change intended.

  MFC after:	2 weeks

  (cherry picked from commit 3c3686b3c773131243d204b4096e484037c7b502)


   sys/kern/kern_rwlock.c | 4 ++--
   sys/sys/rwlock.h       | 2 +-
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 17226a28bbd59ebd2b2031606a38e29654a62964]
Date: 2025-09-06
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: rmlock: Sprinkle const qualifiers where appropriate
Review: No functional change; only const qualifiers added to internal rmlock structures.
Body:

  No functional change intended.

  MFC after:	2 weeks

  (cherry picked from commit bec053201032b6b200dfe4e545e745af0f2179b4)


   sys/kern/kern_rmlock.c | 4 ++--
   sys/sys/rmlock.h       | 2 +-
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 89c3be21d65bbf7f992f3a37519f831dc3e93871]
Date: 2025-09-06
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: mtx: Sprinkle const qualifiers where appropriate
Review: The commit adds const qualifiers to internal mutex structures with no functional change intended.
Body:

  No functional change intended.

  MFC after:	2 weeks

  (cherry picked from commit 7bbfcc540810ba08f75b8f04263bb9a25f1cf45e)


   sys/kern/kern_mutex.c | 4 ++--
   sys/sys/mutex.h       | 2 +-
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit c2f1bb9a8c02cb23ff5d807e124a2df2bd046801]
Date: 2025-09-06
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: kenv: Sprinkle const qualifiers where appropriate
Review: The commit adds const qualifiers to kenv functions without changing functionality, so there is no user-visible impact.
Body:

  No functional change intended.

  MFC after:	2 weeks

  (cherry picked from commit 2a0ed0bef264da39b670461809bf027362dfeb80)


   sys/kern/kern_environment.c | 32 ++++++++++++++++----------------
   sys/sys/kernel.h            | 16 ++++++++--------
   2 files changed, 24 insertions(+), 24 deletions(-)

[commit 7d680875473d4abc056d0e6ad354842d8909bbdc]
Date: 2025-09-05
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Drivers.device
Subject: vtnet: Prefer "hardware" accounting for the multicast and total number of octets sent
Review: The vtnet driver now prefers hardware accounting over software accounting for multicast and total octets sent when ALTQ is enabled, simplifying the accounting logic.
Body:

  When ALTQ is enabled, this driver does "hardware" accounting and soft
  accounting at the same time. Prefer the "hardware" one to make the logic
  simpler.

  Reviewed by:	zlei
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D44817

  (cherry picked from commit 2a346c8993cbb92a321a7c25bd9ac4dcaae352d1)


   sys/dev/virtio/network/if_vtnet.c | 2 --
   1 file changed, 2 deletions(-)

[commit 8049f85bdd8b60560d7a4759afb762dc62033171]
Date: 2025-09-05
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: vtnet: Do "hardware" accounting for the total number of received octets
Review: The vtnet driver now performs hardware accounting for received octets and advertises IFCAP_HWSTATS, preventing double counting in the network stack.
Body:

  While here, advertise the IFCAP_HWSTATS capability to avoid the net
  stack from double counting it.

  Co-authored-by:	zlei
  Reviewed by:	zlei
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D44816

  (cherry picked from commit a14d561e58529c9686a2efc47f4828ad82026e63)


   sys/dev/virtio/network/if_vtnet.c | 3 +++
   1 file changed, 3 insertions(+)

[commit dc32441e3825a90027b61259c3c77ef6e213728a]
Date: 2025-09-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: ifnet: Defer detaching address family dependent data
Review: The ifnet address family data detach is deferred to avoid writing to freed memory, which can hide real problems. This change makes NULL pointer dereferences more visible, aiding in debugging network interface issues.
Body:

  While diagnosing PR 279653 and PR 285129, I observed that thread may
  write to freed memory but the system does not crash. This hides the
  real problem. A clear NULL pointer derefence is much better than writing
  to freed memory.

  PR:	279653
  PR:	285129
  Reviewed by:	glebius
  MFC after:	3 weeks
  Differential Revision:	https://reviews.freebsd.org/D49444

  (cherry picked from commit b5c46895fdddcdb7dd1994598925d6989ea7c8f2)


   sys/net/if.c       | 26 +++++++++++++++++++++-----
   sys/netinet/in.c   |  2 ++
   sys/netinet6/in6.c |  2 ++
   3 files changed, 25 insertions(+), 5 deletions(-)

[commit e05d4c4c08b2d515713e909cb9c5a30a7c9da153]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ethernet: Prefer memcmp() over bcmp()
Review: The commit replaces bcmp() with memcmp() for a slight performance gain, but there is no functional change and it is an internal optimization without user-visible impact.
Body:

  The link-level address and the mbuf shall not overlap. Prefer memcmp()
  over bcmp() for slight performance gain.

  No functional change intended.

  Reviewed by:	glebius
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D52345

  (cherry picked from commit 51098f0529f0d1cc532512e0eae9bfcffb8e68e4)


   sys/net/if_ethersubr.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3038122a7642e66514658fb6db7c6ab8b4fd3cfb]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: init_main: Remove the placeholder SYSINIT
Review: Removes an internal placeholder SYSINIT that had no user-visible effect.
Body:

  This was initially introduced to ensure there is at least one entry so
  that the sysinit_set symbol is not undefined. Well now that the kernel
  has plenty of SYSINITs and it is unlikely we will have a kernel without
  any SYSINITs in future, then this placeholder is not relevant anymore.

  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D47916

  (cherry picked from commit 7e38993247f5e82abd4c347079fd256e73a76a00)


   sys/kern/init_main.c | 7 -------
   1 file changed, 7 deletions(-)

[commit b2293f7f60c238e7a83551472aed9452cd017769]
Date: 2025-09-03
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: init_main: Fix logging the subsystem of pre-loaded kernel modules
Review: The commit fixes internal logging of pre-loaded kernel module subsystems, which is a minor internal change without user-visible impact.
Body:

  The pre-load, aka linker_preload() runs at the order of SI_SUB_KLD, but
  a pre-loaded module may have SYSINITs that have startup order prior to
  SI_SUB_KLD, e.g. TUNABLE_INT() / TUNABLE_LONG(), hence it is possible
  that we run into abnormal orders.

  Without this change, the subsystem of the pre-loaded kernel modules
  will be melted into previous one. That is mostly harmless but confusing.

  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D47904

  (cherry picked from commit 11f1dd193af57dfa5128eadc62b084502292a784)


   sys/kern/init_main.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 04741ceafa2c14b6352626e66b99d023a65be006]
Date: 2025-08-30
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Drivers.device
Subject: iflib: Set the get counter routine prior to attaching the interface
Review: The iflib driver framework now sets the get counter routine before attaching the interface, ensuring correct counter visibility for other threads such as ioctl threads.
Body:

  This ensures other threads, e.g. ioctl threads, see the correct counter
  routine once after the interface has been attached.

  This change partially reverts commit 23ac9029f96b, which for unclear
  reason moved setting the get counter routine after ether_ifattach().

  Reviewed by:	kbowling, kgalazka, #iflib
  Fixes:		23ac9029f96b Update iflib to support more NIC designs
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50712

  (cherry picked from commit ae7f8da8bf6ed0c4f0e9f0e95ae2b08abce54378)


   sys/net/iflib.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 8d6bc14c547472aafeddae65ae64024a24c5c5a7]
Date: 2025-08-30
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: iflib: Make iflib_register() return void
Review: The commit changes the return type of iflib_register() to void, which is an internal API change with no user-visible impact.
Body:

  It never fails since change [1]. No functional change intended.

  [1] aa3860851b9f net: Remove unneeded NULL check for the allocated ifnet

  Reviewed by:	kbowling, #iflib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50713

  (cherry picked from commit bb5135d0f2276e84b7abfcc481c92000647f68d4)


   sys/net/iflib.c | 11 +++--------
   1 file changed, 3 insertions(+), 8 deletions(-)

[commit b4c6c3db0379a5b3d34143325805cd7e68cf3d9a]
Date: 2025-09-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: ipfw: Teach ipfw that EtherIP is an upper layer protocol
Review: The ipfw firewall now allows EtherIP packets over IPv6 when net.inet6.ip6.fw.deny_unknown_exthdrs is enabled, preventing unintended discarding of these packets.
Body:

  so that we do not discard EtherIP packets ( over IPv6 network ) when
  net.inet6.ip6.fw.deny_unknown_exthdrs is set to 1 ( which is the default
  value ).

  PR:		227450
  Reviewed by:	ae, #network
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D52566

  (cherry picked from commit 0418e6690e91aa6c38dd9af9da43c4c5a9dc1cd2)
  (cherry picked from commit b1c96e54b906d0cdea0b5a9c74cc295803dfe50e)


   sys/netpfil/ipfw/ip_fw2.c | 7 +++++++
   1 file changed, 7 insertions(+)

[commit 52dbbe3f37ffda10751c3146b9ec0e11772fd5b6]
Date: 2025-09-01
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: bridge: Fix adding gif(4) interface assigned with IP addresses as bridge memeber
Review: The sysctl net.link.bridge.member_ifaddrs no longer affects IP address assignment on gif(4) interfaces that are bridge members, ensuring proper tunnel endpoint operation for EtherIP.
Body:

  and fix assigning IP addresses to the gif(4) interface when it is a
  member of a if_bridge(4) interface.

  When setting the sysctl net.link.bridge.member_ifaddrs to 1, if_bridge(4)
  can eliminate unnecessary walk of the member list to determine whether
  the inbound unicast packets are for us or not.

  Well when a gif(4) interface is member of a if_bridge(4) interface, it
  acts as the tunnel endpoint to tunnel Ethernet frames over IP network,
  aka the EtherIP protocol, so the IP addresses configured on it are
  independent of the if_bridge(4) interface or other if_bridge(4) members,
  hence the sysctl net.link.bridge.member_ifaddrs should not have any
  influnce over gif(4) interfaces's behavior of assigning IP addresses.

  PR:		227450
  Reported by:	Siva Mahadevan <me@svmhdvn.name>
  Reviewed by:	ivy, #bridge
  MFC after:	1 week
  Fixes:		0a1294f6c610 bridge: allow IP addresses on members to be disabled
  Differential Revision:	https://reviews.freebsd.org/D52200

  (cherry picked from commit 9764aa1ccad08a7ec53ed9b80741b9553f3fa4e6)


   sys/net/if_bridge.c | 6 +++---
   sys/netinet/in.c    | 4 ++--
   sys/netinet6/in6.c  | 4 ++--
   3 files changed, 7 insertions(+), 7 deletions(-)

[commit 5c6fae9d27dacf77c900e9b982d35a6095b22ec6]
Date: 2025-09-01
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: tests: bridge: Add regression test for gif(4) interface as bridge member
Review: The commit adds a regression test for bridge functionality but does not introduce any user-visible changes, new features, or configuration modifications.
Body:

  if_bridge(4) should not prohibit adding a gif(4) interface which is
  assigned with IP addresses as a bridge member regardless of the setting
  of sysctl variable net.link.bridge.member_ifaddrs.

  Assigning IP addresses on the gif(4) interface should not be affected
  no matter whether it is member of a bridge interface or not.

  PR:		227450
  Reported by:	Siva Mahadevan <me@svmhdvn.name>
  Reviewed by:	ivy (previous version)
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D52200

  (cherry picked from commit b944c8ff17971b1c8f61d5612eac146f5d589e87)


   tests/sys/net/if_bridge_test.sh | 19 +++++++++++++++++++
   1 file changed, 19 insertions(+)

[commit 1b42526ce9f4e4587f4179a7e78655ce34b95110]
Date: 2025-08-27
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Docs.manpages
Subject: gif.4: Mention that gif(4) can tunnel Ethernet traffic
Review: The man:gif[4] man page now mentions that gif(4) can tunnel Ethernet traffic and references if_bridge(4) for EtherIP setup examples.
Body:

  Ideally this manpage shall have examples for the EtherIP setup, but
  there has been one in if_bridge(4) since the introduction of EtherIP [1],
  so direct the setup to if_bridge(4) at this moment.

  While here, add RFC 3378 to the reference section.

  [1] 73ff045c575b Add RFC 3378 EtherIP support

  Reviewed by:	meta
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51781

  (cherry picked from commit bf6027df0955cb79c9c56c47cc96709b2215c82a)


   share/man/man4/gif.4 | 20 +++++++++++++++++++-
   1 file changed, 19 insertions(+), 1 deletion(-)

[commit aeb8f341ad20b5f49561fff688e8bee601b0e15a]
Date: 2025-08-08
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Network.general
Subject: EtherIP: Fix passing the address family from if_bridge(4) to gif(4)
Review: EtherIP tunneling over IPv4 or IPv6 now works correctly when the gif(4) interface is a member of a bridge. Previously, such configurations would produce incorrectly encapsulated packets.
Body:

  Given IPPROTO_IPV4, IPPROTO_IPV6 and IPPROTO_ETHERIP have different
  protocol numbers, then it is perfect valid to tunnel IPv4, IPv6 and
  Ethernet traffic over IPv[46] by the same interface. Since gif(4) has
  already utilized the inbound csum_data field to carry address family,
  also teach if_bridge(4) to do that, rather than checking if a gif(4)
  interface is member of a if_bridge(4) interface.

  Without this fix, tunnel IPv[46] over IPv[46] will not work when the
  gif(4) interface is member of a if_bridge(4) interface, aka the EtherIP
  setup, as the address family passed from gif_output() will be overwritten
  with the wrong one AF_LINK by gif_transmit(), and end up with incorrectly
  encapsulated packets.

  PR:		227450
  Reviewed by:	kp
  Tested by:	meta
  Fixes:		8a0308722372 gif(4): Assert that gif_output() isn't called for EtherIP
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51682

  (cherry picked from commit f4744b8acb932fbb3e48b71d31b7cd585566b668)


   sys/net/if_bridge.c |  6 ++++++
   sys/net/if_gif.c    | 10 +++-------
   2 files changed, 9 insertions(+), 7 deletions(-)

[commit e5f01421ddbfee935546271121e6254472dcc7f5]
Date: 2025-08-08
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: tests: gif(4): Add regression tests for setup with EtherIP
Review: Adds regression tests for gif(4) tunnel functionality when the interface is a member of an if_bridge(4) interface (EtherIP setup). This does not introduce user-visible changes; it only adds test coverage.
Body:

  Tunnel IPv[46] traffic over IPv[46] should still function when the
  gif(4) interface is member of a if_bridge(4) interface, aka the
  EtherIP setup.

  PR:		227450
  Reviewed by:	kp
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51682

  (cherry picked from commit 04d0dc4c0c65592a21225cff43f25e0a0da64eb9)


   tests/sys/net/if_gif.sh | 154 ++++++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 154 insertions(+)

[commit 3152a2f5dd0447daba80466f70c66ea794400015]
Date: 2025-09-19
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: ConnectWise
Section: Storage.general
Subject: fusefs: fix a kernel panic regarding SCM_RIGHTS
Review: Fusefs now handles VOP_CLOSE calls without thread context, preventing a kernel panic when the last open file copy resides in a Unix-domain socket buffer.
Body:

  If the last copy of an open file resides within the socket buffer of a
  unix-domain socket, then VOP_CLOSE will be called with no thread
  information.  Fix fusefs to handle that case, and add a regression test.

  Also add a test case for writes to a file that lies within a sockbuf.
  Along with close, a write from the writeback cache is the only other
  operation I can think of that might apply to a file residing in a
  sockbuf.

  PR:		289686
  Reported by:	iron.udjin@gmail.com
  Sponsored by:	ConnectWise
  Reviewed by:	glebius, markj
  Differential Revision: https://reviews.freebsd.org/D52625

  (cherry picked from commit e043af9ca59608309cac2fd222c17f989ba0d35e)


   sys/fs/fuse/fuse_vnops.c       | 10 ++++--
   tests/sys/fs/fusefs/release.cc | 54 +++++++++++++++++++++++++++++++
   tests/sys/fs/fusefs/write.cc   | 73 ++++++++++++++++++++++++++++++++++++++++++
   3 files changed, 134 insertions(+), 3 deletions(-)

[commit 7dc691b703537113c686add53e2789566c8ab9e6]
Date: 2025-09-14
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: fusefs: fix the last_local_modify LLM/LastLocalModify.lookup/3 test
Review: The commit fixes a test case for fusefs but does not introduce any user-visible changes, only internal test corrections.
Body:

  The LastLocalModify tests were originally written to simulate a race
  condition between VOP_SETATTR and VOP_LOOKUP.  They were later extended
  to cover some other VOPs that can affect file size, including VOP_WRITE.
  However, the test never correctly simulated the race with VOP_WRITE.  So
  that test only ever passed by accident.  Fix it by always opening the
  file with O_DIRECT.

  PR:		289237
  Reported by:	Siva Mahadevan <me@svmhdvn.name>

  (cherry picked from commit d1eaa52d10f9b85e5f6358e1a280899b9d55dd07)


   tests/sys/fs/fusefs/last_local_modify.cc | 12 ++++++++++--
   1 file changed, 10 insertions(+), 2 deletions(-)

[commit a16c01f71fd513fec4bc76a572c5b15f3b2369df]
Date: 2025-06-11
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: ConnectWise
Section: Storage.general
Subject: fusefs: don't fake the mountpoint's stat info before FUSE_INIT completes
Review: The man:fuse_vnop_getattr[9] behavior for the mountpoint before FUSE_INIT completion changes. It no longer returns zeros, instead waiting for the daemon to be ready, which may affect scripts or tools that stat the mountpoint early.
Body:

  Ever since the first GSoC contribution, fusefs has had a curious
  behavior.  If the daemon hasn't finished responding to FUSE_INIT,
  fuse_vnop_getattr would reply to VOP_GETATTR requests for the mountpoint
  by returning all zeros.  I don't know why.  It isn't necessary for
  unmounting, even if the daemon is dead.

  Delete that behavior.  Now VOP_GETATTR for the mountpoint will wait for
  the daemon to be ready, just like it will for any other vnode.

  Reported by:	Vassili Tchersky
  Sponsored by:	ConnectWise
  Differential Revision: https://reviews.freebsd.org/D50800

  (cherry picked from commit 9e682c426093a3afc0f609a1f04048b0beb021ec)


   sys/fs/fuse/fuse_vnops.c        | 34 ++++++-------------
   tests/sys/fs/fusefs/pre-init.cc | 72 +++++++++++++++++++++++++++++++++++++++++
   2 files changed, 81 insertions(+), 25 deletions(-)

[commit 4171bf5905a95b8fcfd3bb6bb6ede2fe543db092]
Date: 2025-05-02
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: ConnectWise
Section: Userland.programs
Subject: zfsd: don't try to fix an OFFLINE condition
Review: The man:zfsd(8) daemon no longer attempts to automatically online a disk that was manually taken offline with man:zpool(8) offline, and does not activate a hotspare to replace it. This preserves the administrator's intent when a disk is intentionally taken offline.
Body:

  If the system administrator does "zpool offline", he's doing it for a
  reason.  zfsd shouldn't consider an offline disk to be an event that
  requires automatic healing.  Don't online it in response to a GEOM
  event, and don't try to activate a hotspare to take over from it.

  Sponsored by:	ConnectWise

  (cherry picked from commit a13ddd6210f349dec341eba0506b5f2395a7a2d6)


   cddl/usr.sbin/zfsd/case_file.cc                    | 18 +++++-
   cddl/usr.sbin/zfsd/zfsd_event.cc                   |  7 +++
   tests/sys/cddl/zfs/tests/zfsd/Makefile             |  2 +
   .../cddl/zfs/tests/zfsd/zfsd_offline_001_neg.ksh   | 64 +++++++++++++++++++++
   .../cddl/zfs/tests/zfsd/zfsd_offline_002_neg.ksh   | 66 ++++++++++++++++++++++
   tests/sys/cddl/zfs/tests/zfsd/zfsd_test.sh         | 60 ++++++++++++++++++++
   6 files changed, 215 insertions(+), 2 deletions(-)

[commit 3c69315911babfa4e71c8cb53c601a22f6aa6bb1]
Date: 2025-07-22
Score: 5
Status: proposed(include=no,score=5)
Sponsor: ConnectWise
Section: undecided
Subject: mac_bsdextended: report that all tests require the kernel module
Review: The commit updates test infrastructure to report kernel module dependencies but does not introduce any user-visible changes in functionality, configuration, or behavior.
Body:

  Use the standard required_kmods reporting mechanism to notify Kyua of
  which kernel modules are required.

  Sponsored by:	ConnectWise
  Reviewed by:	Siva Mahadevan <me@svmhdvn.name>
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1783

  (cherry picked from commit 2a08ae16555ea60c5a1d6f1c9966ea233af405be)


   tests/sys/mac/bsdextended/Makefile        | 1 +
   tests/sys/mac/bsdextended/matches_test.sh | 3 ---
   2 files changed, 1 insertion(+), 3 deletions(-)

[commit e1deeea6c1737d26c9160d1112138137292082e5]
Date: 2025-07-22
Score: 5
Status: proposed(include=no,score=5)
Sponsor: ConnectWise
Section: undecided
Subject: ctladm: Use require.kmods for cfiscsi
Review: The commit changes test infrastructure to use a standard method for loading kernel modules, which does not affect user-visible behavior or functionality.
Body:

  Use the standard require.kmods ATF variable instead of ad-hoc code to
  load the cfiscsi kernel module.

  Sponsored by:	ConnectWise
  Reviewed by:	imp, Siva Mahadevan <me@svmhdvn.name>
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1784

  (cherry picked from commit 863dc799f74306e18625e29a7522c2fe72533a89)


   usr.sbin/ctladm/tests/port.sh | 16 +++++-----------
   1 file changed, 5 insertions(+), 11 deletions(-)

[commit 872d4fb51ef4d885302a0802101964787e02c2b5]
Date: 2025-06-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix
Section: undecided
Subject: ctladm: skip the tests if ctladm is missing
Review: The commit modifies a test script to skip tests when ctladm is missing, which is an internal test infrastructure change with no user-visible impact.
Body:

  Reviewed by:	asomers
  Sponsored by:	Netflix
  Differential Revision:	https://reviews.freebsd.org/D51081

  (cherry picked from commit 582f787e2a5c3114819dfaa4611cb4762716f0a1)


   usr.sbin/ctladm/tests/port.sh | 11 +++++++++++
   1 file changed, 11 insertions(+)

[commit e39e892969cb18531fbfa152795c96e1f7da1f08]
Date: 2025-07-22
Score: 5
Status: proposed(include=no,score=1)
Sponsor: ConnectWise
Section: undecided
Subject: ctl: delete dead code in the tests
Review: The commit removes dead test code with no user-visible impact.
Body:

  This function has always been dead.  It isn't needed, since ctladm will
  automatically load the module, if needed.

  Sponsored by:	ConnectWise

  (cherry picked from commit d3c9f62862e4e76acec581a2e2c0aa05d7145e24)


   tests/sys/cam/ctl/ctl.subr | 9 ---------
   1 file changed, 9 deletions(-)

[commit 931274f70d082b13e62f61eb51d78694946e4e5f]
Date: 2025-07-22
Score: 5
Status: proposed(include=no,score=5)
Sponsor: ConnectWise
Section: undecided
Subject: fusefs: report that all tests require the fusefs kernel module
Review: The commit only changes test infrastructure to properly report test dependencies to Kyua. There is no user-visible change in functionality, behavior, or configuration.
Body:

  Previously the googletest tests would skip themselves if /dev/fuse could
  not be found.  But that information would not be passed to Kyua.
  Instead it would think that they had passed.  Also, the atf-sh test
  would previously fail if the fusefs module weren't loaded.  Now both
  tests will correctly report their requirements to Kyua.

  Note that fusefs's googletest tests still require that the
  mac_bsdextended(4) module _not_ be loaded, but Kyua has no way to report
  such a requirement.

  Sponsored by:	ConnectWise
  Reviewed by:	Siva Mahadevan <me@svmhdvn.name>
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1782

  (cherry picked from commit 2662fd6a487bb505cf1667e4cc3436b36f7e9d4e)


   tests/sys/fs/fusefs/Makefile | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 8b66d677a99be46ddd3b0698e6727f65e8efee7e]
Date: 2024-10-03
Score: 5
Status: proposed(include=no,score=30)
Sponsor: ConnectWise
Section: undecided
Subject: ctl: add ATF tests for SCSI PERSISTENT RESERVE IN/OUT
Review: Adds ATF tests for SCSI PERSISTENT RESERVE IN/OUT commands, which helps verify functionality and includes a regression test for security issue HYP-08.
Body:

  These commands are complicated, and the test suite isn't complete.  But
  it's a start.  And it includes a regression test for HYP-08
  (commit 64b0f52be2c9d7bcecebfeef393f8ec56cb85f47).

  Security:	HYP-08
  Sponsored by:	ConnectWise
  Differential Revision: https://reviews.freebsd.org/D46947

  (cherry picked from commit ece617cda6b5999e6e57c2227f98c18c1ca1d79d)


   tests/sys/cam/ctl/Makefile                  |   6 +
   tests/sys/cam/ctl/persist.sh                | 349 ++++++++++++++++++++++++++++
   tests/sys/cam/ctl/prout_register_huge_cdb.c |  88 +++++++
   3 files changed, 443 insertions(+)

[commit 9c4e33eb359f9fe3f2795d2f29464a616436133e]
Date: 2025-09-13
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: cron: Fix comment from "root's" to "system" crontab
Review: Comment-only change; no user-visible impact.
Body:

  It is referred to in the documentation as the system crontab, not root's
  crontab.

  PR:		289099
  Reviewed by:	emaste
  Approved by:	emaste (mentor)
  Fixes:	d33daab9348a ("Call /etc/crontab the "system crontab", not "root's crontab".  While here, fix some other wording issues")
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D52503

  (cherry picked from commit c806defe8fee62c4738f46e555d69b085e8d1259)


   usr.sbin/cron/cron/crontab | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4010352306ef73b6d5b3c2f652dac346f035e481]
Date: 2025-09-23
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp lro: remove redundant check
Review: Removes a redundant check in the TCP Large Receive Offload (LRO) implementation, which is an internal optimization with no direct user-visible impact.
Body:

  Remove a check which is also done in tcp_lro_rx_common().

  Reviewed by:		gallatin
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52683

  (cherry picked from commit 43bbecaeb95fe5ea1d7acffab4f2874247ba6915)


   sys/netinet/tcp_lro.c | 11 -----------
   1 file changed, 11 deletions(-)

[commit 3f87b632ed047d70f93ca21d481a709529763f2f]
Date: 2025-09-23
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: fix sending of RST segments
Review: The TCP stack now considers endpoint parameters when sending RST segments, which can affect network behavior and reliability.
Body:

  Take endpoint parameters into account when available.

  Fixes:		463b5aed0d62 ("tcp: retire rstreason")
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit ab17974c12033c6ff3bae27458efcd13584438ba)


   sys/netinet/tcp_input.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e26928669f39c8683aea74040b9e2472e944c43a]
Date: 2025-09-22
Score: 5
Status: added(include=yes,score=85)
Sponsor: https://www.patreon.com/cperciva
Section: Userland.programs
Subject: freebsd-update: Library ordering
Review: The freebsd-update utility now installs shared libraries in a specific order (libsys, libc, libthr, then others) to prevent failures during upgrades from 14.x to 15.x.
Body:

  Upgrading from 14.x to 15.x with freebsd-update broke because libc
  depends on the new libsys library; freebsd-update installed the new
  libc before creating libsys, and every step after that failed because
  all the tools (including gunzip and install) are dynamically linked
  and need a working libc.

  Enforce ordering when installing shared objects: First libsys, then
  libc, then libthr, and then all the rest of the shared object files.

  This is a candidate for an Errata Notice since the issue this fixes
  breaks upgrades.

  PR:		289769
  Reported by:	Graham Perrin
  Reviewed by:	kib
  MFC after:	3 days
  Sponsored by:	https://www.patreon.com/cperciva
  Differential Revision:	https://reviews.freebsd.org/D52688

  (cherry picked from commit 7ece602e00e85195fc426a2401c49921cd39735e)


   usr.sbin/freebsd-update/freebsd-update.sh | 20 +++++++++++++++++++-
   1 file changed, 19 insertions(+), 1 deletion(-)

[commit 8f7dded412516d35e538ed05524d2a14870e62b0]
Date: 2025-07-15
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: bsdinstall: fix vfs.zfs.vdev.min_auto_ashift oid
Review: The bsdinstall ZFS configuration script now correctly references the vfs.zfs.vdev.min_auto_ashift sysctl, ensuring proper ashift values are set during ZFS pool creation in the installer.
Body:

  Signed-off-by: Siva Mahadevan <me@svmhdvn.name>
  PR: 266374
  Pull request: https://github.com/freebsd/freebsd-src/pull/1851
  Reviewed by: emaste
  Sponsored by: The FreeBSD Foundation

  (cherry picked from commit 87a7b35f04b60956e9aa192680ae80773ec38f14)
  (cherry picked from commit 093f3f26e95198bf1db082763e915d7a53c6ba82)


   usr.sbin/bsdinstall/scripts/zfsboot | 10 +++++-----
   1 file changed, 5 insertions(+), 5 deletions(-)

[commit 9f94939b73f56fa7f7e53acbd260cad3cfcf91ef]
Date: 2025-03-27
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: Bump .Dd for recently changed aio_*(2) manpages
Review: Updates the date in the man:page[2] entries for aio_read, aio_waitcomplete, and aio_write to reflect recent changes.
Body:

  The ones that were effectively unchanged from
  d97e44784bb5a^..e24279e0f9e did not have `.Dd` bumped. Only
  the ones that had a net content change between those
  revisions.

  MFC after:	2 weeks
  MFC with:	d97e44784bb5a e24279e0f9e

  (cherry picked from commit 1b37af092211f9947d9f089f452232b791b9eafc)


   lib/libc/sys/aio_read.2         | 2 +-
   lib/libc/sys/aio_waitcomplete.2 | 2 +-
   lib/libc/sys/aio_write.2        | 2 +-
   3 files changed, 3 insertions(+), 3 deletions(-)

[commit e4b1597b428c8cfa555c7f0753f3b5f073169fcf]
Date: 2025-03-27
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: Remove mentions of ENOSYS added in d97e44784bb5
Review: The commit removes mentions of ENOSYS from man:aiocancel[2], man:aioerror[2], man:aiofsync[2], man:aiomlock[2], man:aioread[2], man:aioreturn[2], man:aiosuspend[2], man:aiowaitcomplete[2], and man:aiowrite[2] because aio(4) is now a hard kernel requirement, making the ENOSYS error scenario impossible.
Body:

  aio(4) is a hard requirement in the kernel as of f3215338ef82. The
  scenario that the patch was submitted for is no longer possible.

  This isn't a straight up revert since the previous change also addressed
  some minor issues.

  PR:		190942
  Reported by:	asomers
  MFC after:	2 weeks
  MFC with:	d97e44784bb5
  Fixes:		d97e44784bb5 ("aio_*(2): mention ENOSYS under ERRORS")
  Differential Revision: https://reviews.freebsd.org/D49541

  (cherry picked from commit e24279e0f9e28ba0c1920cb539fc357568790c0a)


   lib/libc/sys/aio_cancel.2       | 7 -------
   lib/libc/sys/aio_error.2        | 7 -------
   lib/libc/sys/aio_fsync.2        | 7 -------
   lib/libc/sys/aio_mlock.2        | 7 -------
   lib/libc/sys/aio_read.2         | 7 -------
   lib/libc/sys/aio_return.2       | 7 -------
   lib/libc/sys/aio_suspend.2      | 7 -------
   lib/libc/sys/aio_waitcomplete.2 | 7 -------
   lib/libc/sys/aio_write.2        | 7 -------
   9 files changed, 63 deletions(-)

[commit 9620fa7091a27f4c903aaee7d119a1f2d52926fa]
Date: 2025-03-25
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: aio_*(2): mention ENOSYS under ERRORS
Review: The man:pages for aio_*(2) system calls now document ENOSYS when the aio(4) kernel module is not loaded, clarifying a possible error scenario for users.
Body:

  ENOSYS can occur if aio(4) is not loaded in the kernel. Document this
  behavior so consumers on FreeBSD can better understand that this is a
  possible scenario.

  Clean up the manpages slightly while here:
  - Sort `ERRORS` by errno(3).
  - Use `.Fx` instead of `FreeBSD`.

  MFC after:	2 weeks
  Reviewed by:	ziaee
  PR:		190942
  Differential Revision: https://reviews.freebsd.org/D49502

  (cherry picked from commit d97e44784bb5a510b7af7593c86cfbcff73855c4)


   lib/libc/sys/aio_cancel.2       |  7 +++++++
   lib/libc/sys/aio_error.2        |  7 +++++++
   lib/libc/sys/aio_fsync.2        |  7 +++++++
   lib/libc/sys/aio_mlock.2        |  7 +++++++
   lib/libc/sys/aio_read.2         | 11 ++++++++++-
   lib/libc/sys/aio_return.2       |  7 +++++++
   lib/libc/sys/aio_suspend.2      |  7 +++++++
   lib/libc/sys/aio_waitcomplete.2 | 11 +++++++++--
   lib/libc/sys/aio_write.2        | 11 ++++++++++-
   9 files changed, 71 insertions(+), 4 deletions(-)

[commit fcc00aaba41cd28606eb166ee281cd57bd2ce0b8]
Date: 2025-08-18
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: Makefile.inc1: garbage collect unused variable: install-info
Review: No user-visible changes; internal build system cleanup.
Body:

  The variable's definition was removed with texinfo in
  2d2813618c3818d7d41a7ced1fca4a1a01d3591d, but the reference to the
  variable was left behind.

  This is effectively a no-op cleanup.

  MFC after:	3 days

  (cherry picked from commit de3e5dbea171f576e9e6d89ea5238ea3c9c8b26a)


   Makefile.inc1 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d0efd64479ed55c74bfa55c1ed23c13d732ee27a]
Date: 2022-03-17
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Beckhoff Automation GmbH & Co. KG
Section: Hardware.virtualization
Subject: bhyve: assign a valid INTPIN to NVIDIA GPUs
Review: bhyve now assigns a valid INTPIN to NVIDIA GPUs passed through to virtual machines, allowing NVIDIA GPU drivers in Linux guests to detect and use the hardware.
Body:

  When passing an NVIDIA GPU to a Linux VM, the GPU driver refuses to work and
  complains about a missing IRQ:

  [ 77.208984] NVRM: Can't find an IRQ for your NVIDIA card!
  [ 77.212697] NVRM: Please check your BIOS settings.
  [ 77.212699] NVRM: [Plug & Play OS] should be set to NO
  [ 77.212700] NVRM: [Assign IRQ to VGA] should be set to YES
  [ 77.212702] nvidia: probe of 0000:00:07.0 failed with error -1

  By setting a valid INTPIN in the PCI config space those error messages
  disappear. Additionally, tools like nvidia-smi are able to detect the GPU and
  the GPU driver seems to work properly.

  Note that bhyve still doesn't support legacy interrupts. So, the guest
  shouldn't try to use it even though we're assigning an INTPIN.

  Reviewed by:		jhb
  Tested by:		chuck
  MFC after:		1 week
  Sponsored by:		Beckhoff Automation GmbH & Co. KG
  Differential Revision:	https://reviews.freebsd.org/D51892

  (cherry picked from commit effcd0ded0ef1c92bef29c1e9bbf517c97bb45b8)


   usr.sbin/bhyve/Makefile              |  1 +
   usr.sbin/bhyve/pci_passthru_quirks.c | 48 ++++++++++++++++++++++++++++++++++++
   2 files changed, 49 insertions(+)

[commit d13a8d09338d1825a3ae16e8e50f4686e88acbc4]
Date: 2025-09-08
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: man: Fix usage message
Review: Fixes a usage message in man:man[1] after the addition of the -l option.
Body:

  PR:		289245
  Fixes:		14b61b2e9317 ("man: Add -l option")
  (cherry picked from commit dc38cf116c820df0be341ec5e359de0012b2d58a)


   usr.bin/man/man.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d1e926d8985f17e07f121b278a2e340ce237e18b]
Date: 2025-08-16
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.contrib
Subject: kyua: Improve required_kmods metadata
Review: The kyua testing framework's required_kmods metadata is made platform-agnostic and now reports all non-loaded kernel modules instead of just the first. The man:kyuafile[5] manual page is updated.
Body:

  - Make it platform agnostic
  - Separate FreeBSD related code
  - Fix tests
  - Make it report all non-loaded modules instead of the first occurrence
    only
  - Update kyuafile.5 man page

  Reviewed by:	ngie
  MFC after:	2 weeks
  Pull Request:	https://github.com/freebsd/kyua/pull/270

  (cherry picked from commit 939fec44a79323ba06cf0ad60d4b69300a8abbc6)


   contrib/kyua/doc/kyuafile.5.in                    | 10 ++++
   contrib/kyua/drivers/report_junit_test.cpp        |  3 ++
   contrib/kyua/engine/atf_list.cpp                  |  2 -
   contrib/kyua/engine/requirements.cpp              | 57 +++++++++++------------
   contrib/kyua/engine/requirements.hpp              | 26 +++++++++++
   contrib/kyua/integration/cmd_report_junit_test.sh |  4 ++
   contrib/kyua/integration/cmd_report_test.sh       |  1 +
   contrib/kyua/model/metadata.cpp                   | 16 +++----
   contrib/kyua/model/metadata.hpp                   |  4 --
   contrib/kyua/model/metadata_test.cpp              |  6 ++-
   contrib/kyua/model/test_case_test.cpp             |  2 +-
   contrib/kyua/model/test_program_test.cpp          |  8 ++--
   contrib/kyua/os/freebsd/main.cpp                  | 11 +++++
   contrib/kyua/os/freebsd/reqs_checker_kmods.cpp    | 50 ++++++++++++++++++++
   contrib/kyua/os/freebsd/reqs_checker_kmods.hpp    | 54 +++++++++++++++++++++
   usr.bin/kyua/Makefile                             |  3 +-
   16 files changed, 203 insertions(+), 54 deletions(-)

[commit 13cf806828e27753c76479337ef138762ae8ae89]
Date: 2025-06-06
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: atf-c(3): fill in prototypes for functions
Review: The commit adds function prototypes to the atf-c(3) man page, which improves documentation for developers using the ATF C library.
Body:

  This change fills in prototypes for functions exposed by atf-c(3) to aid
  the programmer with using the APIs with the library.

  MFC after:	2 weeks
  Differential Revision: https://reviews.freebsd.org/D50734

  (cherry picked from commit a14573de29deda5b86b4458901aa5a0a9bf84375)


   contrib/atf/atf-c/atf-c.3 | 111 ++++++++++++++++++++++++++++++++++++++--------
   1 file changed, 92 insertions(+), 19 deletions(-)

[commit af3e311a27341a567624dbae3ad84b65ec066858]
Date: 2025-05-31
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.contrib
Subject: atf, kyua: Implement require.kmods.
Review: Adds a require.kmods metadata variable to ATF and Kyua, allowing tests to specify required kernel modules. Tests that require unavailable kernel modules are skipped.
Body:

  This adds a metadata variable, require.kmods, and corresponding functions
  or methods in C, C++, and shell, which allow a test to specify that it
  requires particular kernel modules to run.  If the kernel modules are not
  present, the test is skipped.  One might want to consider a kyua option
  which makes it attempt to load the modules instead.

  Differential Revision:	https://reviews.freebsd.org/D47470

  (cherry picked from commit 83a1ee578c9d1ab7013e997289c7cd470c0e6902)


   contrib/atf/atf-c++/atf-c++.3        | 10 +++++-
   contrib/atf/atf-c++/tests.cpp        |  7 +++++
   contrib/atf/atf-c++/tests.hpp        |  1 +
   contrib/atf/atf-c/atf-c.3            | 14 ++++++++-
   contrib/atf/atf-c/tc.c               | 61 ++++++++++++++++++++++++++++++++++++
   contrib/atf/atf-c/tc.h               |  3 ++
   contrib/atf/atf-sh/atf-sh.3          | 13 +++++++-
   contrib/atf/atf-sh/libatf-sh.subr    | 12 +++++++
   contrib/atf/doc/atf-test-case.4      | 10 +++++-
   contrib/kyua/engine/atf_list.cpp     |  4 +++
   contrib/kyua/engine/requirements.cpp | 30 ++++++++++++++++++
   contrib/kyua/model/metadata.cpp      | 22 +++++++++++++
   contrib/kyua/model/metadata.hpp      |  6 ++++
   lib/atf/libatf-c/Makefile            |  2 ++
   libexec/atf/atf-sh/Makefile          |  1 +
   tests/sys/fs/tarfs/tarfs_test.sh     | 18 ++++++++++-
   tests/sys/net/if_wg.sh               | 15 +++------
   usr.bin/kyua/Makefile                |  2 +-
   18 files changed, 214 insertions(+), 17 deletions(-)

[commit 4e0d2f1566b3b588908a098c3ee672a202978a15]
Date: 2025-09-16
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: vm/vm_fault.c: update and split comments for vm_fault() and vm_fault_trap()
Review: The commit updates and splits comments for internal kernel functions without any user-visible changes.
Body:

  (cherry picked from commit 22cce201da76a1916be5c993201f0478f3048292)


   sys/vm/vm_fault.c | 42 ++++++++++++++++++++++++++++++------------
   1 file changed, 30 insertions(+), 12 deletions(-)

[commit bf2391ee2ef274dd24b27a67c0a850b1d6cc2df9]
Date: 2025-09-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Kernel.general
Subject: tcp: improve compilation of cc and their helper modules
Review: The kernel now compiles congestion control modules CDG, CHD, HD, and vegas for IPv6-only kernel configurations. The h_ertt helper module is only compiled when one of these congestion control modules is also compiled. TCP TSO is performed whenever possible unless one of these congestion control modules is loaded or compiled into the kernel.
Body:

  * Allow the congestion control modules CDG, CHD, HD, and vegas also
    to be compiled into the kernel for IPv6 only kernel configs.
  * Compile the helper module h_ertt for round trip time estimation only
    into the kernel, if one of the congestion control module using it
    (one of CDG, CDH, HD, or vegas) is also compiled into the kernel.
  Please note the second point implies that TCP TSO is done whenever
  possible as long as none of the congestion control modules CDG, CHD,
  HD, or vegas is loaded or compiled into the kernel.

  Reviewed by:		cc
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52547

  (cherry picked from commit 1bb72d3d6eee50232b6d6acbc201f9aaac93e2b5)


   sys/conf/files | 18 +++++++++++++-----
   1 file changed, 13 insertions(+), 5 deletions(-)

[commit e1401a283d101acd94d14d769a0a2d80c34a65dc]
Date: 2025-09-15
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: ifconfig: Enter jail as soon as possible
Review: The man:ifconfig[8] command now attaches to a jail immediately when the -j option is encountered, which changes the behavior of certain option combinations such as -g and -j. This may affect scripts that rely on the previous order of processing.
Body:

  Some options (in particular, -g) are processed immediately upon being
  parsed.  This will produce the wrong result in combination with -j since
  we only attach to the jail after we're done parsing arguments.  Solve
  this by attaching to the jail immediately when -j is encountered.  The
  downside is that e.g. `ifconfig -j foo -j bar` would previously attach
  to jail bar, whereas now it will attempt to attach to jail foo, and
  if successful, attempt to attach to jail bar within jail foo.  This
  may be considered a feature.

  PR:		289134
  MFC after:	1 week
  Reviewed by:	zlei
  Differential Revision:	https://reviews.freebsd.org/D52501

  (cherry picked from commit 18fd1443d205aed6be22966125a4820f77571948)


   sbin/ifconfig/ifconfig.8 | 42 +++++++++++++++++++++---------------------
   sbin/ifconfig/ifconfig.c | 22 ++++++++--------------
   sbin/ifconfig/ifconfig.h |  1 -
   3 files changed, 29 insertions(+), 36 deletions(-)

[commit ea4e916858ef29a29236b292c188d83eac5e1ebc]
Date: 2025-09-06
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: iommu_get_requester(): make it more resilient against arbitrary dev arg
Review: The iommu_get_requester() function is made more resilient against arbitrary device arguments, improving stability in IOMMU and busdma operations.
Body:

  PR:	289318

  (cherry picked from commit c745a6818bcbf33cf7f59641c925d19b3f98cea8)


   sys/dev/iommu/busdma_iommu.c  | 54 ++++++++++++++++++++++++++++++++-----------
   sys/dev/iommu/iommu.h         |  2 +-
   sys/kern/subr_bus.c           | 13 +++++++++--
   sys/x86/iommu/amd_intrmap.c   | 14 ++++++++---
   sys/x86/iommu/intel_intrmap.c |  8 +++++--
   5 files changed, 70 insertions(+), 21 deletions(-)

[commit bd49a8db47dd3a825a48f4dcf1c8684675a502c2]
Date: 2025-09-19
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: Revert "zfsctl_root_readdir: if there were no dirents to copy out, return EINVAL"
Review: The revert restores the previous behavior where reading an empty directory in ZFS returns success instead of an error, preventing potential userland issues with utilities expecting standard readdir semantics.
Body:

  (cherry picked from commit 72924ce99c7f177db486bd2764a76bcf25892a17)


   .../openzfs/module/os/freebsd/zfs/zfs_ctldir.c     | 40 ++++++++--------------
   1 file changed, 14 insertions(+), 26 deletions(-)

[commit 5367bef138862b21f937a66b5647f8f81e6f2ab7]
Date: 2025-09-19
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: Revert "zfs readdir: if there were no dirents to copy out, return EINVAL same as UFS"
Review: The change reverts a previous modification to the ZFS readdir behavior, restoring compatibility with UFS by not returning EINVAL when no directory entries are available. This affects applications that rely on consistent error handling across filesystems.
Body:

  PR:	289485, 289678

  (cherry picked from commit 932e404f12c172e3d4ec47dedee02da400ef8f92)


   sys/contrib/openzfs/module/os/freebsd/zfs/zfs_vnops_os.c | 4 +---
   1 file changed, 1 insertion(+), 3 deletions(-)

[commit a24fa22bf03c78f7b2d78990d27663af29d6ba36]
Date: 2025-09-07
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: share/mk: Fix a heuristic in bsd.cpu.mk
Review: The commit fixes a cross-build issue from macOS where MACHINE_ABI detection incorrectly inferred 32-bit long, causing openssl build failures. This affects users cross-building from macOS on ARM64 systems.
Body:

  When cross-building from MacOS we have MACHINE=arm64 MACHINE_ARCH=arm,
  so bsd.cpu.mk infers that sizeof(long) == 4, but of course it isn't.
  This breaks the bootstrap build of openssl, which tests
  MACHINE_ABI:Mlong64 to decide whether to build ecp_nistp224.c.  It
  doesn't, and crypto/openssl/freebsd/include/openssl/configuration.h
  undefines OPENSSL_NO_EC_NISTP_64_GCC_128, so we end up with a link
  error.

  Reviewed by:	ngie, emaste
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D52340

  (cherry picked from commit 4341f92251ae00c3f82904623bfd561bb8ea49fb)


   share/mk/bsd.cpu.mk | 7 +++++--
   1 file changed, 5 insertions(+), 2 deletions(-)

[commit 7e8473273f0254f381871f56cb1792dac5b6269e]
Date: 2025-09-03
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Hardware.virtualization
Subject: bhyve: insert VM name to the VNC screen title
Review: The VNC screen title for bhyve virtual machines now includes the VM name, making it easier to identify virtual machines in VNC viewers.
Body:

  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D52329

  (cherry picked from commit 0e7f8abb45263c780a4b448fb52af6b6a3cbc9fd)


   usr.sbin/bhyve/rfb.c | 19 +++++++++++++++----
   1 file changed, 15 insertions(+), 4 deletions(-)

[commit 20bb3d7d500bae255d0c52ebacb32502616f490d]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: bnxt: Fix the request length in bnxt_hwrm_func_backing_store_cfg()
Review: The bnxt(4) driver fixes a hardware request length issue that could affect functionality with certain Broadcom network adapters.
Body:

  PR:		286720
  Reviewed by:	zlei
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50491

  (cherry picked from commit 5ca390f03bc63bccc8952313d536fd4bcabf2cab)


   sys/dev/bnxt/bnxt_en/bnxt_hwrm.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 009317e7dab9f202a6c45e76d1949efc7afb4f81]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=35)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: undecided
Subject: share/sendmail: Use consistent ordering when processing files
Review: The commit ensures consistent ordering of files processed by sendmail-related scripts, leading to reproducible filesystem images when using 'make installworld -DNO_ROOT'.
Body:

  Otherwise files are handled in the order returned by find(1).  This
  in turn results in inconsistent ordering of files in the METALOG mtree
  file produced by "make installworld -DNO_ROOT", which results in
  non-reproducible filesystem images.

  Reviewed by:	gshapiro, emaste
  MFC after:	2 weeks
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52349

  (cherry picked from commit 65688fcb79eee1711fa2a83bee4bd2cd0b851d19)


   share/sendmail/Makefile | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit c118367125483b68d862d4914e5130a8318bcd97]
Date: 2025-09-09
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: Ports.packaging
Subject: release: Remove a duplicate package listing in oracle.conf
Review: Removes a duplicate package listing in the Oracle cloud image configuration, preventing potential conflicts or redundant installations.
Body:

  sysutils/panicmail is specified again several lines down.

  MFC after:	1 week
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.

  (cherry picked from commit cc6e21cb946337e2b4584dd2b55209d45805fec2)


   release/tools/oracle.conf | 1 -
   1 file changed, 1 deletion(-)

[commit 3f63d59e38cd643b8aedf37e706c50fe7fa494b3]
Date: 2025-08-30
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: vnode: Assert that VOP_LOCK succeeds in freevnode()
Review: The commit adds an assertion that VOP_LOCK succeeds in freevnode(), which is an internal kernel consistency check with no direct user-visible impact.
Body:

  Reviewed by:	kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D52245

  (cherry picked from commit a7aac8c20497d1666a15f160ef99acddd55a1365)


   sys/kern/vfs_subr.c | 8 +++++++-
   1 file changed, 7 insertions(+), 1 deletion(-)

[commit c3a8da8f6828979f53a54ec1da9d3ee28feeb95b]
Date: 2025-08-22
Score: 5
Status: proposed(include=no,score=15)
Sponsor: Klara, Inc. | The FreeBSD Foundation
Section: undecided
Subject: vdso: Build without debug info
Review: The vDSO (virtual dynamic shared object) is built without debug information, improving build reproducibility by avoiding embedded build paths.
Body:

  The debug info is not very useful and embeds build paths because
  elf-vdso.so.o is built without CFLAGS, breaking reproducibility of
  elf-vdso.so.o and thus the kernel.  Just stop passing debug flags to
  amd64_vdso.sh.

  Reviewed by:	kib
  MFC after:	2 weeks
  Sponsored by:	Klara, Inc.
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D52129

  (cherry picked from commit b7e0373acb1d022e9e5acb5be9727def5f941194)


   sys/conf/files.amd64         | 4 ++--
   sys/tools/amd64_ia32_vdso.sh | 2 +-
   sys/tools/amd64_vdso.sh      | 2 +-
   3 files changed, 4 insertions(+), 4 deletions(-)

[commit d93223f34beeb0f57a8bc67fdb9870899934eea8]
Date: 2025-08-19
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: random: Make random_source definitions const
Review: The commit makes internal random source definitions read-only without any functional change or user-visible impact.
Body:

  We can do so trivially, so make these tables read-only.  No functional
  change intended.

  Reviewed by:	cem, emaste
  MFC after:	2 weeks
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52003

  (cherry picked from commit d5f55356a2fbf8222fb236fe509821e12f1ea456)


   sys/crypto/ccp/ccp.c                  | 2 +-
   sys/dev/qcom_rnd/qcom_rnd.c           | 2 +-
   sys/dev/random/armv8rng.c             | 2 +-
   sys/dev/random/darn.c                 | 2 +-
   sys/dev/random/ivy.c                  | 2 +-
   sys/dev/random/nehemiah.c             | 2 +-
   sys/dev/random/random_harvestq.c      | 6 +++---
   sys/dev/random/randomdev.h            | 4 ++--
   sys/dev/virtio/random/virtio_random.c | 2 +-
   9 files changed, 12 insertions(+), 12 deletions(-)

[commit 527c05afa6d9f5596210efb1c16f3bc51d3ca497]
Date: 2025-01-06
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Modirum MDPay | Klara, Inc.
Section: Kernel.general
Subject: vm_pageout: Scan inactive dirty pages less aggressively
Review: The vm_pageout inactive scan now aborts early when encountering many dirty pages without meeting the free page shortage, reducing VM object lock contention and CPU bursts that could cause application latency spikes. This change paces page daemon work, particularly benefiting workloads with large file-backed caches like databases.
Body:

  Consider a database workload where the bulk of RAM is used for a
  fixed-size file-backed cache.  Any leftover pages are used for
  filesystem caching or anonymous memory.  In particular, there is little
  memory pressure and the inactive queue is scanned rarely.

  Once in a while, the free page count dips a bit below the setpoint,
  triggering an inactive queue scan.  Since almost all of the memory there
  is used by the database cache, the scan encounters only referenced
  and/or dirty pages, moving them to the active and laundry queues.  In
  particular, it ends up completely depleting the inactive queue, even for
  a small, non-urgent free page shortage.

  This scan might process many gigabytes worth of pages in one go,
  triggering VM object lock contention (on the DB cache file's VM object)
  and consuming CPU, which can cause application latency spikes.

  Observing this behaviour, my observation is that we should abort
  scanning once we've encountered many dirty pages without meeting the
  shortage.  In general we've tried to make the page daemon control loops
  avoid large bursts of work, and if a scan fails to turn up clean pages,
  there's not much use in moving everything to laundry queue at once.  In
  particular, pacing this work ensures that the page daemon isn't
  frequently acquiring and releasing the VM object lock over long periods,
  especially when multiple page daemon threads are in use.

  Modify the inactive scan to abort early if we encounter enough dirty
  pages without meeting the shortage.  If the shortage hasn't been met,
  this will trigger shortfall laundering, wherein the laundry thread will
  clean as many pages as needed to meet the instantaneous shortfall.
  Laundered pages will be placed near the head of the inactive queue, so
  will be immediately visible to the page daemon during its next scan of
  the inactive queue.

  Reviewed by:	alc, kib
  MFC after:	1 month
  Sponsored by:	Modirum MDPay
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D48337

  (cherry picked from commit 095f6305772be1dae27e7af9d87db0387625440d)


   sys/vm/swap_pager.c |  2 +-
   sys/vm/swap_pager.h |  1 +
   sys/vm/vm_pageout.c | 61 +++++++++++++++++++++++++++++++++++++++++------------
   3 files changed, 49 insertions(+), 15 deletions(-)

[commit 3cd8d379e3821bfa32f36d683cc7340dc37e8eb8]
Date: 2025-08-09
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: tests: Add some regression tests for copy_file_range()
Review: Adds regression tests for copy_file_range() to cover known bugs.
Body:

  These cover a few bugs that have cropped up, including the ones fixed by
  commits 4046ad6bb0e and 2319ca6a0181.

  PR:		276045
  Reviewed by:	rmacklem
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51856

  (cherry picked from commit 3af6f55735cef7df72ca3f4ecf2b0027abb5fcb8)


   tests/sys/kern/Makefile          |   2 +
   tests/sys/kern/copy_file_range.c | 231 +++++++++++++++++++++++++++++++++++++++
   2 files changed, 233 insertions(+)

[commit 8f9a7ea9cf255a1621d869561040c8fa27ab78b6]
Date: 2025-09-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: rk_tsadc: use tsadc_temp_to_raw for shutdown_temp
Review: The commit fixes a kernel reboot cycle on rk3566/68 boards by correcting a temperature conversion function in the RK TSADC driver.
Body:

  Use tsadc_temp_to_raw instead of tsadc_raw_to_temp, otherwise rk3566/68
  get stuck in a kernel reboot cycle.

  https://forums.freebsd.org/threads/running-freebsd-on-radxa-rock-3c-rk3566-board.89389/post-624890

  Submitted by:	covacat
  Reviewed by:	mmel
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D52309

  (cherry picked from commit 2b0f8c6907b96a8e150a1250e56d25a7a5d202d8)


   sys/arm64/rockchip/rk_tsadc.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 2c2bb7913d478889da548fe9837dc9b32727a81d]
Date: 2025-07-08
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: vm_domainset: Refactor iterators, multiple fixes
Review: The commit refactors internal VM domain set iterators and fixes allocation logic inconsistencies, but these changes are internal to the kernel's memory management with no direct user-visible impact.
Body:

  vm_domainset_iter_first() would not check if the initial domain selected
  by the policy was effectively valid (i.e., allowed by the domainset and
  not marked as ignored by vm_domainset_iter_ignore()).  It would just try
  to skip it if it had less pages than 'free_min', and would not take into
  account the possibility of no domains being valid.

  Factor out code that logically belongs to the iterator machinery and is
  not tied to how allocations (or impossibility thereof) are to be
  handled.  This allows to remove duplicated code between
  vm_domainset_iter_page() and vm_domainset_iter_policy(), and between
  vm_domainset_iter_page_init() and _vm_domainset_iter_policy_init().
  This also allows to remove the 'pages' parameter from
  vm_domainset_iter_page_init().

  This also makes the two-phase logic clearer, revealing an inconsistency
  between setting 'di_minskip' to true in vm_domainset_iter_init()
  (implying that, in the case of waiting allocations, further attempts
  after the first sleep should just allocate for the first domain,
  regardless of their situation with respect to their 'free_min') and
  trying to skip the first domain if it has too few pages in
  vm_domainset_iter_page_init() and _vm_domainset_iter_policy_init().  Fix
  this inconsistency by resetting 'di_minskip' to 'true' in
  vm_domainset_iter_first() instead so that, after each vm_wait_doms()
  (waiting allocations that could not be satisfied immediately), we again
  start with only the domains that have more than 'free_min' pages.

  While here, fix the minor quirk that the round-robin policy would start
  with the domain after the one pointed to by the initial value of
  'di_iter' (this just affects the case of resetting '*di_iter', and would
  not cause domain skips in other circumstances, i.e., for waiting
  allocations that actually wait or at each subsequent new iterator
  creation with same iteration index storage).

  PR:             277476
  Tested by:      Kenneth Raplee <kenrap_kennethraplee.com>
  Fixes:          7b11a4832691 ("Add files for r327895")
  Fixes:          e5818a53dbd2 ("Implement several enhancements to NUMA policies.")
  Fixes:          23984ce5cd24 ("Avoid resource deadlocks when one domain has exhausted its memory."...)
  MFC after:      10 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D51251

  (cherry picked from commit 637d9858e6a8b4a8a3ee4dd80743a58bde4cbd68)


   sys/kern/kern_malloc.c |  11 ++-
   sys/vm/uma_core.c      |  10 ++-
   sys/vm/vm_domainset.c  | 234 +++++++++++++++++++++++++++++--------------------
   sys/vm/vm_domainset.h  |   6 +-
   sys/vm/vm_kern.c       |  12 ++-
   sys/vm/vm_page.c       |  20 +++--
   6 files changed, 177 insertions(+), 116 deletions(-)

[commit 0206ec4350ca385a8c29f410dc6814b5517dafc5]
Date: 2025-07-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: vm_domainset: Simplify vm_domainset_iter_next()
Review: Internal kernel memory management refactoring with no user-visible functional change.
Body:

  As we are now visiting each domain only once, the test in
  vm_domainset_iter_prefer() about skipping the preferred domain (the one
  initially visited for policy DOMAINSET_POLICY_PREFER) becomes redundant.
  Removing it makes this function essentially the same as
  vm_domainset_iter_rr().

  Thus, remove vm_domainset_iter_prefer().  This makes all policies behave
  the same in vm_domainset_iter_next().

  No functional change (intended).

  PR:             277476
  MFC after:      10 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D51250

  (cherry picked from commit d0b691a7c1aacf5a3f5ee6fc53f08563744d7203)


   sys/vm/vm_domainset.c | 32 ++------------------------------
   1 file changed, 2 insertions(+), 30 deletions(-)

[commit b5834753d330f201195602d039633be8d811e204]
Date: 2025-07-07
Score: 5
Status: proposed(include=no,score=15)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: vm_domainset: Only probe domains once when iterating, instead of up to 4 times
Review: The commit optimizes NUMA domain scanning during memory allocation to reduce redundant probes, which may improve allocation performance in multi-domain systems. No user-visible behavior change is introduced.
Body:

  Because of the 'di_minskip' logic, which resets the initial domain, an
  iterator starts by considering only domains that have more than
  'free_min' pages in a first phase, and then all domains in a second one.
  Non-"underpaged" domains are thus examined twice, even if the allocation
  can't succeed.

  Re-scanning the same domains twice just wastes time, as allocation
  attempts that must not wait may rely on failing sooner and those that
  must will loop anyway (a domain previously scanned twice has more pages
  than 'free_min' and consequently vm_wait_doms() will just return
  immediately).

  Additionally, the DOMAINSET_POLICY_FIRSTTOUCH policy would aggravate
  this situation by reexamining the current domain again at the end of
  each phase.  In the case of a single domain, this means doubling again
  the number of times domain 0 is probed.

  Implementation consists in adding two 'domainset_t' to 'struct
  vm_domainset_iter' (and removing the 'di_n' counter).  The first,
  'di_remain_mask', contains domains still to be explored in the current
  phase, the first phase concerning only domains with more pages than
  'free_min' ('di_minskip' true) and the second one concerning only
  domains previously under 'free_min' ('di_minskip' false).  The second,
  'di_min_mask', holds the domains with less pages than 'free_min'
  encountered during the first phase, and serves as the reset value for
  'di_remain_mask' when transitioning to the second phase.

  PR:             277476
  Fixes:          e5818a53dbd2 ("Implement several enhancements to NUMA policies.")
  Fixes:          23984ce5cd24 ("Avoid resource deadlocks when one domain has exhausted its memory."...)
  MFC after:      10 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D51249

  (cherry picked from commit d440953942372ca275d0743a6e220631bde440ee)


   sys/vm/vm_domainset.c | 53 ++++++++++++++++++++++++++++++---------------------
   sys/vm/vm_domainset.h |  6 +++++-
   2 files changed, 36 insertions(+), 23 deletions(-)

[commit bda42942b95faf7b4cc8f3fa825c76ca58820ceb]
Date: 2023-11-20
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: Avoid waiting on physical allocations that can't possibly be satisfied
Review: The commit modifies VM memory allocation to avoid infinite waiting when physical allocations cannot be satisfied, affecting kernel subsystems like DRM and TLS.
Body:

  - Change vm_page_reclaim_contig[_domain] to return an errno instead
    of a boolean.  0 indicates a successful reclaim, ENOMEM indicates
    lack of available memory to reclaim, with any other error (currently
    only ERANGE) indicating that reclamation is impossible for the
    specified address range.  Change all callers to only follow
    up with vm_page_wait* in the ENOMEM case.

  - Introduce vm_domainset_iter_ignore(), which marks the specified
    domain as unavailable for further use by the iterator.  Use this
    function to ignore domains that can't possibly satisfy a physical
    allocation request.  Since WAITOK allocations run the iterators
    repeatedly, this avoids the possibility of infinitely spinning
    in domain iteration if no available domain can satisfy the
    allocation request.

  PR:		274252
  Reported by:	kevans
  Tested by:	kevans
  Reviewed by:	markj
  Differential Revision: https://reviews.freebsd.org/D42706

  (cherry picked from commit 2619c5ccfe1f7889f0241916bd17d06340142b05)

  MFCed as a prerequisite for further MFC of VM domainset changes.  Based
  on analysis, it would not hurt, and I have been using it in productions
  for months now.

  Resolved the trivial conflict due to commit 718d1928f874 ("LinuxKPI:
  make linux_alloc_pages() honor __GFP_NORETRY") having been MFCed before
  this one.


   sys/arm/nvidia/drm2/tegra_bo.c              |  9 +++--
   sys/compat/linuxkpi/common/src/linux_page.c |  8 ++--
   sys/dev/drm2/ttm/ttm_bo.c                   |  4 +-
   sys/dev/drm2/ttm/ttm_page_alloc.c           |  9 +++--
   sys/kern/uipc_ktls.c                        |  5 ++-
   sys/kern/uipc_shm.c                         |  5 ++-
   sys/vm/vm_domainset.c                       | 32 +++++++++++++---
   sys/vm/vm_domainset.h                       |  2 +
   sys/vm/vm_kern.c                            | 24 +++++++++++-
   sys/vm/vm_page.c                            | 58 ++++++++++++++++++++++-------
   sys/vm/vm_page.h                            |  6 +--
   11 files changed, 123 insertions(+), 39 deletions(-)

[commit 6f59cb79e84a86d7b864d709652ec57b6928a6cf]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.libraries
Subject: lib/msun: cpow{,f,l}(CMLX(0.0, 0.0)) should return 1.0
Review: The man:cpow[3] function now returns 1.0 when both arguments are zero, correcting a previous incorrect result.
Body:

  PR:	289447

  (cherry picked from commit 8b41ba845c7e10b5f241a1f944fe9a8e19ad75a9)


   lib/msun/src/s_cpow.c  | 5 ++++-
   lib/msun/src/s_cpowf.c | 5 ++++-
   lib/msun/src/s_cpowl.c | 5 ++++-
   3 files changed, 12 insertions(+), 3 deletions(-)

[commit 3b47fcc146dae76988084983fbb95e82d44e6b54]
Date: 2025-09-15
Score: 5
Status: proposed(include=no,score=20)
Sponsor: https://www.patreon.com/cperciva
Section: undecided
Subject: release: Fix typo in powerpc mkisoimages.sh
Review: Fixes a typo in the powerpc mkisoimages.sh script that caused temporary file garbage in /tmp when creating ISO images.
Body:

  "[ n foo ]" is an error and should have been "[ -n foo ]".

  Fortunately the only ill effect was to result in garbage in /tmp/ when
  creating powerpc ISO images.

  Fixes:	6c3e01bf8578 ("release: Randomize powerpc boot block file name")
  MFC after:	3 days
  Sponsored by:	https://www.patreon.com/cperciva

  (cherry picked from commit 8c9a919abaa3f6f16a17586ca72bab939788bf69)


   release/powerpc/mkisoimages.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d1142d54fa2153fdba3947f0cf03e8a2ce4f0e75]
Date: 2025-09-13
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: libc: fix the _FORTIFY_SOURCE build of getgrouplist(3)
Review: The commit fixes a build issue with _FORTIFY_SOURCE for man:getgrouplist[3], ensuring the function prototype is available. This is a minor internal build fix with no direct user-visible impact.
Body:

  We need <unistd.h> to get our prototype normally, but WARNS in libc is
  way too low to surface that.

  Additionally, _FORTIFY_SOURCE needs to include <ssp/unistd.h> by way of
  <unistd.h> to actually export an implementation of getgrouplist(3).  The
  version defined in the .c gets named __ssp_real_getgrouplist() and the
  actual implementation comes from the redirect stub in <ssp/unistd.h>,
  which basically gets optimized away in the built object because our
  __builtin_object_size() check is trivially false when we cannot resolve
  any object sizes in this translation unit.

  This could be argued as a design flaw in _FORTIFY_SOURCE, but we should
  grab <unistd.h> for our prototype anyways so let's kick the can down
  the road instead of re-thinking it for 15.0.

  Reported by:	Shawn Webb (HardenedBSD)
  Fixes:		d3f8ed6066 ("getgrouplist(3): Remove superfluous [...]")
  MFC after:	3 days

  (cherry picked from commit 91ea7e2ce2b5b2ff4702c3092cfe944862d58172)

  This is (partly) MFCed just for the sake of re-introducing the
  <unistd.h> include to have a prototype.  There is no _FORTIFY_SOURCE
  support for getgrouplist(3) in 14.


   lib/libc/gen/getgrouplist.c | 2 ++
   1 file changed, 2 insertions(+)

[commit 7220f36f6cf9d72bef0f274d4134fad0d86f6052]
Date: 2025-09-12
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: getgrouplist(3): Remove superfluous headers, bogus comment and whitespace
Review: No user-visible changes; commit removes only internal code comments and whitespace.
Body:

  No functional change (intended).

  Fixes:          a59d6a872459 ("Implementing 'fallback' nsswitch source.")
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit d3f8ed6066fdea329ed695925fc726e84d50abc3)


   lib/libc/gen/getgrouplist.c | 8 --------
   1 file changed, 8 deletions(-)

[commit 009268dbfdd5fe487117654f75ae3850a2c1a7d9]
Date: 2025-09-09
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: hwpmc: On attach, fix allowing a PMC's owner to attach it to itself
Review: The commit fixes a bug in man:hwpmc[4] that prevented a PMC's owner process from attaching the PMC to itself, even when security checks would allow it. This restores the intended functionality for performance monitoring.
Body:

  The returned value in this case was wrong, and would basically prevent
  some PMC's owner process to attach that PMC to itself although the
  security checks underneath would have allowed it.

  Now that this early return has been fixed, its block basically becomes
  a performance short-circuit which has no effect from a functional
  standpoint.

  Fixes:          ebccf1e3a6b1 ("Bring a working snapshot of hwpmc(4), ...")
  MFC after:      9 days
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 1c40b15971f09c0c0676ae476b88b32166eae8ac)


   sys/dev/hwpmc/hwpmc_mod.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 59a73e9a1fe33517393a18ff958ef8d05f550a56]
Date: 2025-08-26
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: hwpmc: On attach, ensure owner is a target effective GID's member
Review: The commit restores a security check for hwpmc attach permissions, ensuring the owner is a member of the target effective GID. This affects users of the hwpmc performance monitoring subsystem.
Body:

  This restores a check that existed prior to commit be1f7435ef218b1d
  ("kern: start tracking cr_gid outside of cr_groups[]").

  While here, improve pmc_can_attach()'s style by changing the type of
  'decline_attach' to 'bool', fixing tests on it, adding missing
  parentheses to 'return' statements, and by changing its return value
  type to 'bool'.

  Fixes:          be1f7435ef218b1d ("kern: start tracking cr_gid outside of cr_groups[]")
  MFC after:      9 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D52252

  (cherry picked from commit 1c3c698ba4c40485ebbbd157cb49172cfa7de9b2)

  MFC to 14 does not fix any bug, but just applies some style changes
  needed by next MFC.

  In pmc_can_attach(): Start index of the loop on groups was changed to
  1 in order to avoid a (harmless) duplicated groupmember() call with
  'tc->cr_gid', which in 14 is still an alias of 'tc->cr_groups[0]'.  We
  chose to MFC the addition of that latter call to minimize differences
  with what is in -CURRENT and 15.


   sys/dev/hwpmc/hwpmc_mod.c | 21 ++++++++++-----------
   1 file changed, 10 insertions(+), 11 deletions(-)

[commit eabd561d3a2a7542e5817e493ccef25dfd247eed]
Date: 2025-09-17
Score: 5
Status: proposed(include=no,score=15)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sdp(3): Change bdaddr parameter type in sdp_register_service()
Review: The sdp_register_service() function now accepts a const bdaddr_t * parameter, resolving compilation errors when using constant addresses like NG_HCI_BDADDR_ANY.
Body:

  Fixes compiler error when the caller passes a const bdaddr_t *
  paramemeter (e.g., NG_HCI_BDADDR_ANY).

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 day
  Reviewed by:	markj, emaste
  Differential Revision:	https://reviews.freebsd.org/D52582

  (cherry picked from commit 3d14cc82d7a8c11cd164a6ba668d20b939c576fe)


   lib/libsdp/sdp.3     | 4 ++--
   lib/libsdp/sdp.h     | 2 +-
   lib/libsdp/service.c | 2 +-
   3 files changed, 4 insertions(+), 4 deletions(-)

[commit e4fcd203f2525fa98a03fa631cf1cc36bf438e41]
Date: 2025-09-15
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ng_btsocket_rfcomm: Mark a couple buffers as const in a helper function
Review: The commit marks buffers as const in an internal helper function, which is a minor internal change with no user-visible impact.
Body:

  Fixes:	680f9acc3657 ("ng_hci: Cast NG_HCI_BDADDR_ANY to const bdaddr_t *")
  (cherry picked from commit 18fd3f8ec5c50da21515757af24421a078a4a468)


   sys/netgraph/bluetooth/socket/ng_btsocket_rfcomm.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 064006b78c90b52813a5a93341a4c52452114ca9]
Date: 2025-09-15
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: ng_hci: Cast NG_HCI_BDADDR_ANY to const bdaddr_t *
Review: No user-visible change; internal compiler fix.
Body:

  This is needed to address some compiler errors cleanly, where consumer
  functions want this address to be a const pointer.

  Sponsored by:	The FreeBSD Foundation
  MFC after:	3 days
  Reviewed by:	markj
  Differential Revision: https://reviews.freebsd.org/D52310

  (cherry picked from commit 680f9acc3657efcea07d8ac0954645b6eaf8dac8)


   sys/netgraph/bluetooth/include/ng_hci.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit cbd62452bff6bc8837c9cffeaa4c9f43b99995ce]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: Add doas support
Review: The nuageinit utility now supports doas as an alternative to sudo, allowing users to use doas for privilege escalation. The man:nuageinit[7] man page is updated to reflect the use of ${LOCALBASE}.
Body:

  * Set mode of etc directory to 0755.
  * Use user.localbase sysctl instead of /usr/local.
  * Add test case for doas.
  * Set ${LOCALBASE} instead of /usr/local in nuageinit(7) man page.

  Reviewed by:            bapt@
  Approved by:            bapt@
  Differential Revision:  https://reviews.freebsd.org/D52437

  (cherry picked from commit 9a829e865697e623a046800545be7781a117125e)


   libexec/nuageinit/nuage.lua          | 62 +++++++++++++++++++++++++++++++++++-
   libexec/nuageinit/nuageinit          |  3 ++
   libexec/nuageinit/nuageinit.7        |  9 +++++-
   libexec/nuageinit/tests/nuageinit.sh | 12 ++++++-
   4 files changed, 83 insertions(+), 3 deletions(-)

[commit f0588c1cd8d92f692f18debaf66a90c95e037022]
Date: 2025-08-22
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: nuageinit.7: put each sentence on a new line
Review: The commit only reformats a man page by placing each sentence on a new line, which is a style change without user-visible impact.
Body:

  (cherry picked from commit a7f19968ae5d5e7e5feba85d04698050fcaf784f)


   libexec/nuageinit/nuageinit.7 | 22 +++++++++++++++-------
   1 file changed, 15 insertions(+), 7 deletions(-)

[commit ea186b76c675ac05e4ece3eddd2d301a80e9547d]
Date: 2025-08-22
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: nuageinit.7: grammar fixes
Review: Grammar fixes in man:nuageinit[7].
Body:

  (cherry picked from commit 95b0be1118b1a24ceb1b59ecd936aaa155d828bd)


   libexec/nuageinit/nuageinit.7 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit bf187f6ac5b198d51b3db80c8876fc70ce75b162]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: Allow the use of network parameters from network-config
Review: The nuageinit utility now supports reading network configuration parameters from the network-config file, improving compliance with the cloud-init specification.
Body:

  To better comply with the cloud-init specification, we need to
  support the configuration of network-related parameters from
  the network-config file, which is common in most deployments.

  Reviewed by:            bapt@
  Approved by:            bapt@
  Differential Revision:  https://reviews.freebsd.org/D52419

  (cherry picked from commit 95230b248f6412c2d1c416c1e9795c3192cdf750)


   libexec/nuageinit/nuageinit   | 31 ++++++++++++++++++++++++++++++-
   libexec/nuageinit/nuageinit.7 |  7 +++++++
   2 files changed, 37 insertions(+), 1 deletion(-)

[commit d9843a40f8b15b8be1594615b609fe3e7b828b9d]
Date: 2025-09-11
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: nuageinit: Add me to copyright list
Review: Adds a new contributor to the copyright list of the nuageinit utility and its associated files.
Body:

  Approved by:    bapt@

  (cherry picked from commit 18555060dcae4cad8f2f8968142fc02a2571377b)


   libexec/nuageinit/nuage.lua          | 1 +
   libexec/nuageinit/nuageinit          | 1 +
   libexec/nuageinit/nuageinit.7        | 1 +
   libexec/nuageinit/tests/nuage.sh     | 1 +
   libexec/nuageinit/tests/nuageinit.sh | 1 +
   libexec/nuageinit/tests/utils.sh     | 1 +
   6 files changed, 6 insertions(+)

[commit 5d8efb8f2578a1d94ef81c5157df1754f5dd13ab]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: chmod sudoers directory instead of chmod (again) sudoers file
Review: The mode of the sudoers file is set to 0440, ensuring proper permissions for the nuageinit utility.
Body:

  * Set mode of sudoers to 0440.

  Reviewed by:            bapt@, jlduran@
  Approved by:            bapt@, jlduran@
  Differential Revision:  https://reviews.freebsd.org/D52438

  (cherry picked from commit a5cc9b7b96dcba4d3ee98f2eb58c3f389590ddf0)


   libexec/nuageinit/nuage.lua | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 918e1973ff277512aac4f58e67bd9b1bfa913ec8]
Date: 2025-09-11
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: nuageinit: Remove duplicate description of users.{user}.groups
Review: Removes a duplicate description of the users.{user}.groups configuration parameter from the man:nuageinit[7] manual page.
Body:

  Reviewed by:            bapt@
  Approved by:            bapt@
  Differential Revision:  https://reviews.freebsd.org/D52436

  (cherry picked from commit 9f3330f5224ea2384a1c7d79a5b1f2784f7c14b6)


   libexec/nuageinit/nuageinit.7 | 2 --
   1 file changed, 2 deletions(-)

[commit 3a680e9544696c8ea434a7ed60dbaae693e5af7f]
Date: 2025-08-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.contrib
Subject: nuageinit: Improvements for nuageinit
Review: nuageinit receives multiple improvements including fixes for pkg update usage, documentation updates, and new network configuration parameters such as match.name, match.driver, set-name, mtu, wakeonlan, and nameservers. It now uses resolvconf(8) for DNS configuration and tzsetup(8) for time zone setting, enhancing cloud-init compatibility.
Body:

  - Fix 'pkg update' usage:
    - The function 'nuage:run_pkg_cmd(...)' adds the flag '-y', which
      does not make sense with some commands such as 'pkg update',
      causing an error when updating the repository catalogs.
  - Fix typo 'ssh-authorized-keys -> ssh_authorized_keys' in
    'nuageinit(7)' man page.
  - Document 'ssh_authorized_keys' parameter.
  - Use device configuration ID when no 'match' rule is specified:
    - This is the default behavior of cloud-init when no match rule is
      specified, so the device is configured anyway (even if it does not
      exist). This greatly simplifies things, since in many cases
      'if_vtnet(4)' is used, so there is no need to perform a comparison
      with the MAC address.
  - Document 'network' parameter:
    - Add example to 'EXAMPLES' section.
  - Set 'gateway[46]' only when 'addresses' is specified:
    - To comply with the cloud-init specification, 'gateway4' and 'gateway6'
      must only take effect when 'addresses' (or static configuration) is
      specified.
  - Use a separate function to check 'match' rules:
    - This way, we can easily add new logic to new types of rules.
  - Implement 'network.ethernets.{id}.match.name' parameter:
    - But unlike cloud-init, which works with glob expressions (although it
      depends on the network backend), this implementation takes advantage
      of Lua pattern-matching expressions.

      Also note that previously we were only concerned with one interface
      matching, however, to be cloud-init-compliant, we need to configure
      the matching interfaces (one or more).
  - Set default router only once.
  - Implement 'network.ethernets.{id}.wakeonlan' parameter.
  - Implement 'network.ethernets.{id}.set-name' parameter.
  - Implement 'network.ethernets.{id}.match.driver' parameter:
    - Rename 'get_ifaces(...)' function as 'get_ifaces_by_mac(...)'.
    - Add get_ifaces_by_driver(...) function.
  - Implement 'network.ethernets.{id}.mtu' parameter.
  - Implement 'nameservers' parameter.
  - Use 'resolvconf(8)' to manipulate 'resolv.conf(5)'.
  - Use 'tzsetup(8)' to set time zone.

  Reviewed by:            bapt@
  Approved by:            bapt@
  Differential Revision:  https://reviews.freebsd.org/D51643

  (cherry picked from commit ba5df7a2d03cd5624b1825ca8d4c39dcaace7796)


   libexec/nuageinit/nuage.lua             |  20 ++-
   libexec/nuageinit/nuageinit             | 238 ++++++++++++++++++++++++++++----
   libexec/nuageinit/nuageinit.7           |  92 +++++++++++-
   libexec/nuageinit/tests/Makefile        |   1 +
   libexec/nuageinit/tests/nuage.sh        |   9 ++
   libexec/nuageinit/tests/nuageinit.sh    |   4 +-
   libexec/nuageinit/tests/settimezone.lua |   5 +
   7 files changed, 335 insertions(+), 34 deletions(-)

[commit 08e259e3923696b6a93e11cb32f53bab7a24db00]
Date: 2025-09-03
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: timeout(1): add license header to unit test
Review: No user-visible change; only adds a license header to an internal unit test file.
Body:

  Requested by:	kevans

  (cherry picked from commit 245f2abf94889d3fd69360c4f49532074ff25fbf)


   bin/timeout/tests/timeout_test.sh | 2 ++
   1 file changed, 2 insertions(+)

[commit 65f42f894b1b7541e43984c7b18c7fd6f05461ee]
Date: 2025-06-27
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: mac_do(4): fix typo
Review: Fixes a typographical error in the man:mac_do[4] manual page.
Body:

  Reported by:	des

  (cherry picked from commit d0c8733997079a54828ad2222517427d9447dbaf)


   share/man/man4/mac_do.4 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 673f8232146a0c9beb481988b06eeae6f08d934d]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Amn Afzar Hoopad Inc
Section: Ports.packaging
Subject: pkg(7): Add support for pkg+ prefix to bootstrap pubkey
Review: The pkg(7) bootstrap process now supports a 'pkg+' prefix for the public key URL, allowing users to specify alternative key sources.
Body:

  MFC After: 	1 day
  Sponsored by:	Amn Afzar Hoopad Inc
  Differencial Revision:	https://reviews.freebsd.org/D52418

  (cherry picked from commit 08b8843137b8be3f71608400907cb38bcda14965)


   usr.sbin/pkg/pkg.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 123881aead724fefa38d4324d2d442ecc79942b2]
Date: 2025-09-15
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: sound: Honor CHN_F_NBIO
Review: The sound subsystem now honors O_NONBLOCK when opening audio devices, ensuring non-blocking I/O behavior persists across channel resets.
Body:

  If the device is opened with O_NONBLOCK, even though we check for it in
  order to set CHN_F_NBIO, the subsequent chn_reset() calls will clear all
  flags, except those set in CHN_F_RESET, which does not include
  CHN_F_NBIO.

  Add CHN_F_NBIO to CHN_F_RESET. Additionally, because primary channels
  can be reused, make sure we do not unintentionally keep CHN_F_NBIO set
  if the channel is re-opened, but without O_NONBLOCK.

  PR:		289441
  MFC after:	2 days
  Reviewed by:	christos, markj
  Differential Revision:	https://reviews.freebsd.org/D52493

  (cherry picked from commit e8b5025c3880b04c1c2139fe73b65fbd6deb41d4)


   sys/dev/sound/pcm/channel.h | 2 +-
   sys/dev/sound/pcm/dsp.c     | 4 ++--
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 44d7a8298eaee9df45b786176d5d85a37e095c94]
Date: 2025-09-10
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Userland.programs
Subject: ifconfig: also fix removing IPv6 addresses without netlink
Review: The man:ifconfig[8] utility now correctly removes IPv6 addresses when netlink is not used, fixing a regression from a previous change.
Body:

  Reported by:	bdrewery
  MFC after:	1 week
  See also:	da50f49977cc4e6aae55cb2379313599249a8dd2
  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit c8fb5a4d032b28dd97b9fa4a73f85a84d8d35fdd)


   sbin/ifconfig/af_inet6.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 65ce9cefee56a15c8361ee5d5154064e11d629a7]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Klara, Inc.
Section: Docs.manpages
Subject: uptime: Mention libxo support in manual page
Review: The man:uptime[1] and man:w[1] manual pages now mention libxo support, which allows users to generate XML and JSON output.
Body:

  MFC after:	3 days
  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D52489

  (cherry picked from commit 55bd607b9930e5f61219007ad0a81801c8cfdbf3)


   usr.bin/w/uptime.1 | 18 ++++++++++++++++--
   usr.bin/w/w.1      |  4 ++--
   2 files changed, 18 insertions(+), 4 deletions(-)

[commit a5bf37963aeb6ee2dc2c26cb39a1931ea7558055]
Date: 2025-09-10
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: src.sys.mk: Support src.conf in SRCTOP
Review: The build system now uses a src.conf file in the source tree root if present, overriding /etc/src.conf. This change affects developers and users who customize build options.
Body:

  If SRCCONF is not defined and src.conf exists at the top level of the
  source tree, use that instead of /etc/src.conf.

  MFC after:	3 days
  Reviewed by:	kevans, imp
  Differential Revision:	https://reviews.freebsd.org/D52470

  (cherry picked from commit dd8c666d8b78f6b9ddb691f0505837fa885ff3b4)

  UPDATING: mention the src.conf change

  Fixes:		dd8c666d8b78 ("src.sys.mk: Support src.conf in SRCTOP")
  (cherry picked from commit ab2fea3f9a5a58f0ba90499ad3a8614e3dca0c5f)


   .gitignore                  | 1 +
   UPDATING                    | 5 +++++
   share/man/man5/src.conf.5   | 9 ++++++---
   share/mk/src.sys.mk         | 4 ++++
   sys/conf/kern.pre.mk        | 4 ++++
   tools/build/options/makeman | 7 +++++--
   6 files changed, 25 insertions(+), 5 deletions(-)

[commit 61735a4f685bb1a1d2a787d79e1541ed017a5ca5]
Date: 2025-09-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: man: Add -l option
Review: The man:man[1] utility gains a -l option that interprets arguments as file paths to open directly instead of searching MANPATH.
Body:

  Add a -l option which causes man to interpret all arguments as paths to
  open directly rather than man pages to search for in MANPATH.  See the
  PR for a detailed rationale.

  PR:		289245
  MFC after:	1 week
  Reviewed by:	ziaee, emaste
  Differential Revision:	https://reviews.freebsd.org/D52385

  (cherry picked from commit 14b61b2e931741281d0bfef426e9809f16006504)


   usr.bin/man/man.1  | 24 ++++++++++++++++++------
   usr.bin/man/man.sh | 33 ++++++++++++++++++++++++---------
   2 files changed, 42 insertions(+), 15 deletions(-)

[commit bc8b95bb7695b372d0d25d261fa8f3d7beed7fc8]
Date: 2025-08-29
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: Modirum MDPay
Section: Userland.programs
Subject: w: Fix idle time in json output, add login/idle times to json output
Review: The man:w[1] utility now reports idle time as a string in JSON output and includes login time delta and idle seconds in both JSON and XML outputs.
Body:

  Currently the idle time will show as `true` part of the time in the json
  output and quoting depends on what is being printed. Make sure it's
  always printed correctly and for consistency treated as a string in the
  json output.

  Login time delta and since times are currently exposed in the xml
  output, expose these times in the json output as well.

  In the json and xml outputs expose the number of seconds idle as a new
  field or attribute respectively.

  MFC after:	1 week
  Sponsored by:	Modirum MDPay
  Event:		Oslo Hackathon 202508
  Differential Revision:	https://reviews.freebsd.org/D52237

  (cherry picked from commit 6e6febb54da91bf5e13007c3d8f4a54495273969)


   usr.bin/w/pr_time.c | 26 +++++++++++++++++++-------
   1 file changed, 19 insertions(+), 7 deletions(-)

[commit 8c40728a46d4c2a3a93314deca47252f5c2ebe12]
Date: 2025-09-13
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: kern/kern_event.c: properly spell COMPAT_FREEBSD32
Review: Fixes a typo in a kernel source file with no user-visible impact.
Body:

  PR:	289504

  (cherry picked from commit cab4cf201acf76b415a8f1a59ea4eeeb14b4636c)


   sys/kern/kern_event.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a1dcf2fc8f327c5d492278f14c07380b7170fc68]
Date: 2025-09-08
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: geom: only set TDP_GEOM for user threads
Review: The commit adjusts internal thread handling in the GEOM subsystem to only set TDP_GEOM for user threads, which is an internal implementation detail with no direct user-visible impact.
Body:

  PR:	289204

  (cherry picked from commit b0474e14895908f45c64158b0e558236923b8eb2)


   sys/geom/geom_event.c | 9 +++++++--
   1 file changed, 7 insertions(+), 2 deletions(-)

[commit 594982a69714150ccf8616ffbce65fecab70ec03]
Date: 2025-09-08
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: kern_thr_exit(): clear kASTs in advance
Review: The commit addresses a kernel thread exit issue by clearing kASTs early, which may affect system stability and thread termination behavior.
Body:

  PR:	289204

  (cherry picked from commit f51d7d5139a76d225c9f537bd948525ababdef0c)


   sys/kern/kern_thr.c | 11 +++++++++++
   1 file changed, 11 insertions(+)

[commit 31eaa0141c49128fabfc65f3d282997a8d5e9cdc]
Date: 2025-03-26
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Hardware.virtualization
Subject: riscv timer: fix interrupt handling.
Review: The commit fixes timer interrupt handling on RISC-V by correcting supervisor timer interrupt clearing, which resolves operation on Codasip A730 hardware.
Body:

  Based on the spec the STIP bit of SIP register is read-only.

  To clear STIP bit from supervisor we have to do an SBI call to firmware.
  Upon reception of SBI request, the machine-mode firmware clears the STIP
  bit in the MIP register.

  This fixes operation on Codasip A730.

  Reviewed by:	mhorne
  Differential Revision:	https://reviews.freebsd.org/D49487

  (cherry picked from commit 6d58c670060a17817fa0c8ebf4e7543c3d2b4523)


   sys/riscv/riscv/timer.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 4efc1b22aab1a15bff95012deb789696d71f97ec]
Date: 2024-05-22
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Hardware.virtualization
Subject: riscv: Fix SSTC extension support
Review: The commit fixes the SSTC extension support for RISC-V, ensuring proper timer interrupt handling when the supervisor-mode timer compare register is implemented. This resolves operation in Spike with the sstc extension enabled.
Body:

  From the SSTC spec:
  "If the stimecmp (supervisor-mode timer compare) register is implemented,
  then STIP is read-only in mip and reflects the supervisor-level timer
  interrupt signal resulting from stimecmp. This timer interrupt signal
  is cleared by writing stimecmp with a value greater than the current time
  value."

  This fixes operation in Spike with sstc extension enabled.
  Example:
    spike --isa RV64IMAFDCH_zicntr_zihpm_sstc

  Reviewed by:	mhorne
  Differential Revision:	https://reviews.freebsd.org/D45226

  (cherry picked from commit ddd0d4f4cd65341a07bb3bb833dee7982018fd60)


   sys/riscv/riscv/timer.c | 7 +++++--
   1 file changed, 5 insertions(+), 2 deletions(-)

[commit 70caaeb8b63f9e11e1f495ab3918119c537a8677]
Date: 2025-01-20
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.general
Subject: sys: add MBIM (mobile broadband interface module) interface type.
Review: Adds MBIM (Mobile Broadband Interface Module) as a new interface type, enabling support for upcoming USB mobile broadband devices.
Body:

  This is part of the upcoming USB umb(4) work.

  PR:		263783
  Approved by:	adrian, zlei
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D48167

  (cherry picked from commit 86bfbaf1002c88b5c1a6d3ed261becedb533490b)


   sys/net/if_types.h | 1 +
   1 file changed, 1 insertion(+)

[commit 9c390bd8829cef80ed276870e1117a93e8e9dfef]
Date: 2025-09-10
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: minor cleanup
Review: Minor cleanup with no functional change.
Body:

  No functional change intended.

  Sponsored by:	Netflix, Inc.

  (cherry picked from commit c3d5387a7bd814a6c341902c29a3f8aaa956fadb)


   sys/netinet/tcp_subr.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit ffd956a3918cd5e64c8850eb77247428a29f7221]
Date: 2025-09-10
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: dhclient: improve UDP checksum handling
Review: The dhclient utility now handles UDP checksums correctly, particularly for odd-length payloads and when running in virtualized environments with checksum offloading. This improves reliability in DHCP client-server communication, especially in VMs where the host serves DHCP.
Body:

  When sending UDP packets:
  * compute the checksum in the correct order. This only has an impact
    if the length of the payload is odd.
  * don't send packet with a checksum of zero, use 0xffff instead as
    required.
  When receiving UDP packets:
  * don't do any computations when the checksum is zero.
  * compute the checksum in the correct order. This only has an impact
    if the length of the payload is odd.
  * when computing the checksum, store the pseudo header checksum
  * if the checksum is computed as zero, use 0xffff instead.
  * also accept packets, when the checksum in the packet is the pseudo
    header checksum.
  The last point fixes a problem when the DHCP client runs in a VM,
  the DHCP server runs on the host serving the VM and the network
  interface supports transmit checksum offloading. Since dhclient
  doesn't use UDP sockets but bpf devices to read the packets, the
  checksum will be incorrect and only contain the checksum of the
  pseudo header.

  PR:			263229
  Reviewed by:		markj, Timo Vlker
  Tested by:		danilo
  Differential Revision:	https://reviews.freebsd.org/D52394

  (cherry picked from commit 187ee62c71f2be62870f26ae98de865e330121be)


   sbin/dhclient/packet.c | 53 +++++++++++++++++++++++++++++++++-----------------
   1 file changed, 35 insertions(+), 18 deletions(-)

[commit 06d08e6e758df2114111af415c67623ea3c1825b]
Date: 2025-01-20
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: FreeBSD Foundation
Section: Drivers.device
Subject: sys: add MBM device ioctl() values
Review: Adds ioctl values for MBM devices, which are part of the upcoming USB umb(4) driver support.
Body:

  This is part of the upcoming USB umb(4) work.  It implements the control
  ioctl(4)s that MBM devices will need to implement.

  Differential Revision:	https://reviews.freebsd.org/D48167
  Approved by:	adrian, zlei
  Sponsored by:	FreeBSD Foundation
  PR:		kern/263783
  Submitted by:	Pierre Pronchery <khorben@defora.org>

  (cherry picked from commit e5f3620a3e12c0febab7e4125da526c59a5a195b)


   sys/sys/sockio.h | 4 ++++
   1 file changed, 4 insertions(+)

[commit 289f8429c7d4e04bb939a6d4de35d7c897bd7642]
Date: 2025-09-11
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: backlight(9): add cross-ref to backlight(8)
Review: The commit adds a cross-reference from man:backlight[9] to man:backlight[8] in the manual page.
Body:

  Reviewed by:	bcr
  MFC after:	3 days

  (cherry picked from commit a74c8b8236c9816fb28186c16f7ca999f6fdd573)


   share/man/man9/backlight.9 | 2 ++
   1 file changed, 2 insertions(+)

[commit e9e9c912c5c28d15fe485e5d8850da231b1bb371]
Date: 2025-05-05
Score: 5
Status: proposed(include=no,score=20)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: flua: add posix.unistd.execp
Review: The commit adds a new function posix.unistd.execp to the flua module, providing an interface for executing programs with a search path. This matches the existing lposix interface, offering users an additional method for program execution within flua scripts.
Body:

  This matches the interface of lposix, although I do wonder why they went
  with execp rather than execvp for the function name here.

  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50177

  (cherry picked from commit 7080a0c170daf8e4b3f331ec33003b2f8893dc23)


   libexec/flua/modules/lposix.c | 57 +++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 57 insertions(+)

[commit c7608bcae4e008a8b9c7f59ee4ab9a0804fe2c9e]
Date: 2025-09-10
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: ports.7: Fix example of passing variables on the command line
Review: The man:ports.7 page now correctly describes how the make(1) -D flag works, clarifying that it does not set variable values but defines variables with a value of 1.
Body:

  make(1)'s -D flag does not allow for setting the value of the variable.
  It just defines the variable and sets its value to 1. In fact, make(1)
  treats "=" as just another character in the variable name:

  ```
  $ make -DA=2 -V A  # Output is just an empty line.

  $ make -DA=2 -V A=2  # Variable "A=2" is defined and set to "1".
  1
  ```

  Fixes:	d25f7d324a9d ports.7: Document DEBUG_FLAGS and the process of debugging ports
  MFC after:	3 days

  (cherry picked from commit 9365a328596c9f156deaa15fa018b76b3a6e6b18)


   share/man/man7/ports.7 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 00a35910b4b07d539c3e082bca3fb9a7f9ee0c43]
Date: 2025-08-31
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: bsdinstall: Drop outdated comments about ZFS dataset compression
Review: Removes outdated comments about ZFS dataset compression from man:bsdinstall[8] and the installer scripts, as compression is now default on zroot pools.
Body:

  All datasets on zroot pool are compressed by default since FreeBSD 11.0 [1],
  no need to mention that on some specific datasets these days.

  [1] 47206692f2cca020891d1eec5028e02c3e6f56c5

  Reviewed by:	jrm (mentor), ziaee
  MFC after:	3 days
  Differential Revision:	 https://reviews.freebsd.org/D52304

  (cherry picked from commit f304c5bb8be65df83b86f8a50e1c7982b266262d)


   usr.sbin/bsdinstall/bsdinstall.8    | 4 ++--
   usr.sbin/bsdinstall/scripts/zfsboot | 4 ++--
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit 5ea201a58bc719808026da1ffeed02c377f43a8a]
Date: 2025-08-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Google LLC (GSoC 2025) | The FreeBSD Foundation
Section: undecided
Subject: MAC/do: Rename the internal malloc type
Review: The commit renames an internal malloc type from M_DO to M_MAC_DO and updates descriptions, which are internal implementation details without user-visible impact.
Body:

  From M_DO to M_MAC_DO.  While here, make the descriptions more accurate.

  (Commit message by olce@.)

  Reviewed by:    olce
  MFC after:      3 days
  Sponsored by:   Google LLC (GSoC 2025)
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 6612fc306d3eb58f85f4cf4533161a1340374709)


   sys/security/mac_do/mac_do.c | 48 ++++++++++++++++++++++----------------------
   1 file changed, 24 insertions(+), 24 deletions(-)

[commit f3631902a58ffa659a5eebc15395992953b5a30b]
Date: 2025-07-25
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: chroot.8: Be more precise when describing '-u', '-g' and '-G'
Review: The man:chroot[8] manual page now provides more precise descriptions of the '-u', '-g', and '-G' options.
Body:

  Reviewed by:    kevans, ziaee
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D51511

  (cherry picked from commit 04a6dc7974ee02004c9ccbb0c28d14a3271fb56a)


   usr.sbin/chroot/chroot.8 | 14 ++++++++------
   1 file changed, 8 insertions(+), 6 deletions(-)

[commit 8392bdd176c4eb0c74888dc8ebfe077b7cbb1aaf]
Date: 2025-09-09
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: NOTES: Fix whitespace in "options MAC_DO"
Review: No user-visible change; whitespace fix only.
Body:

  For "options", we put a space before a TAB so that commenting out an
  option doesn't move the columns.

  No functional change.

  Fixes:          c8d8cac2a847 ("mac_do(4): allow compiling into kernel")
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 1cf67b587023af90f2b2c6e87d9103ec42b2b9b2)


   sys/conf/NOTES | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 995d95c309fccd312f6e1c27ad4a93544b95780a]
Date: 2025-08-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: undecided
Subject: if_ovpn tests: skip float and linklocal test on < 2.7
Review: Test changes only; no user-visible impact.
Body:

  Earlier versions (than 2.7.0) do not support float notifications or link-local
  addresses. Skip the relevant tests there.

  PR:		289150
  MFC after:	1 week
  Sponsored by:	Rubicon Communications, LLC ("Netgate")
  Differential Revision:	https://reviews.freebsd.org/D52234

  (cherry picked from commit 512d3c3a2c6391cee61ff41e3fe6304973346857)


   tests/sys/net/if_ovpn/if_ovpn.sh |  2 ++
   tests/sys/net/if_ovpn/utils.subr | 19 +++++++++++++++++++
   2 files changed, 21 insertions(+)

[commit 36f4d6dc0d3ab0e69ccdd39aa06793ac6b1968c2]
Date: 2025-09-10
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: ixgbe: Correct ixgbe_link_speed_to_str comment
Review: The commit only fixes a comment in the ixgbe driver, which has no user-visible impact.
Body:

  PR:		288960
  Reported by:	michaelo

  (cherry picked from commit c1532f74e4684f4b4227e873bae05b16ccc0a17c)


   sys/dev/ixgbe/if_ix.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 7dc494e6377451469763a8a687032dee2b8324b2]
Date: 2025-09-09
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: ixgbe: Fix incomplete speed coverage in link status logging
Review: The ixgbe driver now correctly logs link speeds other than 1 Gbps and 10 Gbps, such as 2.5 Gbps or 5 Gbps, in system messages.
Body:

  Originally ixgbe_if_update_admin_status() only handled 1G and 10G speeds,
  causing any other speeds to display as "1 Gbps" in link status logs.

  This issue is fixed by adding link speed to string conversion logic through
  the introduction of a helper function, ixgbe_link_speed_to_str(), which
  corrects the misleading logs to reflect accurate link speeds.

  Signed-off-by: Yogesh Bhosale yogesh.bhosale@intel.com

  PR:		288960
  Reported by:	Mike Belanger - QNX
  Differential Revision:	https://reviews.freebsd.org/D52442

  (cherry picked from commit 46347b3619757e3d683a87ca03efaf2ae242335f)


   sys/dev/ixgbe/if_ix.c | 34 +++++++++++++++++++++++++++++++---
   1 file changed, 31 insertions(+), 3 deletions(-)

[commit 1522c8af3676da7fcccb3f4ba2b290a9c209623b]
Date: 2025-07-09
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.contrib
Subject: flua: fbsd: allow stdout to be captured for exec() processes
Review: The fbsd module in flua now allows capturing stdout from exec() processes, enabling Lua scripts to read output from executed commands.
Body:

  This allows us to do things like:

  ```
  local fp = assert(fbsd.exec({"ls", "-l"}, true))
  local fpout = assert(fp:stdout())

  while true do
          local line = fpout:read("l")
          if not line then break end
          print("Read: " .. line)
  end

  fp:close()
  ```

  The makeman lua rewrite will use it to capture `make showconfig` output
  for processing.

  Reviewed by:	bapt
  Differential Revision:	https://reviews.freebsd.org/D50539

  (cherry picked from commit 3f0e1092097ed63b83a02518395e370c3cac01be)


   libexec/flua/modules/lfbsd.c | 95 ++++++++++++++++++++++++++++++++++++++------
   1 file changed, 82 insertions(+), 13 deletions(-)

[commit d9412b5fff915aa4d0c21d863a1a6d2e08bafbb0]
Date: 2025-07-09
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.contrib
Subject: flua: fbsd: return a process handle to operate on when we exec()
Review: The flua module now returns a process handle when executing commands, allowing interaction with the process's stdin and future stdout capture. The handle automatically closes and waits for the process on garbage collection, preventing resource leaks for existing scripts.
Body:

  This gives us some way to be able to write to stdin if we want to, or
  as a future improvement, will allow us to extract stdout from the
  process.  The handle is setup to close and waitpid() on close/gc so that
  existing users wouldn't necessarily leak for the lifetime of the script
  if they weren't adopted to the new model.

  Reviewed by:	bapt
  Differential Revision:	https://reviews.freebsd.org/D50538

  (cherry picked from commit 6a2c624b35a0c760b00b9a34c10b7ea0c240c677)


   libexec/flua/modules/lfbsd.c | 94 ++++++++++++++++++++++++++++++++++++++++----
   1 file changed, 86 insertions(+), 8 deletions(-)

[commit 5e6d22fffb23b94273a13a8b58d822596451e8a8]
Date: 2025-07-09
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: flua: fbsd: avoid leaking stdin pipes on error
Review: The commit fixes a resource leak in the flua module's handling of stdin pipes, which may affect processes using the lfbsd module in flua scripts.
Body:

  Additionally, there's no way to get to the end without a valid
  stdin_pipe[1] at the moment, so don't check for it.  stdin_pipe[0] is
  closed earlier, as the parent shouldn't need the read-side of the pipe.

  While we're here, also free the file actions earlier and on error --
  they're not necessary once posix_spawnp() has returned.

  Reviewed by:	bapt
  Differential Revision:	https://reviews.freebsd.org/D50537

  (cherry picked from commit 0610ba6cdbf2d8bed2619ae78ef2da5ee9c30b94)


   libexec/flua/modules/lfbsd.c | 16 ++++++++++------
   1 file changed, 10 insertions(+), 6 deletions(-)

[commit f56402485dd54c7a2d88cb145864bba59b8d4532]
Date: 2025-07-07
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.libraries
Subject: lposix: Clean up the posix namespace definitions
Review: The lposix module's namespace structure is changed so that 'posix' and 'posix.sys' are proper tables, affecting code that directly accesses posix submodules via _G["posix.sys.utsname"].uname().
Body:

  The posix module is subdivided according to C headers; for instance,
  posix.unistd contains routines available from unistd.h, such as
  chown(2).

  A quirk of our implementation is that each of the modules is a direct
  entry in the global table.  That is, there is no "posix" table.
  Instead, "posix.foo" and "posix.bar.baz" are both top-level tables.
  This is surprising and goes against Lua's shorthand of using "." to
  access keys in a table.  lua-posix also doesn't work this way.

  Rework things so that "posix" and "posix.sys" are proper tables.
  Existing flua code which uses require() to bind posix submodules to a
  name will be unaffected.  Code which accesses them directly using
  something like _G["posix.sys.utsname"].uname() will be broken, but I
  don't think anything like that exists.  In particular, it is now
  possible to call posix.sys.utsname.uname() without any require
  statements.

  Reviewed by:	imp, bapt
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51158

  (cherry picked from commit eda96744b434325c475dce449744f2268f1033e8)


   libexec/flua/linit_flua.c     | 10 +--------
   libexec/flua/modules/lposix.c | 51 +++++++++++++++++++++++++++++++++----------
   libexec/flua/modules/lposix.h |  8 +------
   3 files changed, 42 insertions(+), 27 deletions(-)

[commit 7f6da651e23f4fbafac04ad77f1bdf74deec5882]
Date: 2025-05-05
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Userland.libraries
Subject: flua: add posix.unistd.dup2()
Review: The Lua module for POSIX functions now includes man:dup2[2] support, allowing scripts to duplicate file descriptors.
Body:

  Reviewed by:	emaste
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50176

  (cherry picked from commit 909aa6781340f8c0b4ae01c6366bf1556ee2d1be)


   libexec/flua/modules/lposix.c | 34 ++++++++++++++++++++++++++++++++++
   1 file changed, 34 insertions(+)

[commit c406a288e1e5083119d3b728c083b129a3ea104f]
Date: 2023-09-13
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Userland.contrib
Subject: flua: add fbsd module
Review: The fbsd module is added to flua, providing the exec function to execute programs without invoking a shell.
Body:

  This module is bundled into flua, it only provides for now the exec
  function. The point of the function is to be able to execute a program
  without actually executing a shell.

  to use it:
  fbsd.exec({"id", "bapt"})

  Reviewed by:	manu
  Differential Revision:	https://reviews.freebsd.org/D41840

  (cherry picked from commit 1f31e00e19f9e24d4c891a24973e08a027c4f71c)


   libexec/flua/Makefile        |   2 +-
   libexec/flua/linit_flua.c    |   2 +
   libexec/flua/modules/lfbsd.c | 134 +++++++++++++++++++++++++++++++++++++++++++
   libexec/flua/modules/lfbsd.h |  32 +++++++++++
   4 files changed, 169 insertions(+), 1 deletion(-)

[commit d140a121523e4a13cb8c04c317e85bf20284e24e]
Date: 2025-09-08
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Drivers.device
Subject: vtnet: fix compilation for NOIP configs
Review: The commit fixes a compilation error for vtnet driver when NOIP is configured, ensuring the driver builds correctly in such setups.
Body:

  Reported by:	bz
  Fixes:		3008f30d2c2c ("vtnet: improve checksum offloading")

  (cherry picked from commit 614e9b33bf5594d9d09b5d296afa4f3aa6971823)


   sys/dev/virtio/network/if_vtnet.c | 9 +++++++++
   1 file changed, 9 insertions(+)

[commit 07625c420dc30cc484018c269bb7a212436ded8a]
Date: 2025-09-08
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: vtnet: improve checksum offloading
Review: The vtnet driver improves checksum offloading by correctly mapping checksum flags between FreeBSD and virtio network headers. This fixes checksum offloading issues for virtual network interfaces.
Body:

  When transmitting a packet over the vtnet interface, map the
  csum flags CSUM_DATA_VALID | CSUM_PSEUDO_HDR to the virtio
  flag VIRTIO_NET_HDR_F_DATA_VALID.
  When receiving a packet over the virtio network channel, translate
  the virtio flag VIRTIO_NET_HDR_F_NEEDS_CSUM not to CSUM_DATA_VALID |
  CSUM_PSEUDO_HDR, but to CSUM_TCP, CSUM_TCP_IPV6, CSUM_UDP, or
  CSUM_UDP_IPV6.
  The second change fixes a series of issue related to checksum
  offloading for if_vtnet.
  While there, improve the stats counters to allow a detailed view
  on what is going on in relation to checksum offloading.

  PR:			165059
  Reviewed by:		tuexen, manpages
  Differential Revision:	https://reviews.freebsd.org/D51686

  (cherry picked from commit 3008f30d2c2cabdd7e17f7fb922139da8681ffbd)


   share/man/man4/vtnet.4               |  28 +++--
   sys/dev/virtio/network/if_vtnet.c    | 220 ++++++++++++++++++-----------------
   sys/dev/virtio/network/if_vtnetvar.h |   2 +-
   3 files changed, 132 insertions(+), 118 deletions(-)

[commit c456341202556f1119ae21c8a707d5dd327f5149]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: tests: disable transmit checksum offloading for epair interfaces
Review: The commit disables transmit checksum offloading for epair interfaces in test environments to ensure checksums are computed for verification.
Body:

  When transmit checksum offloading is enabled, if_epair does not
  compute checksums, it just marks packets that this computation still
  needs to be done. However, some test cases verify the checksum.
  Therefore disable this for IPv4 and IPv6.

  Reviewed by:		kp
  Differential Revision:	https://reviews.freebsd.org/D52379

  (cherry picked from commit bd8296e7173aa625f6d4d766aac2df6be639e49a)


   tests/atf_python/sys/net/vnet.py | 1 +
   tests/sys/common/vnet.subr       | 5 +++++
   2 files changed, 6 insertions(+)

[commit f103de98b855e69f1c0e1e90f7a174ae06acf892]
Date: 2025-09-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.config
Subject: sh, csh: Add config tag to /.profile and /.cshrc
Review: The config tag is added to /.profile and /.cshrc to prevent pkg upgrade from overwriting these files, ensuring user customizations are preserved.
Body:

  The file /.profile is installed as a hard link to /root/.profile. The
  file in /root has the config tag, but the file in / does not, which
  causes it to be overwritten by pkg upgrade. Since they're linked, this
  also overwrites the file in /root.

  Add the config tag to the file in / as well, so pkg treates both links
  as config files and won't overwrite them.

  For stable/14, also add this to /.cshrc, which is no longer installed
  in 15.0.

  PR:		289097
  MFC after:	3 days
  Reviewed by:	bapt, emaste
  Differential Revision:	https://reviews.freebsd.org/D52162

  (cherry picked from commit aa730a66bc74696df85b21ec2719c75d8eab8c9f)

  sh: Fix non-NO_ROOT installconfig

  When building without NO_ROOT, ${TAG_ARGS} is not set, which means we
  pass ",config" as an install(1) argument.  Only add the config tag if
  ${TAG_ARGS} is defined to begin with.

  Fixes:	aa730a66bc74 ("sh: Add config tag to /.profile")
  Reported by:	bz

  (cherry picked from commit b197d2abcb6895d78bc9df8404e374397aa44748)


   bin/csh/Makefile | 4 ++--
   bin/sh/Makefile  | 2 +-
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 604830cbe5a66a80f2c8b5b1ba51c84d22fd7b98]
Date: 2025-08-26
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Ports.packaging
Subject: sendmail: Remove runtime dependency on clang
Review: The sendmail build no longer requires a C compiler at runtime, which may affect build environments without compilers installed.
Body:

  etc/mail/Makefile includes bsd.own.mk, which includes bsd.compiler.mk,
  which fails with an error if it can't locate a C compiler.  Set
  _WITHOUT_SRCCONF=yes before including bsd.own.mk to disable this
  behaviour.

  Reviewed by:	gshapiro
  Differential Revision:	https://reviews.freebsd.org/D52134

  (cherry picked from commit e957c041d7058fcf070323e847db2c0c0479a111)


   etc/mail/Makefile | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit 4a4b3f8c0a997e583045b6f4f4b49ff943355f56]
Date: 2025-06-05
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: pw: Skip root check with alternate root
Review: The man:pw[8] utility now allows unprivileged users to run with an alternate root directory, enabling image or jail creation without requiring full root privileges. Permission errors are still reported if the user lacks appropriate access to files.
Body:

  pw may be run by an unprivileged user for creating an image or jail.
  EPERM will still be reported from the file open if the user does not
  have appropriate permission.

  Reviewed by:	markj
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50710

  (cherry picked from commit 142b4309f42d5018a92ad5e08943fd1081a9ea57)


   usr.sbin/pw/pw.8      |  9 +++++++--
   usr.sbin/pw/pw.c      |  1 +
   usr.sbin/pw/pw_user.c | 18 ++++++++++++------
   usr.sbin/pw/pwupd.h   |  1 +
   4 files changed, 21 insertions(+), 8 deletions(-)

[commit 78343cd2a0f1805d5b831302eee8b0e0b173570a]
Date: 2024-07-29
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: pw: Clarify groupadd/groupmod memberlist formats
Review: The man:groupadd[8] and man:groupmod[8] manual pages now clarify the acceptable formats for member lists with the '-M', '-m', and '-d' flags.
Body:

  Clarify in which formats the memberlist for groupadd/groupmod can be
  accepted for '-M', '-m', or '-d' flag.

  Related commit:	40ab104eaa6f6d5577dcff6d8bf04de03faef345.

  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1352

  (cherry picked from commit d573295659550cf4bfbf3aaaf97d050fe7416d77)


   usr.sbin/pw/pw.8 | 5 +++--
   1 file changed, 3 insertions(+), 2 deletions(-)

[commit 9a69781361576e597f68b25e22925f8c24b9e433]
Date: 2025-08-30
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Netflix, Inc.
Section: Docs.manpages
Subject: syncache.4: add missing information
Review: The man:syncache[4] man page now includes descriptions for one sysctl variable and three counters displayed by netstat.
Body:

  Add the description for one sysctl-variable and three counters provided
  by netstat.

  Reviewed by:		gbe, rscheff
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52226

  (cherry picked from commit bed2299823b8173fd791c0bbacc75ac224cecc0a)


   share/man/man4/syncache.4 | 29 +++++++++++++++++++++++++++--
   1 file changed, 27 insertions(+), 2 deletions(-)

[commit 31c467da81d349767264182bee218bb60ea78924]
Date: 2025-08-30
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: improve sending of SYN-cookies
Review: The sysctl net.inet.tcp.syncookies_only now consistently enables SYN-cookie-only mode, preventing SYN-cache entries when set. The tcps_sc_completed statistic no longer counts connections established via SYN-cookies.
Body:

  Ensure that when the sysctl-variable net.inet.tcp.syncookies_only is
  non zero, SYN-cookies are sent and no SYN-cache entry is added to the
  SYN-cache. In particular, this behavior should not depend on the value
  of the sysctl-variable net.inet.tcp.syncookies, which controls whether
  SYN cookies are used in combination with the SYN-cache to deal with
  bucket overflows.
  Also ensure that tcps_sc_completed does not include TCP connections
  established via a SYN-cookie.
  While there, make V_tcp_syncookies and V_tcp_syncookiesonly bool
  instead of int, since they are used as boolean variables.

  Reviewed by:		rscheff, cc, Peter Lei, Nick Banks
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52225

  (cherry picked from commit 7b57f2513361fb98fd5e2262f130989fe65946c6)


   sys/netinet/tcp_syncache.c | 85 +++++++++++++++++++++++++---------------------
   1 file changed, 46 insertions(+), 39 deletions(-)

[commit 1b72d275eef4b3219708bbe9ef5a898c967195dd]
Date: 2025-06-17
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: tcp: unlock before syncookie_expand()
Review: The commit removes an unnecessary lock in the TCP syncookie expansion path, which may slightly improve performance under SYN flood conditions.
Body:

  The function doesn't need a lock on sch.  It uses the pointer as value for
  the SipHash calculation.

  Reviewed by:		tuexen
  Differential Revision:	https://reviews.freebsd.org/D50898

  (cherry picked from commit 0809d26de24defdc4a2ae161357566c02dc163d1)


   sys/netinet/tcp_syncache.c | 7 +++----
   1 file changed, 3 insertions(+), 4 deletions(-)

[commit ea5560f2293b9f2c69f62cba6b122c91b0b8eb3b]
Date: 2025-06-17
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: tcp: increase tcps_sc_recvcookie only in the syncache_expand()
Review: The commit fixes a counter bug in the TCP syncookie mechanism that only occurs when INVARIANTS is enabled, preventing incorrect statistics in diagnostic builds. This has no impact on normal production systems.
Body:

  The syncookie_expand() is called from syncookie_cmp() in INVARIANTS mode
  to confirm that values calculated via syncookies mechanism match those
  stored in the syncache entry.  This creates a counting bug, that with
  INVARIANTS every successful use of syncache also counts as use of a
  syncookie.

  Reviewed by:		tuexen
  Differential Revision:	https://reviews.freebsd.org/D50897

  (cherry picked from commit 3ed8d5645dd42a7c080ba800cf6d25cb7e147d7e)


   sys/netinet/tcp_syncache.c | 5 +++--
   1 file changed, 3 insertions(+), 2 deletions(-)

[commit f5d8084a8d5cb01de66f8e3c49597c05d79edca4]
Date: 2025-06-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: tcp: refactor debug function syncookie_cmp()
Review: This commit refactors internal debug functions and does not introduce any user-visible changes, such as new features, configuration changes, or bug fixes affecting behavior.
Body:

  - Don't bzero() the test structure.  All fields checked are set by
    syncache_expand().
  - Don't allocate TCP address logging string if there is nothing to report.
  - Mark hash bucket argument as pointer to const.
  - Make it void.

  Differential Revision:	https://reviews.freebsd.org/D50896

  (cherry picked from commit e9e6a025b4523c9aa2885e892495601964e03056)


   sys/netinet/tcp_syncache.c | 43 ++++++++++++++++++++++---------------------
   1 file changed, 22 insertions(+), 21 deletions(-)

[commit d6849a3b13f2f704aefd48fcfc6fc2d9c2834903]
Date: 2025-06-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: tcp: rename syncookie_lookup() into syncookie_expand() and make it bool
Review: The commit renames an internal function and changes its return type for code clarity, but explicitly states there are no functional changes. This is a refactoring/cleanup with no user-visible impact.
Body:

  This function always returns the same pointer it was passed.  With new
  name and return type the code is easier to understand.  Mark the hash
  bucket argument as pointer to const, since function doesn't modify it,
  just uses value as integer.  No functional changes.

  Reviewed by:		tuexen
  Differential Revision:	https://reviews.freebsd.org/D50895

  (cherry picked from commit 6538742c1aaca3ce522ccea95007dfa9686c78dd)


   sys/netinet/tcp_syncache.c | 24 +++++++++++++-----------
   1 file changed, 13 insertions(+), 11 deletions(-)

[commit caf162412dbc74e71ca2ac02e2a8a96e5e086f47]
Date: 2025-08-25
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: exports.5: Add a paragraph clarifying the use of "V4:"
Review: The man:exports[5] man page now includes a paragraph clarifying the use of "V4:" lines to define the NFSv4 export subtree root.
Body:

  The exports.5 man page is a bit of a monster.
  One place of common confusion is the use of
  the "V4:" line(s) for defining the location of the
  root of the NFSv4 export subtree.

  This patch adds a paragraph in an attempt to
  clarify this.

  This is a content change.

  (cherry picked from commit 200730f29dbc8da2aa9392b35518bf77b8899f89)


   usr.sbin/mountd/exports.5 | 15 ++++++++++++++-
   1 file changed, 14 insertions(+), 1 deletion(-)

[commit 5d65c9eeb8057ac796cf9b51ab3fa3d30b06e91c]
Date: 2025-09-02
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: micro-optimize SYN-cookie expansion
Review: No functional change intended; only micro-optimizations and type changes.
Body:

  Only compute wscale when it is actually used. While there, change the
  type of wscale to u_int as suggested by glebius.
  No functional change intended.

  Reviewed by:		glebius, rscheff (older version)
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52296

  (cherry picked from commit 341d1aabc13e47911d2eb38e857b90f7d356134e)


   sys/netinet/tcp_syncache.c | 14 ++++++++------
   1 file changed, 8 insertions(+), 6 deletions(-)

[commit c9467d0b562c03a10ae358922eec6427bf250d03]
Date: 2025-08-06
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: freebsd-update: Fix the pkgbase check
Review: The freebsd-update utility now correctly handles pkgbase checks when upgrading non-pkgbase jails, allowing upgrades to proceed without requiring root privileges for the pkg command.
Body:

  Even on a pkgbase system, it should be possible to use freebsd-update -j
  to upgrade a non-pkgbase jail, at least for the time being.  However,
  the check_pkgbase() call came before get_params, so BASEDIR was always
  set to /.

  Make check_pkgbase() a pure function and call it after get_params().
  While here, use pkg -r ${BASEDIR} instead of pkg -c ${BASEDIR} since the
  latter requires root privileges.  freebsd-update is supposed to be run
  as root, but it doesn't actually check this that I can see, so let's not
  make that assumption here since it affects the result of the function
  (i.e., pkg -c ${BASEDIR} always fails as a non-root user).

  Reviewed by:	des
  Fixes:		856e158dc4aa ("freebsd-update: improve pkgbase check")
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51770

  (cherry picked from commit 66c75fa63aff40e9c587345b2cc6b8148e396de8)


   usr.sbin/freebsd-update/freebsd-update.sh | 29 ++++++++++++++++-------------
   1 file changed, 16 insertions(+), 13 deletions(-)

[commit d779cb94daaa5f1c172cbe413c66a331730763b7]
Date: 2025-07-29
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.libraries
Subject: libc/amd64: rewrite memrchr() baseline impl. to read the string from the back
Review: The memrchr() implementation on amd64 is rewritten to improve performance for searches near the end of strings.
Body:

  This ensures O(1) behaviour if the character is a constant offset
  from the end of the string, regardless of how long the string is.

  Reported by:	Mikael Simonsson <m@mikaelsimonsson.com>
  Reviewed by:	benni
  PR:		288321
  MFC after:	1 month

  (cherry picked from commit 4b15965daa99044daf184221b7c283bf7f2d7e66)


   lib/libc/amd64/string/memrchr.S | 152 +++++++++++++++++++---------------------
   1 file changed, 74 insertions(+), 78 deletions(-)

[commit 7caa8fbd17a8a50df6677f2e7c6a6cade053366e]
Date: 2025-07-29
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: libc/amd64: rewrite memrchr() scalar impl. to read the string from the back
Review: The memrchr() scalar implementation for amd64 is rewritten, which may affect performance when opting out of SSE usage.
Body:

  A very simple implementation as I don't have the patience right now
  to write a full SWAR kernel.  Should still do the trick if you wish
  to opt out of SSE for some reason.

  Reported by:	Mikael Simonsson <m@mikaelsimonsson.com>
  Reviewed by:	strajabot
  PR:		288321
  MFC after:	1 month

  (cherry picked from commit 30acc84270266e41f66cf572f67c3290d923da2f)


   lib/libc/amd64/string/memrchr.S | 72 +++++++++++++++++++----------------------
   1 file changed, 34 insertions(+), 38 deletions(-)

[commit b84156e7f136792d3a34f5338635e5b41b256b4f]
Date: 2025-09-03
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: nfsd: Fix the NFSv4 Readdir operation for an empty ZFS dir
Review: The NFSv4 Readdir operation now correctly handles empty ZFS directories, preventing an EINVAL error when the directory contains only "." and ".." entries.
Body:

  Commit 9a3edc8 modified the behaviour of ZFS's
  VOP_READDIR() such that it will reply EINVAL for
  an offset past EOF on the directory.

  This exposed a latent bug in the NFSv4 Readdir
  code, which would attempt a Readdir with an
  offset beyond EOF for a directory that consists
  of only "." and "..". This happened because NFSv4
  does not reply "." or ".." to the client and, after
  skipping over them, attempted another VOP_READDIR().

  This patch fixes the problem by checking the eofflag
  for the case where all entries have been skipped over.

  Reviewed by:	kib
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D52370

  (cherry picked from commit 1c52d525f06411726d7755081f904de64749eb9b)


   sys/fs/nfsserver/nfs_nfsdport.c | 3 +++
   1 file changed, 3 insertions(+)

[commit a2230148a649404b44b1c5b8283c951f790c3b32]
Date: 2025-09-03
Score: 5
Status: proposed(include=yes,score=5)
Sponsor: Netflix, Inc.
Section: Docs.manpages
Subject: vtnet.4: remove stray line
Review: Removes a stray line from the man:vtnet[4] manual page, improving readability.
Body:

  Reported by:	Timo Vlker
  Fixes:		ac87d70563f8 ("vtnet.4: improve existing descriptions and add missing ones")
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 491986942dd2b3be8a6f232c487b3bb7c1ea412b)


   share/man/man4/vtnet.4 | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit 35693dc5d55bca988af04f251d99d6c9975d0c95]
Date: 2025-08-28
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Drivers.device
Subject: vtnet: mark statistic counters with CTLFLAG_STATS
Review: The vtnet driver's statistic counters are now marked with CTLFLAG_STATS, which may affect how they are displayed or collected by monitoring tools.
Body:

  Reviewed by:	Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D51999

  (cherry picked from commit e6253eac1ab346d70db79d638c200bffa65cae02)


   sys/dev/virtio/network/if_vtnet.c | 70 +++++++++++++++++++++++----------------
   1 file changed, 42 insertions(+), 28 deletions(-)

[commit 2db6762a6950f4c7699dca6c2b65a1a2f2c52213]
Date: 2025-08-28
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: remove stale comment
Review: Removes a stale comment in the TCP syncache code with no user-visible impact.
Body:

  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 9a4b30dabf075ce1c7565ffbec1d34d52f7dbefd)


   sys/netinet/tcp_syncache.c | 1 -
   1 file changed, 1 deletion(-)

[commit f0f1e749448fff002a781c0b649d402a8e7133a1]
Date: 2025-08-28
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: vtnet: fix computation of sysctl variables
Review: The vtnet driver sysctl counters for TX/RX task rescheduling, TSO offloading, checksum offloading, and checksum failures now correctly aggregate statistics. The dev.vtnet.X.tx_defrag_failed counter now only counts actual defragmentation failures.
Body:

  Fix the aggregation of the interface level counters
  * dev.vtnet.X.tx_task_rescheduled,
  * dev.vtnet.X.tx_tso_offloaded,
  * dev.vtnet.X.tx_csum_offloaded,
  * dev.vtnet.X.rx_task_rescheduled,
  * dev.vtnet.X.rx_csum_offloaded, and
  * dev.vtnet.X.rx_csum_failed.
  Also ensure that dev.vtnet.X.tx_defrag_failed only counts the number
  of times m_defrag() fails.
  While there, mark sysctl-variables used for exporting statistics as
  such (CTLFLAG_STATS).

  Reviewed by:		Timo Vlker
  Differential Revision:	https://reviews.freebsd.org/D51999

  (cherry picked from commit 03da4395158d374b5e38623f6744ce31302b530c)


   sys/dev/virtio/network/if_vtnet.c | 131 ++++++++++++++++++++++++++++++++++----
   1 file changed, 117 insertions(+), 14 deletions(-)

[commit bb2287ec1b0170e0f52a13c44d5571dbcfd6fff0]
Date: 2025-08-26
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: netstat: improve statistic output for sctp
Review: man:netstat(1) now displays receive and transmit checksum offloading counters for SCTP connections.
Body:

  Provide counters for receive and transmit checksum offloading for
  SCTP.

  (cherry picked from commit 6d988ec3a76135409730313877b3eb0b8a7517fc)


   usr.bin/netstat/sctp.c | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit 37c6c4daae1538cd623971bdef1caea3cbb90d54]
Date: 2025-08-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: epair: don't include if_var.h twice
Review: The commit removes a duplicate header inclusion in the epair driver, which is an internal cleanup with no user-visible impact.
Body:

  Sponsored by:	Netflix, Inc.

  (cherry picked from commit f5dbf1b1c725da226fd45937decb5a5652ac1422)


   sys/net/if_epair.c | 1 -
   1 file changed, 1 deletion(-)

[commit 68ff713966ed2f5e9e78ca6c782bbef2e657623a]
Date: 2025-08-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Netflix, Inc.
Section: undecided
Subject: vtnet.4: use transmit checksum offloading
Review: The commit updates man:vtnet[4] to use consistent terminology for transmit checksum offloading.
Body:

  Use transmit checksum offloading instead transmission checksum
  offloading to be consistent with other man pages.

  Reported by:	Peter Lei
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit c7263f873ee9abb772f67b5536e2380a046e1b94)


   share/man/man4/vtnet.4 | 10 +++++-----
   1 file changed, 5 insertions(+), 5 deletions(-)

[commit 25c0c8725fbb1713543429709077cbb78bac0c51]
Date: 2025-08-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: vtnet, ptnet: include opt_*.h files early
Review: The commit adjusts header inclusion order and removes redundant includes in vtnet and ptnet drivers, which is an internal build fix with no direct user-visible impact.
Body:

  Include opt_inet.h and opt_inet6.h early in the files including
  virtio_net.h, since they use INET and/or INET6.
  While there, remove redundant inclusion of sys/types.h, since it is
  included already by sys/param.h.

  There was a discussion to include opt_inet.h and opt_inet6.h also
  in virtio_net.h. glebius suggested to add a mechanism for files
  to check, if required opt_*.h files were included. virtio_net.h
  will be the first consumer of this mechanism.

  Reviewed by:		glebius, Peter Lei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52046

  (cherry picked from commit 3077532b1bb2911d3012ee90bae9d9499c960569)


   sys/dev/netmap/if_ptnet.c         | 6 ++----
   sys/dev/virtio/network/if_vtnet.c | 6 +++---
   2 files changed, 5 insertions(+), 7 deletions(-)

[commit c2fe29000d17861ca6e16ceb112adb20880f1341]
Date: 2025-08-21
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: Netflix, Inc.
Section: Docs.manpages
Subject: vtnet.4: improve existing descriptions and add missing ones
Review: The vtnet(4) driver manual page is updated with improved descriptions of loader tunables and sysctl statistics.
Body:

  Improve several descriptions for loader tunables and add descriptions
  of the statistics provided by read only sysctl-variables.

  Reviewed by:		bcr
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51985

  (cherry picked from commit ac87d70563f85d53575956c6fe40615b2e501c13)


   share/man/man4/vtnet.4 | 142 ++++++++++++++++++++++++++++++++++++++++++++++---
   1 file changed, 136 insertions(+), 6 deletions(-)

[commit 9feb2ac05b77a10f992107f2fbc1ab61c058f200]
Date: 2025-08-18
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: icmp: clear offset and flags when reflecting a packet
Review: The ICMP packet reflection code now clears the offset and flags fields, including the DF bit, when generating an ICMP error response.
Body:

  When reflecting a packet, use an offset of 0 and clear all three bits,
  in particular the DF bit.

  PR:			288558
  Reviewed by:		markj, zlei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51991

  (cherry picked from commit b9a2d84b1bf7f9cf556e2f0b68023d5af8362797)


   sys/netinet/ip_icmp.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 19bb9fecba8ea76bf320b6732c3900c554b4a347]
Date: 2025-08-13
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Netflix, Inc.
Section: Userland.programs
Subject: systat: improve reporting of UDP statistics
Review: The systat utility now reports undelivered multicast and broadcast UDP packets separately in its IP statistics display.
Body:

  Report the undelivered multi and broadcast UDP packets separately.

  Reviewed by:		rrs, cc
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51884

  (cherry picked from commit b9de52a0ec07088006dc373c2d882f410aa51f1e)


   usr.bin/systat/ip.c | 20 ++++++++++++--------
   1 file changed, 12 insertions(+), 8 deletions(-)

[commit fd86cd7a7f499358f4402e9963529e3637b508ed]
Date: 2025-08-13
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Userland.programs
Subject: netstat: report undelivered multi and broadcast UDP packets correctly
Review: The man:netstat[1] utility now correctly reports the sum of undelivered broadcast and multicast UDP packets instead of only broadcast packets. This ensures accurate statistics for network monitoring.
Body:

  When reporting undelivered broadcast/multicast datagrams, don't just
  report the undelivered broadcast ones. Actually report the sum of both.
  Alternatively, one could also report broadcast and multicast datagrams
  separately, but that would change the output format of netstat.
  While there, use the correct type for casting a variable printed
  with %ju.

  Reviewed by:		cc
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51881

  (cherry picked from commit 2b068d35de84975ea4b04a19413786663a51dc70)


   usr.bin/netstat/inet.c | 11 +++++++----
   1 file changed, 7 insertions(+), 4 deletions(-)

[commit 4eb741473379cec354a5f478a6cc94a31d505dfd]
Date: 2025-08-12
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: netstat: remove unneeded cast
Review: Minor internal cleanup with no user-visible impact.
Body:

  delivered is already an uint64_t, so no need to cast it to that
  type.

  Sponsored by:		Netflix, Inc.

  (cherry picked from commit 6bca82843e5605fc242211093b56d1129eb4307c)


   usr.bin/netstat/inet.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5cdd4a1bf2cc94553f397b590c743f94e7bd589a]
Date: 2025-08-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: retire rstreason
Review: The commit removes an internal TCP variable and parameter with no functional changes or user-visible impact.
Body:

  With the latest changes, this variable and parameter for
  tcp_dropwithreset() is not needed anymore.
  It also makes it harder to introduce the usage of multiple counters
  for TCP again, which might open side channel attacks.
  No funtional changes intended.

  Reviewed by:		rrs
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51872

  (cherry picked from commit 463b5aed0d62f094addb700604725767a8904901)


   sys/netinet/tcp_input.c                  | 30 +++++++-----------------------
   sys/netinet/tcp_stacks/bbr.c             | 26 +++++++++++++-------------
   sys/netinet/tcp_stacks/rack.c            | 26 +++++++++++++-------------
   sys/netinet/tcp_stacks/rack_bbr_common.c | 10 +++++-----
   sys/netinet/tcp_stacks/rack_bbr_common.h |  4 ++--
   sys/netinet/tcp_var.h                    |  3 +--
   6 files changed, 41 insertions(+), 58 deletions(-)

[commit 95fbcd9cada82ca2e9be6a385f2225670c7d509f]
Date: 2025-08-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: minor cleanup
Review: No functional change intended; only internal code cleanup.
Body:

  Don't use the rstreason variable as a hint that a second lookup is
  performed, since the rstreason variable will be removed.
  Use the INPLOOKUP_WILDCARD flag in the lookupflag variable instead.
  No functional change intended.

  Reviewed by:		rrs
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51847

  (cherry picked from commit 6e07231667e639bd825e6cdb67609a39e3098e9d)


   sys/netinet/tcp_input.c | 28 ++++++++++++++--------------
   1 file changed, 14 insertions(+), 14 deletions(-)

[commit 9eb5c85c70fcfeeaab9d2d5410a566e16309ced1]
Date: 2025-08-12
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: udp: use appropriate error counters
Review: The commit updates UDP error handling to use multicast and broadcast-specific counters, which may affect monitoring and debugging of UDP traffic.
Body:

  Since there are multicast and broadcast specific error counters,
  use them.

  Reviewed by:		rrs
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51869

  (cherry picked from commit 0312f80349eedfc2b0d2f24b4fd073795148d3d5)


   sys/netinet/udp_usrreq.c | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit 86c4e2d071ca335ad4460a3643b4ece9799cfc82]
Date: 2025-08-11
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: icmp: remove unused BANDLIM_UNLIMITED
Review: The commit removes an unused constant from the ICMP subsystem, which has no user-visible impact.
Body:

  Reviewed by:		Nick Banks
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51849

  (cherry picked from commit 52a94237615c6d3b6c928e41d9c7168ff6979996)


   sys/netinet/icmp_var.h | 1 -
   sys/netinet/ip_icmp.c  | 2 +-
   2 files changed, 1 insertion(+), 2 deletions(-)

[commit d1ab6d36aeb21091f7a442ca78aa2ca9a8941875]
Date: 2025-08-09
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: mitigate a side channel for detection of TCP connections
Review: The TCP stack increments a global counter when generating challenge ACKs, mitigating a side channel that could allow detection of existing TCP connections.
Body:

  If a blind attacker wants to guess by sending ACK segments if there
  exists a TCP connection , this might trigger a challenge ACK on an
  existing TCP connection. To make this hit non-observable for the
  attacker, also increment the global counter, which would have been
  incremented if it would have been a non-hit.
  This issue was reported as issue number 11 in Keyu Man et al.:
  SCAD: Towards a Universal and Automated Network Side-Channel
        Vulnerability Detection

  Reviewed by:		Nick Banks, Peter Lei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51724

  (cherry picked from commit f0f6e50388963cae44bb92bb69ed7a1135dd2eec)


   sys/netinet/tcp_subr.c | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit e7331da314b57c39cf5c3fb5f20a2963b2485ce6]
Date: 2025-08-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: rate limit the sending of all RST segments
Review: Rate limiting of TCP RST segments is extended to cover additional cases, including data on closed sockets and certain handshake failures, reducing the impact of RST storms.
Body:

  Also rate limit the sending of RST segments in the following cases:
  * when receiving data on a closed socket.
  * when a socket can not be created at the end of the handshake and
    the sysctl-variable net.inet.tcp.syncache.rst_on_sock_fail is 1.
  * when an ACK segment is received in SYN SENT state and it does not
    acknowledge the SYN segment.
  After this change, there is no need anymore to provide a rstreason
  to tcp_dropwithreset(), since it is always BANDLIM_TCP_RST.
  This will be a follow-up commit, since it will change the code in a
  couple of places, but will not change the functionality.

  Reviewed by:		rrs, Nick Banks, Peter Lei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51815

  (cherry picked from commit 2eb786d96e97a953d0256d1d622c4853964be2dc)


   sys/netinet/tcp_input.c       | 6 +++---
   sys/netinet/tcp_stacks/bbr.c  | 4 ++--
   sys/netinet/tcp_stacks/rack.c | 4 ++--
   3 files changed, 7 insertions(+), 7 deletions(-)

[commit 125056694075a6b7c34e70c7a1ef89bf7255d6c9]
Date: 2025-08-07
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp : remove assignment without effect
Review: Removes an unused variable assignment in TCP input processing with no functional change.
Body:

  rstreason is only relevant in the code paths with the label
  'dropwithreset', but not in the one with the label 'drop'.
  No functional change intended.

  Reviewed by:		Nick Banks, rrs, Peter Lei, imp
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51814

  (cherry picked from commit b6521ceaf2771fe6b3f4ae7e7eb390312e3a678a)


   sys/netinet/tcp_input.c | 1 -
   1 file changed, 1 deletion(-)

[commit 63803f20f90df2afe84932e2a8e6e7556e246004]
Date: 2025-08-06
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp sack: improve computation of delivered_data
Review: The TCP SACK delivered_data calculation is improved, which may affect TCP performance and congestion control behavior.
Body:

  delivered_data is the number of bytes, which have newly been
  delivered to the peer. This includes the number of bytes
  cumulatively acknowledged and selectively acknowledged.

  Reviewed by:		rscheff
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51718

  (cherry picked from commit 0950ab7d76951ea8e65f25a68511dc809339e802)


   sys/netinet/tcp_sack.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 2871bc271ec17125dce0d35b8bf76f679d99d18d]
Date: 2025-08-06
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: rack, bbr: minor cleanup
Review: No functional change intended; minor cleanup only.
Body:

  No functional change intended.

  Reviewed by:		Nick Banks
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51734

  (cherry picked from commit 717bbade24857fd52724e9bb5ffdcfa0310f0a48)


   sys/netinet/tcp_stacks/rack_bbr_common.c | 6 ++----
   1 file changed, 2 insertions(+), 4 deletions(-)

[commit 163e06ec64eacedacacbbd99fa6088a9968ed337]
Date: 2025-08-01
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: Fix wrap around comparison bug
Review: Fixes a wrap-around bug in TCP high-precision timer comparisons, preventing potential timer misbehavior in long-running connections.
Body:

  The variables p_curtick and p_lasttick are not in usecs.

  Reviewed by:	tuexen
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 79059e0ec9b1d3273ce32fdd028802fcad4b85ab)


   sys/netinet/tcp_hpts.c | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit dd8b6e2ce3fd3f208a8199ae89143953d4e4800c]
Date: 2025-08-01
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Network.general
Subject: sctp, tcp, udp: improve deferred computation of checksums
Review: The SCTP, TCP, and UDP stacks now defer checksum computation for forwarded packets and local delivery, enabling checksum offloading support for virtual machines and jails using interfaces like epair, vtnet, and tap.
Body:

  When the SCTP, TCP, or UDP implementation send a packet, it does not
  compute the corresponding checksum but defers that. The network layer
  will determine whether the network interface selected for the packet
  has the requested capability and computes the checksum in software,
  if the selected network interface doesn't have the requested
  capability.
  Do this not only for packets being sent by the local SCTP, TCP,
  and UDP stack, but also when forwarding packets. Furthermore, when
  such packets are delivered to a local SCTP, TCP, or UDP stack, do not
  compute or validate the checksum, since such packets never have been on
  the wire.
  This allows to support checksum offloading also in the case of local
  virtual machines or jails.
  Support for epair, vtnet, and tap interfaces will be added in
  separate commits.

  Reviewed by:		kp, rgrimes, tuexen, manpages
  Differential Revision:	https://reviews.freebsd.org/D51475

  (cherry picked from commit bcb298fa9e23c1192c5707086a67d3b396186abc)


   share/man/man9/mbuf.9       | 32 +++++++++++++++++++++++---------
   sys/netinet/ip_fastfwd.c    | 22 ++++++++++++++++++++++
   sys/netinet/sctp_input.c    |  6 +++++-
   sys/netinet/tcp_input.c     | 12 ++++++++++++
   sys/netinet/udp_usrreq.c    |  6 ++++++
   sys/netinet6/ip6_fastfwd.c  | 28 ++++++++++++++++++++++++++++
   sys/netinet6/ip6_forward.c  | 27 +++++++++++++++++++++++++++
   sys/netinet6/sctp6_usrreq.c |  6 +++++-
   sys/netinet6/udp6_usrreq.c  |  6 ++++++
   sys/sys/mbuf.h              | 17 ++++++++---------
   10 files changed, 142 insertions(+), 20 deletions(-)

[commit 5c00ab0924b20d256c93c40482a6e468e8a41ae9]
Date: 2025-07-31
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: improve variable and constant names
Review: This commit only renames variables and constants for clarity with no functional changes, so it has no user-visible impact.
Body:

  Don't use ticks in variable names or constant when they don't have
  a relation to ticks. Use slots or usecs.
  No functional change intended.

  Reviewed by:	tuexen
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit f197a24d11967b5780717d05e84a749f34b773c4)


   sys/netinet/tcp_hpts.c        | 32 ++++++++++++++++----------------
   sys/netinet/tcp_hpts.h        | 20 ++++++++++----------
   sys/netinet/tcp_stacks/bbr.c  |  6 +++---
   sys/netinet/tcp_stacks/rack.c | 26 +++++++++++++-------------
   4 files changed, 42 insertions(+), 42 deletions(-)

[commit 226cfd057e205cb5e3ef23e97271e2189e6c40e0]
Date: 2025-07-29
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Docs.manpages
Subject: vtnet.4: update description of loader tunables
Review: The man:vtnet[4] manual page now includes updated descriptions for loader tunables, improving documentation for users configuring vtnet driver settings.
Body:

  This is based on the description of sysctl -d.

  Reviewed by:		Timo Vlker, bcr
  Differential Revision:	https://reviews.freebsd.org/D51604

  (cherry picked from commit 0ded4647215cffde9076ab4e82870b0f491bd0b2)


   share/man/man4/vtnet.4 | 23 ++++++++++++++++++++++-
   1 file changed, 22 insertions(+), 1 deletion(-)

[commit be83b57b6acc1087357994b844fc013ead53a409]
Date: 2025-07-29
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: mbuf.9: describe checksum offloading for SCTP
Review: The commit updates the mbuf(9) man page to describe SCTP checksum offloading and provides more precise details on checksum computation timing. This improves documentation for developers and users working with network packet handling.
Body:

  This describes the current status of the implementation.
  While there, be a bit more precise on how long the checksum
  computation is delayed.

  Reviewed by:		Timo Vlker, bcr
  Differential Revision:	https://reviews.freebsd.org/D51590

  (cherry picked from commit fe35f275ab0240cb5ed05484c943293a71aadb5f)


   share/man/man9/mbuf.9 | 34 +++++++++++++++++++++++-----------
   1 file changed, 23 insertions(+), 11 deletions(-)

[commit 7aa9563e20f9f48fc29285140b23849b5b31d28a]
Date: 2025-07-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: use a single counter for limiting the RST rate
Review: The TCP stack now uses a single counter for limiting RST rate, removing an externally observable signal that could reveal listening ports.
Body:

  Using two counters does not provide any benefit, but it provides an
  externally observable signal whether there is a listening port.

  Reviewed by:		Nick Banks, Peter Lei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51440

  (cherry picked from commit d31bdbc3661f6535d5ce4bc98c3687e10aa56720)


   sys/netinet/icmp_var.h                   |  9 ++++-----
   sys/netinet/ip_icmp.c                    |  3 +--
   sys/netinet/tcp_input.c                  | 31 ++++++++++++++++++-------------
   sys/netinet/tcp_stacks/bbr.c             | 22 +++++++++++-----------
   sys/netinet/tcp_stacks/rack.c            | 22 +++++++++++-----------
   sys/netinet/tcp_stacks/rack_bbr_common.c |  2 +-
   6 files changed, 46 insertions(+), 43 deletions(-)

[commit ef163ce59d89910111cf4951e7084bc8b5fdad66]
Date: 2025-07-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp rack: remove duplicate header include
Review: Removes a duplicate header include in the TCP RACK stack, which is an internal cleanup with no user-visible impact.
Body:

  Reviewed by:	tuexen
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 2385565fac21554085a818975d3b7a97f7a4591e)


   sys/netinet/tcp_stacks/rack.c | 1 -
   1 file changed, 1 deletion(-)

[commit 9f6942484963cb9f45b141eec89c5d9f1ed5db92]
Date: 2025-07-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp rack: fix sendmap app limited count tracking
Review: The commit fixes an internal counter tracking issue in the TCP RACK stack that is only used for blackbox logging events. There is no user-visible change in behavior, performance, or configuration.
Body:

  rc_app_limited_cnt is an internal counter on the rack structure
  that tracks the number of sendmap entries that have the
  RACK_APP_LIMITED flag set. These entries gate goodput measurements.
  The counter is reported in a number of blackbox logging events.
  When a sendmap entry which has the RACK_APP_LIMITED flag set is
  cloned, the counter was not being maintained properly.
  While here, cleanup the counter check when a sendmap entry with
  the flag set is freed which previously hid this issue.

  Reviewed by:	tuexen
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit e0838f8a2e61e73e37c1ae08eab9473daacaacb8)


   sys/netinet/tcp_stacks/rack.c | 9 ++++++---
   1 file changed, 6 insertions(+), 3 deletions(-)

[commit 69ed4a82afd794c513b18d6941573c359cb83384]
Date: 2025-09-03
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: dtrace_lockstat.4: Fix description
Review: The commit fixes a description in a man page, which is a user-visible documentation update.
Body:

  MFC after:	1 day
  Reviewed by:	ziaee, markj
  Differential Revision:	https://reviews.freebsd.org/D52355

  (cherry picked from commit e323aaaf397188e3d8e9cb2376af7a083896b441)


   share/man/man4/dtrace_lockstat.4 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 560ae99e226f57bffe13d165f645ddcb914afa38]
Date: 2025-07-20
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: cleanup
Review: This commit is a cleanup with no functional change; it does not affect user-visible behavior.
Body:

  Don't use the variable rstreason temporarily with a different semantic.
  No functional change intended.

  Reviewed by:		Nick Banks
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51438

  (cherry picked from commit 7dc73fa6693564cecc36cda6788cb21c0c922ced)


   sys/netinet/tcp_input.c | 8 +++++---
   1 file changed, 5 insertions(+), 3 deletions(-)

[commit b5d0e1915a61076a921a4381dab96855ce5da098]
Date: 2025-07-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp hpts: remove unused line argument from tcp_set_hpts
Review: The commit removes an unused argument from internal TCP HPTS functions, which has no user-visible impact.
Body:

  Reviewed by:	tuexen
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 3ad8fd6f30466789111e088c16fcab4d94f63232)


   sys/netinet/tcp_hpts.c | 2 +-
   sys/netinet/tcp_hpts.h | 3 +--
   2 files changed, 2 insertions(+), 3 deletions(-)

[commit f33397e3092bb8dd36ba0458bff8e7f861345a91]
Date: 2025-07-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp hpts: use consistently inline instead of __inline
Review: The commit changes internal macro usage from __inline to inline for consistency, which is a style/refactoring change with no user-visible impact.
Body:

  Reviewed by:	tuexen
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 22bebbb211e304f09a29764f24ad9cfb82cee7f0)


   sys/netinet/tcp_hpts.h | 14 +++++++-------
   1 file changed, 7 insertions(+), 7 deletions(-)

[commit ff3299366f214c589dcb82f02c4f0db2495dd38e]
Date: 2025-07-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: remove duplicate tcp_bblogging_on checks
Review: The commit removes duplicate checks in TCP logging code, which is an internal cleanup with no user-visible impact.
Body:

  Reviewed by:	tuexen
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit a1fa30cea6e3bc66ba7243c69f2e5248ea3f79d5)


   sys/netinet/tcp_hpts.c    | 70 +++++++++++++++++++++++------------------------
   sys/netinet/tcp_log_buf.c |  2 +-
   sys/netinet/tcp_log_buf.h |  8 +++---
   3 files changed, 40 insertions(+), 40 deletions(-)

[commit 2a38a33b221ea96389e95eb7fa5d8ac4c6664a9e]
Date: 2025-07-19
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: fix the test that a duplicate ACK has no data
Review: The TCP fast retransmit algorithm is corrected to avoid unnecessary retransmissions when duplicate ACKs are received without data. This improves network efficiency and reduces spurious retransmissions under certain conditions.
Body:

  When processing a TCP segment, data is removed from the head or
  the tail. The test whether a segment has no data on it should
  depend on the TCP segment before the removal. Without this,
  received segments might trigger a fast retransmit even when they
  should not.

  Reported by:		syzbot+fc97a2b5a0f7ea161161@syzkaller.appspotmail.com
  Reviewed by:		Peter Lei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51425

  (cherry picked from commit e46c15a0f848174f58bb08fed8e173a76b4c473a)


   sys/netinet/tcp_input.c | 9 +++++----
   1 file changed, 5 insertions(+), 4 deletions(-)

[commit 1c7813811d2bf6d15403b755ac7c717194ce1509]
Date: 2025-06-29
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Netflix, Inc.
Section: Kernel.general
Subject: ddb: print FIN flag only one when printing BBLog entries
Review: The commit removes duplicate printing of the FIN flag in BBLog entries displayed by the kernel debugger (man:ddb[4]), ensuring that the flag is printed only once.
Body:

  Fixes:		a62c6b0de48a ("ddb: add optional printing of BBLog entries")
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit ce929c4769c9fa73eff2f723dd266203b7816657)


   sys/netinet/tcp_log_buf.c | 6 ------
   1 file changed, 6 deletions(-)

[commit a388086b44ec5289d65e5050629a8a0b0a31422f]
Date: 2025-06-26
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: use 0 as the value being ignored
Review: No functional change intended.
Body:

  No functional change intended.

  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 36ba7339d4df0803f8e0655e2ba8d174d4ccec38)


   sys/netinet/tcp_timewait.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5e5087a127b1eec83dc663f687dd3b1cd051740c]
Date: 2025-06-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: remove references to Lock(b)
Review: The commit removes internal locking references in TCP stack components but does not introduce any user-visible changes, such as new features, configuration adjustments, or performance impacts.
Body:

  Reviewed by: 	tuexen
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 41c1db8a4daae24dff545ee2d20ba6ffe8abd625)


   sys/netinet/tcp_stacks/tcp_bbr.h  | 2 --
   sys/netinet/tcp_stacks/tcp_rack.h | 4 +---
   2 files changed, 1 insertion(+), 5 deletions(-)

[commit 66950b4f13b3c36864db693243f1edc7b09084ca]
Date: 2025-06-26
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: Netflix, Inc.
Section: Docs.manpages
Subject: tcp.4: fix typo for newcwv sysctl
Review: The man:tcpmib[4] manual page now correctly references the net.inet.tcp.newcwv sysctl variable.
Body:

  Reviewed by:	tuexen
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 8b4f237c561686a9d9188724adb03f660ae79480)


   share/man/man4/tcp.4 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 39291cea53ad06e0dacc98d7c81658b7d75c28c1]
Date: 2025-06-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: Don't include netinet/tcp_timer.h when not needed
Review: The commit removes unnecessary header includes without changing user-visible behavior.
Body:

  Reviewed by:		glebius
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50889

  (cherry picked from commit 6039cd1b45eb847ef5bbe6c58341b8b92fff8a74)


   sbin/ipf/ipsend/iptests.c | 1 -
   sbin/ipf/ipsend/sock.c    | 1 -
   usr.bin/netstat/inet.c    | 1 -
   usr.bin/systat/netstat.c  | 1 -
   usr.bin/systat/tcp.c      | 1 -
   5 files changed, 5 deletions(-)

[commit d862ce89be67c21f25aede1a32c2d70a409ab4df]
Date: 2025-09-05
Score: 5
Status: proposed(include=no,score=25)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: improve compilability
Review: The commit adds a missing header include for DDB support in TCP logging code, which resolves compilation failures when building with DDB enabled.
Body:

  When building with DDB support, the inclusion of in_kdtrace.h
  is needed. Make this explicit and don't rely on tcp_var.h to do this.
  This is required for stable/14.

  Fixes:		a62c6b0de48a ("ddb: add optional printing of BBLog entries")
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 4cb50d74c19c014e8099272777eb20aaf834d61c)


   sys/netinet/tcp_log_buf.c | 3 +++
   1 file changed, 3 insertions(+)

[commit 45d3204dec88baee5d6da2890f90fe2c491e9e2a]
Date: 2025-09-04
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: Remove cached FreeBSD-kmods repo from cloudware
Review: The commit removes cached FreeBSD-kmods repository entries from cloudware configuration files, affecting automated build environments.
Body:

  This is a direct commit to stable/14 but corresponds to part of
  778bfd4e1033, which both chased the renaming of repositories in
  /etc/pkg/FreeBSD.conf and added cleanup of the FreeBSD-ports-kmods
  repository database (which is just "FreeBSD-kmods" on stable/14).

  Fixes:	8a2ce9f9dd67 ("pkg.conf: Use kmod repositories")


   release/tools/azure.conf   | 1 +
   release/tools/ec2.conf     | 1 +
   release/tools/vagrant.conf | 1 +
   3 files changed, 3 insertions(+)

[commit a8f6e2b5e46a71cc6d3deb07baac4707a5ecd81e]
Date: 2025-06-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: tcp: remove TCPTV_TWTRUNC
Review: Removes an unused TCP timer constant, which has no user-visible impact.
Body:

  It is not used anymore...

  Reviewed by:		rscheff, Peter Lei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50900

  (cherry picked from commit 124120d44ba23ccc44144f9fc48d35818c660dc1)


   sys/netinet/tcp_timer.h | 2 --
   1 file changed, 2 deletions(-)

[commit 9514c46ae270530a6ca726bf60fd40d3ab44354a]
Date: 2025-06-13
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: fix handling of TIME WAIT for local TCP connections
Review: The net.inet.tcp.nolocaltimewait sysctl now correctly applies to TCP connections where the remote endpoint is on the local host, not just on the local area network.
Body:

  The sysctl-variable net.inet.tcp.nolocaltimewait should affect
  TCP connections where the remote endpoint is on the local host and
  not on the local area network.

  Reported by:		cc
  Reviewed by:		cc
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50830

  (cherry picked from commit 49eabd405f661fa3a9f0a005c2e54dc4cad07e48)


   sys/netinet/tcp_timewait.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5bfaf4a161da1fe8bc296f1651f350c1d14518dd]
Date: 2025-06-13
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: udp: fix local blackholing
Review: The net.inet.udp.blackhole_local sysctl now correctly applies to UDP packets from local IPv6 addresses, not those from hosts on the local network.
Body:

  The sysctl-variable net.inet.udp.blackhole_local should affect
  UDP packets from an IPv6 address of the local host, not of a host on
  the local area network.
  Thanks to cc@ for pointing me to the issue.

  Reviewed by:		cc
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50829

  (cherry picked from commit 16587f60a69820f1a319644da4ec1a40efbcbdf0)


   sys/netinet6/udp6_usrreq.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c53a6828330043d9ca2e2b56315cee4accd11f30]
Date: 2025-06-13
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: fix local blackholing
Review: The net.inet.tcp.blackhole_local sysctl now correctly applies to TCP segments from local IPv6 addresses rather than those from the local network.
Body:

  The sysctl-variable net.inet.tcp.blackhole_local should affect
  TCP segments from an IPv6 address of the local host, not of a host
  on the local area network.
  Thanks to cc@ for pointing me to the issue.

  Reviewed by:		cc
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50828

  (cherry picked from commit de8fb1b3835758998a53d772deeebcdb71bbb823)


   sys/netinet/tcp_input.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 9506da19ca73f54c277ffa9fd89a774a6117d2d0]
Date: 2025-06-10
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Netflix, Inc.
Section: Kernel.general
Subject: ddb: fix handling of BBLog entries when BBLog is disabled
Review: The commit fixes a bug in the kernel debugger (man:ddb[4]) where BBLog entries were incorrectly handled when BBLog is disabled, preventing potential crashes or incorrect behavior during debugging.
Body:

  Fixes:		a62c6b0de48a ("ddb: add optional printing of BBLog entries")
  Sponsored by:	Netflix, Inc.

  (cherry picked from commit 0dc78204a7dcbc51bfab4c701e1335084548bc05)


   sys/netinet/tcp_log_buf.h | 7 +++----
   sys/netinet/tcp_usrreq.c  | 5 +++++
   2 files changed, 8 insertions(+), 4 deletions(-)

[commit aded5f4203ec7aa3bd86d6c05be6b20714a2136c]
Date: 2025-06-10
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Userland.programs
Subject: ddb: add optional printing of BBLog entries
Review: The ddb(4) debugger adds a /b option to show tcpcb and show all tcpcbs commands to print BBLog entries, aiding in TCP debugging and packetdrill script generation.
Body:

  Add a /b option to show tcpcb and show all tcpcbs to print BBLog
  entries. Right now this supports the entries generated by the
  FreeBSD default TCP stack. It should help in debugging issues
  reported by syzkaller.
  The syntax for printing sent and received packets is similar to the
  one used by packetdrill, since the output of ddb will be used to
  create packetdrill scripts for debugging.

  Reviewed by:		thj
  Tested by:		thj
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50629

  (cherry picked from commit a62c6b0de48a5b9b752976b2675ac807684b7fdb)


   share/man/man4/ddb.4      |  12 +-
   sys/netinet/tcp_log_buf.c | 381 ++++++++++++++++++++++++++++++++++++++++++++++
   sys/netinet/tcp_log_buf.h |   4 +
   sys/netinet/tcp_usrreq.c  |  15 +-
   4 files changed, 405 insertions(+), 7 deletions(-)

[commit 6e95753ac51716aec45cef049e1493d3c96874b1]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Kernel.general
Subject: ddb: add show all tcpcbs
Review: Adds a new ddb(4) command 'show all tcpcbs' to display all TCP control blocks, with an option to limit output to locked TCP control blocks. This aids debugging TCP-related kernel panics by showing relevant TCP state information.
Body:

  Add a command to show all TCP control blocks. Also provide an option
  to limit the output to TCP control blocks, which are locked.
  The plan is to run show all tcpcbs/l when syzkaller triggers a panic.
  If a TCP control block is affected, it is most likely locked and
  therefore the command shows the information of the affected TCP
  control block.

  Reviewed by:		markj, thj
  Tested by:		thj
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50516

  (cherry picked from commit f1430567f26bc84db3818914fa91c74507d1602a)


   share/man/man4/ddb.4     | 10 +++++++++-
   sys/netinet/tcp_usrreq.c | 23 +++++++++++++++++++++++
   2 files changed, 32 insertions(+), 1 deletion(-)

[commit ca0fcea09cf47ca8ebf37d0b90db5f66843e11cc]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Netflix, Inc.
Section: Userland.programs
Subject: ddb: improve show tcpcb
Review: The man:ddb[4] debugger now displays the TCP function block name, congestion control algorithm, and Black Box Logging information when showing tcpcb structures.
Body:

  Print the name of the TCP function block and the name of the
  congestion control algorithm. Furthermore, print some information
  related to Black Box Logging.

  Reviewed by:		thj
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50535

  (cherry picked from commit 8d4f495df46567dcfcbec59794e9b9137b2f38fe)


   sys/netinet/tcp_usrreq.c | 52 ++++++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 52 insertions(+)

[commit 3973a0cc2565e33dd402adb4b487432b706f9e57]
Date: 2025-05-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Netflix, Inc.
Section: undecided
Subject: ddb4: improve formatting
Review: The commit only improves formatting consistency in the man:ddb[4] manual page without any user-visible functional changes.
Body:

  Improve the consistency of the formatting.

  Reviewed by:		ziaee
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50514

  (cherry picked from commit a8b9eea5c5b5ec507be7e5e78a4b7a9a1a945dc1)


   share/man/man4/ddb.4 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit c73ee7ff64695d75af5a7da21dbcd1032138b480]
Date: 2025-08-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ipfw: Add tests for the NPTv6 rule parser
Review: The commit adds test files for the NPTv6 rule parser, which is an internal development change with no direct user-visible impact.
Body:

  (cherry picked from commit d879f1c8961d99bdbe6727004bfc6c23924526f8)


   sbin/ipfw/Makefile           |   3 ++
   sbin/ipfw/tests/Makefile     |   1 +
   sbin/ipfw/tests/ipfw_test.sh | 107 +++++++++++++++++++++++++++++++++++++++++++
   3 files changed, 111 insertions(+)

[commit 167991a1bfb4bc2d8767b274c8dac2a96450b215]
Date: 2025-08-21
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Network.general
Subject: ipfw: Fix segfault in NPTv6 rule parser
Review: The commit fixes a segmentation fault in the NPTv6 rule parser when a prefix length is specified with internal or external prefixes. This prevents man:ipfw[8] from crashing during configuration parsing.
Body:

  If the user specified a prefix length with either the internal or
  external prefix, we'd jump to check_prefix where we'd dereference p
  which was most likely uninitialized.

  Instead, store the various prefix lengths separately and check them
  all after the loop.

  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50597

  (cherry picked from commit 64bc9ac8cd9a42259aeb1715d4e14902aa83fcac)


   sbin/ipfw/nptv6.c | 49 ++++++++++++++++++++++++++-----------------------
   1 file changed, 26 insertions(+), 23 deletions(-)

[commit a39ca2c299954b0e077bdebc9a083546cf3e9d0f]
Date: 2025-08-31
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: date(1): Improve manpage around '-I'
Review: The man:date[1] manpage is updated to clarify that the '-I' option outputs only the extended ISO 8601 format and that ISO 8601 uses timezone offsets, not Olson timezone names.
Body:

  * ISO 8601 defines two formats: basic and extended, clarify that we
    output the extended format only.
  * Clarify that ISO 8601 is only aware of timezone /offsets/, not timezones,
    it has no relation to the Olson timezone database (TZ environment variable).

  Reviewed by:	otis (mentor), des
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D52314

  (cherry picked from commit 21628c79d541b55b5e60231cefec73ca31719b6d)


   bin/date/date.1 | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 6147dfa9aff7ed7e6d2529e10f83d997a079f651]
Date: 2025-09-02
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: moused,syscons: Avoid warning if system has no /dev/ttyv*
Review: The moused and syscons startup scripts no longer emit a warning when /dev/ttyv* devices are absent, such as on systems without virtual terminals.
Body:

  A VM had no virtual terminals and emitted a warning on boot
  `eval: cannot open /dev/ttyv*: No such file or directory`.

  Break the loop in this case to avoid the warning.

  PR:		289173
  Reviewed by:	jlduran
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D52344

  (cherry picked from commit 5eb80bf1a6a435e88507c49111a28ed9e38b4b76)


   libexec/rc/rc.d/moused  | 1 +
   libexec/rc/rc.d/syscons | 2 ++
   2 files changed, 3 insertions(+)

[commit 4407e10fdc8b969775233d47c05559c2601b60f4]
Date: 2025-08-25
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: The FreeBSD Foundation
Section: Network.general
Subject: ng_parse: Add upper bound to avoid possible overflow
Review: The commit adds input validation to netgraph parsing to prevent overflow, improving security and stability of netgraph-related operations.
Body:

  Also move num initialization for clarity.

  We still need to check num in ng_unparse_composite (reported by des@ in
  D52151) but this is another incremental improvement in netgraph input
  validation.

  Reviewed by:	des
  PR:		267334
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D52151

  (cherry picked from commit 375527545c85362f14070d35575f9bcd7092f4b9)


   sys/netgraph/ng_parse.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 6e934dc3a7375fe7cef5f5c4b24f6cac470fc84e]
Date: 2025-09-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vm/vm_fault.c: rename vm_fault_hold_pages_e() to vm_fault_hold_pages()
Review: Internal rename of a kernel function with no user-visible impact.
Body:

  (cherry picked from commit 5a308afeaf3d12562c6a61e06f112f730f4d7270)


   sys/vm/vm_extern.h | 2 +-
   sys/vm/vm_fault.c  | 4 ++--
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 9ab8dc298e7ab022120daa9f7b8980030fa8104d]
Date: 2025-08-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vm_fault.c: rename vm_fault_quick_hold_pages_e() to vm_fault_hold_pages_e()
Review: Internal function rename with no user-visible impact.
Body:

  (cherry picked from commit c18e41de7436f5f3c2516f48fabe6577e082547f)


   sys/vm/vm_extern.h | 4 ++--
   sys/vm/vm_fault.c  | 4 ++--
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit 12b17b1cccd2b43de455a9c1d53a371ce67e4efa]
Date: 2025-08-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: vm_fault: improve interface for vm_fault_quick_hold_pages()
Review: The commit refines an internal kernel interface for page fault handling, which does not introduce any user-visible changes in behavior, features, or configuration.
Body:

  (cherry picked from commit 041efb55ec8ba4e379fd1d0a75bd0f637e3d9676)


   sys/vm/vm_extern.h |  2 ++
   sys/vm/vm_fault.c  | 81 ++++++++++++++++++++++++++++++++++++++++--------------
   2 files changed, 63 insertions(+), 20 deletions(-)

[commit 56b5818f9aa78ec7ae881cd901eadd889c56e6a2]
Date: 2025-08-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kern/kern_thread.c: improve assert in thread_single_end()
Review: The commit improves an internal assertion in the kernel's thread management code with no user-visible impact.
Body:

  (cherry picked from commit 8321d0da2ce294d83acc564f2c71fc3a023eb621)


   sys/kern/kern_thread.c | 6 ++++--
   1 file changed, 4 insertions(+), 2 deletions(-)

[commit 93006233f20317dfa18f65f879828910f95b10c5]
Date: 2025-08-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: vfs: make vfscount refcounting handle possible kld unload
Review: The vfs module refcounting now handles kernel module unloading, preventing potential crashes when unloading vfs klds.
Body:

  (cherry picked from commit be8bae67002503baff6bb9fb77fbe6b80f035c33)


   sys/kern/vfs_init.c  | 16 ++++++++++++++--
   sys/kern/vfs_mount.c |  7 +++++--
   sys/sys/mount.h      |  1 +
   3 files changed, 20 insertions(+), 4 deletions(-)

[commit c0e3a2d77bfe2cd1992a10c760cae273924e8300]
Date: 2025-08-12
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix, Inc.
Section: Userland.programs
Subject: netstat: fix reporting of delivered UDP packets
Review: The man:netstat[1] utility now correctly reports delivered UDP packet counts by fixing an over-subtraction of broadcast port unreachable errors.
Body:

  The counter udps_noport includes udps_noportbcast, so don't subtract
  udps_noportbcast twice.

  PR:			288680
  Reviewed by:		rrs
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51870

  (cherry picked from commit d3f2d49e01a867e19186a1db095a7dd66e6c77c0)


   usr.bin/netstat/inet.c | 1 -
   1 file changed, 1 deletion(-)

[commit e2a3408b612f717c79f0e16cfabfdeff4067c2af]
Date: 2025-08-27
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Juniper Networks, Inc.
Section: undecided
Subject: irdma: normalize .CURDIR-relative paths to SRCTOP
Review: The commit normalizes build paths in the irdma driver module Makefile, which is an internal build system change with no user-visible impact.
Body:

  Sponsored by:	Juniper Networks, Inc.
  MFC after:	1 week
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D52192

  (cherry picked from commit a93e46f15693b6962eefac2ffa962edb020f8b49)


   sys/modules/irdma/Makefile | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 4f41ff7ced8a2fa6fc7ba35023b161567323282b]
Date: 2025-09-03
Score: 5
Status: proposed(include=no,score=20)
Sponsor: Juniper Networks, Inc.
Section: undecided
Subject: IfAPI: fix LINT-NOIP build
Review: Fixes a build issue for LINT-NOIP kernel configurations by adjusting ifAPI wrappers.
Body:

  Also, reimplement the wrappers with __strong_reference macro.

  Fixes:		7b3094df479f
  Reported by:	zlei
  Sponsored by:	Juniper Networks, Inc.
  Reviewed by:	zlei, jhibbits
  Differential Revision:	https://reviews.freebsd.org/D52362


   sys/net/bpf.c          |  2 ++
   sys/net/if.c           | 12 ------------
   sys/net/if_ethersubr.c |  2 ++
   3 files changed, 4 insertions(+), 12 deletions(-)

[commit 7b3094df479fd820eb7a2bd3948619a9eaf77665]
Date: 2025-09-03
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Juniper Networks, Inc.
Section: Kernel.general
Subject: IfAPI: restore KBI after bceb9c2f2b19
Review: The if_bpfmtap and if_etherbpfmtap functions are restored, maintaining compatibility for kernel modules or code that depends on these interfaces.
Body:

  This commit restores if_bpfmtap and if_etherbpfmtap functions, and
  implement them as wrappers around bpf_mtap_if and ether_bpf_mtap_if
  funcitons.

  Fixes:		bceb9c2f2b19
  Sponsored by:	Juniper Networks, Inc.


   sys/net/if.c     | 12 ++++++++++++
   sys/net/if_var.h |  2 ++
   2 files changed, 14 insertions(+)

[commit 938fbab6f52aae1872202411a976fcfb6797a2c9]
Date: 2025-08-02
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: chroot.2: Update errors and unprivileged use
Review: The man:chroot[2] manual page now includes a note about unprivileged chroot when the security.bsd.unprivileged_chroot sysctl is set to 1, and reorganizes error descriptions.
Body:

  Include errors common to chroot and fchroot in a single list, followed
  by errors unique to each.

  Unprivileged chroot is permitted if the security.bsd.unprivileged_chroot
  sysctl is set to 1.  Make note of this and update the EPERM description.

  Reported by:	kevans
  Reviewed by:	kevans, kib
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D51703

  (cherry picked from commit 95f8c3e1ed0c3075411444381a5a4baef4ed8fda)


   lib/libc/sys/chroot.2 | 44 +++++++++++++++++++++++++++++++++-----------
   1 file changed, 33 insertions(+), 11 deletions(-)

[commit e425d433c5adaa0f7a513ba836fa378137ed7be4]
Date: 2024-08-16
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: The FreeBSD Foundation
Section: Ports.packaging
Subject: Makefile.inc1: Avoid including cwd in path
Review: The buildworld process no longer includes the current directory in PATH, preventing conflicts when objcopy attempts to overwrite itself.
Body:

  Buildworld failed when objcopy tried to overwrite itself, with `objcopy:
  open objcopy failed: Text file busy`.  The PATH ended up with `::`,
  effectively including the current directory, and we found the wrong
  objcopy.

  PR:		261215
  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit ac7ed266dc73a1d55f2bc1e90bfce3c93757e8b4)


   Makefile.inc1 | 5 ++++-
   1 file changed, 4 insertions(+), 1 deletion(-)

[commit 1ff48c6810a1c4e340e63eea166ad46631496c57]
Date: 2025-06-17
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: tests: Update for jemalloc's option parsing
Review: The commit updates test files to reflect a change in jemalloc's option parsing, where MALLOC_OPTIONS=J is replaced with MALLOC_CONF=junk:true. This affects test execution but does not introduce user-visible changes in production systems.
Body:

  MALLOC_OPTIONS=J -> MALLOC_CONF=junk:true

  PR:		287357
  Reviewed by:	markj
  Event:		Kitchener-Waterloo Hackathon 202506
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50910

  (cherry picked from commit 4f33d073003ccd91390709e14e5c1bf1f0c1c85c)


   bin/sh/tests/execution/func1.0           | 4 ++--
   tools/regression/bpf/bpf_filter/Makefile | 2 +-
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 96743bfb95431f396e71d35eb92258122233334f]
Date: 2025-02-28
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: boot_i386.8: Mention this is legacy
Review: The man:boot_i386.8[8] page now states that it is a legacy document.
Body:

  Reviewed by:	imp
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D49704

  (cherry picked from commit b8437cbae173308180fbaddc6a74bfb6f8c4410b)


   sbin/reboot/boot_i386.8 | 8 +++-----
   1 file changed, 3 insertions(+), 5 deletions(-)

[commit bceb9c2f2b1933d7172feb6597a31a6547960005]
Date: 2023-07-21
Score: 5
Status: proposed(include=no,score=30)
Sponsor: Juniper Networks, Inc.
Section: undecided
Subject: IfAPI: Retire if_etherbpfmtap() and if_bpfmtap()
Review: The functions if_etherbpfmtap() and if_bpfmtap() are removed, as they are obsolete. Drivers now use bpf_mtap_if() and ether_bpf_mtap_if() instead, which may affect custom kernel modules or driver development.
Body:

  Summary:
  These came in the original DrvAPI commits in 2014, and are obsoleted by
  bpf_mtap_if() and ether_bpf_mtap_if().  The `_if` suffix, rather than
  prefix, conveys that it's operating on the bpf of the interface, instead
  than the interface itself.

  Reviewed by:	glebius
  Sponsored by:	Juniper Networks, Inc.
  Differential Revision: https://reviews.freebsd.org/D41146

  (cherry picked from commit 2a3716432d209c5fef1eb1a719f4c1914e7c8b5a)


   sys/arm/allwinner/if_awg.c          |  2 +-
   sys/arm64/broadcom/genet/if_genet.c |  2 +-
   sys/dev/bge/if_bge.c                |  2 +-
   sys/dev/bxe/bxe.c                   |  4 ++--
   sys/dev/dwc/if_dwc.c                |  2 +-
   sys/dev/eqos/if_eqos.c              |  2 +-
   sys/dev/fxp/if_fxp.c                |  2 +-
   sys/dev/nfe/if_nfe.c                |  2 +-
   sys/dev/ntb/if_ntb/if_ntb.c         |  2 +-
   sys/net/if.c                        | 12 ------------
   sys/net/if_var.h                    |  2 --
   11 files changed, 10 insertions(+), 24 deletions(-)

[commit d10640804e74b84ba06102a1a399a34117f4cf41]
Date: 2025-08-27
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Storage.general
Subject: nfs client: switch nfs_advlock() to use exclusive vnode lock
Review: The nfs_advlock() function now uses an exclusive vnode lock, which may affect file locking behavior on NFS clients.
Body:

  (cherry picked from commit fe53e046cd9ce9c95a118ac0374e94336f16a37f)


   sys/fs/nfsclient/nfs_clvnops.c | 7 +------
   1 file changed, 1 insertion(+), 6 deletions(-)

[commit 6ec314485100d738c818269e9545ce08fe42d000]
Date: 2025-03-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: tests: xfail readelf phdr count test w/LLVM binutils
Review: The commit only modifies a test script to temporarily skip a failing test case due to an upstream LLVM readelf limitation. This is an internal testing change with no user-visible impact.
Body:

  LLVM readelf does not (yet) support phdr counts that overflow 16 bits.
  Temporarily xfail this test until fixed; see upstream issue 132216 for
  more details https://github.com/llvm/llvm-project/issues/132216.

  PR:		285547
  Reported by:	markj
  Reviewed by:	dim, markj
  Sponsored by:	The FreeBSD Foundation
  Fixes: 1cae7121c667 ("Enable LLVM_BINUTILS by default")
  Differential Revision: https://reviews.freebsd.org/D49561

  (cherry picked from commit 5df8159d56a681e388a2fff1c1c24a4830b741d6)


   tests/sys/kern/coredump_phnum_test.sh | 5 +++++
   1 file changed, 5 insertions(+)

[commit eb808098834bc0997fcbe7ca9d7ff12663eff9d0]
Date: 2023-09-19
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Userland.programs
Subject: route(8): fix `route not found` exit code and warn with netlink
Review: The man:route[8] command now returns a non-zero exit code when a route is not found with 'route -n get', and it prints a warning message.
Body:

  Fix route(8) incorrectly returning a zero exit code even when unable to
  find the specified route with route -n get <route>.

  PR:		274426
  Reviewed by:	kp
  Sponsored by:	Rubicon Communications, LLC ("Netgate")
  Differential Revision:	https://reviews.freebsd.org/D41882

  (cherry picked from commit 2a78083fc2a14af863afb098925b0682698a2838)


   sbin/route/route_netlink.c | 25 +++++++++++++++----------
   1 file changed, 15 insertions(+), 10 deletions(-)

[commit 00d474e24217870bf0c237dd3cfed31196230503]
Date: 2025-08-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: git-blame-ignore-revs: witness white space cleanup and style(9) tweeks
Review: The commit adds a hash entry to .git-blame-ignore-revs for internal development tooling, which has no direct user-visible impact.
Body:

  Hash is updated to match MFC commit.

  MFC after:	3 days

  (cherry picked from commit 2ddb9cbe42039ccbf8de96c8d3e74e94c14c9560)


   .git-blame-ignore-revs | 2 ++
   1 file changed, 2 insertions(+)

[commit 91c0ef0f5a2afa17489b603a2f82edaa28e3cce7]
Date: 2025-08-29
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: witness: White space cleanup and some style(9) tweeks
Review: The commit consists of whitespace cleanup and style fixes with no user-visible impact.
Body:

  MFC after:	3 days

  (cherry picked from commit f5377665253b2b107ee8a4690ad2e6682375b304)


   sys/kern/subr_witness.c | 134 ++++++++++++++++++++----------------------------
   1 file changed, 56 insertions(+), 78 deletions(-)

[commit c4e5df1cb25ff2cf588806b482ade663a8ecfdf5]
Date: 2025-08-28
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: vtnet: Do not compare boolean with integer
Review: The vtnet driver no longer incorrectly compares boolean variables with integer values, which resolves a potential logic error in promiscuous and all-multicast mode handling.
Body:

  The type of variable promisc and allmulti was changed from int to bool
  by commit [1].

  [1] 7dce56596f36 Convert to if_foreach_llmaddr() KPI

  MFC after:	3 days

  (cherry picked from commit 80dfed11fc1c61ce9168db01dee263447619e859)


   sys/dev/virtio/network/if_vtnet.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 135478abe3bcac1c5195b7e4d75e9f2d6ab40221]
Date: 2025-08-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ifnet: Don't include ethernet.h twice
Review: Duplicate include of ethernet.h removed; no functional change.
Body:

  MFC after:	3 days

  (cherry picked from commit 393356f25fb8b76e38b10347f0ad40d4a23372ba)


   sys/net/if.c | 1 -
   1 file changed, 1 deletion(-)

[commit f086954950c6ee18a72dc28de31ad348150e418f]
Date: 2025-08-23
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: amd64 vmx: micro-optimize vmlaunch failure path
Review: The commit micro-optimizes the vmlaunch failure path in the AMD64 VMX code, which is an internal performance improvement with no direct user-visible impact.
Body:

  (cherry picked from commit 2b35b717188adb843de100c4221ec1ded13024f0)


   sys/amd64/vmm/intel/vmx_support.S | 8 +++-----
   1 file changed, 3 insertions(+), 5 deletions(-)

[commit 727bc500264bffc48b699a88e00a0baa14cbe73d]
Date: 2025-08-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Bootloader.general
Subject: Bail out of corrupt directory entries during boot
Review: The boot loader now skips corrupt directory entries when reading UFS filesystems, preventing boot failures due to filesystem corruption.
Body:

  Reported-by:  Daniel O'Connor darius-dons.net.au
  MFC-after:    1 week
  Sponsored-by: Netflix
  Differential-Revision: https://reviews.freebsd.org/D2844

  (cherry picked from commit 690ae8a2025ca1ce58d08a90a1df1645c81392ea)


   stand/libsa/ufs.c     | 6 ++++++
   stand/libsa/ufsread.c | 7 +++++++
   2 files changed, 13 insertions(+)

[commit b0e655bc5c646dd588aef5f92345213316259946]
Date: 2025-05-09
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: flua: clean up lposix argument checking
Review: Internal code cleanup with no user-visible impact.
Body:

  The key insight here is that the luaL_check*() and luaL_opt*() functions
  will happily take indexes that are larger than the stack top and print a
  useful error message.

  This means that there is no need to check if too few arguments have been
  received prior to checking the types of individual arguments.

  This patch also replaces a couple reimplementations of luaL_opt*()
  functions with the luaL helpers.

  References:	https://www.lua.org/manual/5.4/manual.html#4.1.2
  Reviewed by:	emaste, kevans
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50273

  (cherry picked from commit 5437b0ff6d557daf6c35e1307a5737139bc12f9a)


   libexec/flua/modules/lposix.c | 111 ++++++++++++++++--------------------------
   1 file changed, 43 insertions(+), 68 deletions(-)

[commit 9d80d2f348381dc7b81f099585a90ccbc46790b5]
Date: 2025-07-30
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Userland.config
Subject: vt: Remove FONT specification from INDEX files
Review: The FONT specification is removed from vt(4) INDEX files, simplifying configuration for keymaps and fonts. This change eliminates an unnecessary step when selecting keymaps or fonts, as vt(4) uses UTF-8 and no longer requires font specification for character set compatibility.
Body:

  There is no reason to change the font in order to select a keymap or a
  font.

  This was done in the syscons(4) era to ensure that a font with the
  appropriate character set was used for kbdmap or vidfont's localized
  menu, but vt is always UTF-8 and this is no longer necessary.

  PR:		235565
  Reviewed by:	imp
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D51640

  (cherry picked from commit bf426b859bda58a1d6598bb9516ffc6692b2502f)


   share/vt/fonts/INDEX.fonts     | 8 --------
   share/vt/keymaps/INDEX.keymaps | 8 --------
   2 files changed, 16 deletions(-)

[commit 6ecbe4478566d94bdc1a76a517927129210428e2]
Date: 2024-04-11
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Makefile.inc1: Fix typo
Review: Typo fix in build infrastructure with no user-visible impact.
Body:

  Signed-off-by: Elyes Haouas <ehaouas@noos.fr>
  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/882
  (cherry picked from commit f092a54fdc6d394d510451ed0429f78abe0f3a55)


   Makefile.inc1 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 1105ee91f45a8c7e4141a295a57a478ea0dee985]
Date: 2025-07-29
Score: 5
Status: proposed(include=no,score=20)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: ssh: Reduce sshd_config diffs against OpenSSH 10.0p2
Review: The sshd_config file is updated to reduce diffs against OpenSSH 10.0p2 by incorporating an improved description for KbdInteractiveAuthentication. This change aligns the configuration file with upstream and avoids future conflicts during imports.
Body:

  Upstream had a poor description for KbdInteractiveAuthentication prior
  to the 10.0p2 release.  We use KbdInteractiveAuthentication for PAM
  authentication, and we replaced the poor description with a note about
  use by PAM.

  In 10.0p2 the upstream description has been fixed.  Incorporate that
  text now as it is an improvement and avoids a conflict in the upcoming
  10.0p2 import.

  Reviewed by:	jhb
  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 8be24d80adb4ba998240c1b5e20e678852dc0a05)


   crypto/openssh/sshd_config | 7 +++++--
   1 file changed, 5 insertions(+), 2 deletions(-)

[commit 05459c1b860c086ada0cacb398fa5d61a240e0ca]
Date: 2025-07-25
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: pom: Cache tzdata before entering capability mode
Review: The commit fixes a timezone data availability issue for man:pom[1] when running in capability mode, ensuring correct local time display.
Body:

  Pom uses localtime() so needs tzdata available.

  PR:		278574
  Reported by:	Tatsuki Makino
  Reviewed by:	ivy
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D51521

  (cherry picked from commit 0fde36fe04b2b656a2215f7dad07a52884e8dcfd)


   usr.bin/pom/pom.c | 1 +
   1 file changed, 1 insertion(+)

[commit 330dca227fd9bcb3d8167a3cd1af7fa5f6df3c41]
Date: 2025-07-23
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: rpc.h: Remove reference to unimplemented DES ioctls
Review: Removes references to unimplemented DES ioctls from header files, which does not affect user-visible functionality.
Body:

  We won't be adding support for hardware DES.  Remove the #ifdef notdef
  block.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit c143ffbaf787f6c1d7fcbae8f5d9299182ff0b85)


   include/rpc/des.h | 20 --------------------
   1 file changed, 20 deletions(-)

[commit f5f07b9c891253187fedff27228f54eca66ffd31]
Date: 2025-07-24
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: asa.1: Drop SEE ALSO reference to long-gone f77(1)
Review: The man:asa[1] manual page no longer references the removed f77(1) command.
Body:

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 58d9d2f8daef8f646372efd6e87a7d4f5e05656b)


   usr.bin/asa/asa.1 | 2 --
   1 file changed, 2 deletions(-)

[commit d52dc0b4bf6c2fb34b4a9ab614247b7c5524ff32]
Date: 2024-10-28
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.contrib
Subject: flua: lposix: add fnmatch function
Review: The flua lposix module now includes the fnmatch function, which provides shell-style filename pattern matching.
Body:

  The fnmatch function matches a string against a shell-style filename
  pattern. It is a complex function and cannot easily be implenented
  using regular expressions. Adding fnmatch to flua increases the amd64
  binary by less than 1 KB.

  Approved by:	markj
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D46849

  (cherry picked from commit f35ccf46c7c6cb7d26994ec5dc5926ea53be0116)


   libexec/flua/linit_flua.c     |  1 +
   libexec/flua/modules/lposix.c | 41 +++++++++++++++++++++++++++++++++++++++++
   libexec/flua/modules/lposix.h |  1 +
   3 files changed, 43 insertions(+)

[commit 069a0460280b5356162feffed66dd70f89d02ee3]
Date: 2024-09-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Fix the cross-build after recent commits
Review: The commit fixes internal cross-build issues and does not introduce any user-visible changes.
Body:

  - Provide a sys/md4.h in the cross-build environment to fix bootstrap
      of libmd.
  - flua now exposes WTRAPPED which isn't incredibly common- make it
      conditional, we probably won't be using it in any bootstrap context
      any time soon.

  Fixes:	442e0975ee4b3 ("Consolidate md4 implementations written in C")
  Fixes:	c2caf3b3313fe ("flua: posix: add more useful functions [...]")
  (cherry picked from commit aad507854efd13c4387394e88d5667cc6f060933)


   libexec/flua/modules/lposix.c                    |  2 +
   tools/build/cross-build/include/common/sys/md4.h | 91 ++++++++++++++++++++++++
   2 files changed, 93 insertions(+)

[commit d2be11512ede667398e7ed90a548205fc76553ea]
Date: 2023-03-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.contrib
Subject: flua: lposix: add more useful functions for general purpose scripts
Review: The lposix module in flua adds functions for general-purpose scripting, including _exit, close, fork, getpid, pipe, read, write, basename, dirname, and realpath. This enables scripts to perform process management, file operations, and path resolution.
Body:

  unistd:
  - _exit
  - close
  - fork
  - getpid
  - pipe
  - read
  - write

  libgen:
  - basename, dirname

  stdlib:
  - realpath

  These are sufficient for a number of real world scenarios.  In our first
  application of them, we use the libgen+stdlib additions to grab the
  script dir based on argv[0].  The unistd assortment is then used to
  outsource a bunch of work to forks and report back to the main process.

  Reviewed by:	emaste, imp
  Differential Revision:	https://reviews.freebsd.org/D39083

  (cherry picked from commit c2caf3b3313fe73bfc9b4b984c21da8d571f8798)


   libexec/flua/linit_flua.c     |   3 +
   libexec/flua/modules/lposix.c | 415 ++++++++++++++++++++++++++++++++++++++----
   libexec/flua/modules/lposix.h |   3 +
   3 files changed, 388 insertions(+), 33 deletions(-)

[commit eac6f90ce161775ac803747c24680eb3d4a921ff]
Date: 2025-04-15
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: flua: Connect man page
Review: The man page for man:flua[1] is now installed.
Body:

  The flua man page was MFC'd but the Makefile update was dropped
  accidentally.

  (cherry picked from commit 550289771d5cb73befb6a1645fb9cdf0b9fb65a7)

  Fixes: d967c87d073d1307dfd51ab9335ead472a05e6bd
  Sponsored by:	The FreeBSD Foundation


   libexec/flua/Makefile | 1 -
   1 file changed, 1 deletion(-)

[commit b06973a2f2a8854b4803c9a4d00dc0482be8f268]
Date: 2025-08-15
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Storage.general
Subject: nfsd: Fix slow leaks of NAMEI buffers
Review: The commit fixes a memory leak in the NFS server that occurs when mountd(8) reloads exports, preventing a slow accumulation of leaked NAMEI buffers.
Body:

  Commit 5b5b7e2ca2fa changed namei()s behaviour such that it
  does not free the NAMEI buffer unless returning an error.

  The nfsd was not fixed for this.  Fortunately, the only
  leak would be one NAMEI buffer each time mountd(8) reloads
  the exports.  (There were also leaks in the pNFS server
  configuration, but almost no one uses it.)

  This patch fixes the leaks by adding NDFREE_PNBUF() macros
  in the appropriate places.

  MFC after:	2 weeks
  Discussed with:	kib
  Fixes:	5b5b7e2ca2fa ("vfs: always retain path buffer after lookup")

  (cherry picked from commit 9cd3860c10b6afaaaeb118dafc166ab168bc9083)


   sys/fs/nfsserver/nfs_nfsdport.c  | 1 +
   sys/fs/nfsserver/nfs_nfsdstate.c | 6 ++++++
   2 files changed, 7 insertions(+)

[commit f5d312cb4d605c9d60ac1510d7063b234fbc7861]
Date: 2025-08-26
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: linuxkpi: Fix a typo in a source code comment
Review: Typo fix in a comment only, no user-visible impact.
Body:

  - s/__FreeBSD_verison/__FreeBSD_version/

  (cherry picked from commit e0875bf019e11f93d5e23b9839e1a7f0c4317320)


   sys/compat/linuxkpi/common/include/acpi/acpi.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4d294b72f8e31c0f9589d2f9cb3799d4391e0189]
Date: 2025-08-18
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Storage.general
Subject: nfsclient: va_rdev should be NODEV for non-special nodes
Review: The NFS client now sets va_rdev to NODEV for non-special nodes, which may affect applications that rely on device information from NFS-mounted files.
Body:

  (cherry picked from commit 6acc5ed5f9c3e1b462e7ae0d1ae1c5196328fa9f)


   sys/fs/nfs/nfsport.h           | 2 +-
   sys/fs/nfsclient/nfs_clport.c  | 6 +++---
   sys/fs/nfsclient/nfs_clvnops.c | 2 +-
   3 files changed, 5 insertions(+), 5 deletions(-)

[commit f47e963c432f43a3edc62a89ea95a8c44bc0c19a]
Date: 2025-08-18
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Storage.general
Subject: cd9660: va_rdev should be NODEV for non-special inodes
Review: The commit fixes a bug in the cd9660 filesystem where va_rdev could be incorrectly set for non-special inodes, potentially affecting file system utilities or system calls that rely on correct device information.
Body:

  (cherry picked from commit fba63c09ed0fd21865bfd0ec3b9e0c3840a55dd6)


   sys/fs/cd9660/cd9660_vnops.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4612f5f2d23348c8a861834d4c9f98b0a2742f56]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: vfs: Introduce VN_ISDEV() macro
Review: The commit introduces a new VN_ISDEV() macro for checking if a vnode represents a device, replacing direct checks of the v_type field. This provides a cleaner interface for kernel code but does not introduce user-visible behavior changes, new features, or configuration impacts.
Body:

  (cherry picked from commit 567e6250c003eeb251b4bc8dbe60d2adabab2988)


   lib/libprocstat/libprocstat.c  |  3 +--
   sys/fs/cd9660/cd9660_vnops.c   | 12 ++++++------
   sys/fs/ext2fs/ext2_vnops.c     | 14 +++++++-------
   sys/fs/fuse/fuse_vnops.c       |  2 +-
   sys/fs/nfsclient/nfs_clvnops.c |  2 +-
   sys/fs/p9fs/p9fs_vnops.c       |  2 +-
   sys/fs/tarfs/tarfs_vnops.c     |  5 ++---
   sys/fs/tmpfs/tmpfs_subr.c      |  2 +-
   sys/fs/tmpfs/tmpfs_vnops.c     | 17 +++++++----------
   sys/kern/vfs_bio.c             |  2 +-
   sys/kern/vfs_syscalls.c        |  2 +-
   sys/sys/param.h                |  2 +-
   sys/sys/vnode.h                |  9 +++++++++
   sys/ufs/ffs/ffs_vnops.c        | 12 ++++++------
   sys/ufs/ufs/ufs_vnops.c        | 16 ++++++----------
   sys/vm/vnode_pager.c           |  3 +--
   16 files changed, 52 insertions(+), 53 deletions(-)

[commit 05fe8c88e1ce7904a14997a5e5e253d92fbe3e42]
Date: 2024-12-08
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: libc: lib_malloc_aligned(): add a missing NULL check
Review: libc's lib_malloc_aligned() now checks for allocation failure, preventing a segmentation fault when early memory allocation fails.
Body:

  For some reason return value of the __je_bootstrap_malloc()
  is not checked and then de-referenced few lines below, causing
  a SEGV if an early allocation fails.

  MFC after:      1 month

  (cherry picked from commit 1e99be5dcda222d47a77715e190a381a14f46ece)


   lib/libc/gen/tls.c | 2 ++
   1 file changed, 2 insertions(+)

[commit c73d3c6c960bef6222fa03a1119df0bb5380a611]
Date: 2024-09-09
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: mbuf: improve KASSERT(9) falure messages in the m_apply()
Review: The commit improves KASSERT failure messages in the mbuf m_apply() function, which may aid debugging but does not introduce any user-visible changes in behavior, features, or configuration.
Body:

  - Make less ambiguous;
  - extend to provide more context for post-mortem.

  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D43776
  MFC after:	2 weeks

  (cherry picked from commit a43fb3653b35ab88b72e1277dccc26328363cdb7)


   sys/kern/uipc_mbuf.c | 6 ++++--
   1 file changed, 4 insertions(+), 2 deletions(-)

[commit b8259e21504330940b90714372bfdf9a592ce928]
Date: 2025-08-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: mod_cc(4): Fix a typo in a source code comment
Review: Fixes a typo in a source code comment only, with no user-visible impact.
Body:

  - s/assigments/assignments/

  (cherry picked from commit 88ed58d7f88471dc69e943e94d420cd4ef090042)


   sys/netinet/cc/cc.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a1def923143dd73d8d9e48d0bafb2d2fb577afcd]
Date: 2025-08-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: mwl(4): Fix a typo in a source code comment
Review: Fixes a typographical error in a comment within the mwl(4) driver source code.
Body:

  - s/firwmare/firmware/

  (cherry picked from commit 4f768b8acdf818f08f4f0124c1df418127720266)


   sys/dev/mwl/if_mwl.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit cff9febe910eff82a2f0f992554e0c38112179ae]
Date: 2025-08-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: bce(4): Fix a typo in a source code comment
Review: Typo fix in a source code comment only; no user-visible impact.
Body:

  - s/firwmare/firmware/

  (cherry picked from commit a848c85d27c8f8d6b8394a372417703a2969314c)


   sys/dev/bce/if_bce.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 526f1d34bf450564a4b1461dfc4e0a3f26e18624]
Date: 2025-08-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: cam(3): Fix a common typo in source code comments
Review: Fixes a typo in source code comments only, no user-visible impact.
Body:

  - s/tranferred/transferred/

  (cherry picked from commit 90d7186379b08e5fb0f3d146a2e82a4fa8d9c9b8)


   sys/cam/ata/ata_all.c  | 4 ++--
   sys/cam/scsi/scsi_da.c | 4 ++--
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit ba027e7a117f8245352167a123c964b39cf8ad1f]
Date: 2025-08-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: ice(4): Fix a typo in a source code comment
Review: Typo fix in source code comment only, no user-visible impact.
Body:

  - s/firwmare/firmware/

  (cherry picked from commit 62db40b5644726ca61e84aa56fff2fbaf30b05ca)


   sys/dev/ice/ice_fw_logging.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b071ce1d8e4940bfe09139c782f99fa2143b0f1e]
Date: 2025-08-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: ffs(3): Fix a typo in a source code comment
Review: Typo fix in source code comment only, no user-visible impact.
Body:

  - s/fist/first/

  (cherry picked from commit cc5623d8bda6ac24faf1c18ba9712e7f78dc127b)


   sys/ufs/ffs/ffs_rawread.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 36a4b027bb5f2ab18a04434875577d18c870c769]
Date: 2025-08-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: hpt27xx(4): Fix a couple of typos in source code comments
Review: Fixes typos in source code comments only; no user-visible impact.
Body:

  - s/tranform/transform/

  (cherry picked from commit 49ae0c259205e45267ed5d8dcc99132595cf1cec)


   sys/dev/hpt27xx/hptintf.h | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 6a4aae1ed69d365205d70098c6199c2bce52fe97]
Date: 2025-08-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: msdofs(5): Fix a typo in a source code comment
Review: Only fixes a typo in a source code comment with no user-visible impact.
Body:

  - s/fist/first/

  (cherry picked from commit ac4005219166fc94da4ebb7adce3da159072f6d3)


   sys/fs/msdosfs/bootsect.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 55403c7c559c68c84070a49a5fdb6740cced0014]
Date: 2025-08-25
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Sippy Software, Inc.
Section: undecided
Subject: build: fix list-old-dirs / check-old-dirs
Review: Fixes a bug in the build system where list-old-dirs could produce an empty line, which could cause check-old-dirs to incorrectly interpret it as the root filesystem.
Body:

  Fix list-old-dirs to not generate empty line at the end of the
  output if OLD_DIRS happens to have a space at the end of the
  last word of the output before the final \n. Then that space
  is turned into \n and we end up with a blank line.

  Futhermore this gets converted into a "/" i.e. root fs when
  calling check-old-dirs.

  This is the regression since a8267ecc3df0a.

  Reviewed by:	emaste
  Approved by:	emaste
  Sponsored by:	Sippy Software, Inc.
  Differential Revision:	https://reviews.freebsd.org/D52153
  MFC After:	3 days


   Makefile.inc1 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 1235e1d16085de69f87fbea68a80e070cf360019]
Date: 2025-08-17
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: Docs.manpages
Subject: stat(2): Document the st_rdev field
Review: The man:stat[2] manual page now documents the st_rdev field.
Body:

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.
  Reviewed by:	bcr
  Differential Revision:	https://reviews.freebsd.org/D51946

  (cherry picked from commit 4eaa7f66620c33957ff9a929820cb791f7fe5578)


   lib/libc/sys/stat.2 | 5 ++++-
   1 file changed, 4 insertions(+), 1 deletion(-)

[commit d62cfe703fd1fb53bc0006b3724428a3dc8991f1]
Date: 2025-08-17
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: Userland.programs
Subject: getmntpoint: Don't compare st_rdev for non-devices
Review: The man:mount[8] utility no longer incorrectly matches non-device mount sources by device number, preventing spurious matches for filesystems like nullfs, tarfs, and procfs.
Body:

  If the mntfromname of a mountpoint is not a device (e.g. nullfs, tarfs,
  procfs) we shouldn't compare st_rdev, as any match will be spurious.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.
  Reviewed by:	kib
  Differential Revision:	https://reviews.freebsd.org/D51945

  (cherry picked from commit 8073a5137f223bb481606b15edaa5ecb93ceffcb)


   sbin/mount/getmntopts.c | 1 +
   1 file changed, 1 insertion(+)

[commit bb6dfb08f0619b14ad9b68cca592db65b152c194]
Date: 2025-08-15
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: freebsd-update: Do not fsync
Review: The man:freebsd-update[8] utility no longer calls fsync after installing each file, which speeds up the update process.
Body:

  Fsyncing each file we install slows us down significantly and adds
  little to no safety.

  MFC after:	1 week
  PR:		287897

  (cherry picked from commit 20f0996700a8e60780931e7fde65899040465f4e)


   usr.sbin/freebsd-update/freebsd-update.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 935c26dbe3a6ce77cda9bd802fa45cdb938610a6]
Date: 2025-08-15
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: libkern: Drop incorrect qsort optimization
Review: The libkern qsort optimization is removed, which may affect kernel module behavior but has no direct user-visible impact.
Body:

  See 5205b32de3fb for details.

  PR:		287089
  MFC after:	1 week
  Reviewed by:	jlduran
  Differential Revision:	https://reviews.freebsd.org/D51919

  (cherry picked from commit ef8f3e913156aa268e07ae1daa68e3bc3f1c4d29)


   sys/libkern/qsort.c | 14 +-------------
   1 file changed, 1 insertion(+), 13 deletions(-)

[commit f1e93df44ba0b494c6eda01958a71fec501bc32b]
Date: 2025-08-15
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Userland.libraries
Subject: libc: Drop incorrect qsort optimization
Review: The qsort(3) implementation removes an incorrect optimization that caused quadratic runtime for some inputs, restoring expected linearithmic performance.
Body:

  As pointed out in the PR and the article linked below, the switch to
  insertion sort in the BSD qsort code is based on a misunderstanding of
  Knuth's TAOCP and is actually a pessimization.  As demonstrated by the
  added test, it is trivially easy to construct pathological input which
  results in quadratic runtime.  Without that misguided optimization, the
  same input runs in nearly linearithmic time.

  https://www.raygard.net/2022/02/26/Re-engineering-a-qsort-part-3

  PR:		287089
  MFC after:	1 week
  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D51907

  (cherry picked from commit 5205b32de3fb7702e96b3991f5b1a61eee406d8b)


   lib/libc/stdlib/qsort.c             |  13 -----
   lib/libc/tests/stdlib/Makefile      |   1 +
   lib/libc/tests/stdlib/qsort_bench.c | 113 ++++++++++++++++++++++++++++++++++++
   3 files changed, 114 insertions(+), 13 deletions(-)

[commit 0110702febf077114bb449ec53a6058ae9f766d1]
Date: 2025-01-09
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: enic(4): fix down/up, MTU changes and more
Review: The enic(4) driver now supports ifconfig down/up cycles and MTU changes via ifconfig. Checksum offloading is enabled, and multiple queue support is improved with updated interrupt handling.
Body:

  (cherry picked from commits 0acab8b3d1336d4db73a9946ef76b4bcd0b0aabe, 1c9c4a25e600bcfad3eec891d43221b55ddf7e19)

  ifconfig down/up cycles was not working.  Fix that which is required
  to support MTU changes.  Now doing ifconfig enic0 mtu 3000 for example
  works.  If the MTU is changes in the VIC HW configuration, that is not
  reflected in and the OS reports the default 1500.  I need to look at
  that but changing it via ifconfig works.  So this is different then
  what Linux does.

  Change TX interrupt allocation to be in this driver.  Change the admin
  interrupt count to 2.  This make multiple queues work but need to be
  done as pairs so if the VIC has more TX or RX queues setup in the
  VIC configuration it will use the lesser value.

  While updating the TX interrupt also add support for devcmd2.

  Enable checksum offloading.

  PR:	282095


   sys/dev/enic/cq_desc.h       |  15 ---
   sys/dev/enic/enic.h          |  76 ++++++--------
   sys/dev/enic/enic_res.c      |   4 +-
   sys/dev/enic/enic_res.h      |   2 -
   sys/dev/enic/enic_txrx.c     |  39 +++++--
   sys/dev/enic/if_enic.c       | 192 +++++++++++++++++++++++++++++-----
   sys/dev/enic/vnic_cq.c       |   2 -
   sys/dev/enic/vnic_cq.h       |   9 +-
   sys/dev/enic/vnic_dev.c      | 244 ++++++++++++++++++++++++++++++++++++-------
   sys/dev/enic/vnic_dev.h      |   9 +-
   sys/dev/enic/vnic_intr.c     |   2 +-
   sys/dev/enic/vnic_intr.h     |   2 +-
   sys/dev/enic/vnic_resource.h |   1 +
   sys/dev/enic/vnic_rq.c       |   7 +-
   sys/dev/enic/vnic_rq.h       |   1 -
   sys/dev/enic/vnic_rss.h      |   5 -
   sys/dev/enic/vnic_wq.c       | 106 +++++++++++++++++--
   sys/dev/enic/vnic_wq.h       |  18 +++-
   18 files changed, 569 insertions(+), 165 deletions(-)

[commit 5e243ccc5f67229582f6e6cbfbaee834adb7cdae]
Date: 2025-08-19
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.libraries
Subject: libc: preserve errno in gai_strerror()
Review: The man:gai_strerror[3] function now preserves errno, preventing unintended side effects for applications that rely on errno after calling it.
Body:

  PR:	288931

  (cherry picked from commit f892e509c1a07f7116b9788a05e4ae99a06d54d0)


   lib/libc/net/gai_strerror.c | 4 ++++
   1 file changed, 4 insertions(+)

[commit ac1e3998bd770ee142a1180123e8b735548b7d57]
Date: 2025-08-19
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: libc: some style in gai_strerror.c
Review: Style-only changes with no user-visible impact.
Body:

  (cherry picked from commit bd4dd5d951ea022b478c455c3eabb2a1b8cc4936)


   lib/libc/net/gai_strerror.c | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 5dd8aa3d2b945508c90cc814331aa9047faf55e2]
Date: 2025-08-19
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libc: mark ai_errlist as const
Review: The commit changes an internal variable to const, which has no user-visible impact.
Body:

  (cherry picked from commit 47d1788c2e984f99521fd5b31194f96d94bf8a6b)


   lib/libc/net/gai_strerror.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 30151215532469142d7c81a7e1736cc4460170de]
Date: 2025-08-19
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libc: convert ai_errlist array to designated initializers syntax
Review: The commit converts an internal array to designated initializers, which is a code style change with no user-visible impact.
Body:

  (cherry picked from commit 632f7051709da98d4c9e59f11404f00d456b592c)


   lib/libc/net/gai_strerror.c | 30 +++++++++++++++---------------
   1 file changed, 15 insertions(+), 15 deletions(-)

[commit 17d87881a363c160e7e8cdb252d0261214c1a50b]
Date: 2025-08-18
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Juniper Networks, Inc.
Section: Kernel.general
Subject: arm64: prevent panic when using syscall mux + large arg call (mmap)
Review: The arm64 kernel now supports up to 10 arguments for syscall muxing, preventing a panic when using mmap with large argument counts.
Body:

  if the syscall muxes are used, up to two additional arguments
  may be required.  This means that the 8 required for mmap increases
  up to 10 (for __syscall).

  Sponsored by:   Juniper Networks, Inc.

  (cherry picked from commit 740b879c6ade531adebeba7cd2f261bbe650797f)


   sys/arm64/arm64/elf32_machdep.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5b42aac0013afa760a8071cdf16c70786c5802b9]
Date: 2025-07-21
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: makefs/zfs tests: Run in parallel
Review: makefs ZFS tests now run in parallel, reducing test suite execution time.
Body:

  Use the script PID as a pool GUID.  This way, tests running in parallel
  will have pool GUIDs that won't collide, and the tests no longer need to
  be serialized.

  MFC after:	1 month

  (cherry picked from commit 68dc9c6b8ef86caef3962cc9177bb21d8f38b0ed)


   usr.sbin/makefs/tests/Makefile            | 4 ----
   usr.sbin/makefs/tests/makefs_zfs_tests.sh | 2 +-
   2 files changed, 1 insertion(+), 5 deletions(-)

[commit b681da5c8d8b8bfac0a91401545776fe8f1919ae]
Date: 2025-07-21
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: makefs/zfs: Allow the user to specify the pool GUID
Review: The man:makefs[8] utility now supports specifying a pool GUID for ZFS filesystem creation, enabling parallel test execution.
Body:

  This will be used by the test suite to enable running makefs/zfs tests
  in parallel.

  MFC after:	1 month

  (cherry picked from commit cd4b9dac1a0dc6b868aa4376ac355aaf25430a77)


   usr.sbin/makefs/makefs.8 | 6 ++++++
   usr.sbin/makefs/zfs.c    | 6 +++++-
   2 files changed, 11 insertions(+), 1 deletion(-)

[commit 8fbaa731d538fcbea8144d843b3d71037503cc78]
Date: 2025-07-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: makefs/zfs: Make it possible to set a compression property
Review: The man:makefs[8] utility now supports setting a compression property for ZFS datasets when creating a filesystem image. This allows enabling compression for new files after the generated pool is imported, with compression inherited from the parent dataset by default.
Body:

  makefs currently does not implement compression for ZFS datasets, as
  doing so seems somewhat fraught with compatibility issues.  As a result,
  the root dataset has compression disabled, and all others inherit from
  that.

  However, it may be useful to enable compression for new files once the
  generated pool is actually imported.  Thus, implement a per-data
  compression option.  By default, compression is inherited from the
  parent dataset and disabled on the root dataset.

  Add a regression test.

  PR:		288241
  MFC after:	1 month

  (cherry picked from commit d8f3e8781b2ce316120e9a5a42bb1174e9a53187)


   usr.sbin/makefs/makefs.8                  | 10 +++-
   usr.sbin/makefs/tests/makefs_zfs_tests.sh | 90 +++++++++++++++++++++++++++++++
   usr.sbin/makefs/zfs/dsl.c                 | 44 +++++++++++++--
   3 files changed, 137 insertions(+), 7 deletions(-)

[commit 58022811d35382ffe48ab6b1edc4984c800f9841]
Date: 2025-07-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.contrib
Subject: libdtrace: Permit taking the address of an identifier without type info
Review: The DTrace language now permits taking the address of identifiers without type information, such as assembler-defined symbols like `ticks`. This allows users to cast and dereference pointers to these symbols to access their values.
Body:

  Symbols defined using assembler directives lack type info, but in this
  case one ought to be able to cast a pointer to the symbol and
  dereference the pointer to get a value.  Without this change, D
  disallows this trick since it requires all identifiers to have a type.

  Relax the rules slightly and allow an identifier to have type "void" if
  we know we're just taking its address.

  As a result, the following dtrace invocation works:

    dtrace -n 'tick-1s {printf("%d", *(int *)&`ticks);}'

  In particular, since commit b2b974f7ef4c ("clock: Simplify subr_ticks
  and rename"), "ticks" does not have any type info associated with it, so
  its value couldn't be printed.  This trick provides a workaround and is
  probably generally useful.

  Add a regression test which exercises this functionality.

  PR:		287752
  Reviewed by:	avg
  MFC after:	1 month
  Differential Revision:	https://reviews.freebsd.org/D51417

  (cherry picked from commit dabde7d97680cac7e0ead56693d424f4e5631019)


   .../dtrace/test/tst/common/profile-n/tst.ticks.d   | 54 ++++++++++++++++++++++
   .../opensolaris/lib/libdtrace/common/dt_parser.c   | 25 ++++++++--
   .../opensolaris/lib/libdtrace/common/dt_parser.h   |  1 +
   .../dtrace/tests/common/profile-n/Makefile         |  1 +
   4 files changed, 78 insertions(+), 3 deletions(-)

[commit d9ddd261ef3e746704385889a38d275a32284de4]
Date: 2025-08-01
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Kernel.general
Subject: vm_page: Clear VM_ALLOC_NOCREAT in vm_page_grab_pflags()
Review: The commit fixes an assertion failure in the virtual memory subsystem that could cause a kernel panic under certain conditions, preventing system crashes related to memory allocation.
Body:

  Otherwise vm_page_grab_zero_partial() and vm_page_grab_pages() can pass
  it to vm_page_alloc_*(), which results in an assertion failure since
  that flag is meaningless when allocating a page:

  panic: invalid request 0x8400
  cpuid = 0
  time = 1754074745
  KDB: stack backtrace:
  db_trace_self_wrapper() at db_trace_self_wrapper+0x49/frame 0xfffffe00542859c0
  vpanic() at vpanic+0x1ea/frame 0xfffffe0054285b00
  panic() at panic+0x43/frame 0xfffffe0054285b60
  vm_page_alloc_domain_iter() at vm_page_alloc_domain_iter+0x720/frame 0xfffffe0054285be0
  vm_page_grab_zero_partial() at vm_page_grab_zero_partial+0x1d4/frame 0xfffffe0054285c90
  shm_fspacectl() at shm_fspacectl+0x1cd/frame 0xfffffe0054285d30
  kern_fspacectl() at kern_fspacectl+0x49f/frame 0xfffffe0054285db0
  sys_fspacectl() at sys_fspacectl+0x5b/frame 0xfffffe0054285e00
  amd64_syscall() at amd64_syscall+0x29c/frame 0xfffffe0054285f30
  fast_syscall_common() at fast_syscall_common+0xf8/frame 0xfffffe0054285f30

  Reported by:	syzkaller
  Reviewed by:	alc, kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51692

  (cherry picked from commit 9a1b3303352beb44d48b8251b80656a316b7a2e9)


   sys/vm/vm_page.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 88fff9ee28476ae00536bcc5b9cfdd37185143ae]
Date: 2025-07-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: vnode_pager: Remove uses of DEBUG_VFS_LOCKS
Review: The commit removes a dependency on DEBUG_VFS_LOCKS for an assertion, allowing it to be checked with INVARIANTS, but this is an internal debugging change with no user-visible impact.
Body:

  This assertion can reasonably be checked when plain INVARIANTS is
  configured, there's no need to configure a separate option.

  Reviewed by:	kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51699

  (cherry picked from commit d733bca67055b6a49b4f7abe78c39188900a7720)


   sys/vm/vnode_pager.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 765b8ef6991c317b4172f3ebc2db21beb8168627]
Date: 2025-07-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: mac: Remove uses of DEBUG_VFS_LOCKS
Review: The commit removes internal debugging code for vnode locks when INVARIANTS is configured, which does not affect user-visible behavior.
Body:

  We can assert that a vnode lock is held whenever INVARIANTS is
  configured.

  Reviewed by:	kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51698

  (cherry picked from commit 2daaf63d538b76b6c135c273cc17c56fac5a7535)


   sys/security/mac/mac_framework.h | 2 +-
   sys/security/mac/mac_vfs.c       | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit b532d0509b715858ac7381c3d8f260c010595419]
Date: 2025-07-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: tmpfs: Remove uses of DEBUG_VFS_LOCKS
Review: The commit removes a dependency on DEBUG_VFS_LOCKS for an assertion, allowing it to be checked with INVARIANTS. This is an internal kernel debugging change with no user-visible impact.
Body:

  This assertion can reasonably be checked when plain INVARIANTS is
  configured, there's no need to configure a separate option.

  Reviewed by:	kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51697

  (cherry picked from commit 4b56c7ff6c5b4e4f9dfd2eb09a5a901f4ff9b8b3)


   sys/fs/tmpfs/tmpfs_vnops.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d033848a5e4ca02b20c55b8e8601c57087dafb81]
Date: 2025-07-24
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: ufs: Remove uses of DEBUG_VFS_LOCKS
Review: Removes the requirement for DEBUG_VFS_LOCKS to enable certain UFS assertions; these checks are now available with the standard INVARIANTS kernel option.
Body:

  All of these assertions can reasonably be checked when plain INVARIANTS
  is configured, there's no need to configure a separate option.

  Reviewed by:	olce, imp, kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51696

  (cherry picked from commit 4798f1e8f28d1bd440987696b3474eb6ca764fde)


   sys/ufs/ffs/ffs_softdep.c | 2 --
   sys/ufs/ffs/ffs_vnops.c   | 2 --
   sys/ufs/ufs/ufs_lookup.c  | 2 --
   sys/ufs/ufs/ufs_quota.c   | 4 ----
   4 files changed, 10 deletions(-)

[commit a58eb4d233bfdddff243faec071f8dc18d3e5492]
Date: 2025-07-14
Score: 5
Status: proposed(include=no,score=45)
Sponsor: 
Section: undecided
Subject: lib: Fix calls that naively set F_SETFD.
Review: The commit fixes a bug where setting FD_CLOEXEC inadvertently cleared FD_CLOFORK and FD_RESOLVE_BENEATH flags, which could affect file descriptor behavior in forked processes or path resolution.
Body:

  With the recent inclusion of the FD_CLOFORK and FD_RESOLVE_BENEATH flags,
  we must avoid clearing them when setting only FD_CLOEXEC.

  Signed-off-by: Ricardo Branco <rbranco@suse.de>

  Reviewed by:	kib, markj
  MFC after:	1 month
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1766

  (cherry picked from commit 8768b60de16a3d72a8783ec1241a711a782a36a9)


   lib/libc/gen/fdopendir.c | 10 +++++++++-
   lib/libc/stdio/fdopen.c  | 18 ++++++++++++++----
   lib/libc/stdio/freopen.c | 10 +++++++---
   lib/libfetch/common.c    |  7 +++++--
   4 files changed, 35 insertions(+), 10 deletions(-)

[commit 10bb227a7d10cbdc859473424cc0c1ab0adbf503]
Date: 2025-07-17
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: vfs: Move DEBUG_VFS_LOCKS checks to INVARIANTS
Review: Vnode lock assertions are now enabled when INVARIANTS is configured, removing the separate DEBUG_VFS_LOCKS option. This change makes debugging vnode locking issues more straightforward for developers and testers.
Body:

  It is easy to forget to configure DEBUG_VFS_LOCKS, and when one does, no
  vnode lock assertions are checked when INVARIANTS is configured, so bugs
  can arise.  This has happened to me more than once, and the overhead
  over DEBUG_VFS_LOCKS does not appear to be high enough to prohibit
  folding it into INVARIANTS, so let's do that.

  The change makes vnode lock assertions useful in plain INVARIANTS
  kernels, and guards VOP debug routines on INVARIANTS rather than
  DEBUG_VFS_LOCKS.  Further, invariants are now checked by plain
  assertions rather than having various sysctls to finely control what
  happens the checks fail.  The extra complexity didn't seem particularly
  useful and is at odds with how we handle debugging most everywhere else.

  Reviewed by:	kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51402

  (cherry picked from commit 3bd8fab2415bf517d169fed2aa345ef08a977a98)


   sys/kern/vfs_subr.c    | 103 ++++++++++++++-----------------------------------
   sys/sys/vnode.h        |   8 ++--
   sys/tools/vnode_if.awk |   6 +--
   3 files changed, 37 insertions(+), 80 deletions(-)

[commit 56e00aca338cc45c3fbd4f95c2a8bb8dfac1efb7]
Date: 2025-08-16
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Storage.general
Subject: zfs readdir: if there were no dirents to copy out, return EINVAL same as UFS
Review: The ZFS readdir implementation now returns EINVAL when there are no directory entries to copy out, matching the behavior of UFS. This ensures consistent error handling across filesystems for applications that rely on this error code.
Body:

  (cherry picked from commit 9a3edc8d5dbcb896179cfa7867f961184e146a09)


   sys/contrib/openzfs/module/os/freebsd/zfs/zfs_vnops_os.c | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit d5cd41f2f1cffcf302ff80fc8a6a51ceeb81bfa5]
Date: 2025-08-16
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Storage.general
Subject: zfs readdir: set *eofp to 1 on eof
Review: The ZFS readdir operation now correctly sets the eof flag when reaching the end of directory entries, ensuring consistent behavior with other filesystems.
Body:

  (cherry picked from commit adba3e087173b8ca6c5e9db7241812d4ac752608)


   sys/contrib/openzfs/module/os/freebsd/zfs/zfs_vnops_os.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 828b4f1476c24ee3026d7944646363c49484d9f6]
Date: 2025-08-16
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: zfsctl_root_readdir: if there were no dirents to copy out, return EINVAL
Review: The man:zfs(8) filesystem returns EINVAL when reading an empty directory, affecting applications that rely on specific error behavior.
Body:

  (cherry picked from commit cead6157cc1b748df29b32072f492d4f6afae65a)


   .../openzfs/module/os/freebsd/zfs/zfs_ctldir.c     | 40 ++++++++++++++--------
   1 file changed, 26 insertions(+), 14 deletions(-)

[commit bbb515decc5cacefd4e0e053b50712d24df1b56c]
Date: 2025-08-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: zfsctl_root_readdir(): properly set eof
Review: The ZFS control directory readdir operation now correctly sets the end-of-file flag, preventing potential infinite loops when listing directories.
Body:

  PR:	288889

  (cherry picked from commit 1031208ebceb8554a0fe9c6d9c4b98a6631d4718)


   sys/contrib/openzfs/module/os/freebsd/zfs/zfs_ctldir.c | 2 ++
   1 file changed, 2 insertions(+)

[commit 53b021680ed97b7169ffc244894a8f8179867ac6]
Date: 2025-07-25
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: bsdinstall: Improve message for existing FreeBSD EFI entry
Review: The bsdinstall utility now displays a clearer message when an existing FreeBSD EFI boot entry is found during a reinstall, reducing potential user confusion.
Body:

  When reinstalling FreeBSD bsdinstall reported "There are multiple
  FreeBSD EFI boot entries."  This sounds like something went wrong in the
  past.  Clarify that there may be only one existing entry, which is not
  surprising for a reinstall.

  Reviewed by:	manu, ziaee
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D51527

  (cherry picked from commit ebc6ff8db17683b566d49fe89a43a668d3d67915)


   usr.sbin/bsdinstall/scripts/bootconfig | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 0c3d511959bac1661cb3891042e380bc480d8266]
Date: 2025-08-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: ufs: st_rdev is only meaningful for special nodes
Review: The man:stat[2] field st_rdev is now only set for special device nodes in UFS filesystems, aligning with POSIX and other filesystem behavior.
Body:

  (cherry picked from commit 6fd60c4887cb08203f654e6aac6b4dbaaf76111b)


   sys/ufs/ufs/ufs_vnops.c | 12 ++++++++----
   1 file changed, 8 insertions(+), 4 deletions(-)

[commit ea35c5b54fccf7a3f71857a251e610a5090ad154]
Date: 2025-08-23
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: UPDATING: Add an entry for commit 3f61ececacd8
Review: The commit adds an entry to the UPDATING file, which is a user-visible documentation update for administrators regarding a previous change.
Body:


   UPDATING | 5 +++++
   1 file changed, 5 insertions(+)

[commit 4f22d274ab0d1da23c000e4f7f2ea003c5fa94a7]
Date: 2025-08-23
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Kernel.general
Subject: param.h: Bump __FreeBSD_version for 3f61ececacd8
Review: The __FreeBSD_version is bumped due to an internal KAPI change in NFS modules, which may affect third-party kernel modules that rely on the version number for compatibility checks.
Body:

  Bump __FreeBSD_version to 1403505 for 3f61ececacd8
  since this commit changes the internal KAPI between
  the NFS modules.


   sys/sys/param.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 2fd0083fcc23f4c25860b8890292448720a5961c]
Date: 2025-08-09
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Kernel.general
Subject: vfs_syscalls.c: Fix handling of offset args for copy_file_range
Review: The copy_file_range() system call now correctly updates file offsets when non-NULL offset arguments are provided, preventing potential infinite loops in user code.
Body:

  Commit 197997a broke handling of the offset
  arguments to copy_file_range() when specified non-NULL.
  The code fails to update the offsets and, as such, a loop like:

  do {

     len = copy_file_range(infd, &inpos, outfd, &outpos,
        SSIZE_MAX, 0);
  } while (len > 0);

  becomes an infinite loop, just doing the same copy over and
  over again.

  This patch fixes it.

  The clause "(foffsets_locked || foffsets_set)" in the if is not
  actually needed for correctness, but I thought it made the code
  a little more readable and might avoid some static
  analyzer from throwing a "used before being set" for
  the savinoff and savoutoff variables.

  (cherry picked from commit 4046ad6bb0ee542a42d89a48a7d6a56564ed7f33)


   sys/kern/vfs_syscalls.c | 17 ++++++++++++-----
   1 file changed, 12 insertions(+), 5 deletions(-)

[commit 248daca0b3c3bd411a4629047e21cc03532890c0]
Date: 2025-08-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: nfscl: Fix GetACL so that it does not want a reply cached
Review: The NFS client now disables reply caching for GetACL RPC requests to avoid NFS4ERR_X errors when ACL replies are too large for caching.
Body:

  Without this patch, an NFSv4.1/4.2 GetACL RPC requests that
  the session cache the reply.  In some cases, the reply may
  be too large to cache, resulting in a NFS4ERR_X
  error from the server.

  Since a GetACL is idempotent, disable reply caching for it,
  by setting that it can generate a large reply.
  Tested against a Linux server with a large ACL on a file.

  (cherry picked from commit 51affb7e97161e260f6d99cb0904daf7cc9f51a7)


   sys/fs/nfs/nfs_commonsubs.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3f61ececacd8d86f7c9dfc73383e0346f66f0784]
Date: 2025-07-19
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: nfsd: Avoid relocking vnode for NFSv4 Readdir
Review: The commit addresses a potential deadlock in NFSv4 Readdir by avoiding unnecessary vnode relocking for extended attribute checks. This change improves efficiency and prevents possible deadlocks if future NFSv4 clients request the extended attribute attribute during Readdir operations.
Body:

  Without this patch, nfsv4_fillattr() relocks the vnode to
  test to see if extended attributes are supported.
  This is inefficient and could cause deadlocks if Readdir
  ever asks for this attribute.

  At this time, no extant NFSv4 client asks for this attribute
  for Readdir, but this patch fixes the problem in case a
  future client does so, by moving the test for extended attribute
  support to before the nfsv4_fillattr() call where the vnode
  is still locked.

  (cherry picked from commit c00baac0ab46f54951a29b834e064935b749ae9a)


   sys/fs/nfs/nfs_commonsubs.c     | 19 +++----------------
   sys/fs/nfs/nfs_var.h            |  6 +++---
   sys/fs/nfsclient/nfs_clrpcops.c |  2 +-
   sys/fs/nfsclient/nfs_clstate.c  |  2 +-
   sys/fs/nfsserver/nfs_nfsdport.c | 24 ++++++++++++++++++------
   sys/fs/nfsserver/nfs_nfsdserv.c | 16 ++++++++++++++--
   6 files changed, 40 insertions(+), 29 deletions(-)

[commit 637fa8441f0c8712b64f7ad95d072fcef5435c11]
Date: 2025-06-04
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Ports.packaging
Subject: packages: fix ownership of /tmp and /dev
Review: The ownership and permissions of /tmp and /dev in package installations are now set via mtree, ensuring correct defaults without manual post-install steps.
Body:

  release/packages/runtime.ucl manually adds "/tmp" and "/dev" to the
  "directories" key, which causes them to be included in the manifest
  with the user/group owner of whoever built the package repository:

  drwxr-xr-x   7 ivy wheel 512 Jun  1 17:24 /dev
  drwxrwxrwt  10 ivy wheel  10 Jun  1 17:42 /tmp

  Remove the manual entries and instead put an explicit package tag
  in etc/mtree/BSD.root.dist.  This also means /tmp gets the right
  mode by default and we can remove the chmod from the post-install
  script.

  PR:	288746
  Reviewed by:	manu, kevans, emaste
  Approved by:	kevans (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50636

  (cherry picked from commit 6b2993e74ebaacd46bd1e438787c23450cd2752d)


   etc/mtree/BSD.root.dist      | 4 ++--
   release/packages/runtime.ucl | 5 -----
   2 files changed, 2 insertions(+), 7 deletions(-)

[commit 8174561013b3f2a0685819e037934e47f63d917a]
Date: 2025-07-28
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: bsdinstall: use the canonical name for compression
Review: The bsdinstall installer now uses the canonical ZFS property name 'compression' instead of the alias 'compress', and changes the default compression from 'lz4' to 'on' to adapt to future default algorithm changes.
Body:

  According to zfsprops(7), the canonical property for the compression
  algorithm is "compression", with "compress" accepted as an alternate
  name.  Use the canonical name in bsdinstall.

  While here, change "lz4" to "on" so we pick up any future changes in
  the default compression algorithm.

  MFC after:	1 week
  Reviewed by:	delphij
  Differential Revision:	https://reviews.freebsd.org/D51572

  (cherry picked from commit 16045420e7f83489ecd5e2163aa9bb11236962f5)


   usr.sbin/bsdinstall/bsdinstall.8    | 2 +-
   usr.sbin/bsdinstall/scripts/zfsboot | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit c064ee9d7d974d5626e43f7817db940cefe9dead]
Date: 2025-07-31
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.programs
Subject: ifconfig: Support VLAN ID in static/deladdr
Review: The ifconfig(8) utility now supports specifying a VLAN ID when adding or removing static addresses on bridge interfaces. This allows administrators to manage bridge addresses on specific VLANs using the 'vlan <id>' argument with the 'static' and 'deladdr' commands.
Body:

  Add an optional "vlan <n>" argument to the bridge static and deladdr
  commands to allow addresses to be added to / removed from a particular
  vlan.  No changes to if_bridge are required as the kernel API already
  supports this, it just wasn't exposed in ifconfig.

  Add tests for the new functionality, and improve the test for the
  existing "static" command.

  Reviewed by:		kevans
  Differential Revision:	https://reviews.freebsd.org/D51243

  (cherry picked from commit 3650722abf2922893540361a1369b54abc5ff8d2)


   sbin/ifconfig/ifbridge.c        | 71 +++++++++++++++++++++++++++++++----------
   sbin/ifconfig/ifconfig.8        | 18 ++++++++---
   tests/sys/net/if_bridge_test.sh | 70 +++++++++++++++++++++++++++++++++++++++-
   3 files changed, 136 insertions(+), 23 deletions(-)

[commit 8b728c63f777f3b2e220fe28fbe24b74f5a7c388]
Date: 2025-07-28
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ifconfig/ifbridge.c: add get_vlan_id()
Review: Adds a new internal helper function for VLAN ID validation in man:ifconfig[8] bridge code. No user-visible changes.
Body:

  This is like get_val() but takes an ether_vlanid_t* and ensures the
  value is a valid VLAN ID. This avoids redundant comparisons and
  casting when parsing VLAN IDs.

  Reviewed by:	des
  Differential Revision:	https://reviews.freebsd.org/D51548

  (cherry picked from commit 287a5fdcd3c941ce73705c664b5df4932ba3bad4)


   sbin/ifconfig/ifbridge.c | 14 ++++++++++++++
   1 file changed, 14 insertions(+)

[commit 99f2177b0905b9567ee35fd060b0db931e87b542]
Date: 2025-07-31
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.programs
Subject: ifconfig: Support variable-argument commands
Review: The ifconfig utility now supports variable-argument commands, allowing new commands to accept a flexible number of arguments for custom parsing.
Body:

  Add a new type of command, DEF_CMD_VARG, which takes an (argc, argv)
  pair instead of a fixed number of arguments.  This allows commands
  to do their own argument parsing and accept a variable number of
  arguments.

  Reviewed by:		kevans
  Differential Revision:	https://reviews.freebsd.org/D51243

  (cherry picked from commit 7d4a177efc653bc60a496ba0adf5cb4e0560fa07)


   sbin/ifconfig/ifconfig.c |  7 +++++++
   sbin/ifconfig/ifconfig.h | 10 ++++++++++
   2 files changed, 17 insertions(+)

[commit 4f295cd38b0a59d56bfdebb10346e2e91ebf7c19]
Date: 2025-08-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Ports.packaging
Subject: bsd.files.mk: Fix FILESPACKAGE
Review: The fix corrects package assignment for files installed via bsd.files.mk, ensuring that files like /usr/share/examples/sendmail/mailer.conf and some /usr/share/nls files are placed in the correct packages, and creates a new FreeBSD-examples package in stable/14.
Body:

  Because TAGS may already have a package tag, assigning TAGS to
  FILESTAGS causes the value of FILESPACKAGE to be ignored.

  Only assign tags other than package, and take the default package from
  ${PACKAGE}, which matches the behaviour of bsd.confs.mk and bsd.man.mk.

  This fixes several files that were wrongly installed in utilities,
  including /usr/share/examples/sendmail/mailer.conf and some files
  in /usr/share/nls.

  The fix trips a bug in share/syscons where Makefile.inc was setting
  FILESPACKAGE to the wrong package, but the problem was hidden because
  the subdirectories set PACKAGE explicitly.  Fix this by setting the
  correct FILESPACKAGE in Makefile.inc and removing the PACKAGEs.

  In stable/14, this creates a new FreeBSD-examples package, so add an
  entry to Makefile.packages.

  Reviewed by:		manu
  Differential Revision:	https://reviews.freebsd.org/D51784

  (cherry picked from commit 1e629ebb15db9ee0cb11a3654d7bcd3046a0df54)


   release/packages/Makefile.package | 2 ++
   share/mk/bsd.files.mk             | 6 +++---
   share/syscons/Makefile.inc        | 3 +--
   share/syscons/fonts/Makefile      | 3 ---
   share/syscons/keymaps/Makefile    | 3 ---
   share/syscons/scrnmaps/Makefile   | 3 ---
   6 files changed, 6 insertions(+), 14 deletions(-)

[commit 394f7ebf10bdb398d31f9115dd26b2d900fe1f6d]
Date: 2025-08-07
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: share/mk: Use :ts,:[*] to stringify TAG_ARGS
Review: The commit fixes a build system issue that could cause empty tags in arguments, affecting package builds. This change ensures consistent argument generation in various makefiles.
Body:

  This avoids a situation where we sometimes prepend an empty tag,
  leading to arguments like "-T ,package=foo".

  Reviewed by:		manu
  Differential Revision:	https://reviews.freebsd.org/D51785

  (cherry picked from commit 399faa7d3ae8938d73d58c9224123a71a2096947)


   share/mk/bsd.confs.mk | 2 +-
   share/mk/bsd.dirs.mk  | 2 +-
   share/mk/bsd.doc.mk   | 2 +-
   share/mk/bsd.incs.mk  | 2 +-
   share/mk/bsd.lib.mk   | 2 +-
   share/mk/bsd.links.mk | 2 +-
   share/mk/bsd.prog.mk  | 2 +-
   7 files changed, 7 insertions(+), 7 deletions(-)

[commit 5c4e9a10334b3c59f5d9f9d262ad3fa1a746b00d]
Date: 2025-08-07
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.config
Subject: share/misc: Move init.ee to the correct package
Review: The init.ee file is moved to the correct package and only installed when MK_EE is enabled, affecting users who rely on the ee editor initialization file.
Body:

  Also, only install it if MK_EE is enabled.

  Reviewed by:		manu (previous version)
  Differential Revision:	https://reviews.freebsd.org/D51787

  (cherry picked from commit 3958a0eb7efdea1e76137a0b8da55af7af4d4738)


   share/misc/Makefile                      | 10 +++++++++-
   tools/build/mk/OptionalObsoleteFiles.inc |  1 +
   2 files changed, 10 insertions(+), 1 deletion(-)

[commit 1eb29a37f26b1a3671f38037dd61975e1b1105cf]
Date: 2025-08-10
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.config
Subject: rc.conf: Use user.localbase to determine _localbase
Review: The rc.conf script now uses the user.localbase sysctl to determine the localbase path, falling back to /usr/local if unavailable. This ensures rc.d scripts like man:ldconfig[8] work correctly when a non-default localbase is set.
Body:

  When running an rc.d script outside of boot, ${_localbase} isn't set,
  and rc.conf hardcodes the default value to /usr/local.  Instead, try
  to get the localbase from the user.localbase sysctl, and only fall
  back to /usr/local if we can't for some reason.

  This fixes e.g. /etc/rc.d/ldconfig when localbase has a non-default
  value.

  Reviewed by:		imp, des
  Differential Revision:	https://reviews.freebsd.org/D51852

  (cherry picked from commit 5467020a540d92a39dcabc149a264f3c0d0c084c)


   libexec/rc/rc.conf | 1 +
   1 file changed, 1 insertion(+)

[commit d0fe99e288dceed9c4d87e6ca837a8079b128df3]
Date: 2025-08-10
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: tests/sys/net: if_bridge_test does not require python
Review: The if_bridge_test no longer requires Python to be installed for its basic tests, allowing them to run in environments without Python.
Body:

  This was originally added for if_bridge_test:span which uses scapy, but
  that requirement is now annotated in the test itself.

  Remove the requirement so the remaining bridge tests can run without
  Python installed.

  (cherry picked from commit bc9867173f6af243929129b7050af6c64966c7d6)


   tests/sys/net/Makefile | 1 -
   1 file changed, 1 deletion(-)

[commit 7b4ef8bcaf8c38c056b83a690ea214a4c0c028c6]
Date: 2025-08-15
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: syslogd.8: Remove incorrect .Aq
Review: Fixes a formatting issue in the man:syslogd[8] manual page by correcting the markup for angle brackets.
Body:

  Using .Aq is wrong here, because the protocol says the prefix must use
  ASCII <>.

  MFC after:	3 days
  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D51880

  (cherry picked from commit c75550e499971549b31d514ab139b80297c14792)


   usr.sbin/syslogd/syslogd.8 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a4e9f8567708a6e67bb634b3168c7fdca560e663]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: arm: Fix two typos in kernel messages of pmu_fdt.c
Review: Fixes two typographical errors in kernel messages of the pmu_fdt.c driver, correcting 'interupt' to 'interrupt' in output strings.
Body:

  - s/interupt/interrupt/

  (cherry picked from commit 9c7a9b3ff1eebbc15ef26bbdaae4f9448450523f)


   sys/arm/arm/pmu_fdt.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 4e8ac151bca92afbca258718a689d30a87e49d31]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: bnxt(4): Fix typos in a comment and a kernel message
Review: Fixes typos in a comment and a kernel message in the bnxt(4) driver.
Body:

  - s/priviledged/privileged/

  (cherry picked from commit 74eb496c1019f702a28b4fa757f1139fbcf44895)


   sys/dev/bnxt/bnxt_re/qplib_res.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 0a0f3b405100e2c8a51234a4fe77c92bbfe9746c]
Date: 2025-08-14
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.libraries
Subject: [libm] Avoid left shift of signed integer entities
Review: The commit fixes undefined behavior in libm by avoiding left shifts of signed integers, which may affect mathematical calculations in certain edge cases.
Body:

  Follow-up commit d180086e6eae by fixing the left shift of signed integer
  entities through the use of a helper function. Specific per file changes
  are:

  * lib/msun/src/e_fmodf.c:
  * lib/msun/src/s_remquof.c:
    . Eliminate now unused variable 'i'.
    . Sort declaration statement.
    . Use subnormal_ilogbf() to avoid left shift of signed integer.

  * lib/msun/src/math_private.h b/lib/msun/src/math_private.h:
    . Implement subnormal_ilogbf() to extract an exponent of a subnormal
      float.  This avoids left shifts of signed integers.
    . Update nearby comment.

  * lib/msun/src/s_ilogbf.c
    . Fix declaration of the function statement in accordance with style(9).
    . Use subnormal_ilogbf() to avoid left shift of signed integer.

  PR:		288850
  MFC after:	1 week

  (cherry picked from commit c58c77246f88da87f309e8c449e98195d43e2c76)


   lib/msun/src/e_fmodf.c      | 16 +++++++++-------
   lib/msun/src/math_private.h | 16 +++++++++++++++-
   lib/msun/src/s_ilogbf.c     |  5 +++--
   lib/msun/src/s_remquof.c    | 16 +++++++++-------
   4 files changed, 36 insertions(+), 17 deletions(-)

[commit d94b403b590f381ac924078b80c5e04ee62dd79c]
Date: 2025-08-18
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: nfsport.h: minor comments cleanup
Review: Minor comment-only cleanup with no user-visible impact.
Body:

  (cherry picked from commit c04fe26aa2f7d4c10070fc5cdbe047102f83c1be)


   sys/fs/nfs/nfsport.h | 12 ------------
   1 file changed, 12 deletions(-)

[commit b09a75d675dcaa9a1e5dcc63f7cfbb5df85419e6]
Date: 2025-08-01
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Klara, Inc.
Section: Docs.manpages
Subject: dtrace.1: Document security.bsd.allow_destructive_dtrace
Review: The man:dtrace[1] manual page now documents the security.bsd.allow_destructive_dtrace sysctl.
Body:

  PR:		288284
  Reviewed by:	bcr, markj
  MFC after:	3 days
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51633

  (cherry picked from commit 1acfb873cf2e59f9ddf53602cbc67fa810c878a6)


   cddl/contrib/opensolaris/cmd/dtrace/dtrace.1 | 25 ++++++++++++++++++++++++-
   1 file changed, 24 insertions(+), 1 deletion(-)

[commit 6a1e5dcb00514e056c1d702b46603142fcf48454]
Date: 2025-07-31
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: Klara, Inc.
Section: Docs.manpages
Subject: sysctl.3: Reference kinfo_getvmmap(3), kinfo_getfile(3), and kinfo_getproc(3)
Review: The sysctl.3 man page now references kinfo_getvmmap(3), kinfo_getfile(3), and kinfo_getproc(3) functions, helping users discover these utility wrappers.
Body:

  It seems to be a good place to help the user discover those useful
  wrappers.

  Reviewed by:	christos
  MFC after:	3 days
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51654

  (cherry picked from commit 04c8bba8c8672d186837e353d4f2335a26f0c3c1)


   lib/libc/gen/sysctl.3 | 7 ++++++-
   1 file changed, 6 insertions(+), 1 deletion(-)

[commit c1ccb7d304fbaa28531c604318a6b50cd5f8ecc9]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ufs_times_locked(): style
Review: Minor style fix with no user-visible impact.
Body:

  (cherry picked from commit 054c6e5b2fd629d651ce709e2916e13a0279309d)


   sys/ufs/ufs/ufs_vnops.c | 14 +++++++-------
   1 file changed, 7 insertions(+), 7 deletions(-)

[commit f17d7105cbca4679aa9dcc92cdac7b5ffd2b569f]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: isa: Fix a typo in a source code comment
Review: Typo fix in a source code comment only, no user-visible impact.
Body:

  - s/Monochome/Monochrome/

  (cherry picked from commit 4c7b81cfa29084bb0013969c175700069e6d7019)


   sys/isa/isareg.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3807e87f4eec6614d2e975f43a4f8308f3a4743a]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: udp: Fix a typo in a source code comment
Review: Typo fix in source code comment only, no user-visible impact.
Body:

  - s/datgram/datagram/

  (cherry picked from commit a3a78bd7a7446a9a437391c681ba196d956987da)


   sys/netinet/udp_usrreq.c   | 2 +-
   sys/netinet6/udp6_usrreq.c | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit f5a611989fa442706665d87afcc0607fe7d2cc6e]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: g_part: Fix a few typos in source code comments
Review: Fixes typos in source code comments only; no user-visible impact.
Body:

  - s/partitition/partition/

  (cherry picked from commit 7ce07c41423d143cd3f7b8f7e61c2f3e8b6336c2)


   sys/geom/part/g_part.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit d88135570023b2699744db78f8e76f298a00b1b4]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: libc: Fix a typo in a source code comment
Review: Typo fix in a source code comment only, no user-visible impact.
Body:

  - s/aguments/arguments/

  (cherry picked from commit 333b0490e3132bf8f1a0d974d8b2597caf765970)


   lib/libc/i386/gen/makecontext.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 7f1296b8dab1b177a150dff150cb2585e9f833d7]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: services_mkdb(8): Fix a typo in a source code comment
Review: Only a typo fix in a source code comment; no user-visible impact.
Body:

  - s/priviledged/privileged/

  (cherry picked from commit fbf0efd02608473021692d377dd567f247a1a85c)


   usr.sbin/services_mkdb/services | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 03fb545e27ef01db821a0cdc0d40035225a2d5ac]
Date: 2025-08-17
Score: 5
Status: proposed(include=yes,score=5)
Sponsor: 
Section: Docs.manpages
Subject: localedef.1: Fix a typo in the manual page
Review: Fixes a typographical error in the man:localedef[1] manual page.
Body:

  - s/contants/content/

  (cherry picked from commit c0367c654a3340c5aa194a3137489f760d556139)


   usr.bin/localedef/localedef.1 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 1458494b92e6e55ede271e3faa4b074353f1cb00]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: test/netfibs: Fix a typo in a source code comment
Review: Typo fix in a comment only; no user-visible impact.
Body:

  - s/aguments/arguments/

  (cherry picked from commit f066a425059e6ce80997f8ed850b74cc168c4d5e)


   tools/test/netfibs/reflector.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e3ba3105f735c8ab1b7fb726345498d4aa3d456c]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: isci(4): Fix a typo in a source code comment
Review: Fixes a typo in a source code comment only, with no user-visible impact.
Body:

  - s/contants/constants/

  (cherry picked from commit 663061da205e4112fa25bc628f35a56f0e31a39a)


   sys/dev/isci/scil/intel_sata.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit f7fb177c02216272a5d145885e213c4eabdf829d]
Date: 2025-08-17
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: stand/efi: Fix a typo in a source code comment
Review: Typo fix in a source code comment only, no user-visible impact.
Body:

  - s/externel/external/

  (cherry picked from commit a7818e34209579b5e1bba0df73c4d0d5ed2b1397)


   stand/efi/include/amd64/pe.h | 2 +-
   stand/efi/include/i386/pe.h  | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit 7c4565e3e75e110b167f04efbe9d9d6355fcf2de]
Date: 2025-08-12
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: [libm] Fix undefined behavior of a left shifted of a signed integer
Review: Fixes undefined behavior in libm functions fmod, ilogb, and remquo that could cause incorrect results or crashes when certain edge-case inputs are processed.
Body:

  PR:	288778

  (cherry picked from commit d180086e6eae2e152e803ed6cf13775a7c006dc7)


   lib/msun/src/e_fmod.c       | 30 ++++++++++++------------------
   lib/msun/src/math_private.h | 21 +++++++++++++++++++++
   lib/msun/src/s_ilogb.c      | 13 +++++--------
   lib/msun/src/s_remquo.c     | 30 ++++++++++++------------------
   4 files changed, 50 insertions(+), 44 deletions(-)

[commit 4d41e3a22d320e45619c2a10ce73957d15c3efc2]
Date: 2025-08-07
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Drivers.device
Subject: null: support EVFILT_READ/EVFILT_WRITE kevent filters
Review: The null, full, and zero devices now support EVFILT_READ and EVFILT_WRITE kevent filters, allowing event-driven monitoring of these devices.
Body:

  This enhances the full, null, and zero devices to support read and write kevent filters.

  A read event is immediately triggered for full and null, and never for zero.
  A write event is immediately triggered for zero and null, and never for full.

  Reviewed by:		cognet
  MFC after:		1 week
  Differential Revision:	https://reviews.freebsd.org/D51807

  (cherry picked from commit b89104dfd5cf001b34963b9e02083027f9d215d5)


   sys/dev/null/null.c | 48 ++++++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 48 insertions(+)

[commit 8b26c76a6d41556ecb2b2309a7332dfba47b65cf]
Date: 2025-08-09
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Updates for ccosh[f] and csinh[f]
Review: The commit updates internal math library implementations for complex hyperbolic functions (ccosh, csinh) with performance optimizations and minor code consistency changes. There is no user-visible change in behavior, API, or functionality.
Body:

  * lib/msun/src/s_ccosh.c:
    . Update Copyright years.
    . sin() and cos() are needed at the same time, so use sincos() to
      compute values.  This does argument reduction once instead of twice.
    . Replace '* 0.5' with '/ 2'. This reduces diff with s_ccoshf.c.
    . For (LDBL_MANT_DIG == 53), add weak references for ccoshl and ccosl.

  * lib/msun/src/s_ccoshf.c:
    . Update Copyright years.
    . sin() and cos() are needed at the same time, so use sincos() to
      compute values.  This does argument reduction once instead of twice.
    . Replace '* 0.5F' with '/ 2'. This reduces diff with s_ccoshf.c.

  * lib/msun/src/s_csinh.c:
    . Update Copyright years.
    . sin() and cos() are needed at the same time, so use sincos() to
      compute values.  This does argument reduction once instead of twice.
    . Replace '* 0.5' with '/ 2'. This reduces diff with s_csinhf.c.
    . For (LDBL_MANT_DIG == 53), add weak references for csinhl and csinl.

  * lib/msun/src/s_csinhf.c:
    . Update Copyright years.
    . sin() and cos() are needed at the same time, so use sincos() to
      compute values.  This does argument reduction once instead of twice.
    . Replace '* 0.5F' with '/ 2'. This reduces diff with s_ccoshf.c.

  PR:		288740
  MFC after:	1 week

  (cherry picked from commit a1d051bc878decc761b37cf8771ead100cc05768)


   lib/msun/src/s_ccosh.c  | 23 ++++++++++++++++-------
   lib/msun/src/s_ccoshf.c | 18 +++++++++++-------
   lib/msun/src/s_csinh.c  | 23 ++++++++++++++++-------
   lib/msun/src/s_csinhf.c | 18 +++++++++++-------
   4 files changed, 54 insertions(+), 28 deletions(-)

[commit 50e1230228d8bf7aeb1beb11f29c2e55338940df]
Date: 2024-06-25
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Dell EMC Isilon
Section: undecided
Subject: libmsun: remove duplicates after cdefs.h added inline to __always_inline
Review: Removes duplicate definitions of __always_inline in libmsun after cdefs.h inclusion, which may affect compiler behavior for math library functions but has no direct user-visible impact.
Body:

  Reviewed by:	kib, olce
  Sponsored by:	Dell EMC Isilon
  Differential Revision:	https://reviews.freebsd.org/D45712

  (cherry picked from commit 07cc7ea7386c5428cef9e8f06d4ebd8144dec311)


   lib/msun/ld128/e_rem_pio2l.h | 2 +-
   lib/msun/ld128/s_logl.c      | 2 +-
   lib/msun/ld80/e_rem_pio2l.h  | 2 +-
   lib/msun/ld80/s_logl.c       | 2 +-
   lib/msun/src/e_rem_pio2.c    | 2 +-
   lib/msun/src/e_rem_pio2f.c   | 2 +-
   6 files changed, 6 insertions(+), 6 deletions(-)

[commit a0849d43d4eb3c6fa4d1e497a2ef81ff071299b6]
Date: 2025-08-09
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: timerfd_read(): stop setting td_rtcgen
Review: The timerfd_read() system call no longer sets td_rtcgen, which is an internal kernel thread state change with no user-visible impact.
Body:

  (cherry picked from commit e8b37e754589c911fb7cdc706ba7c49a5bfb7175)


   sys/kern/sys_timerfd.c | 1 -
   1 file changed, 1 deletion(-)

[commit 3eafc9f76fd54fbd222d587b11752290766a0af5]
Date: 2025-07-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: chroot: don't clobber the egid with the first supplemental group
Review: The chroot(8) command now correctly handles the effective group ID and supplemental groups when using the -G and -g options, preventing unintended group list modifications.
Body:

  There are two problems here, really:

  1.) If -G is specified, the egid of the runner will get clobbered by
      the first supplemental group
  2.) If both -G and -g are specified, the first supplemental group will
      get clobbered by the -g group

  Ideally our users shouldn't have to understand the quirks of our
  setgroups(2) and the manpage doesn't describe the group list as needing
  to contain the egid, so populate the egid slot as necessary.

  I note that this code seems to have already been marginally aware of the
  historical behavior because it was allocating NGROUPS_MAX + 1, but this
  is an artifact of a later conversion to doing dynamic allocations
  instead of pushing NGROUPS_MAX arrays on the stack -- the original code
  did in-fact only have an NGROUPS_MAX-sized array, and the layout was
  still incorrect.

  Reviewed by:	olce

  (cherry picked from commit 48fd05999b0f8e822fbf7069779378d103a35f5c)
  (cherry picked from commit babab49eee9472f628d774996de13d13d296c8c0)


   usr.sbin/chroot/chroot.c | 57 ++++++++++++++++++++++++++++++------------------
   1 file changed, 36 insertions(+), 21 deletions(-)

[commit c2806cddc64766b69daa42b4fb192f767e4b4705]
Date: 2025-08-02
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: tests: gif(4): Add tests to cover all IPv[46] in IPv[46] setups
Review: Adds tests for gif(4) covering all IPv4 and IPv6 in IPv4 and IPv6 tunnel configurations.
Body:

  While here, rename basic to 4in4 to be consistent with other tests.

  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51566

  (cherry picked from commit 62439516cc9bba32ed2406f340326c4d37e4cc59)


   tests/sys/net/if_gif.sh | 147 ++++++++++++++++++++++++++++++++++++++++++++++--
   1 file changed, 141 insertions(+), 6 deletions(-)

[commit 878d3bdb59d70b2ce077f4bbdefea0ec875d6e82]
Date: 2025-08-02
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Userland.programs
Subject: ifconfig: Garbage collect unused parameter swabips
Review: Removes the unused swabips parameter and EN_SWABIPS macro from man:ifconfig[8], which were historical artifacts with no functional impact.
Body:

  and the macro EN_SWABIPS.

  The macro EN_SWABIPS is identical to IFF_LINK0 (also historically
  IFF_LLC0) and we already have the parameter link0 to toggle IFF_LINK0.

  These were inherited from 386BSD 0.1 and have never been used since
  the very first FreeBSD release.

  Reviewed by:	adrian, #network
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51368

  (cherry picked from commit 8632e4e73a6934f3f9996a18932e36b04e6a3faf)


   sbin/ifconfig/ifconfig.c | 5 -----
   1 file changed, 5 deletions(-)

[commit c28c2cd5a546b78fea7fe89533f9d042d4135eb4]
Date: 2025-08-09
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: Remove unused variables in msun/bsdsrc/b_tgamma.c
Review: Internal code cleanup with no user-visible impact.
Body:

  PR:		288736
  MFC after:	3 days

  (cherry picked from commit 53b77089e5cacb1ae863c3f70b3e6f286ca71df5)


   lib/msun/bsdsrc/b_tgamma.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 08559edad42205ebd3b1e542c23f0a019ec63df4]
Date: 2025-08-12
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: bsd.man.mk: Add checkmanlinks target
Review: The commit adds a new 'checkmanlinks' target to bsd.man.mk for verifying man page link integrity. This provides a build-time tool for developers and documentation maintainers to detect broken MLINKS entries.
Body:

  This target checks that every page mentioned in MLINKS exists and that
  every link corresponds to a (possibly commented-out) name entry in the
  page it links to.

  MFC after:	1 week
  Reviewed by:	bcr
  Differential Revision:	https://reviews.freebsd.org/D51862

  (cherry picked from commit 18a9f83630a7d4612066bb690bcec0437c0e2e72)


   share/mk/bsd.man.mk | 16 ++++++++++++++--
   1 file changed, 14 insertions(+), 2 deletions(-)

[commit 64de28a52827f0ec919e470ffa6f67963c877b28]
Date: 2025-08-11
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: kern.post.mk: Support flavors in PORTS_MODULES
Review: The build system now supports flavors in PORTS_MODULES, allowing more flexible module building from ports.
Body:

  MFC after:	1 week
  PR:		288596
  Reviewed by:	pkubaj
  Differential Revision:	https://reviews.freebsd.org/D51833

  (cherry picked from commit 988426e815c12a899c8c6853090b8c8fca7ed5cd)


   share/man/man7/build.7 | 10 +++++++---
   sys/conf/kern.post.mk  | 10 ++++++++--
   2 files changed, 15 insertions(+), 5 deletions(-)

[commit 89906b9b20fd0aaf33e4eaea14b99190179ad572]
Date: 2025-08-09
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.libraries
Subject: stdio: Fix bug in integer-parsing FSM
Review: The man:scanf[3] family of functions now correctly parses octal numbers when a zero is encountered after an initial zero, matching the C standard.
Body:

  If we encounter a zero in the havezero state, we should assume octal,
  just like we would if we encountered any other digit below 8.

  MFC after:	1 week
  PR:		288440
  Fixes:		d9dc1603d6e4 ("libc: Implement N2630.")
  Reviewed by:	mandree
  Differential Revision:	https://reviews.freebsd.org/D51832

  (cherry picked from commit 602e98dd35ea5041b800fb56a2b1ac34f6649310)


   lib/libc/stdio/vfscanf.c            |  5 ++---
   lib/libc/stdio/vfwscanf.c           |  5 ++---
   lib/libc/tests/stdio/sscanf_test.c  | 25 +++++++++++++++++++++++++
   lib/libc/tests/stdio/swscanf_test.c | 25 +++++++++++++++++++++++++
   4 files changed, 54 insertions(+), 6 deletions(-)

[commit d26dac01421e780f673ebcb806f2c2b51531eab1]
Date: 2025-08-08
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Klara, Inc.
Section: Userland.programs
Subject: indent: Fix buffer overflow
Review: The man:indent[1] utility no longer has a static buffer overflow vulnerability when creating backup files.
Body:

  The function used to create a backup of the input before starting work
  used a static buffer and did not check that the file name it constructed
  did not overflow.  Switch to using asprintf(), clean up the rest of the
  function, and update some comments that still referred to an earlier
  version of the code.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	bnovkov
  Differential Revision:	https://reviews.freebsd.org/D51796

  (cherry picked from commit eb41613d22977798f41dd979e4e4ec0965711916)


   usr.bin/indent/indent.c                 | 40 ++++++++++++++-------------------
   usr.bin/indent/tests/functional_test.sh | 18 +++++++++++++++
   2 files changed, 35 insertions(+), 23 deletions(-)

[commit 9bdd39b9fe52c3fb9f7d2ec9322138defb01afcc]
Date: 2025-08-08
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Klara, Inc.
Section: undecided
Subject: indent: Simplify test script
Review: The commit simplifies a test script for man:indent[1] by removing unnecessary workarounds and irrelevant cases. This change is internal to the test suite and does not affect user-visible functionality.
Body:

  Much of the test script was concerned with working around RCS tags and
  dealing with cases which don't apply to indent.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D51795

  (cherry picked from commit 0ecc679fd3da0720d6ba331ebcceca8e0760fa22)


   usr.bin/indent/tests/functional_test.sh | 55 +++++++++------------------------
   1 file changed, 15 insertions(+), 40 deletions(-)

[commit 62df4a7dd8e0cd0c27da54966f540dfb5c543658]
Date: 2025-08-06
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Userland.programs
Subject: hastd: Fix nv data size check
Review: The commit fixes a data size check in hastd that could be bypassed, preventing a potential segfault.
Body:

  The data size check, as currently written, can be defeated by providing
  a very large number that rounds up to 0, which will pass the check
  (because zero plus the size of the header and name is smaller than the
  size of the message) but cause a segfault later when used to index the
  data array.

  Rewrite the data size check to take rounding into account, and add a
  cast to ensure the name size can't round up to zero.

  MFC after:	1 week
  PR:		266827
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D51615

  (cherry picked from commit 3caee2a93f235ebcfe3a8ec99eb2c3f3e5b0438f)


   sbin/hastd/nv.c | 9 +++------
   1 file changed, 3 insertions(+), 6 deletions(-)

[commit f0ee68d143e5a0a9c2c89b50e67ef94065e77610]
Date: 2025-08-03
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: libutil: Add missing MLINKs
Review: The commit adds missing manual page links (MLINKs) for libutil functions and fixes a broken link, ensuring that man:quota_check_path[3] is properly documented. This resolves manlint failures and improves documentation completeness.
Body:

  MFC after:	1 week
  Reviewed by:	olce, imp, emaste
  Differential Revision:	https://reviews.freebsd.org/D51706

  (cherry picked from commit 22afc767869a23f4e0ec5436ce843728fded950c)

  libutil: Remove manual link for nonexistent function

  I believe quota_statfs() was the original name of the function now
  called quota_check_path().  I must have forgotten to update the MLINK
  when I renamed it.

  MFC after:	1 week
  Fixes:		5666aadb3ddf ("Further extend the quotafile API.")
  Fixes:		22afc767869a ("libutil: Add missing MLINKs")
  Reviewed by:	bcr
  Differential Revision:	https://reviews.freebsd.org/D51863

  (cherry picked from commit 7400d04407c033341ddc0b323b5ae7cd1cca358f)

  libutil: Fix manlint failures

  MFC after:	1 week
  Reviewed by:	ziaee
  Differential Revision:	https://reviews.freebsd.org/D51864

  (cherry picked from commit d0cc09fcdb4a3192fb76c95b1bd3c7f31a4cf486)

  ObsoleteFiles: Remove bogus manlink

  Fixes:		7400d04407c0 ("libutil: Remove manual link for nonexistent function")
  (cherry picked from commit 46f9056367596daad0b4f0065e5a8fa0bcbb907d)


   ObsoleteFiles.inc        |   3 +
   lib/libutil/Makefile     | 160 ++++++++++++++++++++++++++++++-----------------
   lib/libutil/login.conf.5 |   7 ++-
   lib/libutil/login_auth.3 |   4 +-
   lib/libutil/login_cap.3  |   1 +
   lib/libutil/pw_util.3    |   1 +
   lib/libutil/uucplock.3   |   1 +
   7 files changed, 116 insertions(+), 61 deletions(-)

[commit 4dd4999d23f7d2a281430729fe02ddc7cb77e92b]
Date: 2025-08-03
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: libutil: Document pidfile_signal()
Review: The man:pidfile[3] manual page now includes documentation for the pidfile_signal() function.
Body:

  Fixes:		287451fd0192
  MFC after:	1 week
  Reviewed by:	pauamma_gundo.com, emaste
  Differential Revision:	https://reviews.freebsd.org/D51705

  (cherry picked from commit 4e6a3e7e3240a95cda1d490831aa16ed3b9bd59b)


   lib/libutil/pidfile.3 | 68 ++++++++++++++++++++++++++++++++++++++++++++++++---
   1 file changed, 64 insertions(+), 4 deletions(-)

[commit 51dbdd1d8634bf0d5af2a3d5a521a6576cc93a37]
Date: 2024-05-24
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.config
Subject: rc: improve NAME_setup handling
Review: The rc.subr framework now invokes NAME_setup before NAME_precmd during service start, restart, and reload actions, allowing custom configuration generation and fixes before configuration checks. This change affects administrators who write or modify rc.d scripts.
Body:

  Reload is used for service reconfiguration as well
  and lacks a NAME_prepend-like mechanism so it makes
  sense to extend the NAME_reload hook into this
  action.

  precmd may use configuration checks and blocks setup
  from doing its designated work (e.g. nginx).  In moving
  the invoke of the setup script in front allows us to
  provide custom scripts for config file generation and
  fixing prior to precmd checking configuration integrity.

  Also introduce _run_rc_setup to separate the launcher
  from the main one.  Let it run correctly in the case
  of restart_precmd and block further execution as
  would be the case in start due to the internal plumbing
  of restart being split into calling stop and start
  afterwards.

  Differential-Revsiion: https://reviews.freebsd.org/D36259
  Signed-off-by: Franco Fichtner <franco@opnsense.org>
  Reviewed by: imp, oshogbo
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1258

  (cherry picked from commit 11333dd580b704fb4ff0836e1d1a0634099b0cf6)


   libexec/rc/rc.subr       | 72 ++++++++++++++++++++++++++++++++----------------
   share/man/man8/rc.subr.8 | 11 ++++++--
   2 files changed, 57 insertions(+), 26 deletions(-)

[commit e71d494c600e7cd6433f498a2ec9929ef98879fc]
Date: 2025-07-29
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Kernel.general
Subject: aio: Fix a race in sys_aio_cancel()
Review: Fixes a race condition in man:aio_cancel[2] that could cause incorrect behavior when cancelling asynchronous I/O operations.
Body:

  sys_aio_cancel() loops over pending jobs for the process, cancelling
  some of them.  To cancel a job with a cancel callback, it must drop the
  job list mutex.  It uses flags, KAIOCB_CANCELLING and KAIOCB_CANCELLED,
  to make sure that a job isn't double-cancelled.  However, when iterating
  over the list it uses TAILQ_FOREACH_SAFE and thus assumes that the next
  job isn't going to be removed while the lock is dropped.  Of course,
  this assumption is false.

  We could simply start search from the beginning after cancelling a job,
  but that might be quite expensive.  Instead, introduce the notion of a
  marker job, used to keep track of one's position in the queue.  Use it
  in sys_aio_cancel() to resume iteration after a job is cancelled.

  Reported by:	syzkaller
  Reviewed by:	kib, jhb
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51626

  (cherry picked from commit 2dde3bed347ab46685d079c2fcc1dbd1fa149286)


   sys/kern/vfs_aio.c | 33 ++++++++++++++++++++++++++++-----
   1 file changed, 28 insertions(+), 5 deletions(-)

[commit 7b9f6ebb9268defdfa4403abdf4b12282110f4c8]
Date: 2025-08-06
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: NetApp, Inc.
Section: Network.general
Subject: tcp: ensure SACK rxmit never ends up left of its hole
Review: The TCP SACK retransmit logic is adjusted to prevent a retransmission hole pointer from moving left of its hole during RTO events, improving reliability of loss recovery.
Body:

  When a RTO happens during SACK loss recovery, snd_recover can possibly pulled left.
  With Lost Retransmission Detection (LRD) this can lead to rxmit of a hole to end up
  pointing to the left of the hole, which is unexpected and leads to complications.

  Reviewed By: tuexen, #transport
  Sponsored by: NetApp, Inc.
  MFC after: 1 week
  Differential Revision: https://reviews.freebsd.org/D51725

  (cherry picked from commit 65d4a83399843cb4c6dd44061599390843c162db)


   sys/netinet/tcp_output.c | 2 +-
   sys/netinet/tcp_sack.c   | 4 ++--
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit d60022f3c24ea32acd1d2fb9cc583cc095bb2a60]
Date: 2025-07-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Network.general
Subject: if_ovpn: support IPv6 link-local addresses
Review: The OpenVPN interface driver (if_ovpn) now supports IPv6 link-local addresses, enabling IPv6 connectivity in link-local contexts.
Body:

  MFC after:	3 weeks
  Sponsored by:	Rubicon Communications, LLC ("Netgate")
  Differential Revision:	https://reviews.freebsd.org/D51596

  (cherry picked from commit 60e92d17cfeba02bc3c7a6edfa0bcaf7c63e5f35)


   sys/net/if_ovpn.c                | 21 ++++++++++-
   tests/sys/net/if_ovpn/if_ovpn.sh | 76 ++++++++++++++++++++++++++++++++++++++++
   2 files changed, 96 insertions(+), 1 deletion(-)

[commit a0e5fe32d969c7775da4b16f8ecfa93378f589d4]
Date: 2025-07-22
Score: 5
Status: proposed(include=no,score=30)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: undecided
Subject: if_ovpn tests: basic float test case
Review: Adds a basic test case for the if_ovpn interface floating functionality, which may help users verify the behavior of the OpenVPN interface driver.
Body:

  Reviewed by:	markj
  MFC after:	3 weeks
  Sponsored by:	Rubicon Communications, LLC ("Netgate")
  Differential Revision:	https://reviews.freebsd.org/D51469

  (cherry picked from commit ad1b5df8884c0fd7d265526a4980c1fd9c67fb90)


   tests/sys/net/if_ovpn/if_ovpn.sh | 91 ++++++++++++++++++++++++++++++++++++++++
   1 file changed, 91 insertions(+)

[commit fc387ed68f3c7b0b8da9bab13492b7bbafecb5bf]
Date: 2025-07-22
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Drivers.device
Subject: if_ovpn: support floating clients
Review: The if_ovpn driver now supports floating clients by notifying userspace when a client changes its IP address, allowing OpenVPN connections to persist across IP changes.
Body:

  If a client changes its IP address notify userspace of this.

  The UDP filtering function supplies the remote IP address, so we check if the
  address changed there. If so, we tag the packet with the new address. Once the
  packet is decrypted (and as part of that, has had its signature checked) we
  can commit to the address change. Take the write lock and notify userspace of
  the change.

  Reviewed by:	markj
  MFC after:	3 weeks
  Sponsored by:	Rubicon Communications, LLC ("Netgate")
  Differential Revision:	https://reviews.freebsd.org/D51468

  (cherry picked from commit 9c52600a5a150117b4396df3b868cf2516e1674c)


   sys/net/if_ovpn.c | 193 +++++++++++++++++++++++++++++++++++++++++++++++++++++-
   sys/net/if_ovpn.h |   1 +
   sys/sys/mbuf.h    |   1 +
   3 files changed, 194 insertions(+), 1 deletion(-)

[commit d142a8a4f1ad877e22b37f691066cea7a3fa9e6a]
Date: 2025-07-22
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Drivers.device
Subject: if_ovpn: fill out sin_len/sin6_len
Review: The if_ovpn driver now sets the sin_len and sin6_len fields in sockaddr structures when parsing nvlist data, ensuring proper sockaddr length initialization.
Body:

  When we parse an nvlist sockaddr we should set the sockaddr_in(6)'s length
  field. This isn't currently used by anything yet, but it's reasonable to expect
  a sockaddr to contain its length.

  MFC after:	3 weeks
  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit e83df5367d30761803e09bd7fcf518638dfe43d2)


   sys/net/if_ovpn.c | 2 ++
   1 file changed, 2 insertions(+)

[commit 3d2cda366261dd7fdd10b329a4d042fe839894b5]
Date: 2025-08-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sys/conf: Re-add -Wno-unused to ipfilter build flags
Review: The commit re-adds a compiler flag to suppress unused variable warnings for ipfilter, which is a build system change with no direct user-visible impact.
Body:

  This is still required on stable/14 because of the RCS tags defined at
  the top of each source file.

  This is a direct commit to stable/14.

  Fixes:	0947920999dc ("files: add new IPFILTER_C rule for netpfil/ipfilter sources")


   sys/conf/kern.pre.mk | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 52da74743361aee74de93052346bf1c951def73e]
Date: 2024-10-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc.
Section: undecided
Subject: virtio_p9fs: Simplify vt9p_req_wait() a bit
Review: The commit simplifies internal code without any user-visible functional change.
Body:

  Remove an always-false check for whether the request has already
  completed before sleeping.  Even if the request is complete, the
  response tag is updated while holding the channel lock, which is also
  held here.

  No functional change intended.

  Sponsored by:	Klara, Inc.

  (cherry picked from commit 28c9b13b236d25512cfe4e1902411ff421a14b64)


   sys/dev/virtio/p9fs/virtio_p9fs.c | 26 +++++++++++++-------------
   1 file changed, 13 insertions(+), 13 deletions(-)

[commit bc1696f189b51bf3753ffb7097e03c9777399f84]
Date: 2024-10-25
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: Klara, Inc.
Section: Drivers.device
Subject: virtio_p9fs: Check for completions after enabling interrupts
Review: The virtio_p9fs driver now checks for completions after enabling interrupts to prevent lost interrupts and potential filesystem hangs.
Body:

  Otherwise we can end up with a lost interrupt, causing lost request
  completion wakeups and hangs in the filesystem layer.

  Continue processing until we enable interrupts and then observe an empty
  queue, like other virtio drivers do.

  Sponsored by:	Klara, Inc.

  (cherry picked from commit 1f6f247b3526abd4d5927684735012220aefe373)


   sys/dev/virtio/p9fs/virtio_p9fs.c | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit dfd8306a79b5c37f8480112875f12bc8d054d603]
Date: 2025-07-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Stormshield | Klara, Inc.
Section: Drivers.device
Subject: if_ovpn: Destroy cloned interfaces via a prison removal callback
Review: The if_ovpn driver now destroys cloned interfaces via a prison removal callback, preventing jails from getting stuck in the DYING state after using if_ovpn.
Body:

  A if_ovpn interface carries a reference to a socket, which has a
  credential reference, which holds a reference on the containing prison
  and prevents SYSUNINITs from being invoked.  So, register a
  PR_METHOD_REMOVE callback and destroy the cloner from there instead,
  since that mechanism doesn't require the prison refcount to drop to zero
  first.

  This fixes a bug where jails get left stuck in the DYING state after
  running if_ovpn regression tests.

  Reviewed by:	kp
  MFC after:	2 weeks
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51526

  (cherry picked from commit 96b29c7f0cffd377a757ad8ccc0cdd8fcb96d0dd)


   sys/net/if_ovpn.c | 48 ++++++++++++++++++++++++++++++++++++++++--------
   1 file changed, 40 insertions(+), 8 deletions(-)

[commit 5c37f7d22fa7edd03b6cd012cb73fa6cac0880ad]
Date: 2025-04-21
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.libraries
Subject: wordexp(3): Handle ECHILD from waitpid
Review: The man:wordexp[3] function now handles ECHILD from waitpid(3) when SIGCHLD is ignored or SA_NOCLDWAIT is set, preventing spurious failures in those configurations.
Body:

  If the calling process has used SIG_IGN as handler or set the
  SA_NOCLDWAIT flag for SIGCHLD, processes will be automatically reaped on
  exit and calls to waitpid(3) will therefore fail with ECHILD.

  We waitpid primarily to reap our child so that the caller does not have
  to worry about it. ECHILD indicates that there is no child to reap, so
  we can just treat that as a success and move on.

  Signed-off-by: Kenny Levinsen <kl@kl.wtf>
  Tested by: Jan Beich
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1675
  (cherry picked from commit da9e73e5d483c47e67b3094356dd4b640749849e)


   lib/libc/gen/wordexp.c            | 10 +++++++++-
   lib/libc/tests/gen/wordexp_test.c | 26 ++++++++++++++++++++++++++
   2 files changed, 35 insertions(+), 1 deletion(-)

[commit 3cbb5a96bd81b5b5d59f6a0a39a2a0f447357deb]
Date: 2025-07-28
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: jail: Make prison_owns_vnet() operate on a prison instead of a ucred
Review: No functional change intended; internal refactoring only.
Body:

  This will be useful in an upcoming change.  No functional change
  intended.

  Reviewed by:	jamie
  MFC after:	2 weeks
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51524

  (cherry picked from commit 748a4ea1caffca48c4949d5a7b964853c44fbdae)


   sys/kern/kern_jail.c   | 17 +++++++----------
   sys/kern/kern_sysctl.c |  2 +-
   sys/sys/jail.h         |  2 +-
   3 files changed, 9 insertions(+), 12 deletions(-)

[commit 0188e350666dbbd68e4d4b4f2f900309a4c230bc]
Date: 2025-08-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: p9fs: Set vnode state in p9fs_vget_common()
Review: The commit fixes an internal vnode state transition that only triggers under DEBUG_VFS_LOCKS, which is not a user-visible change.
Body:

  Once a new vnode is visible from the mountpoint hash, we should set its
  state from VSTATE_UNINITIALIZED to VSTATE_CONSTRUCTED.  I do not think
  this affects correctness at all, but the bug trips a check in
  vop_unlock_debugpost(), previously hidden under options DEBUG_VFS_LOCKS.

  Reviewed by:	kib
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51720

  (cherry picked from commit e2ac6de6e4edc1c6e7bfdfb0ec8fcf62f46d503f)


   sys/fs/p9fs/p9fs_vfsops.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4d84cefbba2cad514d581d5dfaac7a2ac3ce2912]
Date: 2025-07-25
Score: 5
Status: proposed(include=no,score=35)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: udp: Fix a inpcb refcount leak in the tunnel receive path
Review: The commit fixes a reference count leak in the UDP tunnel receive path that could affect the if_ovpn driver.
Body:

  When the socket has a tunneling function attached, udp_append() drops
  the inpcb lock before calling it.  To keep the inpcb alive, we bump the
  refcount.  After commit 742e7210d00b we only dropped the reference if
  the tunnel consumed the packet, but it needs to be dropped in either
  case.  if_ovpn is the only driver that can trigger this bug.

  Fixes:		742e7210d00b ("udp: allow udp_tun_func_t() to indicate it did not eat the packet")
  Reviewed by:	kp
  MFC after:	2 weeks
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51505

  (cherry picked from commit e1751ef896119d7372035b1b60f18a6342bd0e3b)


   sys/netinet/udp_usrreq.c   | 11 ++++++++---
   sys/netinet6/udp6_usrreq.c | 11 ++++++++---
   2 files changed, 16 insertions(+), 6 deletions(-)

[commit a6059a556654c033619c2a4d0f95c9ac3c92a532]
Date: 2025-08-01
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Drivers.device
Subject: qat: Revert changes to BAR indices
Review: The commit reverts a change to BAR indices in the QAT driver that broke the C3000 driver. This restores hardware compatibility for affected systems.
Body:

  It is not clear how commit ded037e65e52 could reasonably change BAR
  indices, and doing so broke at least the C3000 driver.  Revert that part
  of the change.

  Reported by:	kp
  Reviewed by:	kp, Haresh Sankar Raj <hareshx.sankar.raj@intel.com>
  MFC after:	3 days
  Fixes:		ded037e65e52 ("qat: driver updates to improve code and fix bugs")
  Differential Revision:	https://reviews.freebsd.org/D51664

  (cherry picked from commit 4a8e62a1209f7d7529817c4c27b91fb97750b7b2)


   sys/dev/qat/qat_hw/qat_200xx/adf_200xx_hw_data.h | 4 ++--
   sys/dev/qat/qat_hw/qat_c3xxx/adf_c3xxx_hw_data.h | 4 ++--
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit 9280aa57a5d262f011030a042aabec97f2de3bf6]
Date: 2025-07-07
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Stormshield | Klara, Inc.
Section: Kernel.general
Subject: random: Change the entropy harvest event queuing scheme
Review: The entropy harvest event queuing scheme is changed to use a double-buffering approach to avoid potential race conditions on platforms without total store ordering. This ensures that entropy from environmental sources is reliably mixed into the CSPRNG's entropy pools.
Body:

  The entropy queue stores entropy gathered from environmental sources.
  Periodically (every 100ms currently), the random kthread will drain this
  queue and mix it into the CSPRNG's entropy pool(s).

  The old scheme uses a ring buffer with a mutex to serialize producers,
  while the sole consumer, the random kthread, avoids using a mutex on the
  basis that no serialization is needed since nothing else is updating the
  consumer index.  On platforms without total store ordering, however,
  this isn't sufficient: when a producer inserts a queue entry and updates
  `ring.in`, there is no guarantee that the consumer will see the updated
  queue entry upon observing the updated producer index.  That is, the
  update to `ring.in` may be visible before the updated queue entry is
  visible.  As a result, we could end up mixing in zero'ed queue entries,
  though this race is fairly unlikely in practice given how infrequently
  the kthread runs.

  The easiest way to fix this is to make the kthread acquire the mutex as
  well, and hold it while processing queue entries.  However, this might
  result in a long hold time if there are many queue entries, and we
  really want the hold times to be short, e.g., to avoid delaying
  interrupt processing.

  We could introduce a proper MPSC queue, but this is probably
  overcomplicated for a consumer which runs at 10Hz.

  Instead, define two buffers, always with one designated as the "active"
  buffer.  Producers queue entries in the active buffer, and the kthread
  uses the mutex to atomically flip the two buffers, so it can process
  entries from the inactive buffer without holding the mutex.  This
  requires more memory, but keeps mutex hold times short and lets us keep
  the queue implementation very simple.

  Reviewed by:	cem
  MFC after:	1 month
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51112

  (cherry picked from commit 9940c974029ba53fc00696b3fa1784725c48a9e9)


   sys/dev/random/random_harvestq.c | 103 +++++++++++++++++----------------------
   1 file changed, 46 insertions(+), 57 deletions(-)

[commit 85f964f75eea1f67fe2ae661014770c22adf41fd]
Date: 2025-07-23
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: smbfs: Set eofflag in VOP_READDIR
Review: The smbfs filesystem now correctly sets the end-of-directory flag in VOP_READDIR operations, ensuring proper directory listing termination.
Body:

  MFC after:	2 weeks

  (cherry picked from commit 619308b6fe26f56fc71c6255b13fcd9a6b8ae1f1)


   sys/fs/smbfs/smbfs_io.c    | 20 +++++++++++++-------
   sys/fs/smbfs/smbfs_node.h  |  2 +-
   sys/fs/smbfs/smbfs_vnops.c |  6 ++----
   3 files changed, 16 insertions(+), 12 deletions(-)

[commit bb3fd5897add9f407f30e288d5d52082953aa1e9]
Date: 2025-08-03
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: service: Add an option to enable debugging
Review: The man:service[8] utility gains a -d option to enable debugging of rc scripts, and the documentation is updated to reflect this and other options.
Body:

  * Add and document a -d option which enables rc script debugging.
  * Sort and document existing options correctly.

  MFC after:	1 week
  Reviewed by:	imp, emaste
  Differential Revision:	https://reviews.freebsd.org/D51700

  (cherry picked from commit 25fca243f2b7ca0c523aa1cf26aaea25035e68d2)


   usr.sbin/service/service.8  | 13 ++++++++-----
   usr.sbin/service/service.sh | 19 +++++++++++++------
   2 files changed, 21 insertions(+), 11 deletions(-)

[commit 68669e92f5d2b883c0e2efaceaa1acc74424cd7b]
Date: 2025-05-25
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: Add quiet/-q option to /usr/sbin/service
Review: The man:service[8] utility gains a -q option to suppress output, allowing quiet operation in scripts.
Body:

  Signed-off-by: Dan Mahoney <freebsd@gushi.org>
  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1709
  Closes: https://github.com/freebsd/freebsd-src/pull/1709
  (cherry picked from commit 37983aef7c70b738cf63923bcfd2c4ae03ac5779)

  service: Fix repeated -v in man page

  Fix accidental repeated -v for -q.

  Fixes: 37983aef7c70
  Noticed by: Gary Jennejohn

  (cherry picked from commit 8fa4a4eb705ccaece5aac4ae1201034001f21313)


   usr.sbin/service/service.8  |  3 +++
   usr.sbin/service/service.sh | 23 +++++++++++++++++++----
   2 files changed, 22 insertions(+), 4 deletions(-)

[commit aa326b970e36d063abc653071ca5fccdf83e5554]
Date: 2025-08-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: vm_page: Fix handling of empty bad memory addresses file
Review: The commit fixes a kernel bug where an empty bad memory addresses file could cause incorrect pointer handling, preventing potential crashes or undefined behavior when the file is empty.
Body:

  If a file with bad memory addresses is configured but that file is
  empty (0 lines, 0 bytes), when loading it we end up returning an end
  pointer that is just _before_ the start of the (empty) file content.

  Adjust the code to make it clear what pre-condition are required to set
  the *list / *end pointers correctly, and explicitly set them to NULL
  when they are not matched.

  Reported by:	marklmi@yahoo.com
  Reviewed by:	kib
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51717

  (cherry picked from commit f90940ce6eb71df40538c35a65d77ad3093c679a)


   sys/vm/vm_page.c | 10 +++++++---
   1 file changed, 7 insertions(+), 3 deletions(-)

[commit d88f8a306cfe7ba0a629108102ed2be0b090a876]
Date: 2025-07-19
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: pmap_demote_{l2,pde}: never invalidate wired mappings
Review: The pmap demotion logic now avoids invalidating wired superpage mappings, preventing potential page faults that could sleep. This change ensures that wired mappings remain valid and do not cause unexpected behavior during demotion.
Body:

  Rather than demoting a superpage mapping that hasn't been accessed, we
  ordinarily invalidate it.  However, if the mapping is wired,
  invalidation is problematic because the page fault to reinstantiate the
  mapping could sleep.  Instead, demote the wired mapping with the
  accessed flag cleared in the PTEs.

  (cherry picked from commit 7502c1f270827434bb9661cbb4b9652fdb836521)


   sys/amd64/amd64/pmap.c | 21 +++++++++++----------
   sys/arm64/arm64/pmap.c | 24 +++++++++++++-----------
   2 files changed, 24 insertions(+), 21 deletions(-)

[commit f406b54c806a3348ef4d4aab5e7290ce74ba9d71]
Date: 2025-07-16
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: pmap_enter_{l2,pde}: correct the handling of an error case
Review: The commit fixes an internal kernel page table management error case that does not have a direct user-visible impact.
Body:

  When pmap_enter_object()'s call to pmap_enter_{l2,pde}() fails to create
  a managed mapping within the kernel address space due to the inability
  to allocate a PV entry, it needs to remove the kernel page table page
  from the pmap's trie of idle page table pages.  Previously, it did not.

  (cherry picked from commit 5a846c48f209d04dad36aa35a9968f557c4516f7)


   sys/amd64/amd64/pmap.c | 11 +++++++++++
   sys/arm64/arm64/pmap.c | 12 ++++++++++++
   2 files changed, 23 insertions(+)

[commit c0e04a22331ebab8e639d69a0da7de71dd4119c3]
Date: 2025-07-08
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: arm64 pmap: do not panic when unable to insert PTP into trie
Review: The arm64 pmap no longer panics when unable to insert a page table page into the trie during superpage destruction, improving system stability.
Body:

  When pmap_enter_l2() needs to destroy an existing kernel superpage
  mapping, do not remove the saved page table page (PTP) from the pm_root
  trie and remap it into the page table.  Instead, simply zero it.  Then,
  later the PTP does not need to be unmapped and reinserted into the trie.

  If the kernel region is not mapped by a superpage, then try to insert
  the PTP into the pm_root trie before clearing the PTEs.  If the PTP
  insertion fails, then we can return failure with the old mappings still
  in place.

  Convert an assertion from a panic to a KASSERT.

  (cherry picked from commit 2cfd6342ac84c6915106fbe141795ca23a96cbba)


   sys/arm64/arm64/pmap.c | 84 ++++++++++++++++++++++++++++++++------------------
   1 file changed, 54 insertions(+), 30 deletions(-)

[commit 3922d7f6277847dd0d0337a802fa4437e8d2ff60]
Date: 2025-04-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ip_htable: fix -Wtautological-pointer-compare warnings
Review: Fixes compiler warnings in ip_htable.c with no user-visible impact.
Body:

  This also fixes a few other trivial -Wunused-but-set-variable warnings.

  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1677
  MFC after:	1 month

  (cherry picked from commit e4c864e5550544e5ff7e395309c5098d84058403)


   sys/netpfil/ipfilter/netinet/ip_htable.c | 5 +----
   1 file changed, 1 insertion(+), 4 deletions(-)

[commit 18a405b1ac7fd681377bc9db27bb199b0b2a9133]
Date: 2025-04-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ip_nat.c: fix non-trivial unused variable warnings
Review: The commit fixes compiler warnings by removing unused variables, which has no direct user-visible impact.
Body:

  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1677
  MFC after:	1 month

  (cherry picked from commit 2bae5cad793bd67c071ade7c7a8ae9d4b34e6b6c)


   sys/netpfil/ipfilter/netinet/ip_nat.c | 43 +++++++++++------------------------
   1 file changed, 13 insertions(+), 30 deletions(-)

[commit 0947920999dcf405faa7554c8b0bc9d2bc4e5c0a]
Date: 2025-04-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: files: add new IPFILTER_C rule for netpfil/ipfilter sources
Review: The commit re-enables compiler warnings for netpfil/ipfilter sources, which may affect build-time diagnostics but does not introduce user-visible changes in behavior, features, or configuration.
Body:

  This re-enables all compiler warnings for these sources.

  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1677
  MFC after:	1 month

  (cherry picked from commit 45730dd3ed334d265fc77cf6df1f82013fd5bf69)


   sys/conf/files       | 54 ++++++++++++++++++----------------------------------
   sys/conf/kern.pre.mk |  4 ++++
   2 files changed, 22 insertions(+), 36 deletions(-)

[commit 1203f96d41ff697bf05038786b75fdb3d96cc593]
Date: 2025-04-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: netpfil/ipfilter: fix remaining trivial unused variable warnings
Review: The commit fixes unused variable warnings in the ipfilter subsystem, which is an internal code cleanup with no user-visible impact.
Body:

  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1677
  MFC after:	1 month

  (cherry picked from commit 79d23845179a534f533185763cb92032202729a7)


   sys/netpfil/ipfilter/netinet/fil.c            | 16 +++++-----------
   sys/netpfil/ipfilter/netinet/ip_ftp_pxy.c     |  8 ++++----
   sys/netpfil/ipfilter/netinet/ip_ipsec_pxy.c   |  4 +---
   sys/netpfil/ipfilter/netinet/ip_irc_pxy.c     |  7 ++-----
   sys/netpfil/ipfilter/netinet/ip_lookup.c      |  4 +---
   sys/netpfil/ipfilter/netinet/ip_netbios_pxy.c |  5 +----
   sys/netpfil/ipfilter/netinet/ip_pptp_pxy.c    |  5 -----
   sys/netpfil/ipfilter/netinet/ip_proxy.c       |  4 +---
   sys/netpfil/ipfilter/netinet/ip_raudio_pxy.c  |  8 ++------
   sys/netpfil/ipfilter/netinet/ip_rcmd_pxy.c    |  8 +-------
   sys/netpfil/ipfilter/netinet/ip_rpcb_pxy.c    |  8 ++------
   sys/netpfil/ipfilter/netinet/ip_state.c       | 22 ++--------------------
   sys/netpfil/ipfilter/netinet/ip_tftp_pxy.c    |  4 +---
   sys/netpfil/ipfilter/netinet/ipf_rb.h         |  2 --
   14 files changed, 23 insertions(+), 82 deletions(-)

[commit 21ef66f326d356db9992de218f718298e4d71990]
Date: 2025-04-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ip_nat6.c: fix non-trivial unused variable warnings
Review: Internal code cleanup to fix compiler warnings; no user-visible impact.
Body:

  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1677
  MFC after:	1 month

  (cherry picked from commit 2bbaeb717b690f796e751be63a656fb097ef786d)


   sys/netpfil/ipfilter/netinet/ip_nat6.c | 52 +++++++++-------------------------
   1 file changed, 14 insertions(+), 38 deletions(-)

[commit 389e57881be84106e3036ef1b205a17826fb33dc]
Date: 2025-07-07
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.contrib
Subject: ipfilter: End (cleanup) the iterative search key
Review: The ipfilter hash table listing may miss nodes in subsequent listings due to an uninitialized search key, potentially affecting man:ipf[8] and man:ipfstat[8] output.
Body:

  This results in not finding nodes in subsequent hash table listings.

  MFC after:	3 days

  (cherry picked from commit ac2e39b5ddf5d5c6bc3848e392670a00e5834450)


   sbin/ipf/libipf/printhash_live.c | 3 +++
   1 file changed, 3 insertions(+)

[commit bad971197256729a12c067f1e1f5f7e73dd6098e]
Date: 2025-07-07
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Network.general
Subject: Revert "ipfilter: Avoid allocating a new ipf token when not needed"
Review: The ipfilter token allocation behavior is reverted to reduce lock contention, potentially improving performance under high network load.
Body:

  malloc() outside of a write lock will reduce potential contention.

  MFC after:	3 days

  This reverts commit 7f5e3b9fa3d159b7f061b4d01a767cbe5d0527f3.

  (cherry picked from commit cf9b6857545371ab5becc6a785c62bc844cb2f94)


   sys/netpfil/ipfilter/netinet/fil.c | 13 +++++++++----
   1 file changed, 9 insertions(+), 4 deletions(-)

[commit 35ce5a0f6d3fdca121e6e891e060b5af09a1b8fc]
Date: 2025-08-03
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Juniper Networks, Inc.
Section: Kernel.general
Subject: amd64/pmap: include opt_kstack_pages.h
Review: The commit fixes an early KASAN initialization panic that occurs when a non-default KSTACK_PAGES value is used in the kernel configuration. This prevents kernel panics during early boot for users with custom kernel configurations.
Body:

  This fixes an early KASAN initialization panic in
  pmap_san_enter_early_alloc_4k, when a non-default value is specified for
  KSTACK_PAGES in the build config file.

  Sponsored by:	Juniper Networks, Inc.
  MFC after:	7 days
  Reviewed by:	des, markj
  Differential Revision:	https://reviews.freebsd.org/D51709

  (cherry picked from commit ecf65a4ae5cb9f18ebdc5fd9a40332f443e04959)


   sys/amd64/amd64/pmap.c | 1 +
   1 file changed, 1 insertion(+)

[commit b84a0aa00881ee6ded6e9693db1be6d6dd8b8e52]
Date: 2025-07-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: amd64 pmap: simplify recent changes to pmap_enter_pde()
Review: The commit refines internal pmap handling for kernel address space mappings, but does not introduce user-visible changes in behavior, features, or configuration.
Body:

  When pmap_enter_pde() removes an existing 2MB page mapping within the
  kernel address space, do not remap the kernel page table page since it
  will shortly be unmapped.  Simply zero it.

  Eliminate an unnecessary conditional refcount decrement on what must be
  a kernel page table page.  (We only utilize this refcount on user-space
  page table pages.)

  Convert an assertion from a panic to a KASSERT.

  (cherry picked from commit b87aa791533fd3fc8096faa837264761ed7f4a8c)


   sys/amd64/amd64/pmap.c | 38 +++++++++++++++++++-------------------
   1 file changed, 19 insertions(+), 19 deletions(-)

[commit 9810fb151938b8ceb2e8774b85f1530f41c8241c]
Date: 2025-07-06
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: amd64 pmap: convert panics to KASSERTs
Review: The commit changes internal kernel panic handling to assertions, which does not affect user-visible behavior or configuration.
Body:

  With the recent changes to pmap_demote_DMAP(), the calls to
  pmap_demote_pdpe() and pmap_demote_pde_mpte() should never fail, so
  we change the associated panics to KASSERTs.

  (cherry picked from commit 6a7761b4d27c99b3b548f2d948b88bf1430ee636)


   sys/amd64/amd64/pmap.c | 12 ++++++------
   1 file changed, 6 insertions(+), 6 deletions(-)

[commit 702224d7e0824094fa3f33f7fdc5a34be626d774]
Date: 2025-06-30
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: amd64 pmap: preallocate another page table page in pmap_demote_DMAP()
Review: The amd64 pmap now preallocates a page table page in pmap_demote_DMAP() to prevent a possible kernel panic during demotion operations.
Body:

  To avoid a possible panic in pmap_demote_DMAP(), preallocate the page
  table page that may be needed by pmap_demote_pde() before acquiring the
  kernel pmap lock, so that we can wait until the allocation succeeds.

  (cherry picked from commit 88c8cba0439599c00d9d3d586a66a035004e6e84)


   sys/amd64/amd64/pmap.c | 113 +++++++++++++++++++++++++++++++++----------------
   1 file changed, 77 insertions(+), 36 deletions(-)

[commit 25a559444bd4a830063ac8ea353e00ad42ecf0ab]
Date: 2025-07-26
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: sys/geom: use proper style for sizeof operator
Review: No functional change; style-only fix.
Body:

  No functional change is intended.

  Missing parentheses around sizeof operands have been added with
  a coccinnele patch:
    @disable paren@
    expression E;
    @@
    (
    sizeof(E)
    |
    sizeof
    +(
    E
    +)
    )

  Spaces between sizeof and a parenthesis have been removed with sed.

  Discussed with:	imp

  (cherry picked from commit 150834f8fa57c1ee42e4dd5a42e7faf08ec5b2e5)


   sys/geom/geom.h                  |  2 +-
   sys/geom/geom_ccd.c              | 10 +++++-----
   sys/geom/geom_event.c            |  2 +-
   sys/geom/geom_io.c               |  2 +-
   sys/geom/geom_slice.c            |  6 +++---
   sys/geom/geom_subr.c             | 18 +++++++++---------
   sys/geom/multipath/g_multipath.c | 10 +++++-----
   sys/geom/virstor/g_virstor.c     | 28 ++++++++++++++--------------
   8 files changed, 39 insertions(+), 39 deletions(-)

[commit 927c3d7093177a9c1f38cf11f59d17a5b41720e8]
Date: 2025-08-02
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Klara, Inc.
Section: Userland.contrib
Subject: kyua: Stop using readdir_r()
Review: Kyua no longer uses the deprecated and unsafe readdir_r() function, which may affect compatibility on systems where readdir_r is not available or behaves differently.
Body:

  It cannot be used safely, and Kyua doesn't even pretend to try.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	igoro
  Differential Revision:	https://reviews.freebsd.org/D51680

  (cherry picked from commit 65bae451c23b8d61b2433259d8e707250660eeff)


   contrib/kyua/utils/fs/directory.cpp | 18 ++++++------------
   1 file changed, 6 insertions(+), 12 deletions(-)

[commit 9ddbef8a3a827dfa5a0c332838e1fc8e384c4d92]
Date: 2025-08-02
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Klara, Inc.
Section: Userland.libraries
Subject: libarchive: Stop using readdir_r()
Review: libarchive no longer uses the deprecated and unsafe readdir_r() function, which may affect compatibility with older systems or environments that rely on this behavior.
Body:

  It cannot be used safely, though libarchive goes to ridiculous lengths
  to attempt to do so.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D51679

  (cherry picked from commit 01e42ce81f751ccbeeddc4bc2716e6bd634cf5f8)


   lib/libarchive/config_freebsd.h | 1 -
   1 file changed, 1 deletion(-)

[commit f2805cf36d3928d34afc54b54397ec04c502032f]
Date: 2025-08-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Klara, Inc.
Section: undecided
Subject: bsnmpd: Fix an error message
Review: Fixes an error message in bsnmpd.
Body:

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D51678

  (cherry picked from commit bf304a40cde836435a55e938865fc12ce81cf0fe)


   usr.sbin/bsnmpd/modules/snmp_hostres/hostres_swinstalled_tbl.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 592f2e599f242826a68a08186f2e65e29c2eb887]
Date: 2025-08-01
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Storage.general
Subject: devfs readdir: handle short buffer same as UFS
Review: The devfs readdir implementation now handles short buffers similarly to UFS, which may affect programs that read directory entries with limited buffer sizes.
Body:

  (cherry picked from commit 011efaa5cd246a67bbe6e37364baa18178a9f7bd)


   sys/fs/devfs/devfs_vnops.c | 9 ++++++++-
   1 file changed, 8 insertions(+), 1 deletion(-)

[commit 627831eba3deb2644edc2b92c4ce8365321b8930]
Date: 2025-07-31
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: netlink: Fully clear parser state between messages
Review: The netlink parser state is now fully cleared between messages, preventing a potential underflow in length calculation that could lead to memory corruption.
Body:

  Failing to reset the cookie between messages can lead to an attempt
  to interpret a zeroed buffer as a struct nlattr, causing a length
  calculation to underflow, resulting in a memcpy() call where the
  length exceeds the actual size of the buffer.

  MFC after:	1 week
  PR:		283797
  Reviewed by:	glebius
  Differential Revision:	https://reviews.freebsd.org/D51634

  (cherry picked from commit a8d90e32133b77a49c2551f22e59f72d65293b64)


   sys/netlink/netlink_io.c | 1 +
   1 file changed, 1 insertion(+)

[commit 48bd13dbf90022b0266d419d465160ffb01b8040]
Date: 2025-06-24
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Drivers.device
Subject: cam_fill_mmcio: initialize cmd.error sub-field
Review: The commit initializes a sub-field in the CAM/MMC stack to prevent incorrect timing settings and communication failures with eMMC storage on platforms like Rock64 using the dwmmc driver.
Body:

  For me, this fixes a problem with using eMMC storage in MMCCAM
  configuration with dwmmc driver (on Rock64).
  The problem appeared after commit 07da3bb5d56c85 "mmc: support for SPI
  bus type".

  The problem was caused by the said commit changing the layout of struct
  mmc_ios which is embedded into struct ccb_trans_settings_mmc with the
  latter being embedded into struct ccb_trans_settings, a member of
  union ccb.

  The layout mattered for two reasons:
  1. dwmmc sets cmd.error only in case of an error;
  2. mmc_da's sdda_start_init uses the same ccb for different transaction
     types without explicitly clearing the object between transactions.

  As a result, cmd.error could start out with a non-zero value and dwmmc
  would keep that value which would then be interpreted as a failure.
  Such a failure happened in mmc_set_timing resulting in incorrect timing
  settings and subsequent complete failure to communicate with the eMMC
  module.

  Reviewed by:	pkelsey

  (cherry picked from commit 10db2ad8614adc544292856c693503ca8e9c9fd9)


   sys/cam/cam_ccb.h | 1 +
   1 file changed, 1 insertion(+)

[commit d4d7b768bb8e6d1915f9bbb5ba1d2fc705ce1ec2]
Date: 2025-07-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: mmc_da: garbage-collect sdda_get_max_data
Review: Removes an unused internal function with no user-visible impact.
Body:

  The function is unused since 5aedb8b1d4a6.

  For information, in MMC CAM both XPT_GET_TRAN_SETTINGS and XPT_PATH_INQ
  obtain data using MMC_SIM_GET_TRAN_SETTINGS.  So, "overlapping"
  information like ccb_trans_settings_mmc::host_max_data and
  ccb_pathinq::maxio is derived from the same source.
  That's why sdda_get_max_data was redundant.

  Reported by:	bz

  (cherry picked from commit ad0c3859a9184036484c0cd63d7260a4a3d1ad2d)


   sys/cam/mmc/mmc_da.c | 21 ---------------------
   1 file changed, 21 deletions(-)

[commit 9d5d9e723c4a73a3d816a5d2b0a1b7956d1cb87e]
Date: 2025-06-24
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: mmc_da: fix garbage in disk->d_attachment
Review: The mmc_da driver no longer reports garbage in disk attachment information, fixing potential issues with SD/MMC storage devices.
Body:

  The garbage resulted from reading the value from a ccb which was
  originally populated by XPT_PATH_INQ operation but then overwritten by
  XPT_GET_TRAN_SETTINGS operation.

  The problem could probably be fixed by re-ordering the
  XPT_GET_TRAN_SETTINGS operation, but it seems like the operation was
  redundant.  Besides, the ccb is declared not as union ccb but as struct
  ccb_pathinq, so using it for XPT_GET_TRAN_SETTINGS was questionable.

  I opted for replacing a call to sdda_get_max_data (which uses
  XPT_GET_TRAN_SETTINGS internally) with using maxio provided by the
  XPT_PATH_INQ operation.

  This also required fixing mmc_cam_sim_default_action as controllers
  return maximum I/O size in sectors, but maxio value should be in bytes.

  (cherry picked from commit 5aedb8b1d4a6c099eaa0a65f8fcbdcc4aba8f75b)


   sys/cam/mmc/mmc_da.c  | 4 +---
   sys/cam/mmc/mmc_sim.c | 2 +-
   2 files changed, 2 insertions(+), 4 deletions(-)

[commit b91babab95965209bae8388c1004d8c42fdc0547]
Date: 2025-06-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: mmc_xpt: use strlcpy instead of strncpy
Review: The commit replaces strncpy with strlcpy in the mmc_xpt driver, which improves safety but does not introduce any user-visible functionality change, new feature, or configuration impact.
Body:

  A better practice in general.

  (cherry picked from commit ad8d33679999c0e7f6fd2b77d2e414102bd365ec)


   sys/cam/mmc/mmc_xpt.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit ab8d88442fbbea9d6d57bb0359943514187c34cd]
Date: 2025-06-24
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Drivers.device
Subject: rk3328_codec: add trivial set_sysclk method implementation
Review: The commit adds a trivial set_sysclk method to the RK3328 audio codec driver to suppress a repeated error message about setting the system clock, which previously appeared only during boot but now occurs regularly during use.
Body:

  The method does not change any settings, just returns success.

  This is to silence "pcm0: failed to set sysclk for codec node" message
  printed in audio_soc code.
  Previously, that message was printed only during boot which was tolerable.
  Recently something changed either in the sound infrastructure or in sound
  applications that I use and the message started to be printed regularly.

  (cherry picked from commit 99f436aec00ece1f56132a1fee972fc797bb1b42)


   sys/arm64/rockchip/rk3328_codec.c | 7 +++++++
   1 file changed, 7 insertions(+)

[commit 775224f7e4123378b06c28f1adcb4d30a0717a92]
Date: 2024-06-27
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: rk_i2c: use the register read mode even if the read ends with IIC_M_NOSTOP
Review: The rk_i2c driver now uses register read mode for reads ending with IIC_M_NOSTOP, improving compatibility with sensors like max44009(4).
Body:

  Tested with max44009(4).

  MFC after:	2 weeks

  (cherry picked from commit a743e280ea0541163afa7d1c320504925a02f80b)


   sys/arm64/rockchip/rk_i2c.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 640979856fc8d9c2abf1dd78d68f016d265abc5c]
Date: 2024-06-27
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: rk_i2c: emulate repeated start
Review: The rk_i2c driver now properly emulates repeated start conditions for I2C reads with the IIC_M_NOSTOP flag, improving compatibility with I2C devices like max44009(4).
Body:

  rk_i2c_send_stop is modified so that it sends a stop condition, like it
  always did, if there is no IIC_M_NOSTOP flag.
  But if the flag is set then the function completely resets the control
  register and sets the driver state to transfer completed.
  Something like this was previously done for a write with IIC_M_NOSTOP.
  Now it is done for a read with IIC_M_NOSTOP as well.

  Linux code says that the hardware does not support the repeated start
  condition and the documentation, indeed, does not mention it.
  But according to the Linux driver clearing the control register and then
  sending a start condition acts as if it were a repeated start.

  While here, add braces around a single-line 'if' branch to balance it
  with a multi-line 'else' branch.

  Tested with max44009(4).

  MFC after:	2 weeks

  (cherry picked from commit 0deaf4be346f7f343bd2cf771bbf5d172d1c0d2a)


   sys/arm64/rockchip/rk_i2c.c | 34 ++++++++++++++++++++++------------
   1 file changed, 22 insertions(+), 12 deletions(-)

[commit 231985152cf71d57bd19a518138cbd6da13f4ac4]
Date: 2025-07-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ufs: change isrmdir type to bool or u_int as appropriate
Review: The commit changes internal type definitions for the isrmdir variable in UFS code, which is an implementation detail without user-visible impact.
Body:

  (cherry picked from commit 6f4de208eddec8556da1beba6e732f8abbbd8d8e)


   sys/ufs/ffs/ffs_softdep.c | 20 ++++++++++----------
   sys/ufs/ufs/ufs_extern.h  |  8 ++++----
   sys/ufs/ufs/ufs_lookup.c  |  7 ++++---
   sys/ufs/ufs/ufs_vnops.c   |  8 ++++----
   4 files changed, 22 insertions(+), 21 deletions(-)

[commit 94069737c0282ecd3a6d8ba3df12e919e8bef7a8]
Date: 2025-07-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ufs: Pass the new parent inode number to ufs_dirrewrite()
Review: The ufs_dirrewrite() function now receives the new parent inode number, which is an internal change to support directory operations. This change does not introduce any user-visible behavior, feature, or configuration impact.
Body:

  (cherry picked from commit 2bc355c0182a889acc97a09e1272f7d7593949af)


   sys/ufs/ufs/ufs_vnops.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit f8073b224a14d1e2ae61408667818e401cced1b0]
Date: 2025-07-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ufs: restore conditional
Review: The commit restores a conditional in the UFS filesystem code, which may affect filesystem behavior or stability, but the commit message does not specify any user-visible impact, making it unclear if it should be included.
Body:

  (cherry picked from commit 98eb6f0eaa50d8bd9a6794f0a9da2eddeae5bcd8)


   sys/ufs/ufs/ufs_vnops.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit c330e962240311aefde305b4644abf9fc627f511]
Date: 2025-07-27
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Storage.general
Subject: ufs_vnops.c: newparent is not bool
Review: The commit fixes a type mismatch in the UFS filesystem code, which may affect filesystem behavior and stability.
Body:

  (cherry picked from commit 610319c766e941de96e52f2d28fea9f8cfc51aeb)


   sys/ufs/ufs/ufs_vnops.c | 15 +++++++--------
   1 file changed, 7 insertions(+), 8 deletions(-)

[commit 1f8b830f46bac0bc41273916d2f624ea75ed32f7]
Date: 2025-07-27
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Storage.general
Subject: ufs_vnops.c: use unsigned type for newparent inode number in ufs_rename()
Review: The commit fixes a potential overflow issue in the UFS rename operation by changing the type of a variable to unsigned. This prevents incorrect behavior when handling large inode numbers.
Body:

  (cherry picked from commit c069ca085bd185eda4a90dc4bc2b76cceb74579d)


   sys/ufs/ufs/ufs_vnops.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit d05b81a8edd461db0d40920f7c35a69da2dd7a65]
Date: 2025-07-25
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: if_ovpn tests: Exercise the multihome option
Review: Test coverage for the multihome option in if_ovpn is expanded, but this change does not introduce user-visible functionality or configuration changes.
Body:

  These test cases are variants of the 4in4 and 6in6 tests wherein the
  server interface has an alias assigned and the client is configured to
  connect to the alias rather than the primary address.

  Reviewed by:	kp
  MFC after:	1 month
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51499

  (cherry picked from commit 0bfcfb3cb1cbfa383cbd24eff39d39f143eb63ba)


   tests/sys/net/if_ovpn/if_ovpn.sh | 172 +++++++++++++++++++++++++++++++++++++++
   1 file changed, 172 insertions(+)

[commit 818c85bee2c0f2f9c876df7301859903abd49520]
Date: 2025-07-25
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: Stormshield | Klara, Inc.
Section: Drivers.device
Subject: if_ovpn: Support multihomed server configurations
Review: The man:if_ovpn[4] driver now supports multihomed server configurations in UDP mode, allowing proper handling of connections when the WAN interface has multiple addresses.
Body:

  In UDP server mode, openvpn implements the "multihome" option, which
  makes it avoid binding to an address.  Instead, the server socket is
  bound to INADDR_ANY.

  Today, when configuring a new peer and setting the source address,
  sockaddr() returns the wildcard address, so the source address is
  implicitly determined by the output interface.  This doesn't work as one
  would want if the WAN interface has multiple addresses and clients
  connect to non-primary addresses.

  Make multihome mode work properly: use the local address supplied by
  openvpn in preference to that of the socket.  We still fetch the port
  number out of the socket.

  PR:		273664
  Reviewed by:	kp
  MFC after:	1 month
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51498

  (cherry picked from commit 05b5d56c540335ed17acf843810901338bf862d5)


   sys/net/if_ovpn.c | 52 ++++++++++++++++++++++++++++++++++++++++++++++------
   1 file changed, 46 insertions(+), 6 deletions(-)

[commit 6bd8a7393f28074dea80d452584b992c6302026a]
Date: 2025-07-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: if_ovpn: Assert that udp_set_kernel_tunneling() succeeds
Review: The commit adds an assertion for a kernel tunneling function but does not introduce any user-visible changes, new features, or configuration impacts.
Body:

  We do this elsewhere, so copy the pattern here.

  Reviewed by:	kp
  MFC after:	2 weeks
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51496

  (cherry picked from commit a7dfc570f2747668b2fdd8fde6e1954fcedb2378)


   sys/net/if_ovpn.c | 1 +
   1 file changed, 1 insertion(+)

[commit 9fd5e22f426e77991971a907d442fbeb573441ab]
Date: 2025-07-25
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Stormshield | Klara, Inc.
Section: Drivers.device
Subject: if_ovpn: Destroy the datapath lock when destroying a clone
Review: The commit fixes a missing lock destruction in the OpenVPN interface driver, which could lead to resource leaks when interfaces are cloned and destroyed.
Body:

  Reviewed by:	kp
  MFC after:	2 weeks
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51495

  (cherry picked from commit 9bc6980bdf57432ee8519a3707423f410c5ec639)


   sys/net/if_ovpn.c | 1 +
   1 file changed, 1 insertion(+)

[commit 0a7db9f4f673a5c256e8d968935e4db5b9e6ff57]
Date: 2025-07-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: if_ovpn: Sprinkle const over some helper functions
Review: No functional change; only adds const qualifiers to internal helper functions.
Body:

  No functional change intended.

  Reviewed by:	kp
  MFC after:	2 weeks
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51494

  (cherry picked from commit 2ff1587e3803e76a9726e1734181a5170079ddbe)


   sys/net/if_ovpn.c | 11 ++++++-----
   1 file changed, 6 insertions(+), 5 deletions(-)

[commit ed7856cdf03f3d85d98e175410626e463ddf8087]
Date: 2025-07-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: if_ovpn: Remove an unused field from struct ovpn_kkey_dir
Review: No functional change; internal cleanup only.
Body:

  No functional change intended.

  Reviewed by:	kp
  MFC after:	2 weeks
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51493

  (cherry picked from commit 3d3add7d43adb891ec054ec3f1c3d6d20b78dca8)


   sys/net/if_ovpn.c | 1 -
   1 file changed, 1 deletion(-)

[commit bba73c02879d11933ae29e8ef1a8b065cec2918e]
Date: 2025-07-28
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: comsat: Don't return from the child
Review: The comsat daemon no longer incorrectly returns from the child process, preventing potential issues with biff notifications.
Body:

  Fixes:		91629228e3df
  MFC after:	1 week
  Reviewed by:	emaste
  Differential Revision:	https://reviews.freebsd.org/D51581

  (cherry picked from commit e40a2c4927a8068d7b6adee69c90ae3be8efc4df)


   libexec/comsat/comsat.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4406fe5f220357223978de58d3c1f9847dfa9d1b]
Date: 2025-07-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: comsat: Don't read arbitrary files
Review: The comsat daemon now restricts file names to those without slashes, preventing access to files outside the mail spool while allowing notifications for permitted mailboxes.
Body:

  When processing a notification, instead of accepting any file name
  that doesn't begin with a slash, accept only file names that don't
  contain any slashes at all.  This makes it possible to notify a
  user about a mailbox that doesn't bear their name, as long as they
  are permitted to read it, but prevents comsat from reading files
  outside the mail spool.

  PR:		270404
  MFC after:	1 week
  Reviewed by:	emaste
  Differential Revision:	https://reviews.freebsd.org/D51580

  (cherry picked from commit 4a4338d94401f0012380d4f1a4d332bd6d44fa8e)


   libexec/comsat/comsat.c | 38 +++++++++++++-------------------------
   1 file changed, 13 insertions(+), 25 deletions(-)

[commit b1e5e3b668e587cce59e03c080432d920b23e255]
Date: 2025-07-26
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Userland.programs
Subject: xargs: Limit -n to {ARG_MAX}
Review: The man:xargs[1] utility now limits the -n option to ARG_MAX, preventing arithmetic overflow and out-of-memory issues in tests.
Body:

  Since it's not possible to pass more than {ARG_MAX} bytes on the command
  line, it's also not possible to pass more than {ARG_MAX} individual
  arguments.  Therefore, {ARG_MAX} is a reasonable upper bound for the -n
  option.  This resolves both the arithmetic overflow issue and the CI OOM
  issue, so we can safely re-enable the test.

  Fixes:		eab91d008165
  Fixes:		2682a1552724
  MFC after:	1 week
  Reviewed by:	jlduran, emaste
  Differential Revision:	https://reviews.freebsd.org/D51536

  (cherry picked from commit a7fa987abe1fb0b25a7dd83dc81f14f64a82efc9)


   ObsoleteFiles.inc                                                 | 3 +++
   usr.bin/xargs/tests/Makefile                                      | 2 +-
   .../xargs/tests/{regress.n2147483647.out => regress.nargmax.out}  | 0
   usr.bin/xargs/tests/regress.sh                                    | 8 ++++----
   usr.bin/xargs/xargs.c                                             | 2 +-
   5 files changed, 9 insertions(+), 6 deletions(-)

[commit e3d875b79ddc9801b9c9ff738a050a52d8834952]
Date: 2025-07-24
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.config
Subject: rc.d: Fix mountd service script.
Review: The mountd service script now loads configuration from nfsd and zfs services, ensuring proper variable references.
Body:

  This script references variables beloning to the nfsd and zfs services,
  therefore it needs to load their configurations.

  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51473

  (cherry picked from commit aa183bc7f96fdd51c4a6ead5586a1cb1ecec6bb2)


   libexec/rc/rc.d/mountd | 3 +++
   1 file changed, 3 insertions(+)

[commit bb56c0ecf93e4643da6920822538707eaa108f19]
Date: 2025-07-22
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: extend description of net.inet.ip.fw.one_pass
Review: The description of the net.inet.ip.fw.one_pass sysctl is updated to clarify that it applies to all divert-like packet actions, not just dummynet(4). This improves documentation accuracy for users configuring firewall and packet handling.
Body:

  Description of net.inet.ip.fw.one_pass tunable refers only to dummynet(4),
  while in reality is applicable on any divert-like packet action like
  in-kernel nat, netgraph, reass, or similar.

  Reviewed by:	ae
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51436


   sys/netpfil/ipfw/ip_fw2.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 246f5b4136c39a26898e97b85d243d9b89f5d13f]
Date: 2025-07-30
Score: 5
Status: proposed(include=no,score=35)
Sponsor: 
Section: undecided
Subject: swapongeom: destroy consumer/close vnode in case swaponsomething failed
Review: The swap pager now properly cleans up vnode resources if swaponsomething fails, preventing potential resource leaks.
Body:

  (cherry picked from commit 2e3fa9395fc67e7369fda8d8b5c6613142d2a57d)


   sys/vm/swap_pager.c | 17 ++++++++++++-----
   1 file changed, 12 insertions(+), 5 deletions(-)

[commit 4434ecb939f17c7a228cb176b690fcca331717b3]
Date: 2025-07-29
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: sys_swapon: reject too small devices
Review: The man:swapon[8] utility now rejects swap devices smaller than one page, preventing potential system instability from undersized swap.
Body:

  (cherry picked from commit aa42e4984997c9d3aa5d30534bdaf760e613e97b)


   sys/vm/swap_pager.c | 15 +++++++++------
   1 file changed, 9 insertions(+), 6 deletions(-)

[commit 8d4464377219dcf45e87510b73767c9ec3515bc2]
Date: 2025-07-25
Score: 5
Status: proposed(include=no,score=0)
Sponsor: 
Section: undecided
Subject: vm_page: Fix loading bad memory addresses from file
Review: Error, not correct JSON Failed to parse the request body as JSON: messages[1].content: invalid escape at line 1 column 4928
Body:

  When loading bad memory addresses from a file, we are passed an end
  pointer that points on the first byte after the buffer. We want the
  buffer to be null-terminated (by changing the last byte to \0 if it is
  reasonable to do so), so adjust the end pointer to be on that byte.

  Approved by:	kib, markj
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51433

  (cherry picked from commit 202f8bde836dc86627be2b5b98174d9a0fb2eaba)


   sys/vm/vm_page.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c0b4b2db0adb7c95367a3b7470f0cbf7f7e9b711]
Date: 2025-07-30
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: libthr: fix typo in comment
Review: Typo fix in comment only; no user-visible impact.
Body:

  (cherry picked from commit b87013fe70c051278e67d103d93c5292721cbcba)


   lib/libthr/thread/thr_getthreadid_np.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3a54914b0e52ebe07c8f03ef53b73a1f5c5d0776]
Date: 2025-07-30
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: kern/kern_thread.c: fix typo in comment
Review: Typo fix in a kernel source comment with no user-visible impact.
Body:

  (cherry picked from commit a0041aee49bebd306179382658bcf965e6db5aef)


   sys/kern/kern_thread.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 30218eb7c4bcc8d49dc09a3e3001c64588af2e05]
Date: 2025-07-27
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: clang-scan-deps: Pass ${TDFILE} to tblgen, not ${.ALLSRC}
Review: Fixes a build failure in clang-scan-deps by correcting the argument passed to llvm-tblgen, ensuring the tool builds correctly.
Body:

  ${.ALLSRC} can include the dependency OptParser.td, which causes
  llvm-tblgen to fail since it only accepts a single input argument.

  Use ${TDFILE} directly instead, which matches the other invocations
  of tblgen in the LLVM Makefiles.

  Fixes:		d3c06bed2c16 ("clang: install clang-scan-deps")
  MFC after:	3 days
  Reviewed by:	dim
  Differential Revision:	https://reviews.freebsd.org/D51569

  (cherry picked from commit ad023bc26e106e28e1b4845f991b52b533bd0802)


   usr.bin/clang/clang-scan-deps/Makefile | 7 ++++---
   1 file changed, 4 insertions(+), 3 deletions(-)

[commit bfbb93b6de6afc8aba8df90e2a28db1c93cbd143]
Date: 2025-07-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: qlnxe: Advertise the IFCAP_HWSTATS capability
Review: The qlnxe driver advertises IFCAP_HWSTATS capability to prevent double-counting of interface byte statistics when hardware counters are available.
Body:

  The hardware can count statistics and the driver has already retrieved
  them via qlnx_get_counter().

  Advertise the IFCAP_HWSTATS capability to avoid the net stack from
  double counting IFCOUNTER_IBYTES.

  Reviewed by:	kbowling
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51451

  (cherry picked from commit 386960a8805edc6d5ac6bb6215ad102a83314549)


   sys/dev/qlnx/qlnxe/qlnx_os.c | 1 +
   1 file changed, 1 insertion(+)

[commit cdd97f3aacf1e509858207a0caa085b9c47e5e9e]
Date: 2025-07-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: qlnxe: Fix advertising the IFCAP_LINKSTATE capability
Review: The qlnxe driver now correctly advertises the IFCAP_LINKSTATE capability, which may affect link state reporting for network interfaces using this driver.
Body:

  The following up advertising of IFCAP_HWCSUM capability unconditionally
  overwrite IFCAP_LINKSTATE.

  Reviewed by:	kbowling
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D51450

  (cherry picked from commit c18860339d5051dea99cb5cee7e322ffa5dd2a81)


   sys/dev/qlnx/qlnxe/qlnx_os.c | 4 +---
   1 file changed, 1 insertion(+), 3 deletions(-)

[commit 525795cde28bbbc0aba3e5f359dfc877b9f248d1]
Date: 2025-06-19
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: bsdinstall: Emit a warning if the system has too little memory
Review: The bsdinstall installer now warns users if the system has insufficient memory during installation.
Body:

  PR:		251993
  Reviewed by:	adrian
  Event:		Kitchener-Waterloo Hackathon 202506
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50944

  (cherry picked from commit eb5884c564ae0e37df1d8a3fc5704ab6b2fa07d0)


   usr.sbin/bsdinstall/scripts/auto | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit 943ad2ce59887a63182e5e26ea6962e978ac59bd]
Date: 2025-07-12
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: rc: Use check_jail to check values of security.jail MIBs
Review: The rc scripts now use the check_jail function to verify security.jail MIB values before performing certain operations, ensuring that jail-related checks are handled consistently.
Body:

  PR:		282404
  Reviewed by:	markj, netchild
  Approved by:	markj (mentor)
  MFC after:	2 weeks
  Event:		Berlin Hackathon 202507
  Differential Revision:	https://reviews.freebsd.org/D47329

  (cherry picked from commit 46f18ecf8d3cdda1cd433841c44a4c1268ab9721)


   libexec/rc/rc            | 4 ++--
   libexec/rc/rc.d/hostname | 4 ++--
   libexec/rc/rc.d/routing  | 2 +-
   libexec/rc/rc.d/zfs      | 8 ++++----
   libexec/rc/rc.d/zfsbe    | 2 +-
   libexec/rc/rc.shutdown   | 4 ++--
   libexec/rc/rc.subr       | 2 +-
   7 files changed, 13 insertions(+), 13 deletions(-)

[commit 8679496e454e88031f0c37a67f934130e3d84cb4]
Date: 2025-06-14
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: dtrace.1: Mention providers in SEE ALSO
Review: The man:dtrace[1] manual page now includes references to DTrace providers in the SEE ALSO section.
Body:

  Reviewed by:	bnovkov, christos, markj
  Approved by:	bnovkov (mentor), christos (mentor), markj (mentor)
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50852

  (cherry picked from commit 177471148a6111537e84912fb9a033b6ac5ecb17)


   cddl/contrib/opensolaris/cmd/dtrace/dtrace.1 | 13 ++++++++++++-
   1 file changed, 12 insertions(+), 1 deletion(-)

[commit 8f6769b82a2a071cf07080b6d77639e919efbbcf]
Date: 2025-06-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: file: Fix the !CAPABILITIES build
Review: The commit fixes a build issue when CAPABILITIES is disabled, but this is an internal build fix with no user-visible impact.
Body:

  Reported by:	Ian FREISLICH <ianfreislich@gmail.com>
  Fixes:	f35525ff2053 ("file: Add a fd flag with O_RESOLVE_BENEATH semantics")

  (cherry picked from commit 6783dfb10637100067520bd6d9804e154cfee7ee)


   sys/kern/kern_descrip.c | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit 6a11b6aed8a9d4dee44a151317e3c8fd0d7d6763]
Date: 2025-06-27
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: psm(4): Add kqueue support
Review: The psm(4) driver now supports kqueue events, allowing applications to monitor PS/2 mouse input using the kqueue interface.
Body:

  MFC after:	2 weeks

  (cherry picked from commit b93063c84e4e792ede844d30452d82c4fe12bdd2)


   sys/dev/atkbdc/psm.c | 45 +++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 45 insertions(+)

[commit 6296dd08ae52b01ed681381df6f6c8f60e724467]
Date: 2025-05-14
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: Added identifiers for additional PS4 DualShock controller variants
Review: The PS4 DualShock driver now supports additional controller variants.
Body:

  PR:		285215
  MFC after:	1 week

  (cherry picked from commit d4147ad1a2b9d6e7a862a63894da604c61721786)


   sys/dev/hid/ps4dshock.c | 16 ++++++++++++++++
   1 file changed, 16 insertions(+)

[commit 2100a0fecec7710debf59ef4e7ddbc28abb7397c]
Date: 2025-05-14
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Future Crew, LLC
Section: Drivers.device
Subject: rtlbtfw(8): Sync device VID/PID list with Linux 6.15-rc4
Review: The rtlbtfw(8) utility and its kernel driver now support additional Realtek Bluetooth devices by updating the VID/PID list to match Linux 6.15-rc4.
Body:

  Sponsored by:	Future Crew, LLC
  MFC after:	1 month

  (cherry picked from commit 3e72d0b40040f94c4b99ab9dfa0a0e1b62dff397)


   sys/netgraph/bluetooth/drivers/ubt/ng_ubt_rtl.c | 20 ++++++++
   usr.sbin/bluetooth/rtlbtfw/main.c               | 20 ++++++++
   usr.sbin/bluetooth/rtlbtfw/rtlbt_fw.c           | 14 ++++++
   usr.sbin/bluetooth/rtlbtfw/rtlbt_fw.h           |  1 +
   usr.sbin/bluetooth/rtlbtfw/rtlbtfw.conf         | 66 ++++++++++++++++++++++++-
   5 files changed, 119 insertions(+), 2 deletions(-)

[commit 08ad5c42343b3ac15fa4169ac801e52e2de87135]
Date: 2025-05-14
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Future Crew, LLC
Section: Userland.programs
Subject: rtlbtfw(8): Add support for firmware file format V2
Review: The man:rtlbtfw[8] utility now supports firmware file format V2 for newer Realtek Bluetooth adapters.
Body:

  As Realtek changed format of the firmware files for recent adaptors.

  Sponsored by:	Future Crew, LLC
  MFC after:	1 month
  Differential Revision:	https://reviews.freebsd.org/D50082

  (cherry picked from commit b87a926098b291e2baf45ffc13c076ba0b0f0d74)


   usr.sbin/bluetooth/rtlbtfw/main.c     |  19 +++-
   usr.sbin/bluetooth/rtlbtfw/rtlbt_fw.c | 195 ++++++++++++++++++++++++++++++++--
   usr.sbin/bluetooth/rtlbtfw/rtlbt_fw.h |  53 ++++++++-
   usr.sbin/bluetooth/rtlbtfw/rtlbt_hw.c |  35 ++++++
   usr.sbin/bluetooth/rtlbtfw/rtlbt_hw.h |  13 +++
   5 files changed, 302 insertions(+), 13 deletions(-)

[commit 5aaaa1a61024bb13aafef1716a4fb10f31147b6b]
Date: 2025-06-05
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: beep: Capsicumize
Review: The beep(1) utility now enters a Capsicum sandbox after opening required file descriptors. This provides a simple demonstration of capability sandboxing but does not change its core functionality.
Body:

  While it's unlikely that beep(1) will be used in a context where a
  sandbox is particularly valuable, it does offer a simple demonstration
  of entering a capability sandbox after opening required fds, and is
  trivial to do.

  Reviewed by:	christos
  Event:		Kitchener-Waterloo Hackathon 202506
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50709

  (cherry picked from commit 54eda43cc1e6b1d73804b6c397a15002e3519555)


   usr.bin/beep/beep.c | 4 ++++
   1 file changed, 4 insertions(+)

[commit 27ed3497bb553374f7d80d7a0ff65f0296ee5ce4]
Date: 2025-06-05
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Userland.config
Subject: uk.kbd: Fix  mapping
Review: The UK keyboard keymap now maps Ctrl+4 to the Euro symbol () instead of the generic currency sign ().
Body:

  We previously emitted the generic currency sign `` for Ctrl+4.
  Generally speaking the modifer should be AltGr not Ctrl, and this should
  be the Euro symbol ``.

  Fixes: eb8f9028fb38 ("Add the Euro symbol mapping to the UK keyboard keymap.")
  Fixes: a232c1d130d2 ("Copy country-code .iso syscons keymaps for vt(4)")
  Fixes: fdd869bd8a89 ("Another rpund of fixes, after checking keymaps for plausibility and with")

  Reviewed by:	ivy
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50702

  (cherry picked from commit 5c66d7a2b8a000b6307c0a12e78eb1b50376c9f8)


   share/vt/keymaps/uk.kbd | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3fe326bfa03025654c017dde7ac8124beb5142fb]
Date: 2024-06-05
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: memcmp.3: Clarify return value
Review: The man:memcmp[3] manual page clarifies that the return value only indicates sign, not a specific difference between bytes.
Body:

  The return value is not required to be the difference between the
  differing bytes, only less than zero, zero, or greater than zero.

  Reviewed by:	fuz
  Event:		Kitchener-Waterloo Hackathon 202406
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D47683

  (cherry picked from commit 5cc53d79655bf7f67b1a794c088d896aa6475c2e)


   lib/libc/string/memcmp.3 | 43 +++++++++++++++++++++++++------------------
   1 file changed, 25 insertions(+), 18 deletions(-)

[commit 8aeeb4b7f0ff21844617def38f89fe34bf05ae4c]
Date: 2025-07-15
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Storage.general
Subject: p9fs: Set *eofflag in p9fs_readdir()
Review: The p9fs filesystem now correctly sets the end-of-file flag in readdir operations, which ensures proper termination of directory listings.
Body:

  Reviewed by:	kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50760

  (cherry picked from commit d4cdba5b2f55b62ba1558995226dd9d93fe00af8)


   sys/fs/p9fs/p9fs_vnops.c | 8 +++++++-
   1 file changed, 7 insertions(+), 1 deletion(-)

[commit 852cc22dda9b69dac61068b8507958aee048068a]
Date: 2025-07-15
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Modirum MDPay | Klara, Inc.
Section: undecided
Subject: vm_pageout: Remove a volatile qualifier from some vm_domain members
Review: No functional change intended; internal code cleanup only.
Body:

  These are always accessed using atomic(9) intrinsics, so do not need the
  qualifier.  No functional change intended.

  Reviewed by:	alc, kib
  MFC after:	2 weeks
  Sponsored by:	Modirum MDPay
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51322

  (cherry picked from commit fad79db405052f3faad7184ea2c8bfe9f92a700d)


   sys/vm/vm_pagequeue.h | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 2019311525ce724c79bdf7cb677c44bf7383323e]
Date: 2025-07-15
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Modirum MDPay | Klara, Inc.
Section: undecided
Subject: swap_pager: Convert swap-space-full flags to bools
Review: No user-visible change; internal refactoring only.
Body:

  No functional change intended.

  Reviewed by:	alc, kib
  MFC after:	2 weeks
  Sponsored by:	Modirum MDPay
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51321

  (cherry picked from commit 5c76e9f4579677482b0f96d4b3581f5e1ea2e072)


   sys/vm/swap_pager.c | 23 ++++++++++-------------
   1 file changed, 10 insertions(+), 13 deletions(-)

[commit d8ef477a7bfeed988561ad5a224878b24ee65352]
Date: 2025-07-15
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Storage.general
Subject: fdescfs: Set *eofflag in fdesc_readdir()
Review: The fdescfs filesystem now correctly sets the EOF flag in readdir operations, ensuring proper behavior when reading directory entries.
Body:

  Reviewed by:	kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51319

  (cherry picked from commit da84054f3a508ceab4474e4a002c87813963cc84)


   sys/fs/fdescfs/fdesc_vnops.c | 9 ++++++++-
   1 file changed, 8 insertions(+), 1 deletion(-)

[commit 1392b97d03883e53cf2b92c6c896a9a1ce6f4f04]
Date: 2025-07-15
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: kasan: Use kasan_md_unsupported() to check for invalid addresses
Review: The commit fixes a build issue for KASAN on amd64 after a kernel virtual address layout change, but it is an internal fix without user-visible impact.
Body:

  The subsequent assert verifies that the address is in the kernel map
  anyway, and this removes uses of the MD DMAP_*_ADDRESS constants from MI
  code.

  This fixes the amd64 KASAN build after commit 4dd828c80828 ("amd64: add
  kva_layout").

  MFC after:	2 weeks

  (cherry picked from commit 1f683624df878b2e4c0187137640bf2e6662c36f)


   sys/kern/subr_asan.c | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit 3060f4fda70d5bd80720dbdb7014eda09ff1c501]
Date: 2025-07-21
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: libdtrace: Use a designated array initializer for dt_cook_funcs[]
Review: No functional change; internal code style only.
Body:

  Also make the array const.  No functional change intended.

  MFC after:	1 week

  (cherry picked from commit 654dea596703eb422055a7d637356fbde36f8540)


   .../opensolaris/lib/libdtrace/common/dt_parser.c   | 48 +++++++++++-----------
   1 file changed, 24 insertions(+), 24 deletions(-)

[commit 6c6add72d0640f83f69843af1d52c65642a96142]
Date: 2025-07-13
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Storage.general
Subject: msdosfs: Fix handling of eofflag in VOP_READDIR
Review: The msdosfs filesystem now correctly sets the end-of-directory flag in man:readdir[2] operations, ensuring proper behavior when the end of a directory is reached.
Body:

  We also need to set it when an end-of-directory marker is reached.

  Reported by:	vishwin
  Reviewed by:	kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51290

  (cherry picked from commit 9f6718073382608519912e178e4c313dd61246b3)


   sys/fs/msdosfs/msdosfs_vnops.c | 21 ++++++++++-----------
   1 file changed, 10 insertions(+), 11 deletions(-)

[commit bb4a12ff9ac0feb05af7232c1ffc8e7cdd00f2dd]
Date: 2025-07-05
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: nuageinit: Add wrappers for chmod and chown
Review: Adds error checking and octal mode specification for chmod and chown wrappers in nuageinit.
Body:

  In the wrappers, check for errors and abort if one is raised.  At some
  point it may be useful to have a mechanism to ignore errors, but I'm not
  sure yet how that should look.

  For chmod, let the mode be specified as an octal number, otherwise it's
  hard to understand what's happening.  Note that this must be specified
  as a string, otherwise tonumber() will raise an error.

  Reviewed by:	bapt
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51159

  (cherry picked from commit 667ef8875bad115d334a85c1023db0cf4d8379ba)


   libexec/nuageinit/nuage.lua | 35 +++++++++++++++++++++++++----------
   libexec/nuageinit/nuageinit |  7 +++----
   2 files changed, 28 insertions(+), 14 deletions(-)

[commit 12718429e89f1fe64ebe2865db562f2f2296c7a9]
Date: 2025-07-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: rc_subr_test: Bump some sleep timeouts
Review: The commit increases a sleep timeout in an rc framework test to reduce intermittent failures under heavy load. This is a test-only change with no user-visible impact.
Body:

  The test verifies that the rc framework will OOM-protect a process
  spawned by rc.  It just wraps a 5-second /bin/sleep invocation as part
  of this test.

  The rc framework uses procctl to set the OOM-protect bit after the
  process has started, i.e., it uses procctl -p.  So, with a 5 second
  timeout, it's possible for the process to exit before procctl actually
  runs, if the system is heavily loaded.  (I see this failure occasionally
  with KMSAN configured and many tests running in parallel.)

  Bump the timeout to reduce the risk of this happening.  The timeout
  value is arbitrary since the test will stop the rc process, i.e., we
  don't have to wait for 60 seconds to elapse before the test passes.

  MFC after:	1 week

  (cherry picked from commit da89500adbea360533d2442a674c8af0741b7ff1)


   libexec/rc/tests/rc_subr_test.sh | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit f6ed43d346b1a79f62e33e3a3fe001d3fc5bcbde]
Date: 2025-07-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: Userland.programs
Subject: mkimg: Make output reproducible using a specific timestamp
Review: The man:mkimg[1] utility replaces the -R flag with a -t option to specify a timestamp for reproducible image creation. This allows users to set a custom timestamp for VHD image metadata, affecting tools that process VHD images.
Body:

  In commit 95ac5b0e27e9 ("mkimg: Add a reproducible mode"), I added a -R
  flag to mkimg, indicating that output should be reproducible.

  There is one place in the VHD image backend that uses time(3) to
  populate an image metadata field; this field is visible to tools which
  know how to process VHD images.  Rather than picking an arbitrary value
  for that timestamp, it seems better to behave like makefs(8) and let the
  invoker pick a suitable timestamp.

  So, remove -R and instead add a -t option which lets the timestamp be
  specified directly.  Then, modify the VHD backend to use that timestamp.

  Fixes:		95ac5b0e27e9 ("mkimg: Add a reproducible mode")
  Reviewed by:	bnovkov
  MFC after:	2 weeks
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51077

  (cherry picked from commit 393fefa3d9c78948d911e5de0182a9b858b23475)


   usr.bin/mkimg/mkimg.1 |  8 ++++----
   usr.bin/mkimg/mkimg.c | 24 ++++++++++++++++--------
   usr.bin/mkimg/mkimg.h |  4 ++--
   usr.bin/mkimg/uuid.c  |  7 ++++---
   usr.bin/mkimg/vhd.c   |  2 +-
   5 files changed, 27 insertions(+), 18 deletions(-)

[commit e9e13081931f7dbe8e785d15502b07aab6267b26]
Date: 2025-07-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.contrib
Subject: dtrace: fix symbol address resolution
Review: The dtrace symbol address resolution is corrected to properly handle ELF sections with SHF_ALLOC flag and symbols at the beginning of sections in ET_REL KLDs.
Body:

  Dtrace assumes only ELF sections of type SHT_PROGBITS or SHT_NOBITS
  occupy memory space. However, sections with SHF_ALLOC flag also consume
  memory space. Moreover, the symbol address initialization skips symbols
  at the very beginning of a section in ET_REL KLDs.

  Fix: Check section flag for calculating section offset, and disable the
  skipping at the beginning of a section.

  PR:		288000
  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D51188

  (cherry picked from commit 12bef37a824c52582ee8f38699b8ae4fde17068d)


   cddl/contrib/opensolaris/lib/libdtrace/common/dt_module.c | 14 +++++---------
   1 file changed, 5 insertions(+), 9 deletions(-)

[commit cd03595070272fa97b0f3c9ca78e9d828918580b]
Date: 2025-07-04
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: lposix: Use reentrant passwd and group lookup functions
Review: The lposix module now uses reentrant passwd and group lookup functions, improving thread safety when resolving user and group names in chown() operations.
Body:

  The implementation of chown() in the posix module handles user and group
  names as well as numeric IDs.  When resolving names, be sure to use
  reentrant lookup functions rather than assuming it's safe to clobber the
  internal buffers used by getpwnam() and getgrnam().

  Fix some style nits while here.

  Reviewed by:	imp, bapt
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D46555

  (cherry picked from commit 88d94ead7f7cfb7ea7c4134b4cd2f89da670a8e1)


   libexec/flua/modules/lposix.c | 29 +++++++++++++++++++----------
   1 file changed, 19 insertions(+), 10 deletions(-)

[commit afe2a4025c1fbb9efb62bfbe59e50e573c7124d3]
Date: 2025-07-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: savecore/tests: Serialize the livedump test
Review: The commit serializes a test to avoid parallel execution issues, but it is a test-only change with no user-visible impact.
Body:

  It assumes that the output of kldstat doesn't change over the course of
  the test, but this isn't true with parallel tests enabled.

  MFC after:	2 weeks

  (cherry picked from commit 3e041faa828a359ef0b91b5203eed5ab2c11e42d)


   sbin/savecore/tests/Makefile | 3 +++
   1 file changed, 3 insertions(+)

[commit ac2279ea57b72d688cf0af5a6fa7f5dbd1d4521b]
Date: 2025-06-24
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: unix/tests: Add a regression test for fd transfer across jails
Review: Adds a regression test for file descriptor transfer across jails, which may affect developers and testers working with jail and IPC functionality.
Body:

  MFC after:	3 weeks

  (cherry picked from commit 5843b8ee02e99527c28f579acfc1f48e10033529)


   tests/sys/kern/Makefile           |   2 +
   tests/sys/kern/unix_passfd_test.c | 131 ++++++++++++++++++++++++++++++++++++++
   2 files changed, 133 insertions(+)

[commit 3ad3ab5f9b6e91efc923bae9799697a823eb7227]
Date: 2025-06-24
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Kernel.general
Subject: unix: Set O_RESOLVE_BENEATH on fds transferred between jails
Review: The kernel now sets the O_RESOLVE_BENEATH flag on file descriptors transferred between jails via SCM_RIGHTS messages, preventing processes from escaping jail chroot boundaries through shared mounts.
Body:

  If a pair of jails with different filesystem roots is able to exchange
  SCM_RIGHTS messages (e.g., using a unix socket in a shared nullfs
  mount), a process in one jail can open a directory outside of the root
  of the second jail and then pass the fd to that second jail, allowing
  the receiving process to escape the jail chroot.

  Address this using the new FD_RESOLVE_BENEATH flag.  When externalizing
  an SCM_RIGHTS message into the receiving process, automatically set this
  flag on all new fds where a jail boundary is crossed.  This ensures that
  the receiver cannot do more than access files underneath the directory;
  in particular, the received fd cannot be used to access vnodes not
  accessible by the sender.

  PR:		262179
  Reviewed by:	kib
  MFC after:	3 weeks
  Differential Revision:	https://reviews.freebsd.org/D50371

  (cherry picked from commit 350ba9672a7f4f16e30534a603df577dfd083b3f)


   sys/amd64/conf/SYZKALLER |  5 +++++
   sys/kern/uipc_usrreq.c   | 31 +++++++++++++++++++++++--------
   2 files changed, 28 insertions(+), 8 deletions(-)

[commit 10b3f2138573da952b4db29f88f6d67cfc3300cd]
Date: 2025-06-24
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Kernel.general
Subject: file: Add a fd flag with O_RESOLVE_BENEATH semantics
Review: A new file descriptor flag FD_RESOLVE_BENEATH is added, which automatically applies O_RESOLVE_BENEATH semantics to all lookups relative to that descriptor, enhancing security by preventing filesystem escapes in certain jail scenarios. The flag is sticky and cannot be cleared, and such descriptors cannot be used with man:fchdir[2] or man:fchroot[2].
Body:

  The O_RESOLVE_BENEATH openat(2) flag restricts name lookups such that
  they remain under the directory referenced by the dirfd.  This commit
  introduces an implicit version of the flag, FD_RESOLVE_BENEATH, stored
  in the file descriptor entry.  When the flag is set, any lookup relative
  to that fd automatically has O_RESOLVE_BENEATH semantics.  Furthermore,
  the flag is sticky, meaning that it cannot be cleared, and it is copied
  by dup() and openat().

  File descriptors with FD_RESOLVE_BENEATH set may not be passed to
  fchdir(2) or fchroot(2).  Various fd lookup routines are modified to
  return fd flags to the caller.

  This flag will be used to address a case where jails with different root
  directories and the ability to pass SCM_RIGHTS messages across the jail
  boundary can transfer directory fds in such as way as to allow a
  filesystem escape.

  PR:		262180
  Reviewed by:	kib
  MFC after:	3 weeks
  Differential Revision:	https://reviews.freebsd.org/D50371

  (cherry picked from commit f35525ff2053e026a423e852136d73ed93c95803)


   lib/libc/sys/fcntl.2         | 63 +++++++++++++++++++----------
   sys/fs/fdescfs/fdesc_vnops.c |  4 +-
   sys/kern/kern_descrip.c      | 95 ++++++++++++++++++++++++++++++++------------
   sys/kern/uipc_syscalls.c     |  2 +-
   sys/kern/vfs_acl.c           |  4 +-
   sys/kern/vfs_cache.c         | 14 +++++--
   sys/kern/vfs_extattr.c       |  8 ++--
   sys/kern/vfs_syscalls.c      | 21 +++++++---
   sys/sys/fcntl.h              |  2 +
   sys/sys/file.h               |  2 +-
   sys/sys/filedesc.h           |  8 +++-
   sys/sys/namei.h              |  1 +
   12 files changed, 156 insertions(+), 68 deletions(-)

[commit b731570eca60c421f9c42208d542b49073e33a6d]
Date: 2025-07-13
Score: 5
Status: proposed(include=no,score=0)
Sponsor: 
Section: undecided
Subject: /etc/rc.d/pf: Fix for multi-line pf_fallback_rules
Review: Error, not correct JSON Failed to parse the request body as JSON: messages[1].content: invalid escape at line 1 column 5183
Body:

  Setting multiple pf_fallback_rules in /etc/rc.conf as per the
  documentation produces invalid pf syntax due to the lack of echo
  quoting $pf_fallback_rules in /etc/rc.d/pf. Adding quotes around
  the $pf_fallback_rules echo maintains newlines needed for valid
  pfctl syntax. Provided patch resolves the issue

  Also updating rc.conf(5) to reflect that multi-line pf_fallback_rules
  should not include a trailing backslash (\) as line breaks are
  needed when passing rules to pfctl via stdin.

  PR:		288197
  Reviewed by:	kp
  MFC after:	2 weeks

  (cherry picked from commit 9e8c1f9576e75fcd34007c6e8a4a6da0b1b2f1e2)


   libexec/rc/rc.d/pf       | 2 +-
   share/man/man5/rc.conf.5 | 6 +++---
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit 99979f0eeb9381685c8b4601623a109235341016]
Date: 2024-11-25
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Netflix
Section: Docs.manpages
Subject: setsockopt.2: Clarify SO_SPLICE action
Review: The man:setsockopt[2] manual page clarifies the behavior of the SO_SPLICE socket option, improving documentation for users.
Body:

  Reviewed by:	gallatin, markj
  Sponsored by:	Netflix
  Differential Revision:	https://reviews.freebsd.org/D47720
  Co-authored-by:	Mark Johnston <markj@FreeBSD.org>

  (cherry picked from commit c1e304c60c46a26af57f9638c53417dd6cffa9fe)


   lib/libc/sys/getsockopt.2 | 7 ++++++-
   1 file changed, 6 insertions(+), 1 deletion(-)

[commit 880e131d9d310c98f3b3c035d2daecb757198a77]
Date: 2025-07-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: vm_domainset: Print correct function in KASSERT()/panic()
Review: The commit fixes internal assertion messages and uses __func__ for consistency, with no user-visible impact.
Body:

  Some messages in vm_domainset_iter_next() would wrongly refer to
  vm_domainset_iter_first().  While here, ensure that all assertion/panic
  messages use '__func__' to avoid this discrepancy in the future if code
  is moved/copy-pasted again.

  Reviewed by:    markj, alc, kib
  MFC after:      10 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D51248

  (cherry picked from commit 1e78a6a6d85702b84f679712aac71f91e481e8f9)


   sys/vm/vm_domainset.c | 16 ++++++----------
   1 file changed, 6 insertions(+), 10 deletions(-)

[commit 0e9a3bdeb7376bf04cf21830c4e33aa7efe13961]
Date: 2025-07-08
Score: 5
Status: proposed(include=no,score=15)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: pmap: Degrade pmap_page_set_attr*() into a no-op on same attribute
Review: The pmap_page_set_attr*() functions become no-ops when setting the same attribute, which may affect low-level memory management behavior but has no direct user-visible impact.
Body:

  For 32-bit arm, move the no-op test that was already in place at start
  of the function so that it stays first even if the '#if 0' block around
  the call to sf_buf_invalidate_cache() is uncommented at some point (if
  ever).

  Reviewed by:    jeffpc_josefsipek.net, kib
  MFC after:      10 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D51253

  (cherry picked from commit 9d1f3ce79d85855399663e3977766ec46f28cadd)

  Forgotten on commit to main/-CURRENT:
  PR:             277476


   sys/amd64/amd64/pmap.c      |  5 +++++
   sys/arm/arm/pmap-v6.c       | 32 +++++++++++++++-----------------
   sys/arm64/arm64/pmap.c      |  2 ++
   sys/i386/i386/pmap.c        |  2 ++
   sys/powerpc/aim/mmu_oea.c   |  3 +++
   sys/powerpc/aim/mmu_oea64.c |  3 +++
   sys/powerpc/aim/mmu_radix.c |  4 ++++
   sys/riscv/riscv/pmap.c      |  2 ++
   8 files changed, 36 insertions(+), 17 deletions(-)

[commit 8e1b8ae7298fc8ec91f6d7dc040341343c894e57]
Date: 2025-07-07
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Hardware.virtualization
Subject: LinuxKPI: Have kvzalloc() rely on kvmalloc(), not kmalloc()
Review: The LinuxKPI kvzalloc() function now properly falls back to non-contiguous memory allocation when contiguous memory is unavailable, matching Linux kernel behavior.
Body:

  Since commit 19df0c5abcb9d4e9 ("LinuxKPI: make __kmalloc() play by the
  rules"), kmalloc() systematically allocates contiguous physical memory,
  as it should.  However, kvzalloc() was left defined in terms of
  kmalloc(), which makes it allocate contiguous physical memory too.  This
  is a too stringent restriction, as kvzalloc() is supposed to be a simple
  page-zeroing wrapper around kvmalloc().

  According to Linux's documentation ("memory-allocation.rst"), kvmalloc()
  first tries to allocate contiguous memory, falling back to
  non-contiguous one if that fails.  Thus, callers are already supposed to
  deal with the possibility of non-contiguous memory being returned.

  Reviewed by:    bz
  Fixes:          19df0c5abcb9 ("LinuxKPI: make __kmalloc() play by the rules")
  MFC after:      10 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D51247

  (cherry picked from commit 986edb19a49c7d7d3050c759d9b0826283492ebf)

  Forgotten on commit to main/-CURRENT:
  PR:             277476


   sys/compat/linuxkpi/common/include/linux/slab.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d738ed04dbff78243617ac341486b86486e9c8be]
Date: 2025-07-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: alloc_pages(): Don't reclaim on __GFP_NORETRY
Review: The LinuxKPI's alloc_pages() function now respects the __GFP_NORETRY flag, avoiding disruptive memory reclaim. This improves performance for drivers like amdgpu that rely on fast allocation failures for fallback strategies.
Body:

  Pass VM_ALLOC_NORECLAIM to vm_page_alloc_noobj_contig() so that it
  avoids reclaiming (currently, calling vm_reserv_reclaim_contig()).

  According to Linux's documentation, __GFP_NORETRY should not cause any
  "disruptive reclaim".  alloc_pages() is called a lot from the amdgpu DRM
  driver via ttm_pool_alloc(), which tries to allocate pages of the
  highest order first and fallback to lower order pages (as allocating
  contiguous physical pages is in fact not a requirement).  This process
  relies on failing fast, as requested by __GFP_NORETRY.  See also related
  commit 718d1928f874 ("LinuxKPI: make linux_alloc_pages() honor
  __GFP_NORETRY").

  Reviewed by:    jeffpc_josefsipek.net, bz
  MFC after:      10 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D51246

  (cherry picked from commit 4ca9190251bbd00c928a3cba54712c3ec25e9e26)

  Forgotten on commit to main/-CURRENT:
  PR:             277476


   sys/compat/linuxkpi/common/src/linux_page.c | 5 +++++
   1 file changed, 5 insertions(+)

[commit 38cf4580a449a81805f2d45cc5b5f3a08685a36c]
Date: 2025-07-28
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: Obsoletefiles.inc: Add architecture-specific 'runq.h' headers
Review: The commit removes obsolete architecture-specific 'runq.h' headers from the build system, which is an internal cleanup with no user-visible impact.
Body:

  These were removed in commit 2fefe2c88b31 ("runq: Deduce most
  parameters, remove machine headers").

  MFC with:       2fefe2c88b31 ("runq: Deduce most parameters, remove machine headers")
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 8a69eb88fa00bb0ce85439d91cfdbd71426ffd0e)


   ObsoleteFiles.inc | 3 +++
   1 file changed, 3 insertions(+)

[commit 2d2e8ea9f2866182ad1524b5b99564a46f92649f]
Date: 2025-06-19
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: runq: runq_not_empty() to support racy lookups again
Review: The commit fixes a race condition in the scheduler's runq_not_empty() function that could cause kernel assertions under heavy load. This prevents potential kernel panics during concurrent thread scheduling operations.
Body:

  The 4BSD assumes that its sched_runnable(), which then calls
  runq_not_empty(), can be called racily (another CPU may be grabbing
  a thread from the global queue at the same time).

  This makes runq_not_empty() trip on an assertion in runq_find()
  detecting a mismatch between some bit in the status word and the state
  of the corresponding queue (empty/not empty).

  Re-implement runq_not_empty() in an independent and simpler way as an
  alternative to removing the assertion, which remains useful to detect
  races when removing or adding a thread in some runqueue.

  Fixes:          79f68322c892 ("runq: runq_check(): Re-implement on top of runq_findq()")
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit be8e84c2e9240110ce99bb8d14259073340e4ef6)


   sys/kern/kern_switch.c | 23 +++++++++++++++--------
   1 file changed, 15 insertions(+), 8 deletions(-)

[commit c7bb3ca85e5a8d7916fc2828aa2a47aebddb0294]
Date: 2025-06-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: Fix printing status word bits
Review: The commit fixes a format string issue for printing status word bits on 64-bit platforms, which may affect debugging output but does not introduce user-visible functionality changes.
Body:

  'rqsw_t' is 'unsigned long', strictly longer than integers on 64-bit
  platforms.

  While here, factor out the print format for a status word.

  Fixes:          d2ac231616f0 ("Make the run queue parameters machine dependent...")
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 3e5aeb20645fa0a67ce50d96c5136de14067a944)


   sys/kern/kern_switch.c | 11 ++++++++---
   sys/sys/runq.h         |  1 +
   2 files changed, 9 insertions(+), 3 deletions(-)

[commit 8a59ea47d92c3c4b6dca61a3c21346ae34b30b61]
Date: 2025-06-18
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sched_ule: 32-bit platforms: Fix runq_print() after runq changes
Review: Fixes a compiler warning in a debugging function; no user-visible impact.
Body:

  The compiler would report a mismatch between the format and the actual
  type of the runqueue status word because the latter is now
  unconditionally defined as an 'unsigned long' (which has the "natural"
  platform size) and the format expects a 'size_t', which expands to an
  'unsigned int' on 32-bit platforms (although they are both of the same
  actual size).

  This worked before as the C type used depended on the architecture and
  was set to 'uint32_t' aka 'unsigned int' on these 32-bit platforms.

  Just fix the format (use 'l').  While here, remove outputting '0x' by
  hand, instead relying on '#' (only difference is for 0, and is fine).

  runq_print() should be moved out of 'sched_ule.c' in a subsequent
  commit.

  Reported by:    Jenkins
  Fixes:          79d8a99ee583 ("runq: Deduce most parameters, remove machine headers")
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 013c58ced6aef26bad7ca5c6eb829b9d586f6edb)


   sys/kern/sched_ule.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 2b76d028605bf1f08ab9630f775fa29368737715]
Date: 2025-06-18
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: arm64: lib32: Don't try to install removed <machine/runq.h>
Review: The commit removes a reference to a removed header in the lib32 build for arm64, which is a build system fix without direct user impact.
Body:

  Reported by:    Herbert J. Skuhra (herbert gojira.at)
  Fixes:          79d8a99ee583 ("runq: Deduce most parameters, remove machine headers")
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 63c9b018069b58bacb2875c83c676cc8c4f40d69)


   include/arm/Makefile | 1 -
   1 file changed, 1 deletion(-)

[commit 193c695d7b071f901a60c971736b22c96565bd70]
Date: 2024-09-09
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: ps(1), top(1): Priority: Let 0 be the first timesharing level
Review: The ps(1) and top(1) utilities now display user thread priority with 0 as the first timesharing level, making it easier to distinguish between high-priority (kernel/realtime) and low-priority (timesharing/idle) threads.
Body:

  Change the origin from PZERO to PUSER.

  Doing so allows users to immediately detect if some thread is running
  under a high priority (kernel or realtime) or under a low one
  (timesharing or idle).

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 1d8f8f3e36fafdb50613d042f5fa75d8cbcf2b8f)


   bin/ps/print.c        | 2 +-
   usr.bin/top/machine.c | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit cc604213b59777b33c413e2d2c70f63d4c3665bf]
Date: 2024-05-21
Score: 5
Status: proposed(include=no,score=35)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sched_4bsd: ESTCPULIM(): Allow any value in the timeshare range
Review: The sched_4bsd ESTCPULIM() function now allows 'ts_estcpu' to grow up to the greatest priority of the timeshare range, improving CPU usage estimation precision and queue utilization.
Body:

  The current formula wastes queues and degrades usage estimation
  precision, since any increase of ticks that goes over 40 priorities (so,
  8 * 40) is clamped to the last of these 40 levels (the nice value is
  subsequently added to that number to get the final priority level).

  Allow 'ts_estcpu' to grow up to a value corresponding to the greatest
  (i.e., lowest) priority of the timeshare range.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45392

  (cherry picked from commit eebc148f25c3012b943083b48fbfc13494e9c77f)


   sys/kern/sched_4bsd.c | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit 00c1b4fac2ab709b0e0c77007d47c85e0bf36095]
Date: 2024-05-21
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: sched_4bsd: Remove RQ_PPQ from ESTCPULIM()'s formula
Review: The commit adjusts the scheduler's priority calculation, which may affect process scheduling behavior for multi-process workloads.
Body:

  Substracting RQ_PPQ to the maximum number of allowed priority values
  (the factor to INVERSE_ESTCPU_WEIGHT) has the effect of pessimizing the
  number of processes assigned to the last priority bucket.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45392

  (cherry picked from commit 51a4ae05abe6e170de0ff82641d8fce19043eea9)


   sys/kern/sched_4bsd.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 32766dde5bc35b4fd47550fb6cdf2ff745528773]
Date: 2024-05-21
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sched_4bsd: Move ESTCPULIM() after its macro dependencies
Review: No user-visible changes; commit is a code movement and comment adjustment without functional impact.
Body:

  No functional change (intended).

  Also makes the comment about INVERSE_ESTCPU_WEIGHT() adjacent to its
  definition.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45392

  (cherry picked from commit a454ff6b0440ec1a8e6b5c8154ad22c32df13c51)


   sys/kern/sched_4bsd.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 15056c43e87f2fc451057b1812e23a8270ebcc1f]
Date: 2024-06-25
Score: 5
Status: proposed(include=no,score=35)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sched_ule: Sanitize CPU's use and priority computations, and ticks storage
Review: The commit fixes precision and rounding issues in CPU usage and priority calculations, and ensures tick fields are unsigned to avoid wraparound. These changes affect the accuracy of %CPU reporting in utilities like man:top[1] and man:ps[1], and may slightly alter thread scheduling priorities.
Body:

  Computation of %CPU in sched_pctcpu() was overly complicated, wrong in
  the case of a non-maximal window (10 seconds span; this is always the
  case in practice as the window would oscillate between 10 and 11 seconds
  for continuously running processes) and performed unshifted for the
  first part, essentially losing precision (up to 9% for SCHED_TICK_SECS
  being 10), and with some uneffective shift for the second part.
  Conserve maximum precision by only shifting by the require amount to
  attain FSHIFT before dividing.  Apply classical rounding to nearest
  instead of rounding down.

  To generally avoid wraparound problems with tick fields in 'struct
  td_sched' (as already happened once in sched_pctcpu_update()), make then
  all unsigned, and ensure 'ticks' is always converted to some 'u_int'.
  While here, fix SCHED_AFFINITY().

  Rewrite sched_pctcpu_update() while keeping the existing formulas:
  - Fix the hole in the cliff case that in theory 'ts_ticks' can become
    greater than the window size if a running thread has not been
    accounted for too long (today cannot happen because of sched_clock()).
  - Make the decay ratio explicit and configurable (SCHED_CPU_DECAY_NUMER,
    SCHED_CPU_DECAY_DENOM).  Set it to the current value (10/11),
    currently producing a 95% attenuation after about ~32s.  This eases
    experimenting with changing it.  Apply the ratio on shifted ticks for
    better precision, independently of the chosen value for
    SCHED_TICK_MAX/SCHED_TICK_SECS.
  - Remove redundant SCHED_TICK_TARG.  Compute SCHED_TICK_MAX from
    SCHED_TICK_SECS, the latter now really specifying the maximum size of
    the %CPU estimation window.
  - Ensure it is immune to varying 'hz' (which today can't happen), so
    that after computation SCHED_TICK_RUN(ts) is mathematically guaranteed
    lower than SCHED_TICK_LENGTH(ts).
  - Thoroughly explain the current formula, and mention its main drawback
    (it is completely dependent on the frequency of calls to
    sched_pctcpu_update(), which currently manifests itself for sleeping
    threads).

  Rework sched_priority():
  - Ensure 'p_nice' is read only once, to be immune to a concurrent
    change.
  - Clearly show that the computed priority is the sum of 3 components.
    Make them all positive by shifting the starting priority and shifting
    the nice value in SCHED_PRI_NICE().
  - Compute the priority offset deriving from the %CPU with rounding to
    nearest.
  - Much more informative KASSERT() output with details regarding the
    priority computation.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D46567

  (cherry picked from commit a33225efb4bc2598e4caa1c1f7f715653e8b1fda)


   sys/kern/sched_ule.c | 192 +++++++++++++++++++++++++++++++--------------------
   1 file changed, 116 insertions(+), 76 deletions(-)

[commit c1ca55eb93fd3ce9624258ce73d2ecec06d2d9c3]
Date: 2024-06-17
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: sched_ule: Recover previous nice and anti-starvation behaviors
Review: The ULE scheduler recovers previous nice and anti-starvation behaviors after changes to the runqueue structure, affecting CPU time distribution among processes with different nice values.
Body:

  Justification for this change is to avoid disturbing ULE's behavior too
  much at this time.  We however acknowledge that the effect of "nice"
  values is extremely weak and will most probably change it going forward.

  Tuning allows to mostly recover ULE's behavior prior to the switch to
  a single 256-queue runqueue and the increase of the timesharing priority
  levels' range.

  After this change, in a series of test involving two long-running
  processes with varying nice values competing for the same CPU, we
  observe that used CPU time ratios of the highest priority process to
  change by at most 1.15% and on average by 0.46% (absolute differences).
  In relative differences, they change by at most 2% and on average by
  0.78%.

  In order to preserve these ratios, as the number of priority levels
  alloted to timesharing have been raised from 136 to 168 (and the subsets
  of them dedicated to either interactive or batch threads scaled
  accordingly), we keep the ratio of levels reserved to handle nice values
  to those reserved for CPU usage by applying a factor of 5/4 (which is
  close to 168/136).

  Time-based advance of the timesharing circular queue's head is ULE's
  main fairness and anti-starvation mechanism.  The higher number of
  queues subject to the timesharing scheduling policy is now compensated
  by allowing a greater increment of the head offset per tick.  Because
  there are now 109 queue levels dedicated to the timesharing scheduling
  policy (in contrast with the 168 levels alloted to timesharing levels,
  which include the former but also those dedicated to threads considered
  interactive) whereas there previously were 64 ones (priorities spread
  into a single, separate runqueue), we advance the circular queue's head
  7/4 faster (a ratio close to 109/64).

  While here, take into account 'cnt' as the number of ticks when
  advancing the circular queue's head.  This fix depends on the other code
  changes enabling incrementation by more than one.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D46566

  (cherry picked from commit 6792f3411f6d99e1698589835adbf6b7b51c7c74)


   sys/kern/sched_ule.c | 76 +++++++++++++++++++++++++++++++++++++++-------------
   1 file changed, 58 insertions(+), 18 deletions(-)

[commit d83f27fe73787a3625aae3f36fd50bd4662db483]
Date: 2024-05-22
Score: 5
Status: proposed(include=no,score=30)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sched: Internal priority ranges: Reduce kernel, increase timeshare
Review: The internal priority ranges for kernel and timeshare threads are adjusted, increasing the number of distinct timesharing priority levels to 168, which may affect thread scheduling behavior for user processes.
Body:

  Now that a difference of 1 in priority level is significant, we can
  shrink the priority range reserved for kernel threads.

  Only four distinct levels are necessary for the bottom half (3 base
  levels and arguably an additional one for demoted interrupt threads that
  run for full time slices so that they finally don't compete with other
  ones).  To leave room for other possible uses, we settle on 8 levels.

  Given the symbolic constants for the top half, 10 levels are currently
  necessary.  We settle on 16 levels.

  This allows to enlarge the timesharing range, which covers ULE's both
  interactive and batch range, to 168 distinct levels from less than 64
  ones for ULE (as of before the changes to make it use a single runqueue
  and have 256 distinct levels per runqueue) and 34 ones for 4BSD.

  While here, note that the realtime range is required to have at least 32
  priority levels since:
  - POSIX mandates at least 32 distinct levels for the SCHED_RR/SCHED_FIFO
    scheduling policies.
  - We directly map contiguous priority levels ('sched_priority') of these
    scheduling policies to distinct, contiguous internal priority levels.
  Conversely, having at least 32 priority levels is enough to guarantee
  compliance to the POSIX requirement mentioned above because different
  internal priority levels are treated differently since commit "runq:
  Switch to 256 levels".

  While here, list explicit change restrictions for the realtime and idle
  range.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45391

  (cherry picked from commit dee257c28d936bb7b459d3eda207531b3cf1bd4e)


   sys/sys/priority.h | 52 +++++++++++++++++++++++++++++-----------------------
   1 file changed, 29 insertions(+), 23 deletions(-)

[commit c42d06da488a12c110a7476a6b313e1fce890402]
Date: 2024-05-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: Add copyright
Review: The commit adds copyright notices to internal kernel files, which is an administrative change with no user-visible impact.
Body:

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit d710acecc00f59dbcc1006ca330f0eeb1a133695)


   sys/kern/kern_switch.c | 5 +++++
   sys/sys/runq.h         | 5 +++++
   2 files changed, 10 insertions(+)

[commit 2a9e7fd346f669338a23b438a723f5d604957173]
Date: 2024-05-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: Restrict <sys/runq.h> to kernel only
Review: The <sys/runq.h> header is now restricted to kernel-only use, preventing userland applications from including it.
Body:

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45390

  (cherry picked from commit 055b5b5f850da9d8355740b7a0698fa790c4f97d)


   sys/sys/runq.h | 20 ++++++++------------
   1 file changed, 8 insertions(+), 12 deletions(-)

[commit c6838df8357825d2f49c138b8a7d9d0bfdcc4760]
Date: 2025-03-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: epoch_test: Assign different priorities using offset 1
Review: The commit adjusts an internal test constant to reflect a kernel scheduler change, but it only affects a test file and does not have any direct user-visible impact.
Body:

  Replace the hardcoded 4 (old RQ_PPQ) by 1 (new RQ_PPQ), as all priority
  levels are now treated differently.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit a2d1c3bc2bb44a824a8d1f688aa1fd3b66fa759b)


   sys/tests/epoch/epoch_test.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit dcf352d69d912823b7eb2fb0ed5a33ac4ce9b5c9]
Date: 2024-05-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: Remove userland references to RQ_PPQ in rtprio contexts
Review: The commit removes references to RQ_PPQ in a single test file only, with no user-visible impact.
Body:

  Concerns only a single test (ptrace_test.c).

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45390

  (cherry picked from commit b2a9ee2a72eabcfe7942cfbc2a576b5603ef218c)


   tests/sys/kern/ptrace_test.c | 5 ++---
   1 file changed, 2 insertions(+), 3 deletions(-)

[commit 590d12774f8f921a3181dc0b893612925b041394]
Date: 2024-05-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: Bump __FreeBSD_version after switching to 256 levels
Review: The __FreeBSD_version number is incremented to reflect internal changes to the run queue priority levels.
Body:

  Corresponding to changing RQ_PPQ to 1.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45390

  (cherry picked from commit e3a4b989d7f7d82f7ab8cefe0d665dbe6b74d316)


   sys/sys/param.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 0f54758cbe917bd8ba4160a97b9bf93b05922257]
Date: 2024-05-14
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: runq: Switch to 256 levels
Review: The scheduler runqueue now supports 256 priority levels, increasing from 64. This change ensures POSIX compliance for SCHED_FIFO and SCHED_RR scheduling policies by providing 32 distinct priority levels, allowing threads with different priorities within the same group to preempt each other.
Body:

  This increases the number of levels from 64 to 256, which coincides with
  the distinct internal priority values (priority is currently encoded in
  a 'u_char', whose range is entirely used).

  With this change, we become POSIX-compliant for SCHED_FIFO/SCHED_RR in
  that we really provide 32 distinct priority levels for these policies.
  Previously, threads in the same "priority group", with priority groups
  defined as the threads in consecutive spans of 4 priority levels
  starting with level 0 up to 31 (so there are 8 groups), could not
  preempt or be preempted by each other even if they were assigned
  different priority levels.

  See also commit "sched_ule: Use a single runqueue per CPU" for all the
  drawbacks that this change also removes.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45390

  (cherry picked from commit af8de65ef23e7e447916370851f39aea3f74e16a)


   sys/sys/runq.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c6a65bbee6959f50fa9313c63f31ff6e815b48d4]
Date: 2024-05-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: zfs: spa: ZIO_TASKQ_ISSUE: Use symbolic priority
Review: The commit changes internal ZFS priority handling to use symbolic constants, which has no direct user-visible impact.
Body:

  This allows to change the meaning of priority differences in FreeBSD
  without requiring code changes in ZFS.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45390

  (cherry picked from commit fd141584cf89d7d24543ef5be83c6927a5d67ffa)


   .../openzfs/include/os/freebsd/spl/sys/proc.h       |  4 +++-
   .../openzfs/include/os/linux/spl/sys/sysmacros.h    |  4 +++-
   sys/contrib/openzfs/include/sys/zfs_context.h       |  4 +++-
   sys/contrib/openzfs/module/zfs/spa.c                | 21 +++------------------
   4 files changed, 12 insertions(+), 21 deletions(-)

[commit 79dcda3d5df6ede0bb4a0afcaa7180af703a785d]
Date: 2024-05-22
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: Internal scheduling priorities: Always use symbolic ones
Review: The commit replaces hardcoded priority offsets with symbolic constants across multiple kernel subsystems, but explicitly states no functional change is intended. This is an internal refactoring without user-visible impact.
Body:

  Replace priorities specified by a base priority and some hardcoded
  offset value by symbolic constants.  Hardcoded offsets prevent changing
  the difference between priorities without changing their relative
  ordering, and is generally a dangerous practice since the resulting
  priority may inadvertently belong to a different selection policy's
  range.

  Since RQ_PPQ is 4, differences of less than 4 are insignificant, so just
  remove them.  These small differences have not been changed for years,
  so it is likely they have no real meaning (besides having no practical
  effect).  One can still consult the changes history to recover them if
  ever needed.

  No functional change (intended).

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45390

  (cherry picked from commit 8ecc41918066422d6788a67251b22d11a6efeddf)


   sys/cam/ctl/ctl.c                |  4 ++--
   sys/dev/firewire/firewirereg.h   |  2 +-
   sys/dev/iicbus/iiconf.h          |  2 +-
   sys/dev/ppbus/lpt.c              |  2 +-
   sys/dev/ppbus/ppbconf.h          |  2 +-
   sys/dev/smbus/smbconf.h          |  2 +-
   sys/dev/syscons/syscons.c        |  2 +-
   sys/dev/vkbd/vkbd.c              | 14 +++++++-------
   sys/fs/fuse/fuse_device.c        |  2 +-
   sys/fs/fuse/fuse_io.c            |  2 +-
   sys/fs/fuse/fuse_ipc.c           |  4 ++--
   sys/fs/nfs/nfs_commonsubs.c      |  2 +-
   sys/fs/nfsserver/nfs_nfsdcache.c |  6 +++---
   sys/fs/nfsserver/nfs_nfsdstate.c |  4 ++--
   sys/fs/smbfs/smbfs_io.c          |  2 +-
   sys/kern/kern_rmlock.c           |  7 ++++---
   sys/kern/subr_log.c              |  2 +-
   sys/kern/sysv_msg.c              |  4 ++--
   sys/kern/sysv_sem.c              |  2 +-
   sys/kern/vfs_bio.c               |  7 +++----
   sys/kern/vfs_vnops.c             | 12 ++++++------
   sys/net/if_tuntap.c              |  8 ++++----
   sys/netgraph/ng_device.c         |  2 +-
   sys/sys/buf.h                    |  4 ++--
   sys/ufs/ffs/ffs_softdep.c        |  6 +++---
   sys/ufs/ffs/ffs_vnops.c          |  3 +--
   sys/ufs/ufs/ufs_quota.c          | 22 +++++++++++-----------
   27 files changed, 65 insertions(+), 66 deletions(-)

[commit faa0b715592ddc470fdaacb84f5efc3bbf2b1e69]
Date: 2024-05-14
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: sched_ule: Use a single runqueue per CPU
Review: The ULE scheduler now uses a single runqueue per CPU instead of three separate queues for realtime, timesharing, and idle policies. This change improves priority handling and prepares for future enhancements to support 256 distinct priority levels.
Body:

  Previously, ULE would use 3 separate runqueues per CPU to store threads,
  one for each of its selection policies, which are realtime, timesharing
  and idle.  They would be examined in this order, and the first thread
  found would be the one selected.

  This choice indeed appears as the easiest evolution from the single
  runqueue used by sched_4bsd (4BSD): It allows sharing most of the same
  runqueue code, which currently defines 64 levels per runqueue, while
  multiplying the number of levels (by 3).  However, it has several
  important drawbacks:

  1. The number of levels is the same for each selection policy.  64 is
  unnecessarily large for the idle policy (only 32 distinct levels would
  be necessary, given the 32 levels of our RTP_PRIO_IDLE and their future
  aliases in the to-be-introduced SCHED_IDLE POSIX scheduling policy) and
  unnecessary restrictive both for the realtime policy (which should
  include 32 distinct levels for PRI_REALTIME, given our implementation of
  SCHED_RR/SCHED_FIFO, leaving at most 32 levels for ULE's interactive
  processes where the current implementation provisions 48 (perhaps taking
  into account the spreading problem, see next point)) and the timesharing
  one (88 distinct levels currently provisioned).

  2. A runqueue has only 64 distinct levels, and maps priorities in the
  range [0;255] to a queue index by just performing a division by 4.
  Priorities mapped to the same level are treated exactly the same from
  a scheduling perspective, which is generally both unexpected and
  incorrect.  ULE's code tries to compensate for this aliasing in the
  timesharing selection policy, by spreading the 88 levels into 256,
  knowing the latter amount in the end to only 64 distinct ones.  This
  scaling is unfortunately not performed for the other policies, breaking
  the expectations mentioned in the previous point about distinct priority
  levels.

  With this change, only a single runqueue is now used to store all
  threads, regardless of the scheduling policy ULE applies to them (going
  back to what 4BSD has always been doing).  ULE's 3 selection policies
  are assigned non-overlapping ranges of levels, and helper functions have
  been created to select or steal a thread in these distinct ranges,
  preserving the "circular" queue mechanism for the timesharing selection
  policy that (tries to) prevent starvation in the face of permanent
  dynamic priority adjustments.

  This change allows to choose any arbitrary repartition of runqueue
  levels between selection policies.  It is a prerequisite to the increase
  to 256 levels per runqueue, which will allow to dispense with all the
  drawbacks listed above.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45389

  (cherry picked from commit baecdea10eb50ac20c2ed1fcd4171d3a609e90b5)


   sys/kern/kern_switch.c |  11 --
   sys/kern/sched_ule.c   | 305 ++++++++++++++++++++++++++++++-------------------
   sys/sys/runq.h         |   1 -
   3 files changed, 187 insertions(+), 130 deletions(-)

[commit 0566e750c46cea02b4fbdda5b31e83dafaeaeb15]
Date: 2024-04-29
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: sched_ule: runq_steal_from(): Suppress first thread special case
Review: The sched_ule(4) scheduler no longer has a special case that ignored the highest-priority thread during load balancing. This may slightly affect thread execution ordering and fairness across CPUs.
Body:

  This special case was introduced as soon as commit "ULE 3.0"
  (ae7a6b38d53f, r171482, from July 2007).  It caused runq_steal_from() to
  ignore the highest-priority thread while stealing.

  Its functionality was changed in commit "Rework CPU load balancing in
  SCHED_ULE" (36acfc6507aa, r232207, from February 2012), where the intent
  was to keep track of that first thread and return it if no other one was
  stealable, instead of returning NULL (no steal).  Some bug prevented it
  from working in loaded cases (more than one thread, and all threads but
  the first one not stealable), which was subsequently fixed in commit
  "sched_ule(4): Fix interactive threads stealing." (bd84094a51c4, from
  September 2021).

  All the reasons for this mechanism we could second-guess were dubious at
  best.  Jeff Roberson, ULE's main author, says in the differential
  revision that "The point was to move threads that are least likely to
  benefit from affinity because they are unlikely to run soon enough to
  take advantage of it.", to which we responded: "(snip) This may improve
  affinity in some cases, but at the same time we don't really know when
  the next thread on the queue is to run. Not stealing in this case also
  amounts to slightly violating the expected execution ordering and
  fairness.".

  As this twist doesn't seem to bring any performance improvement in
  general, let's just remove it.

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45388

  (cherry picked from commit fdf31d27476968456a8a389d8152370582756ef1)


   sys/kern/sched_ule.c | 14 --------------
   1 file changed, 14 deletions(-)

[commit 952ccda22e27a7321d07814bd19d2c407c366cd4]
Date: 2024-04-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sched_ule: Re-implement stealing on top of runq common-code
Review: The commit re-implements thread stealing in the ULE scheduler using common runqueue code, which may affect thread scheduling performance and behavior. However, it is an internal refactoring with no clear user-visible impact such as configuration changes, new features, or documented behavior changes.
Body:

  Stop using internal knowledge of runqueues.  Remove duplicate
  boilerplate parts.

  Concretely, runq_steal() and runq_steal_from() are now implemented on
  top of runq_findq().

  Besides considerably simplifying the code, this change also brings an
  algorithmic improvement since, previously, set bits in the runqueue's
  status words were found by testing each bit individually in a loop
  instead of using ffsl()/bsfl() (except for the first set bit per status
  word).

  This change also makes it more apparent that runq_steal_from() treats
  the first thread with highest priority specifically (which runq_steal()
  does not).

  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45388

  (cherry picked from commit f4be333bc56759d33dca49ab4d19eaf22134e844)


   sys/kern/sched_ule.c | 124 ++++++++++++++++++++++++++++-----------------------
   1 file changed, 68 insertions(+), 56 deletions(-)

[commit 16cfdebb8b3466c27a7c4a42589c252353ccdad1]
Date: 2024-04-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: New runq_findq(), common low-level search implementation
Review: Internal refactoring of runqueue search functions without user-visible changes.
Body:

  That new runq_findq(), based on the implementation of the former
  runq_findq_range(), is intended to become the foundation and unique
  low-level implementation for all searches in a runqueue.  In addition to
  a range of queues' indices, it takes a predicate function, allowing to:
  - Possibly skip a non-empty queue with higher priority (numerically
    lower index) on some criteria.  This is not yet used but will be in
    a subsequent commit revising ULE's stealing machinery.
  - Choose a specific thread in the queue, not necessarily the first.
  - Return whatever information is deemed necessary.

  It helps to remove duplicated boilerplate code, including redundant
  assertions, and generally makes things much clearer.  These effects will
  be even greater in a subsequent commit modifying ULE to use it.

  runq_first_thread_range() replaces the old runq_findq_range() (returns
  the first thread of the highest priority queue in the requested range),
  and runq_first_thread() the old runq_findq() (same, but considering all
  queues).

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit 9c3f4682bb90eeb85b0bbe8728a493e7d2ffece3)


   sys/kern/kern_switch.c | 203 ++++++++++++++++++++++++++++++-------------------
   sys/sys/runq.h         |  13 +++-
   2 files changed, 135 insertions(+), 81 deletions(-)

[commit 9eba574a676191e2f2aaaa0401dcd887e25fb961]
Date: 2024-05-23
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: New function runq_is_queue_empty(); Use it in ULE
Review: The commit adds a new internal function for checking runqueue emptiness but does not introduce any user-visible changes, such as new features, configuration impacts, or behavior changes affecting users.
Body:

  Indicates if some particular queue of the runqueue is empty.

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit a31193172cb98bd1fb242555ca8e122efff74258)


   sys/kern/kern_switch.c | 28 ++++++++++++++++++++++++++++
   sys/kern/sched_ule.c   |  2 +-
   sys/sys/runq.h         |  1 +
   3 files changed, 30 insertions(+), 1 deletion(-)

[commit bd97078d704b59341bc05674e89e4d0c9eb2351e]
Date: 2024-03-01
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: Tidy up and rename runq_setbit() and runq_clrbit()
Review: Internal refactoring and renaming of scheduler functions with no user-visible impact.
Body:

  Factorize common sub-expressions in a separate helper (runq_sw_apply())
  for better readability.

  Rename these functions so that the names refer to the use cases rather
  than the implementations.

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit 757bab06fb59abca8b7fda38e8f546ff7c2d3280)


   sys/kern/kern_switch.c | 104 ++++++++++++++++++++++++++++++++++++-------------
   1 file changed, 76 insertions(+), 28 deletions(-)

[commit bfd59136bece048f2c4646d6e7a1ba48a3ce7a36]
Date: 2024-02-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: runq_check(): Re-implement on top of runq_findq()
Review: Internal kernel scheduler refactoring with no user-visible impact.
Body:

  Remove one more loop and duplicated code, with the benefit of less
  instruction cache pollution at the expense of a few cycles more for the
  function calls and computing 'idx' (however, this gives a better
  diagnostic message).

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit de78657a3aef3c2efbcbdf9ea73a95283c91fab0)


   sys/kern/kern_switch.c | 16 +++++++---------
   1 file changed, 7 insertions(+), 9 deletions(-)

[commit de0e1a3abf8b144650173e639337c31a3eaf874f]
Date: 2024-02-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: Revamp runq_find*(), new runq_find_range()
Review: Internal scheduler functions are renamed and refactored, with no direct user-visible impact.
Body:

  Rename existing functions to use the simpler prefix 'runq_findq' instead
  of 'runq_findbit' (that they work on top of bit runs is an
  implementation detail).

  Add runq_findq_range(), which takes a range of indices to operate on
  (bounds included).  This is in preparation for changing ULE to use
  a single runqueue, since it needs to treat the timesharing range
  differently.

  Rename runq_findbit_from() to runq_findq_circular(), which is more
  descriptive.

  To reduce code duplication, have runq_findq() and runq_findq_circular()
  leverage runq_findq_range() internally.  For the latter, this also
  brings a small algorithmic improvement, since previously the second pass
  (from queue 0) would cover the whole runqueue if it was completely
  empty, scanning again empty queues after the start index.

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit 439dc920f2d88e3fe2869a2845f15d8ab44cc051)


   sys/kern/kern_switch.c | 101 ++++++++++++++++++++++++++++---------------------
   1 file changed, 58 insertions(+), 43 deletions(-)

[commit 60608708247207a69d3ec88e4cb05b066d3f3b74]
Date: 2024-03-01
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: Re-order functions more logically
Review: Internal code reorganization with no functional changes.
Body:

  No code change in moved functions.

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit 200fc93dace76cf251460adc58ca809c36031f3e)


   sys/kern/kern_switch.c | 201 +++++++++++++++++++++++++------------------------
   sys/sys/runq.h         |   7 +-
   2 files changed, 105 insertions(+), 103 deletions(-)

[commit 000ffb6f24c498bc665b887fafdd1bd4e96f598f]
Date: 2024-04-23
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: More macros; Better and more consistent naming
Review: Internal macro renaming and code refactoring for runq status words; no user-visible changes.
Body:

  Most existing macros have ambiguous names regarding which index they
  operate on (queue, word, bit?), so have been renamed to improve clarity.
  Use the 'RQSW_' prefix for all macros related to status words, and
  change the status word type name accordingly.

  Rename RQB_FFS() to RQSW_BSF() to remove confusion about the return
  value (ffs*() return bit indices starting at 1, or 0 if the input is 0,
  whereas BSF on x86 returns 0-based indices, which is what the current
  code assumes).  While here, add a check (under INVARIANTS) that
  RQSW_BSF() isn't called with 0 as an argument.

  Also, rename 'rqb_bits_t' to the more concise 'rqsw_t', 'struct rqbits'
  to 'struct rq_status', its 'rqb_bits' field to 'rq_sw' (it designates an
  array of words, not bits), and the type 'rqhead' to 'rq_queue'

  Add macros computing a queue index from a status word index and a bit in
  order to factorize code.  If the precise index of the bit is known,
  callers can use RQSW_TO_QUEUE_IDX() to get the corresponding queue
  index, whereas if they want the one corresponding to the first
  (least-significant): set bit in a given status word (corresponding to
  the non-empty queue with lower index in the status word), they can use
  RQSW_FIRST_QUEUE_IDX() instead.

  Add RQSW_BIT_IDX(), which computes the correspond bit's index in the
  corresponding status word.  This allows more code factorization (even if
  most uses will be eliminated in a later commit) and makes what is
  computed clearer.

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit 7e2502e3dec989ea31e5300ade759a721718548d)


   sys/kern/kern_switch.c | 114 ++++++++++++++++++++++++-------------------------
   sys/kern/sched_4bsd.c  |   2 +-
   sys/kern/sched_ule.c   |  56 ++++++++++++------------
   sys/sys/runq.h         |  40 ++++++++++-------
   4 files changed, 111 insertions(+), 101 deletions(-)

[commit b6e0a4f51747375dfe80fda19a64930912a8ac33]
Date: 2024-03-01
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: Clarity and style pass
Review: No user-visible changes; commit is a style and clarity cleanup with no functional impact.
Body:

  In runq_choose() and runq_choose_fuzz(), replace an unnecessary 'while'
  with an 'if', and separate assignment and test of 'idx' into two lines.

  Add missing parentheses to one 'sizeof' operator.

  Remove superfluous brackets for one-line "then" and "else" branches (to
  match style elsewhere in the file).

  Declare loop indices in their 'for'.

  Test for non-empty bit sets with an explicit '!= 0'.

  Move TABs in some prototypes of <sys/runq.h> (should not split the
  return type specifier, but instead separate the type specifier with the
  function declarator).

  No functional change intended.

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit 57540a0666f6bfebf55c905dceac36230c0743c5)


   sys/kern/kern_switch.c | 24 ++++++++++++------------
   sys/sys/runq.h         |  6 +++---
   2 files changed, 15 insertions(+), 15 deletions(-)

[commit 55731b34c3ffa651c7b4bb78ff797e58d95a8b59]
Date: 2024-02-27
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: API tidy up: 'pri' => 'idx', 'idx' as int, remove runq_remove_idx()
Review: Internal scheduler API refactoring with no functional changes or user-visible impact.
Body:

  Make sure that external and internal users are aware that the runqueue
  API always expects queue indices, and not priority levels.  Name
  arithmetic arguments in 'runq.h' for better immediate reference.

  Use plain integers to pass indices instead of 'u_char' (using the latter
  probably doesn't bring any gain, and an 'int' makes the API agnostic to
  a number of queues greater than 256).  Add a static assertion that
  RQ_NQS can't be strictly greater than 256 as long as the 'td_rqindex'
  thread field is of type 'u_char'.

  Add a new macro CHECK_IDX() that checks that an index is non-negative
  and below RQ_NQS, and use it in all low-level functions (and "public"
  ones when they don't need to call the former).

  While here, remove runq_remove_idx(), as it knows a bit too much of
  ULE's internals, in particular by treating the whole runqueue as
  round-robin, which we are going to change.  Instead, have runq_remove()
  return whether the queue from which the thread was removed is now empty,
  and leverage this information in tdq_runq_rem() (sched_ule(4)).

  While here, re-implement runq_add() on top of runq_add_idx() to remove
  its duplicated code (all lines except one).  Introduce the new
  RQ_PRI_TO_IDX() macro to convert a priority to a queue index, and use it
  in runq_add() (many more uses will be introduced in later commits).

  While here, rename runq_check() to runq_not_empty() and have it return
  a boolean instead of an 'int', and same for sched_runnable() as an
  impact (and while here, fix a small style violation in sched_4bsd(4)'s
  version).

  While here, simplify sched_runnable().

  While here, make <sys/sched.h> standalone include-wise.

  No functional change intended.

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit a11926f2a5f00b57ebff5bd548c9904b7f6e5800)


   sys/kern/kern_switch.c | 199 ++++++++++++++++++++++++-------------------------
   sys/kern/sched_4bsd.c  |  11 +--
   sys/kern/sched_ule.c   |  37 ++++-----
   sys/sys/runq.h         |  16 ++--
   sys/sys/sched.h        |  11 ++-
   5 files changed, 137 insertions(+), 137 deletions(-)

[commit 3020792db81819455f3b9ad6ca29f420c54e6971]
Date: 2024-03-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: Hide function prototypes under _KERNEL
Review: The commit hides internal kernel structures and function prototypes from userland, which is an internal change without direct user-visible impact. It does not affect user applications, configuration, or behavior.
Body:

  And some structure definitions as well.

  This header really is not supposed to be included by userland, so should
  just error in this case.  However, there is one remaining use for it in
  a test: Getting the value of RQ_PPQ to ensure a big enough priority
  level difference in order to guarantee that a realtime thread preempts
  another.  This use will soon be obsoleted by guaranteeing that
  a realtime thread always preempts another one with lower priority, even
  if the priority level is very close.

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit 28b54827f5c10212de752a8e2c4eaf07170d242c)


   sys/sys/runq.h | 10 +++++++---
   1 file changed, 7 insertions(+), 3 deletions(-)

[commit 3f5f50ca526fd485aacf0198c6f1ecc948e4bade]
Date: 2024-03-27
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: More selective includes of <sys/runq.h> to reduce pollution
Review: Internal header include cleanup with no user-visible impact.
Body:

  <sys/proc.h> doesn't need <sys/runq.h>.  Remove this include and add it
  back for kernel files that relied on the pollution.

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit c21c24adde9822a7f364e131ad7b0c4008723502)


   sys/dev/usb/usb_process.h | 1 -
   sys/kern/kern_switch.c    | 1 +
   sys/kern/sched_4bsd.c     | 1 +
   sys/kern/sched_ule.c      | 1 +
   sys/sys/proc.h            | 1 -
   5 files changed, 3 insertions(+), 2 deletions(-)

[commit fac3e1d3bc1900617c1995289b2eefaf55e96c68]
Date: 2024-02-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: runq: Deduce most parameters, remove machine headers
Review: The commit removes architecture-specific runq headers and simplifies internal runq parameter handling without any user-visible functional changes.
Body:

  The 'runq' machinery now depends on only two settable parameters,
  RQ_MAX_PRIO, the maximum priority number that can be accepted, the
  minimum being 0, and RQ_PPQ, the number of priorities per queue (to
  reduce the number of queues).

  All other parameters are deduced from these ones.  Also, all
  architectures automatically get a runq word that is their natural word.

  RQB_FFS() always was 'ffsl() - 1' except for amd64 where it was
  'bsfq()'.  Now that all these finally call compiler builtins, the
  resulting assembly code is the same, so there is no cost to removing
  this special case.

  After all these changes, <machine/runq.h> headers have no more purpose,
  so remove them.

  While here, fix potentially confusing parameter name for RQB_WORD() and
  RQB_BIT().

  While here, include all necessary headers so that <sys/runq.h> can be
  included standalone.

  No functional change (intended).

  Reviewed by:    kib
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D45387

  (cherry picked from commit 2fefe2c88b31dc7f173c9424f3eb13d49e98d55a)


   sys/amd64/include/runq.h   | 46 --------------------------------------
   sys/arm/include/runq.h     | 46 --------------------------------------
   sys/arm64/include/runq.h   | 50 -----------------------------------------
   sys/i386/include/runq.h    | 46 --------------------------------------
   sys/kern/kern_switch.c     |  6 ++---
   sys/kern/sched_ule.c       |  6 ++---
   sys/powerpc/include/runq.h | 55 ----------------------------------------------
   sys/riscv/include/runq.h   | 44 -------------------------------------
   sys/sys/runq.h             | 25 ++++++++++++++++++---
   9 files changed, 27 insertions(+), 297 deletions(-)

[commit 68d289075c766bd742913023a56569863121021b]
Date: 2025-06-06
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sys/param.h: Split some macros into new <sys/_param.h>
Review: The commit moves macros from man:param.h[9] to a new internal header, which may reduce compile-time dependencies for kernel modules but does not introduce any user-visible changes in behavior, features, or configuration.
Body:

  Goal is to avoid having to include the full <sys/param.h> just to get
  some common useful macros.  More macros can be moved into it as needed.

  This is in preparation for using NBBY and howmany() from <sys/runq.h>.

  Reviewed by:    kib, imp (both older version)
  MFC after:      1 month
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50880

  (cherry picked from commit b93161a7e38d37ce560ca562b1f1c18f73551cc2)


   sys/sys/_param.h | 28 ++++++++++++++++++++++++++++
   sys/sys/param.h  | 15 ++-------------
   2 files changed, 30 insertions(+), 13 deletions(-)

[commit f72c7affddfe2c97cb8b3fd11a4dbf03ef69c9ff]
Date: 2025-07-24
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: pom.6: add a more complete bibliography
Review: The commit adds a more complete bibliography to the man: pom.6 man page, enhancing the documentation for users.
Body:

  Source: Wikipedia
  <https://en.wikipedia.org/wiki/Practical_Astronomy_with_Your_Calculator>

  (cherry picked from commit bf0ee5f2175a3c6eb52f9fc74b93b445d37a6086)


   usr.bin/pom/pom.6 | 10 ++++++++--
   1 file changed, 8 insertions(+), 2 deletions(-)

[commit 4f2140aa96773ac6f9d4f63290d79b4b9a6d48bf]
Date: 2025-07-25
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Docs.manpages
Subject: crash.8: update a little
Review: The man:crash[8] manual page is updated to reflect current system behavior, removing references to obsolete panic messages and updating guidance on recovery media.
Body:

  Replace "cannot mount root" (which is no longer a panic) with a brief
  description of the mountroot> prompt, and recommend using "system
  install media" rather than the fixit floppy.

  Remove "timeout table full" entirely since this panic no longer exists.

  MFC after:	3 days
  Reviewed by:	ziaee
  Differential Revision:	https://reviews.freebsd.org/D51512

  (cherry picked from commit c9868af774ec24bcf6914fc971378e9723eb44ab)


   share/man/man8/crash.8 | 32 ++++++++++++++------------------
   1 file changed, 14 insertions(+), 18 deletions(-)

[commit 44a5649bc3a25b9e18980b80ecbbd8df41244d19]
Date: 2025-07-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: tests/sys/net/if_bridge_test: fix MTU test
Review: The commit fixes a test script for bridge MTU testing but does not introduce any user-visible changes, new features, or configuration impacts.
Body:

  "ifconfig gif0 ether" doesn't return any output, so this wasn't
  correctly checking the MTU on the gif interface.  Remove "ether".

  Reviewed by:	zlei, kp
  Differential Revision:	https://reviews.freebsd.org/D51245

  (cherry picked from commit e6ef675de261b15ed66d434d054a6e5e69308ce5)


   tests/sys/net/if_bridge_test.sh | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 83a352bcac0a72feb04e441b5a54ad7f63f9922a]
Date: 2025-07-12
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Netflix
Section: Network.general
Subject: lagg: Fix if_hw_tsomax_update() not being called
Review: The lagg driver now correctly updates TSO maximum segment size when interface capabilities differ between members in a mixed aggregation.
Body:

  In a mixed lagg, its likely that ifcaps or hwassist may not
  match between members.  If this is true, the logical OR will
  be short-circuited and if_hw_tsomax_update() will not be called.

  Fix this by calling it inside the body of the if as well

  Sponsored by: Netflix

  (cherry picked from commit 78bdaa57cfbac759a6d79ecad2fae570e294a4b3)


   sys/net/if_lagg.c | 1 +
   1 file changed, 1 insertion(+)

[commit a04e1adff054e0bb644759b39b54d4c172655801]
Date: 2025-07-22
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.config
Subject: devd.conf(5): call hyperv_vfattach in a Hyper-V guest only
Review: The hyperv_vfattach script is now only called in Hyper-V guests, preventing unnecessary execution on non-Hyper-V systems.
Body:

  Limit calls to /usr/libexec/hyperv/hyperv_vfattach to Hyper-V guests.

  PR:		287873

  (cherry picked from commit d4a0e749cc66cd5d019d8fb8f43427109aef4c9f)


   sbin/devd/hyperv.conf | 1 +
   1 file changed, 1 insertion(+)

[commit bbe75ea73442651b8e6277984b817308663193b6]
Date: 2025-07-18
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Netflix
Section: Userland.programs
Subject: devd: Add vm_guest variable
Review: The devd daemon now detects whether it is running under a hypervisor and sets the vm_guest variable accordingly. This may affect hypervisor-specific configuration or behavior in devd rules.
Body:

  Fetch vm_guest on startup in case we're running under a hypervisor.

  Co-authored-by: eugen@
  PR: 287873
  Sponsored by:		Netflix

  (cherry picked from commit bd4a4e46ceacd8dfc5a5469ec6edd8c92c53605a)


   sbin/devd/devd.cc | 11 +++++++++++
   1 file changed, 11 insertions(+)

[commit 823b81ac9c75f4c86b8e85e12bf1f0219ae59608]
Date: 2025-07-19
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: memchr.3: mention the len argument in the functions description
Review: The man:memchr[3] manual page now mentions the len argument in the function description.
Body:

  (cherry picked from commit 441995e161a2564d37947d054a2f1219754deb5f)


   lib/libc/string/memchr.3 | 16 +++++++++++-----
   1 file changed, 11 insertions(+), 5 deletions(-)

[commit 1c250e04505f0d3e9b103fa22fe1cf103182a695]
Date: 2025-07-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: rtld: do not relocate tlsinit address twice
Review: The dynamic linker no longer relocates the TLS initialization address twice, preventing potential crashes or misbehavior in programs with thread-local storage.
Body:

  PR:	288334

  (cherry picked from commit db9ef9d5f517a14160bb3d0a599b8392e01fb400)


   libexec/rtld-elf/map_object.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d0d92b35d5404243dc25dee8cf12b75288e0eacb]
Date: 2025-05-23
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: bsdinstall: restore the environment when restarting
Review: The installer now resets environment variables when restarting, allowing users to re-enter values like mirror selection instead of being stuck with previous choices.
Body:

  It is possible to restart the installation process upon errors, when
  installing normally through the `auto` script, or when installing a jail
  with the `jail` script. However, some values obtained interactively from
  the user or guessed by some scripts were kept in the environment when
  restarting the process; this made it impossible to re-run some steps as
  expected after the restart.

  For instance, if a bad choice of mirror was made in the `mirrorselect`
  phase, restarting the installer remembered the choice made, and would
  never prompt for a different one again. Rebooting was then the only easy
  way out of this situation.

  This change restores a pre-defined list of environment variables when
  restarting the installation process.

  PR:		266987
  Reviewed by:	emaste
  Approved by:	philip (mentor)
  Sponsored by:	The FreeBSD Foundation
  Differential revision:	https://reviews.freebsd.org/D42281

  (cherry picked from commit 9de72af2cceb6fc4aead0990cccdf565531bc248)


   usr.sbin/bsdinstall/scripts/auto | 33 ++++++++++++++++++++++++++
   usr.sbin/bsdinstall/scripts/jail | 51 ++++++++++++++++++++++++++++++++++++----
   2 files changed, 80 insertions(+), 4 deletions(-)

[commit 986c43bd80e750937d02966883b3182ded828c97]
Date: 2025-07-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: certctl: Add an option to copy files.
Review: The man:certctl[8] utility gains a new option to copy certificate files instead of creating symbolic links. This allows certctl to work in all cases, including when run from outside a jail that lacks the raw certificate data.
Body:

  This is slower than linking but is the only method that works for all
  cases, including running certctl from outside a jail that does not
  contain the raw certificate data.

  While here, fix a bug that occurs in unprivileged mode if DESTDIR
  is unset or the root directory.

  MFC after:	1 week
  Reviewed by:	dfr
  Differential Revision:	https://reviews.freebsd.org/D51373

  (cherry picked from commit 92b9f43c788da24d2d8376a50953ef67c2303ba7)


   usr.sbin/certctl/certctl.8  | 10 ++++++----
   usr.sbin/certctl/certctl.sh | 22 +++++++++++-----------
   2 files changed, 17 insertions(+), 15 deletions(-)

[commit 6a21ccee94eefc22692b9aa267a27f4776f775f9]
Date: 2025-07-18
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Klara, Inc. | NetApp, Inc.
Section: Userland.contrib
Subject: tzcode: Fix time zone change detection.
Review: Fixes a regression in time zone change detection that could cause incorrect time zone data to be used after updates.
Body:

  Prior to the 2022g import, tzloadbody() returned -1 on error.  Now it
  returns an errno code.  When I updated the time zone change detection
  logic to match, I improperly returned errno in all cases, which means
  that if the time zone file has not changed since we last loaded it,
  tzloadbody() returns a random errno value instead of 0.

  Fixes:		bc42155199b5
  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Sponsored by:	NetApp, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D51405

  (cherry picked from commit d63ffdd1ef6368407b35d415237b95cc739d8073)

  tzcode: Add an explicit "the timezone file has changed" case

  This is required for the WITHOUT_DETECT_TZ_CHANGES case, since there the
  value being tested is a numeric literal.

  Fixes:	d63ffdd1ef63 ("tzcode: Fix time zone change detection.")
  (cherry picked from commit 0bf113e9041fe20e8c671fe6b2cca8612dc77b77)


   contrib/tzcode/localtime.c | 16 +++++++---------
   1 file changed, 7 insertions(+), 9 deletions(-)

[commit 99dfaac790a3f252d38d1fbe4b3ec2e19f23127f]
Date: 2025-07-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: udf: Improve input validation.
Review: The commit improves input validation in the UDF filesystem to prevent overflow issues and fixes two struct definitions. This enhances stability and security when handling malformed UDF media.
Body:

  The existing code frequently assigns unsigned 64-bit values to variables
  that are signed and / or shorter without checking for overflow.  Try to
  deal with these cases.

  While here, fix two structs that used single-element arrays in place of
  flexible array members.

  PR:		287896
  MFC after:	1 week
  Reviewed by:	imp
  Differential Revision:	https://reviews.freebsd.org/D51339

  (cherry picked from commit 55f80afa17e8926f69660f19631194bcf7fa66f4)


   sys/fs/udf/ecma167-udf.h |  4 ++--
   sys/fs/udf/udf_vfsops.c  |  7 ++++++-
   sys/fs/udf/udf_vnops.c   | 48 ++++++++++++++++++++++++++++++++++++------------
   3 files changed, 44 insertions(+), 15 deletions(-)

[commit 91a6bf215cb13e40b80e54ad5194c9aaf777cc3c]
Date: 2025-07-09
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Klara, Inc.
Section: Userland.contrib
Subject: kyua: Try harder to delete directories.
Review: The kyua test framework now attempts to set directory permissions to 0700 before deletion, allowing it to clean up after test cases that create unwriteable directories. This resolves a failure when debugging such tests.
Body:

  When recursing into a directory to delete it, start by chmod'ing it to
  0700.  This fixes an issue where kyua is able to run, but not debug, a
  test case that creates unwriteable directories, because when debugging
  it tries (and fails) to delete the directory after the test completes.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	igoro
  Differential Revision:	https://reviews.freebsd.org/D51229

  (cherry picked from commit 9bf14f2a475e221c48488984dc5a02a4608bb877)


   contrib/kyua/utils/fs/operations.cpp      |  2 ++
   contrib/kyua/utils/fs/operations_test.cpp | 14 ++++++++++++++
   2 files changed, 16 insertions(+)

[commit 442f01cb8860226685e378c222a57614d941825d]
Date: 2025-07-17
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Storage.general
Subject: msdosfs: replace '/' in direntries with '?'
Review: The msdosfs filesystem now replaces forward slash ('/') characters in directory entries with question marks ('?') to maintain compatibility with FAT filesystem naming restrictions. This prevents creation of filenames that would be invalid on FAT volumes.
Body:

  PR:	288266

  (cherry picked from commit 29af6d2e2ec9fe8df7cf1e1a0bf3597028831b18)


   sys/fs/msdosfs/msdosfs_conv.c | 11 +++++++++--
   1 file changed, 9 insertions(+), 2 deletions(-)

[commit f0a7a1bda3752c906ef732e89c00371a3ba0760f]
Date: 2025-01-28
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: ConnectWise
Section: Userland.programs
Subject: fstat: identify kqueue, mqueue, and procdesc file descriptors
Review: The man:fstat[1] utility now identifies kqueue, mqueue, and procdesc file descriptors by type instead of showing an "unknown file type" warning.
Body:

  When displaying kqueue, mqueue, and procdesc file descriptors, identify
  them as such.  There aren't any details, but it's better than a scary
  warning like "unknown file type 15 for file 6 of pid 26393".

  Sponsored by:	ConnectWise
  Differential Revision: https://reviews.freebsd.org/D48706

  (cherry picked from commit b3168306a13b9d95c2b01bf7a483c1af9ec0d797)


   usr.bin/fstat/fstat.c | 12 ++++++++++++
   1 file changed, 12 insertions(+)

[commit 6f433f2b4f376c963a456eedf8c690e98d07188d]
Date: 2024-12-18
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: ConnectWise
Section: Storage.general
Subject: fusefs: fix a panic in vop_close with a CTL consumer
Review: The FUSE file system no longer panics when closing a file opened by a CTL kernel consumer with atime enabled on the mountpoint.
Body:

  Kernel consumers like CTL may lack ucred objects.  That led to a panic
  when CTL closed a fuse file, if atime was enabled on the mountpoint.
  Fix it by checking the ucred during close.

  PR:		283402
  Sponsored by:	ConnectWise
  Differential Revision: https://reviews.freebsd.org/D48165

  (cherry picked from commit 9350e9236242f51c88b3e5c19ceeae7869b9cf83)


   sys/fs/fuse/fuse_vnops.c     |  3 ++
   tests/sys/cam/ctl/ctl.subr   | 18 ++++++++++--
   tests/sys/fs/fusefs/Makefile |  5 ++++
   tests/sys/fs/fusefs/ctl.sh   | 69 ++++++++++++++++++++++++++++++++++++++++++++
   4 files changed, 93 insertions(+), 2 deletions(-)

[commit 5a8d8ffd7c8d3f7f09f18fc53e7c74ec6ef6698b]
Date: 2025-01-15
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: ConnectWise
Section: Storage.general
Subject: fusefs: add more checks for buggy FUSE servers
Review: FUSE file systems now perform additional validation when NFS-exported. The system checks that FUSE_LOOKUP operations for "." return the expected nodeid and that nodeid and inode numbers match. Mismatches cause operation failures with warnings to the operator.
Body:

  * If a FUSE file system is NFS-exported (either by a kernel or userspace
    NFS server), then it must support FUSE_LOOKUP operations for ".".  But
    if the response reports a different nodeid than the request, that's
    very bad.  Fail the operation and warn the operator.

  * In general, a FUSE file may have a distinct "nodeid" and "inode
    number".  But it the file system is NFS-exported (either by a kernel
    or userspace NFS server), then those two must match, because the NFS
    server will do VFS_VGET operations using the inode number.  If they
    don't match, warn the operator.

  Sponsored by:	ConnectWise
  Differential Revision: https://reviews.freebsd.org/D48471

  (cherry picked from commit f1ec3bc06ed276e6e24996515bdce729d51e11d8)


   sys/fs/fuse/fuse_ipc.h                   |   2 +
   sys/fs/fuse/fuse_node.c                  |  19 ++++++
   sys/fs/fuse/fuse_vfsops.c                |  13 ++++
   tests/sys/fs/fusefs/last_local_modify.cc |   5 +-
   tests/sys/fs/fusefs/lookup.cc            |   7 ++
   tests/sys/fs/fusefs/nfs.cc               | 106 +++++++++++++++++++++++++++++++
   6 files changed, 149 insertions(+), 3 deletions(-)

[commit 34a893a0ab1050db08c0c4cbd21261537b779549]
Date: 2025-06-05
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: ConnectWise
Section: Storage.general
Subject: fusefs: Fix a panic when unmounting before init
Review: Fixes a kernel panic in man:fusefs[4] that could occur when unmounting before the FUSE_INIT handshake completes, preventing a page fault under specific timing conditions.
Body:

  fusefs would page fault due to the following sequence of events:
  * The server did not respond to FUSE_INIT in timely fashion.
  * Some other process tried to do unmount.
  * That other process got killed by a signal.
  * The server finally responded to FUSE_INIT.

  PR:		287438
  Sponsored by:	ConnectWise
  Reviewed by:	arrowd
  Differential Revision: https://reviews.freebsd.org/D50799

  (cherry picked from commit cc9c213086795fd821e6c17ee99a1db81a2141b2)


   sys/fs/fuse/fuse_internal.c     |   3 +
   tests/sys/fs/fusefs/Makefile    |   1 +
   tests/sys/fs/fusefs/mockfs.cc   |  18 +++--
   tests/sys/fs/fusefs/mockfs.hh   |   6 +-
   tests/sys/fs/fusefs/pre-init.cc | 154 ++++++++++++++++++++++++++++++++++++++++
   tests/sys/fs/fusefs/utils.cc    |   3 +-
   tests/sys/fs/fusefs/utils.hh    |   2 +
   7 files changed, 179 insertions(+), 8 deletions(-)

[commit 0a0d323157cb54970b5c525db307c17c2e7ff864]
Date: 2025-06-05
Score: 5
Status: proposed(include=no,score=5)
Sponsor: ConnectWise
Section: undecided
Subject: fusefs: delete dead code
Review: This commit removes commented-out code from the fusefs implementation, which does not affect user-visible behavior or functionality.
Body:

  These lines have been commented out ever since the first import of fuse.
  The intention seems to be for the original developer to experiment with
  different error handling strategies, but they're very obsolete by now.
  Delete them.

  MFC after:	2 weeks
  Sponsored by:	ConnectWise

  (cherry picked from commit 7ce93195ddb30b371022ae3adbd9bd24189e1444)


   sys/fs/fuse/fuse_ipc.c   | 5 -----
   sys/fs/fuse/fuse_vnops.c | 4 +---
   2 files changed, 1 insertion(+), 8 deletions(-)

[commit f1e63fcb0c4a52d040f3ca9513043c799259471b]
Date: 2025-06-05
Score: 5
Status: proposed(include=no,score=5)
Sponsor: ConnectWise
Section: undecided
Subject: fusefs: revert a workaround for a googletest bug
Review: The commit removes a workaround for a googletest bug that was fixed in 2019, affecting only internal test code with no user-visible impact.
Body:

  This bug was fixed by googletest back in 2019 and released in googletest
  1.10.0, I think.  Using GTEST_SKIP from a test environment works now.

  https://github.com/google/googletest/issues/2189

  MFC after:	2 weeks
  Sponsored by:	ConnectWise

  (cherry picked from commit 35c4ea02cb9fe199dd88b19cf51fef56838c8cba)


   tests/sys/fs/fusefs/utils.cc | 9 +--------
   1 file changed, 1 insertion(+), 8 deletions(-)

[commit 0432511d3ff6f72abc2de326c47a69a0e0be6512]
Date: 2025-05-30
Score: 5
Status: proposed(include=no,score=1)
Sponsor: ConnectWise
Section: undecided
Subject: fusefs: correct a comment in the tests
Review: Only a comment in a test file is corrected, with no user-visible impact.
Body:

  It's been wrong ever since the original commit in 2019.

  [skip ci]

  MFC after:	1 week
  Sponsored by:	ConnectWise

  (cherry picked from commit 7f07575084a279c7f0cc330fe7e2c04d5a05a487)


   tests/sys/fs/fusefs/destroy.cc | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a1df3755a5fa544d05410bbac0e7b06fcb284df8]
Date: 2025-07-03
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Drivers.device
Subject: mlx5en: fix TLS Rx hardware offload initialization
Review: The mlx5en driver now correctly initializes TLS Rx hardware offload, enabling encrypted traffic acceleration for supported Mellanox network cards.
Body:

  (cherry picked from commit d6d66936c45e99ec284554292181d26b6a5558d3)


   sys/dev/mlx5/mlx5_en/mlx5_en_hw_tls_rx.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit ce1af6eb54a423af66054e3775bc71bb09c96b41]
Date: 2025-06-14
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: capsicum.4: Add some more detail from the Capsicum paper
Review: The man:man4/capsicum.4 manual page now includes additional details and language adapted from the Capsicum research paper, providing more comprehensive documentation of the capability-based security framework.
Body:

  Adapt some language from "Capsicum: practical capabilities for UNIX"
  https://www.cl.cam.ac.uk/research/security/capsicum/papers/2010usenix-security-capsicum-website.pdf

  Reviewed by:	markj
  Discussed with:	rwatson
  Event:		Kitchener-Waterloo Hackathon 202506
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50855

  (cherry picked from commit c54534e60263954fac4db5ebb041ed4597df1195)
  (cherry picked from commit ce65ff203a4f7ce59c8782f87d90a657f7ccbc46)


   share/man/man4/capsicum.4 | 47 ++++++++++++++++++++++++++++++++++++++++++++++-
   1 file changed, 46 insertions(+), 1 deletion(-)

[commit f58fb8abc465303ec756b15ef1c8f0e75a33067b]
Date: 2025-06-05
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: capsicum.4: Add capsicum_helpers and libcasper references
Review: The man:casperd[8] daemon and man:capsicum_helpers[3] library are now documented in the SEE ALSO section of man:capsicum[4].
Body:

  These were present in the SEE ALSO section but were not explicitly
  mentioned.  Add a brief description of both.

  Reviewed by:	ziaee
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50707

  (cherry picked from commit 6d46fd2cbea43002689ae1a8a0e388e9774da1bc)


   share/man/man4/capsicum.4 | 16 +++++++++++++++-
   1 file changed, 15 insertions(+), 1 deletion(-)

[commit b84dd938c9130a0416a5c55fc0d012ecafc5b231]
Date: 2025-06-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: linuxkpi: Remove incorrect + 1 from HWEIGHT* macros
Review: The commit fixes an internal macro in the LinuxKPI compatibility layer, which is an internal kernel component with no direct user-visible impact.
Body:

  Fixes: 4cc8a9da491d ("LinuxKPI: add HWEIGHT32()")
  Reviewed by:	bz
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D51010

  (cherry picked from commit cdbff1b2999660b31b2de076d04670722a555ed2)


   sys/compat/linuxkpi/common/include/linux/bitops.h | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 786f7133b513a856fd8d468c2cf8dd8ffedde59b]
Date: 2025-06-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sys: Correct osreldate descriptions
Review: The kern.osreldate sysctl description is corrected to state it reports the kernel version, not a release date.
Body:

  The kern.osreldate sysctl reports the kernel version, not a release
  date.  Also correct a comment about /usr/include/osreldate.h.

  Reviewed by:	kp, olce
  Event:		Kitchener-Waterloo Hackathon 202506
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50938

  (cherry picked from commit 5110a74afe5680882e3274d57da881511ea7c440)


   sys/kern/kern_mib.c | 5 ++---
   1 file changed, 2 insertions(+), 3 deletions(-)

[commit c477deccbfc2dfb91e1bca12950bb8d7567d9a8a]
Date: 2025-07-05
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: mgb: Fix mac tx disable bug in teardown
Review: Fixes a bug in the mgb driver that could cause issues during interface teardown by ensuring the MAC transmitter is properly disabled.
Body:

  Signed-off-by: jefby <jef199006@gmail.com>
  Reviewed-by: emaste
  Pull-request: https://github.com/freebsd/freebsd-src/pull/1755
  (cherry picked from commit 5f9a73c22fea8973e047477853529feaedea6fe6)


   sys/dev/mgb/if_mgb.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 9fa537692fa1b3bcb5ce436b8b755e2b6cff5dcb]
Date: 2025-07-14
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: bsdinstall: wlanconfig: ensure the interface is always up for scanning
Review: The wlanconfig script in bsdinstall now ensures the wireless interface is up before scanning, improving reliability of wireless network detection during installation.
Body:

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	thj (earlier), emaste
  Differential Revision: https://reviews.freebsd.org/D51312

  (cherry picked from commit 153e73d782f3f1b06c502a708a3b30236ab332bd)


   usr.sbin/bsdinstall/scripts/wlanconfig | 6 ++++++
   1 file changed, 6 insertions(+)

[commit a94dd3955a9f7ae51da152c31a4565c1a040c83c]
Date: 2025-07-14
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: bsdinstall: wlanconfig: properly format regdomain dialog input
Review: The bsdinstall wlanconfig script now correctly formats the regdomain dialog input, preventing a misleading error when configuring wireless regulatory domains during installation.
Body:

  Without the extra '\n' the dual-column ('REGD' '') are not properly
  separated for dialog which leads to an [misleading] error hidden on
  the command line:
  	Error: --menu bad arguments items number.
  [Writing this I wonder why the dual-column input is needed].

  It is still unclear as to where the error message quoted in PR287538
  suddenly came from for 14.3-RELEASE given the code was broken since 2016
  (or noone ever noticed or reported).

  Looking at manual ifconfig output:
      ifconfig wlan0 country GB regdomain Expected
      -> ifconfig: unknown regdomain Expected
  and "ifconfig: " gets stripped by the script, which means the regdomain
  variable would have to be set to "Expected" or more likely to
  "Expected eval: Use: not found" which looks like a concatination of
  errors.

  Sponsored by:	The FreeBSD Foundation
  Fixes:		95ee591e83a91
  PR:		287538
  Reviewed by:	emaste, thj
  Differential Revision: https://reviews.freebsd.org/D51313

  (cherry picked from commit 5a1e2927d63ed6394b767088eb2d66676f275467)


   usr.sbin/bsdinstall/scripts/wlanconfig | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 337c3e9859e7b5d971e84bf546a51c2cf9a9e44f]
Date: 2025-07-20
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: if_genet: Plug memory leaks
Review: Fixes a memory leak in the man:genet[4] driver when destroying DMA mappings.
Body:

  The rx_buf_tag should be checked when destroying rx dma mappings.

  PR:		288309
  Reviewed by:	zlei
  Submitted by:	Mike Belanger <mibelanger@qnx.com>
  MFC after:	3 days

  (cherry picked from commit f46e95ae3addc9f7b975c187f71125825a38ffb1)


   sys/arm64/broadcom/genet/if_genet.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 97d5f16c6966e2ae261ddabe1f16a9675dedf43a]
Date: 2025-07-20
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: if_genet: Consistently use the boolean form
Review: No functional change; only a style fix.
Body:

  The variable eaddr_found is declared as bool. This change improves
  readability a little.

  No functional change intended.

  MFC after:	3 days

  (cherry picked from commit 2fc051d090933203e1af6a8452cdd87a4c76ad5b)


   sys/arm64/broadcom/genet/if_genet.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6e211ff4902a4cab3552b7bc21b9688a7f0e6dbd]
Date: 2025-07-08
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.libraries
Subject: libc/powerpc64: Fix swapcontext(3)
Review: The swapcontext(3) function on PowerPC64 platforms no longer crashes when restoring linked contexts. This fixes a crash that occurred during context switching with uc_link != NULL.
Body:

  On PowerPC platforms a valid link to the Table of Contents (TOC) is
  required for PLT lookups to function.  This TOC pointer is stored in
  a dedicated register, and is used along with the stack pointer by both
  C prologue and PLT lookup code.

  When calling swapcontext() with uc_link != NULL, a PLT lookup to
  setcontext(3) is attempted from within the _ctx_done context.  The
  exiting process has usually trashed both r1 and r2 at this point,
  leading to a crash within the PLT lookup before setcontext(2) is
  reached to restore the linked context.

  Save and restore r2 as in a regular function.  This ensures the
  subsequent PLT lookup to setcontext(3) succeeds.

  Signed-off-by: Timothy Pearson <tpearson@raptorengineering.com>

  MFC after:	1 week
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1759

  (cherry picked from commit 8efa35fea384d209c683dfbae8f49f2737a41941)


   lib/libc/powerpc64/gen/_ctx_start.S   | 14 ++++++++
   lib/libc/powerpc64/gen/makecontext.c  |  3 +-
   lib/libc/tests/sys/Makefile           |  4 +--
   lib/libc/tests/sys/swapcontext_test.c | 63 +++++++++++++++++++++++++++++++++++
   4 files changed, 81 insertions(+), 3 deletions(-)

[commit 90a9ce456740d9e2ef20e781e5a57f5d611d1c83]
Date: 2025-07-06
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Hardware.virtualization
Subject: powerpc: Fix multiple issues with FP/VSX save/restore
Review: Fixes register corruption and loss of floating-point and VSX register contents in high-signal-load scenarios on powerpc, particularly affecting Go programs. The FPU state management is corrected to prevent race conditions during signal return.
Body:

  Multiple issues existed within the powerpc FP/VSX save/restore functionality,
  leading to register corruption and loss of register contents in specific
  scenarios involving high signal load and use of both floating point and VSX
  instructions.

  Issue #1

  On little endian systems the PCB used the wrong location for the shadowed
  FP register within the larger VSX register.  This appears to have been an
  attempt to correct issue #2 without understanding how the vector load/store
  instructions actually operate.

  Issue #2

  On little endian systems, the VSX state save/restore routines swapped 32-bit
  words within the 64-bit aliased double word for the associated floating point
  register.  This was due to the use of a word-oriented load/store vs. doubleword
  oriented load/store.

  Issue #3

  The FPU was turned off in the PCB but not in hardware, leading to a potential
  race condition if the same thread was scheduled immediately after sigreturn.

  The triggering codebase for this is Go, which makes heavy use of signals and
  and generates an unusual mix of floating point and VSX assembler.  As a result,
  when combined with th powerpc lazy FPU restore, a condition was repeatedly hit
  whereby the thread was interrupted in FP+VSX mode, then restored in FP only
  mode, thus reliably triggering the issues above.

  Also clean up the associated asm() style issue flagged by GitHub Actions.

  Signed-off-by: Timothy Pearson <tpearson@raptorengineering.com>

  MFC after:	1 week
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1756

  (cherry picked from commit 077e30e61d7e1c90af7df31989bb976a3ace0c69)


   sys/powerpc/include/pcb.h          | 10 +---------
   sys/powerpc/include/ucontext.h     |  2 ++
   sys/powerpc/powerpc/exec_machdep.c | 33 ++++++++++++++++++++++++---------
   sys/powerpc/powerpc/fpu.c          | 30 ++++++++++++++++++++++++++----
   4 files changed, 53 insertions(+), 22 deletions(-)

[commit e04d629d5394ed85c53febeb8688344236fb9483]
Date: 2025-07-06
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Kernel.general
Subject: powerpc: Reserve correct scratch region size below stack
Review: The commit adjusts the stack scratch region reservation on powerpc to comply with the ELF ABI v2, ensuring correct stack alignment and potential compatibility with software expecting the full reserved region.
Body:

  According to the ELF ABI v2, two scratch regions are reserved below the stack
  pointer, one 288 byte general region and one 224 byte compiler region.

  FreeBSD only reserved the 288 byte region.  Follow the ELV v2 ABI and reserve
  the full 512 byte region as specified.

  Signed-off-by: Timothy Pearson <tpearson@raptorengineering.com>

  MFC after:	1 week
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1756

  (cherry picked from commit 645bb3efc3209a9ca6dfabb48b1c6475c1d965a9)


   sys/powerpc/powerpc/exec_machdep.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit dd695839efd80fe81143cd6c7a552c30df8448f6]
Date: 2025-07-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: route: fix `route -n monitor` when its output is redirected
Review: The man:route[8] command's monitor output now flushes properly when redirected, preventing apparent stalls in output.
Body:

  This is a small oversight in the transition to netlink; the non-netlink
  implementation would explicitly flush its stdout as necessary to avoid
  apparent long stalls in output when we end up fully-buffered.  Adjust
  the netlink implementation to do the same.  This was noticed while
  trying to triage failures in the wg-quick script.

  Commit message by kevans, patch by author.

  PR:		278265
  Fixes:		091fec1188929 ("route: switch transport protocol [...]")

  (cherry picked from commit 97b61b22edba74c62adba1d022fb73541aa5ff93)


   sbin/route/route_netlink.c | 1 +
   1 file changed, 1 insertion(+)

[commit 34f71ebee8bd73d6d7bf56aaddf4aeffd754c8d0]
Date: 2025-06-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: tests: extend wireguard test to cover incremental allowed-ips updates
Review: The wireguard test suite is extended to cover incremental allowed-ips updates, but this is a test-only change with no direct user-visible impact.
Body:

  New +/- syntax in wg(8) allows us to add or remove just a single
  allowed-ip rather than forcing replacement or weird tricks to do an
  atomic removal.  Ensure that it works now that we've added kernel
  support for it.

  Reviewed by:	ivy

  (cherry picked from commit 716b6667b65b50c15900be9f88cc67f2326872b4)


   tests/sys/net/if_wg.sh | 205 +++++++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 205 insertions(+)

[commit e95cf8b04b47ee9abf544bb754452e6f30b2dc18]
Date: 2025-06-25
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.contrib
Subject: wg: ipc: add allowed-ip flags support for FreeBSD
Review: The wireguard-tools package now supports allowed-ip flags for FreeBSD, ensuring compatibility with the kernel's WireGuard implementation.
Body:

  For $reasons, we can't rely on flags in wireguard-tools for the kernel
  side of WireGuard.  Provide a mapping function that uses flags from the
  kernel that we're building against and fail the operation if we made it
  to the end without turning some wg(8) flag off.

  Signed-off-by: Kyle Evans <kevans@FreeBSD.org>

  Reviewed by:	ivy (previous version), Jason A. Donenfeld, jhb

  (cherry picked from commit f6d9e22982a1d0354c0199e94ebdb4474eaa74b9)


   contrib/wireguard-tools/ipc-freebsd.h | 7 ++-----
   1 file changed, 2 insertions(+), 5 deletions(-)

[commit 684dd4e8c0085f4e64016a44d4cd699b2fc29681]
Date: 2025-06-25
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Drivers.device
Subject: kern: wg: add support for removing Allowed-IPs
Review: The WireGuard driver now supports removing individual Allowed-IPs from a peer configuration without replacing the entire set, improving incremental updates and reducing potential traffic disruption.
Body:

  This was recently added to Linux to improve incremental update support,
  as you could previously add Allowed-IPs but not remove without replacing
  the whole set (and thus, potentially disrupting existing traffic).

  Removal is incredibly straightforward; we'll find it in p_aips first
  to ensure that it's actually valid for this peer, then we'll delete it
  from the radix tree before we remove the corresponding p_aips entry.

  Reviewed by:	Jason A. Donenfeld, jhb

  (cherry picked from commit d15d610fac97df4fefed3f14b31dcfbdcec65bf9)
  (cherry picked from commit d1ac3e245f084ee0637bde9a446687621358c418)


   sys/dev/wg/if_wg.c | 72 +++++++++++++++++++++++++++++++++++++++++++++++++++++-
   sys/dev/wg/if_wg.h |  6 +++++
   2 files changed, 77 insertions(+), 1 deletion(-)

[commit d0b6c358e7486ac560f99f9dfb8166f1f5d014e4]
Date: 2025-06-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kern: wg: split address/mask construction out of wg_aip_add()
Review: The commit refactors internal WireGuard driver code without any user-visible changes, such as new features, bug fixes, or configuration impacts.
Body:

  We'll re-use these in a future wg_aip_del() to perfectly reconstruct
  what we expect to find in a_addr/a_mask.

  Reviewed by:	ivy, markj (both earlier version), Aaron LI, jhb

  (cherry picked from commit 2475a3dab0d5c5614e303c0022a834f725e2a078)


   sys/dev/wg/if_wg.c | 63 ++++++++++++++++++++++++++++++++++--------------------
   1 file changed, 40 insertions(+), 23 deletions(-)

[commit 1cacf672e3ee3719b72534347cf7d5ce69cf716f]
Date: 2025-06-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kern: wg: refactor out some repetitive bits in allowed-ip config
Review: Refactoring internal code for WireGuard driver; no user-visible changes.
Body:

  The only difference in the wg_aip_add() call after IP validation is the
  address family.  Just pull that out into a variable and avoid the two
  different callsites for wg_aip_add().  A future change will add a new
  call for each case to remove an address from the peer, so it's nice to
  avoid needing to repeat the logic for two different branches.

  Reviewed by:	Aaron LI, Jason A. Donenfeld, ivy, jhb, markj

  (cherry picked from commit ba2607ae7dff17957d9e62ccd567ba716c168e77)


   sys/dev/wg/if_wg.c | 16 ++++++++++++----
   1 file changed, 12 insertions(+), 4 deletions(-)

[commit 4354f62149b23feb7de04f73c46abc13eb34d63b]
Date: 2025-06-24
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: Klara, Inc.
Section: Docs.manpages
Subject: pkill: better document ancestor-hiding
Review: The man:pgrep[1] and man:pkill[1] manual pages now more prominently document that ancestors are hidden and that the pkill/pgrep command itself is never unhidden.
Body:

  More prominently note that we'll hide ancestors in the first two
  paragraphs that provide an overview of pkill/pgrep.  It also seems
  worth noting in the description of -a that we won't ever unhide the
  pgrep/pkill command itself, as mypid is skipped in all process iteration
  by way of PSKIP().

  Reviewed by:	allanjude, des
  Sponsored by:	Klara, Inc.

  (cherry picked from commit 88a2d48d39d9845e36c8e95a9204001b11e7257e)


   bin/pkill/pkill.1 | 21 ++++++++++++++++++---
   1 file changed, 18 insertions(+), 3 deletions(-)

[commit 462b13ebf6c6d71613ab88464b907e38492cf726]
Date: 2025-06-19
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: kern: send parent a SIGCHLD when the debugger has detached
Review: When a debugger detaches from a traced process, the parent process now receives a SIGCHLD signal with the P_CONTINUED status. This prevents parents from being stuck in man:wait[2] after detaching.
Body:

  The practical scenario that leads to this is porch(1) spawning some
  utility and sending it a SIGSTOP as a debugging aide.  The user then
  attaches a debugger and walks through how some specific input is
  processed, then detaches to allow the script to continue.  When ptrace
  is detached, the process resumes execution but the parent is never
  notified and may be stuck in wait(2) for it to continue or terminate.

  Other platforms seem to re-suspend the process after the debugger is
  detached, but neither behavior seems unreasonable.  Just notifying the
  parent that the child has resumed is a relatively low-risk departure
  from our current behavior and had apparently been considered in the
  past, based on pre-existing comments.

  Move p_flag and p_xsig handling into childproc_continued(), as just
  sending the SIGCHLD here isn't really useful without P_CONTINUED set
  and the other caller already sets these up as well.

  Reviewed by:	kib, markj

  (cherry picked from commit ee9895e10d266b7bb0a25677aee3debdc17ab4bf)


   lib/libc/sys/ptrace.2        | 12 +++++++-
   lib/libc/sys/wait.2          |  8 ++++--
   sys/kern/kern_sig.c          |  5 ++--
   sys/kern/sys_process.c       | 11 +++++--
   tests/sys/kern/ptrace_test.c | 68 ++++++++++++++++++++++++++++++++++++++++++++
   5 files changed, 97 insertions(+), 7 deletions(-)

[commit cd8ab8cecff5eca1b6aaf671a840ee840c8e73c7]
Date: 2025-06-18
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Bootloader.general
Subject: lualoader: adapt builtin brand/logo definitions as well
Review: The lualoader bootloader now adapts built-in brand/logo definitions to avoid breaking downstream customizations, maintaining compatibility for embedded brands in drawer.lua.
Body:

  While these should be moved to the new format, it wasn't my intention
  to force them over immediately.  Downstreams may embed their own brands
  in drawer.lua, and we shouldn't break them for something like this.

  Move adapt_fb_shim() up and use it for preloaded definitions to avoid
  forcing the matter for now.  Perhaps in the future we'll start writing
  out warnings for those that do need adapted.

  Reported by:	0x1eef on IRC

  (cherry picked from commit abdbd85d1b6af892c18eaae0330a146b01ff6712)


   stand/lua/drawer.lua | 68 ++++++++++++++++++++++++++++------------------------
   1 file changed, 37 insertions(+), 31 deletions(-)

[commit 8b6be727885d1b9eedae4b0e66674dc9cf2b69bb]
Date: 2025-06-16
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Beckhoff Automation GmbH & Co. KG
Section: Bootloader.general
Subject: loader: Fix loader_brand = none
Review: Setting loader_brand to "none" in loader.conf no longer causes a Lua error during boot.
Body:

  Setting loader_brand to none in loader.conf now result in a lua error
  as we try to get a non-existant table
  Defines it

  Fixes:	bef6d85b6de5 ("lualoader: allow graphical bits to be disabled with loader_gfx")
  Reviewed by:	kevans, tsoome
  Sponsored by:	Beckhoff Automation GmbH & Co. KG

  (cherry picked from commit 7e1930480bef285cca1c14c25b4fd62abdf5dabf)


   stand/lua/drawer.lua | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a0b8aa91546934bb3d0e2ae30ada7a0a48522b3b]
Date: 2025-06-12
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: stand: lua: add a more productive comment
Review: No user-visible change; only a comment addition.
Body:

  The global `shift` is a special little hack for shifting everything when
  the logo is gone, and we should explain that.

  Fixes:	33d3373faf30d ("stand: lua: convert orb to a new format [...]")
  (cherry picked from commit 1beab149d0b9768ad6d07501326a2060d7b0ba58)


   stand/lua/drawer.lua | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit 9dc4d7aef37d3c2b639bb3ed0d46c888028d7659]
Date: 2025-06-12
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Bootloader.general
Subject: stand: lua: convert orb to a new format that allows per-graphic shift
Review: The boot loader's graphical orb display is adjusted for better positioning and no longer clips the bottom when autoboot is interrupted.
Body:

  Previously, we had one shift that had to work for both the ASCII version
  and the image that we may draw if we have a framebuffer to play with.
  That makes it more difficult to get the positioning just right, so split
  them out into their own tables for convenience.

  While we're here, stop clipping off the bottom of the orb when the
  autoboot sequence is interrupted.  There's plenty of space for it to
  move up a hair, so let's do that..

  Reviewed by:	imp, tsoome

  (cherry picked from commit 33d3373faf30d5e7a1890ab686d932c984bc4b75)


   stand/lua/drawer.lua    | 104 ++++++++++++++++++++++++++++++++++--------------
   stand/lua/gfx-orb.lua   |  15 ++++---
   stand/lua/gfx-orbbw.lua |  36 +++++++++--------
   3 files changed, 104 insertions(+), 51 deletions(-)

[commit 6b35b45202d5855aaca0f90a5d8e948ba7dc8628]
Date: 2025-06-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: lualoader: rename loop variable to cleanup luacheck
Review: Renames a loop variable in the lualoader Lua script to resolve a luacheck warning. This is a minor internal cleanup with no user-visible impact.
Body:

  This shadows an `i` used for indexing earlier in the function, and we
  don't care that much about the name.

  (cherry picked from commit d0d5415881b7ed6908a2a734d893eb870b93b33f)


   stand/lua/core.lua | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit a934ad15516b47ff2018141381ddabab55061a56]
Date: 2025-06-06
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Bootloader.general
Subject: lualoader: allow graphical bits to be disabled with loader_gfx
Review: Adds a loader_gfx loader.conf(5) variable to disable graphical boot menu elements, allowing users to revert to ASCII art display. This provides a fallback for systems with functional framebuffers and ensures compatibility with older visual preferences.
Body:

  Some people prefer the old ASCII art look and it's good to have a way
  to confirm that the fallbacks still work right on systems that have a
  functional framebuffer available. Add a loader_gfx loader.conf(5)
  variable to disable the eager use of graphics for these use-cases.

  While we're here, clean up the style in the area a little bit; the early
  porting that I did to lualoader did a lot of redundant ~= nil that has
  carried over into some of the later work.  We can drop some of that, and
  also re-organize some of these variables to improve readability.

  ziaee notes that the positioning of the orb is a bit off; this is due to
  a change in positioning that happened in
  1b4e1171315398dec ("loader: Fix orb position") to account for the image
  dimensions.  This should be partially reverted to get it right; we
  shouldn't assume that we can use the same shift in gfx-* definitions for
  both the ASCII art and the associated image -- the {image, image_rl}
  pair should be converted to something more like an fbimg or gfx table
  that has the image, image width and a shift override to avoid messing
  up the ASCII positioning when disabled (or with no graphics available).

  Reviewed by:	imp, manu, ziaee (manpages)

  (cherry picked from commit bef6d85b6de55e0e7adcfa1fd2e4abdcecbf9564)


   stand/defaults/loader.conf   |  1 +
   stand/defaults/loader.conf.5 |  8 +++++++-
   stand/lua/drawer.lua         | 30 +++++++++++++++---------------
   3 files changed, 23 insertions(+), 16 deletions(-)

[commit 793f5473aa218f773314c9c1294c7067a4d2d15d]
Date: 2025-05-27
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: tests: kern: add some tests for TIOCSTI
Review: Adds kernel tests for TIOCSTI, which verify basic functionality and privilege checks. This is a test-only change with no user-visible impact.
Body:

  These offer at least rudimentary coverage of TIOCSTI, ensuring that it
  basically works and does what it's described to do and throws errors for
  unprivileged use that is supposed to be blocked.

  Reviewed by:	kib

  (cherry picked from commit d094dd9071cea1a2f67c5058caa4d22611da20ad)


   tests/sys/kern/tty/Makefile   |   3 +
   tests/sys/kern/tty/test_sti.c | 337 ++++++++++++++++++++++++++++++++++++++++++
   2 files changed, 340 insertions(+)

[commit f099c6b3a423a78c1367a11fd987457ae592924f]
Date: 2025-05-27
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: kern: tty: refactor TIOCSTI privilege checks slightly
Review: The commit refactors internal privilege checks for TIOCSTI but does not introduce any user-visible changes, new features, or configuration impacts.
Body:

  This removes some repetition from it and makes the flow a little more
  obvious.  Future work may find some way to add more constraints to the
  unprivileged path, add a security sysctl to disable it, or perhaps
  some combination of the two.

  Reviewed by:	kib, markj

  (cherry picked from commit 59fc4cda1bfa712c46d407d1e83bdd5c63e6e0e3)


   sys/kern/tty.c | 26 +++++++++++++++++++++-----
   1 file changed, 21 insertions(+), 5 deletions(-)

[commit 410197011bdfbdf25b92d94f2bf3484e44eb209b]
Date: 2025-05-07
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Bootloader.general
Subject: loader: ficl: restore isvirtualized?
Review: The man:loader(8) restores the ficl word 'isvirtualized', which is used to detect virtualization environments.
Body:

  This word was accidentally removed when gfx bindings were made optional
  to remove some overhead not needed for all loaders.  This one isn't
  graphics related, so we can safely restore it without irritating anyone.

  Reported by:	sjg
  Reviewed by:	adrian, imp
  Fixes:	9c8bf69a53f ("loader: Only create gfx 4th bindings when [...]")

  (cherry picked from commit 354fb783e6d5ff9abcb6529cbb17cbb2ff6a7375)


   stand/ficl/loader.c | 3 +++
   1 file changed, 3 insertions(+)

[commit 9e09ab407983bcda008d4047f33e7de68d1d1c41]
Date: 2025-01-07
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: Beckhoff Automation GmbH & Co. KG
Section: Bootloader.general
Subject: loader: Fix orb position
Review: The boot loader orb position is corrected to align with the menu.
Body:

  Fix the orb position to be aligned with the menu

  Reviewed by:	imp, tsoome
  Sponsored by:	Beckhoff Automation GmbH & Co. KG

  (cherry picked from commit 1b4e1171315398decb1ad3fceffcacf29cff218b)


   stand/lua/drawer.lua    | 4 ++--
   stand/lua/gfx-orb.lua   | 2 +-
   stand/lua/gfx-orbbw.lua | 2 +-
   3 files changed, 4 insertions(+), 4 deletions(-)

[commit 1bc0b2112e94a8cb7243d9b3d229fa6ec6137368]
Date: 2024-10-20
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: tests: kern: add some porch(1)-based tty tests
Review: Adds porch(1)-based tests for tty behavior, requiring sysutils/porch to be installed for execution.
Body:

  If sysutils/porch is installed, we'll do some basic testing of tty
  behavior.  The existing tests primarily cover ICANON-related processing
  and corner cases that have been fixed somewhat recently, but I
  anticipate growing this out a bit in due time.

  Reviewed by:	ngie

  (cherry picked from commit 096c39fae4ad5135a317925d8749b7d83f65ebf8)


   etc/mtree/BSD.tests.dist                   |   2 +
   tests/sys/kern/Makefile                    |   1 +
   tests/sys/kern/tty/Makefile                |  12 +++
   tests/sys/kern/tty/fionread.c              |  21 +++++
   tests/sys/kern/tty/readsz.c                | 130 +++++++++++++++++++++++++++++
   tests/sys/kern/tty/test_canon.orch         | 102 ++++++++++++++++++++++
   tests/sys/kern/tty/test_canon_fullbuf.orch |  23 +++++
   tests/sys/kern/tty/test_ncanon.orch        |  39 +++++++++
   tests/sys/kern/tty/test_recanon.orch       |  90 ++++++++++++++++++++
   9 files changed, 420 insertions(+)

[commit a2328a1338e0bd17fc4c751228ba49b6de4ca5ec]
Date: 2024-10-20
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: mk: add PLAIN_TESTS_PORCH support
Review: Adds support for PLAIN_TESTS_PORCH in the build system, enabling tests for porch(1) from sysutils/porch to be integrated and skipped if the port is not installed.
Body:

  porch(1), available via sysutils/porch, is an expect(1)-like program
  that uses lua instead of tcl for scripting.  Imminent use will be to
  execute tests of tty canonicalization to ensure we don't regress some of
  the corner cases we've fixed, but tests for other interactive programs
  are being considered as well.

  PLAIN_TESTS_PORCH is being introduced primarily to get the metadata
  right without writing it out for every single test; required_programs
  ensures that we skip the tests if the port is not installed.

  Reviewed by:	0mp (previous version), ngie

  (cherry picked from commit 44f736c385f6b8d451feb9d6543220e8e61abcaa)


   share/mk/bsd.README    |  3 +++
   share/mk/plain.test.mk | 11 +++++++++++
   2 files changed, 14 insertions(+)

[commit 49b52eedd0eb565a1a981eb886fd04d4a1d77e66]
Date: 2025-07-13
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.contrib
Subject: share/termcap: add xterm-ghostty entry
Review: The termcap database now includes an entry for xterm-ghostty, allowing applications that use termcap to properly recognize and support the ghostty terminal emulator.
Body:

  As generated by ghostty during the build with some copy-editing.

  Submitted by:	Tim Culverhouse <tim@timculverhouse.com>
  PR:		287642
  Event:		Berlin Hackathon 202507
  MFC after:	1 week

  (cherry picked from commit 804f961c5cddcffa950ff7f13025021cdd95ba46)


   share/termcap/termcap | 20 ++++++++++++++++++++
   1 file changed, 20 insertions(+)

[commit 420058cd3058e8cf2c3ce9b411bfac94645f502a]
Date: 2025-07-13
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Userland.contrib
Subject: share/termcap: ti703 does not actually support tabs
Review: The commit corrects a termcap entry for the ti703 terminal, removing an incorrect tab support flag. This may affect applications that rely on termcap for terminal capabilities.
Body:

  This is a mistake I made when I originally wrote this entry.

  Event:		Berlin Hackathon 202507
  MFC after:	1 week

  (cherry picked from commit b98b82a8bff951b5c1dc1b3b590a986e027efd84)


   share/termcap/termcap | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit 2ee0f3c954e71888028873d85a392c710d6f0b00]
Date: 2025-07-16
Score: 5
Status: added(include=yes,score=85)
Sponsor: The FreeBSD Foundation
Section: Bootloader.general
Subject: release: Install wireless firmware to bootonly media
Review: Wireless firmware packages are now included on bootonly installation media, enabling users to fetch installation files over a wireless connection.
Body:

  Also install wireless firmware packages to the bootonly ISO and the
  mini-memstick image so users can fetch installation files over a
  wireless connection.

  Reported by:	Mark Philips <mark@freebsdfoundation.org>
  Reviewed by:	bz, emaste, imp, releng (cperciva)
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D51348

  (cherry picked from commit 655fcdde1aff164a3a02ad073334611117e20d4c)


   release/Makefile | 4 ++++
   1 file changed, 4 insertions(+)

[commit f40f6374f3d2cfc1a99781acd5c3252e1edfe612]
Date: 2025-07-17
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: qlnxe: Fix error handling of SIOCGI2C ioctl
Review: The man:ifconfig[8] command no longer hangs indefinitely when querying SFP module data on qlnx devices when the module is not present.
Body:

  The error -1 is actually ERESTART in the context of syscall. It is for
  kernel mode only and will not be passed to user mode. When the kernel
  sees this error it will restart the syscall.

  When the the SFP module data is not available, e.g. the SFP module is
  not present, the ioctl handler returns ERESTART and kernel will retry
  infinitely, hence the userland `ifconfig -v ql0` will hang forever until
  get interrupted. That is apparently wrong.

  Fix that by returning error ENODEV to indicate the SFP module data is
  not available.

  As for the case that ecore_ptt_acquire() fails, it appears to be quite
  safe to restart, so keep returning ERESTART.

  Reported by:	Steve Wheeler
  See also:	https://redmine.pfsense.org/issues/16248
  Reviewed by:	kbowling
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D51351

  (cherry picked from commit 12fea464070a9061fda874038614ed55011ad59d)


   sys/dev/qlnx/qlnxe/qlnx_os.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit eaf1cda90610bfeb9d4e5486ab145b6b62669f83]
Date: 2025-07-17
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Drivers.device
Subject: qlnxe: Fix build with INET
Review: The commit fixes a build issue with the qlnxe driver when INET is disabled, ensuring the driver compiles correctly in configurations without IP networking support.
Body:

  opt_inet.h is missing from 5684c8783b64, thus actually `#ifdef INET`
  does not work.

  PR:		287445
  See also:	https://redmine.pfsense.org/issues/16248
  Reviewed by:	kbowling
  Tested by:	leper <leper4@protonmail.com>
  Fixes:		5684c8783b64 qlnxe: Add missing #ifdef INET to fix amd64 LINT-NOINET/NOIP builds
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D51295

  (cherry picked from commit 10d9ec31bf28949221280c9ddc0816464407a43f)


   sys/dev/qlnx/qlnxe/qlnx_os.c    | 2 ++
   sys/modules/qlnx/qlnxe/Makefile | 1 +
   2 files changed, 3 insertions(+)

[commit 8ef7ad95e9156bea689274c9d57fc961b203efe2]
Date: 2025-06-12
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Drivers.device
Subject: qlnx: fix panic at startup
Review: The qlnx driver no longer panics during startup by postponing ether_ifattach until after ifmedia setup.
Body:

  While attaching the qlnx driver we can end up trying to call ifmedia functions
  before those are set up (through ether_ifattach() -> rtnl_handle_ifattach()
  -> dump_iface() -> get_operstate_ether() -> ifmedia_ioctl()). Postpone the
  ether_ifattach() until after the ifmedia setup.

  Reviewed by:	markj,zlei
  Sponsored by:	Rubicon Communications, LLC ("Netgate")
  Differential Revision:	https://reviews.freebsd.org/D50819

  (cherry picked from commit 4f7473d18a62077a218ac00817bae09a95b8cbcb)


   sys/dev/qlnx/qlnxe/qlnx_os.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 000755e790dfd6c78a87c10133c46b55b634ffab]
Date: 2025-07-13
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: bluetooth-config: Fix command line parsing
Review: The bluetooth-config utility now correctly parses command line options, fixing issues where optional parameters were not properly handled.
Body:

  This addresses the problems encountered when parsing options in bluetooth-config.

  - the optional parameters were not properly shifted after consumption
  - the command line parameter count was checked before getopts and not after

  Reported by:	sjg
  Approved by:	kp
  MFC after:	7 days
  Event:	Berlin Hackathon 202507
  Differential Revision:	<https://reviews.freebsd.org/D51281>

  (cherry picked from commit 5031da20599bb1163f0e8d1c4b415ab3bbebce00)


   usr.sbin/bluetooth/bluetooth-config/bluetooth-config.sh | 8 +++++++-
   1 file changed, 7 insertions(+), 1 deletion(-)

[commit a6693b09e297a08c4fc2ba73620e9438a9ff0847]
Date: 2025-07-15
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.config
Subject: inetd.conf: remove -[46] from the ssh entry
Review: The man:inetd.conf[5] configuration no longer includes the -4 and -6 flags for the ssh service entry, allowing outgoing connections such as port forwarding to use either IPv4 or IPv6 regardless of the inbound connection's address family.
Body:

  sshd doesn't require these flags, and including them makes outgoing
  connections (e.g., port forwarding) restricted to the family of the
  inbound connection, which is not usually desirable and also not how
  standalone sshd works.

  MFC after:	3 days
  Reviewed by:	kevans
  Approved by:	kevans (mentor)
  Differential Revision:	https://reviews.freebsd.org/D51296

  (cherry picked from commit 6738882248a755aad859784150969085e006cf89)


   usr.sbin/inetd/inetd.conf | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit ecf88947ef74607c9885b7d01b6bb2cfdf959b02]
Date: 2025-07-10
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: nlmsg_report_err_msg: add __printflike annotation
Review: Adds __printflike annotation to nlmsg_report_err_msg for improved compiler warnings.
Body:

  Reviewed by:	kevans, kp
  Approved by:	kevans (mentor)
  Differential Revision:	https://reviews.freebsd.org/D51234

  (cherry picked from commit db55cc8110ceea084c6f52a1ecfd6ab87e0aac2b)


   sys/netlink/netlink_message_parser.h | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 76e5fcc2874e821d28804a6e2c25b3f7aaf5f9ce]
Date: 2025-07-15
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: ast: do not dereference NULL td_proc in CTR statement
Review: The commit fixes a potential NULL pointer dereference in the kernel's trap handling code, preventing a kernel panic in specific error conditions.
Body:

  (cherry picked from commit 42f1054ef12d10f3ba46770b985a320b0ceb9f2f)


   sys/kern/subr_trap.c | 5 +++--
   1 file changed, 3 insertions(+), 2 deletions(-)

[commit b2d979b1ea6c43861e195852d7a7f1ace51cf10d]
Date: 2025-07-08
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: undecided
Subject: pf tests: sync a state with an rtableid that doesn't exist
Review: The commit adds a test case for pf sync with non-existent rtableid to prevent panics, but it is a test-only change with no direct user-visible impact.
Body:

  Create a state with an rtableid (i.e. fib) that doesn't exist on the receiving
  side. This used to not be handled, and could provoke panics. Create such a
  situation to ensure we still don't panic.

  PR:		287981
  MFC after:	1 week
  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit f651e87be28dd6c3f466dc865b1a036089b892ff)


   tests/sys/netpfil/pf/pfsync.sh | 85 ++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 85 insertions(+)

[commit d7e62fc3d719469297681919b7bf0ed010b05344]
Date: 2025-07-08
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: Network.general
Subject: pf: ignore state update with invalid rtableid
Review: The pf state synchronization daemon now ignores state updates with an unsupported routing table ID, preventing a potential crash.
Body:

  It's possible for a peer to send us a state update with an rtableid we don't
  support (i.e. >= net.fibs).
  Drop these updates rather than potentially crashing later by setting an invalid
  fib number.

  PR:		287981
  MFC after:	1 week
  Sponsored by:	Rubicon Communications, LLC ("Netgate")

  (cherry picked from commit 4af4fefedd1bf14b5a27387075edde98744b722e)


   sys/netpfil/pf/if_pfsync.c | 4 ++++
   1 file changed, 4 insertions(+)

[commit 3348498d96d5c1a11c87f9983185c48d29a504b5]
Date: 2025-07-11
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: ifconfig.8: remove accept_rev_ethip_ver and send_rev_ethip_ver
Review: The man:ifconfig[8] page no longer documents the obsolete accept_rev_ethip_ver and send_rev_ethip_ver options, which have been unavailable since FreeBSD 11.
Body:

  It is removed long ago [1] and unavailable on FreeBSD 11 and later,
  but the corresponding entries in the man page were not removed
  accordingly.

  [1] https://cgit.freebsd.org/src/commit/?id=b1c250ff3ff6af36e95f5cf910973133c3445704

  MFH after:	3 days
  Reviewed by:	mhorne
  Approved by:	mhorne
  Differential Revision:	https://reviews.freebsd.org/D51261

  (cherry picked from commit cca6a72d7f7131685a082c123aff17208aa1693f)


   sbin/ifconfig/ifconfig.8 | 22 +---------------------
   1 file changed, 1 insertion(+), 21 deletions(-)

[commit 854ac20aca7dc2a3819d540fd34945fdfd040313]
Date: 2025-06-27
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: undecided
Subject: Makefile.inc1: Set SOURCE_DATE_EPOCH in more pkg targets
Review: The commit addresses internal build reproducibility by setting SOURCE_DATE_EPOCH in additional package targets, but this is a build system change with no direct user-visible impact on functionality, configuration, or behavior.
Body:

  Otherwise timestamps in the underlying tar files are not reproducible.
  I believe this was a simple omission, other package targets specify the
  timestamp this way.

  Reviewed by:	bapt
  MFC after:	2 weeks
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51066

  (cherry picked from commit 78d91e21bf72a1b706c4152c4f8e2fed3fcbdac3)


   Makefile.inc1 | 9 +++++++--
   1 file changed, 7 insertions(+), 2 deletions(-)

[commit 025287a38dacfbeaa570f35650396fb016f54c9e]
Date: 2025-06-27
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Klara, Inc. | Modirum MDPay
Section: Kernel.general
Subject: vm_pageout: Make the OOM killer less aggressive
Review: The OOM killer becomes less aggressive by resetting the sequence counter when there is no immediate free page shortage, reducing the chance of spurious out-of-memory kills.
Body:

  A problem can arise if we enter a shortfall of clean, inactive pages.
  The PID controller will attempt to overshoot the reclamation target
  because repeated scans of the inactive queue are just moving pages to
  the laundry queue, so inactive queue scans fail to address an
  instantaneous page shortage.  The laundry thread will launder pages and
  move them back to the head of the inactive queue to be reclaimed, but
  this does not happen immediately, so the integral term of the PID
  controller grows and the page daemon tries to reclaim pages in excess of
  the setpoint.  However, the laundry thread will only launder enough
  pages to meet the shortfall: vm_laundry_target(), which is the same as
  the setpoint.

  Oonce the shortfall is addressed by the laundry thread, no more clean
  pages will appear in the inactive queue, but the page daemon may keep
  scanning dirty pages due to this overshooting.  This can result in a
  spurious OOM kill.

  Thus, reset the sequence counter if we observe that there is no
  instantaneous free page shortage.

  Reviewed by:	alc, kib
  MFC after:	2 weeks
  Sponsored by:	Klara, Inc.
  Sponsored by:	Modirum MDPay
  Differential Revision:	https://reviews.freebsd.org/D51015

  (cherry picked from commit 78546fb0e3215c07f970c1bcbf15bba2f5852c76)


   sys/vm/vm_pageout.c | 8 +++++++-
   1 file changed, 7 insertions(+), 1 deletion(-)

[commit f668b5a413d90084f02f0f2f204c7dbf3563b3a9]
Date: 2025-07-12
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: rc.subr: Fix a typo in check_jail()'s description
Review: Fixes a typo in a comment within rc.subr, which has no user-visible impact.
Body:

  MFC after:	3 days
  Event:		Berlin Hackathon 202507

  (cherry picked from commit 5d5258653ba4b37c38e48443f265ee4dcedf9a50)


   libexec/rc/rc.subr | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 23e4075a4add6af5d83be3bd47779a99667cff7a]
Date: 2025-06-13
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: bectl.8: Describe better
Review: The commit improves man:bectl[8] documentation with better descriptions, examples, and formatting, enhancing user guidance.
Body:

  + Concise document description for consistency and apropos results
  + Improve introductory paragraph, mentioning boot loader support
  + Explain -r in "Supported Subcommands and Flags"
  + Clarify the purpose of the check subcommand
  + Add two basic examples, creating and mounting
  + Fold some long lines, correct a stray capitalization.

  MFC after:	3 days
  Co-authored-by:	kevans

  (cherry picked from commit d7baf5f70802a9045f5792a7063b2614bf17356a)


   sbin/bectl/bectl.8 | 121 ++++++++++++++++++++++++++++-------------------------
   1 file changed, 65 insertions(+), 56 deletions(-)

[commit b98efcdb6210e1a38cda7725b873e3dd5f98a1f2]
Date: 2024-10-17
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: builtin.1: streamlined rewrite + document keybinds
Review: The man:builtin[1] manual page is updated with improved formatting, keybindings documentation, and a streamlined structure.
Body:

  + clean title: one line with keywords, builtin's mlinked
  + additional search terms: FreeBSD, index
  + synopsis: builtins are documented in your shell's manual
  + clear/scoped introduction: increase straightforwardness
  + table alignment fixed, now renders nicely on MANWIDTH=59
  + keybindings: fundamentals now documented, more please?
  + improved structure and flow, and a spdx tag
  + remove info(1) from SEE ALSO

  MFC after:	3 days
  Discussed with:	imp,jlduran
  Reviewed by:	imp
  Closes:		https://github.com/freebsd/freebsd-src/pull/1481

  (cherry picked from commit 42df4faf7004aabb4f06acd71f860f12977db3ad)


   share/man/man1/Makefile  |   1 +
   share/man/man1/builtin.1 | 269 ++++++++++++++++-------------------------------
   2 files changed, 93 insertions(+), 177 deletions(-)

[commit 8c79b9db2bcc76bce8a1cd8e950bce806d70edcb]
Date: 2024-12-30
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: truncate.1: Polish title and examples
Review: The commit improves the truncate.1 man page by polishing the title, updating examples to use human-readable sizes, fixing grammar, and adjusting formatting for better readability on standard consoles.
Body:

  + describe better
  + switch examples to human readable sizes, with consistent spacing
  + `Downsize ... in 5 Megabytes` >> `Downsize ... by 5 Megabytes`
  + remove prompt from lone example with prompt for consistency
  + remove x permissions from kernel example
  + examples now fit on standard console without wrapping

  While here:
  + fold a line to eliminate linter warning + tag spdx
  + add -nosplit to AUTHORS to eliminate a rendering glitch

  MFC after:	3 days
  Discussed with:	asomers, jhb, maxim
  Reviewed by:	imp (previous version)
  Closes:		https://github.com/freebsd/freebsd-src/pull/1568

  (cherry picked from commit 91ad27bcfc496393ba88f39ca13cdf1c59a7f487)


   usr.bin/truncate/truncate.1 | 30 +++++++++++++++++-------------
   1 file changed, 17 insertions(+), 13 deletions(-)

[commit 137fcd6dbc527807da69bc8bc971917a0aedfc69]
Date: 2025-07-03
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: write.2: Add EINVAL to ERRORS
Review: The write(2) man page now documents that EINVAL can be returned when writing to a block device with a size not aligned to the sector block size.
Body:

  Since phk rewrote the block layer ~2 decades ago, write(2) can return
  EINVAL when the target is a block device and nbytes, the write size, is
  not a multiple of the sector's block size.

  From the original PR:
  When coming from Linux, people are surprised by the fact
  that write(2) to a device must be aligned to block size.
  Writing a non-aligned block onto a raw device is a case
  where EINVAL is also returned but the manpage does not mention this.

  MFC after:		3 days
  PR:			227185
  Reported by:		riggs
  Reviewed by:		imp, Pau Amma <pauamma@gundo.com>
  Differential Revision:	https://reviews.freebsd.org/D51138

  (cherry picked from commit bd173a540c0ead4881b0866b721955440e3b96fe)


   lib/libc/sys/write.2 | 3 +++
   1 file changed, 3 insertions(+)

[commit 0410aae4f8db0701a3e66fb1a3819251b62986e6]
Date: 2025-07-01
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: pf.4: Add pf_enable to SYNOPSIS
Review: The pf.4 man page now documents the pf_enable tunable in the SYNOPSIS section.
Body:

  MFC after:		3 days
  Reviewed by:		Pau Amma <pauamma@gundo.com>
  Reviewed by:		Felix Johnson <felix.the.red@gmail.com>
  Differential Revision:	https://reviews.freebsd.org/D51117

  (cherry picked from commit 65bc8e9192dd19bca3ed89586a23a74cd449f7b2)


   share/man/man4/pf.4 | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit d9e02d3b3ac376d95096d153d00bc07e5a77cc61]
Date: 2025-06-26
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.contrib
Subject: mandoc: Bump version string to 1.14.6s20250613
Review: mandoc updated to version 1.14.6s20250613.
Body:

  The mandoc compiler is still at version 1.14.6, but we have imported
  several snapshots since the version was bumped. Append a snapshot date
  string to the version to reflect this.

  Requested by:	wosch
  Discussed with:	bapt

  (cherry picked from commit af2949cd29ef453a63a6345de396be866138b051)


   contrib/mandoc/Makefile | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 241fb89acdd2971c9cdc300db1f0aad4e5d254cd]
Date: 2024-10-13
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: mdoc.7/MANUAL STRUCTURE: add HARDWARE
Review: The mdoc.7 manual page now includes a HARDWARE section, documenting that FreeBSD's release infrastructure uses this section to generate Hardware Compatibility Notes.
Body:

  FreeBSD Release infrastructure has been generating the Hardware
  Compatibility Notes from this section for some decades. Make this more
  obvious. This does change the upstream mdoc.7 in a minimal way to
  document this, but the .Dd wasn't bumped to avoid conflicts with the
  next mdoc/mandoc import.

  Reported by:	bz (HARDWAREs generating compatibility notes)
  Reported by:	grahamperrin (order listed in fdp-primer/man)
  Reviewed by:	imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1463

  (cherry picked from commit d235f19d1bf1e3d9ca31822709464cc6250f44c2)


   contrib/mandoc/mdoc.7 | 7 +++++++
   1 file changed, 7 insertions(+)

[commit ec766614e3b87ddcbf8c922c92553ed0f3c5b0d6]
Date: 2024-12-09
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.contrib
Subject: mandoc: drop 3p section
Review: The man:mandoc[1] utility no longer includes the 3p section, which was specific to OpenBSD.
Body:

  The 3p is an OpenBSD thing and this list of sections is otherwise
  entierly customized to FreeBSD.

  Reviewed by:	imp, bapt
  Differential Revision:	https://reviews.freebsd.org/D47948

  (cherry picked from commit 3ca117c6bb1dffaa3542f58339154a7dd166d169)


   contrib/mandoc/msec.in | 1 -
   1 file changed, 1 deletion(-)

[commit 7876738b6038d6a08d0c648404c9b55bb954e5ae]
Date: 2024-12-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: mandoc: remove duplicate libstdthreads entry
Review: The commit removes a duplicate library entry from the build configuration, which is a minor internal cleanup without user-visible impact.
Body:

  (cherry picked from commit 0fd7b4655666fce13c43d4562e5f9e54ad32145e)


   contrib/mandoc/lib.in | 1 -
   1 file changed, 1 deletion(-)

[commit c2b1623bb97e5e2df8447892d22bc64250982f0d]
Date: 2025-06-18
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: truss.1: Reference sysdecode(3)
Review: The commit updates the man:truss[1] manual page to reference sysdecode(3). This improves documentation but does not introduce any user-visible functional changes.
Body:

  MFC after:	1 week

  (cherry picked from commit fa9ac741d03342c33a0e8f85114949625ba4901f)


   usr.bin/truss/truss.1 | 5 +++--
   1 file changed, 3 insertions(+), 2 deletions(-)

[commit b5ec6cda9380ab5ae222c91f161df9f420ab3b5e]
Date: 2025-07-14
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: fortune: Fix typo in dmesgd.nycbug.org example
Review: Typo in fortune data file corrected; no functional change.
Body:

  No functional change, but commit for correctness nonetheless.

  MFC after:	1 day
  Differential Revision:	https://reviews.freebsd.org/D51293

  (cherry picked from commit 697bf0f416e4fe0fdd974b9eacdaed140fe18061)


   usr.bin/fortune/datfiles/freebsd-tips | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c4496f82680c5edb0820598817ea22e322250317]
Date: 2025-06-15
Score: 5
Status: added(include=yes,score=85)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: iwlwifi: compile in ACPI support
Review: The iwlwifi driver now includes ACPI support, enabling regulatory features for 802.11ax, 802.11be, and Per Platform Antenna Gain (PPAG) settings.
Body:

  Now that LinuxKPI supports the lower case Linux ACPI spellings under
  LINUXKPI_WANT_LINUX_ACPI we only need to provide the debug macro to
  allow us to compile in ACPI support.

  This ties into regulatory and will be used, e.g., for 11ax, 11be,
  and Per Platform Antenna Gain (PPAG) settings.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 228b43c258d24c293b135ae94c120e7ccf0a7aea)


   sys/contrib/dev/iwlwifi/iwl-debug.h | 4 +++-
   sys/modules/iwlwifi/Makefile        | 8 +++++++-
   2 files changed, 10 insertions(+), 2 deletions(-)

[commit f39c377274bd02fa0f8e7c4d1a05d3d617de895a]
Date: 2025-06-15
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: rtw89: enable ACPI support on FreeBSD
Review: The rtw89 driver now supports ACPI, enabling power management and configuration on systems that use ACPI for the device.
Body:

  Now that LinuxKPI supports the lower case Linux ACPI spellings under
  LINUXKPI_WANT_LINUX_ACPI remove the #ifdef around the code and compile in
  ACPI support.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 8c97c46418f9767a9984df259116da08d9659076)


   sys/contrib/dev/rtw89/acpi.c | 26 --------------------------
   sys/modules/rtw89/Makefile   |  1 +
   2 files changed, 1 insertion(+), 26 deletions(-)

[commit 6cdcf08c9c5eda6dc3b8395cefd9d30a4f5e2f1a]
Date: 2025-07-04
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: Bump __FreeBSD_verion for LinuxKPI changes to dma-mapping.h and acpi.
Review: The __FreeBSD_version number is incremented to reflect changes to the LinuxKPI dma-mapping.h and acpi headers, which may affect third-party kernel modules that check this version for compatibility.
Body:

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 842da154a0ce8f866d65f495537a13ffa8fb9cc0)


   UPDATING        | 3 ++-
   sys/sys/param.h | 2 +-
   2 files changed, 3 insertions(+), 2 deletions(-)

[commit 45f0c867803bed4251b9c1bc65d610796e6e1cac]
Date: 2025-06-15
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: acpi: add acpi_evaluate_dsm()
Review: The LinuxKPI ACPI subsystem adds an acpi_evaluate_dsm() wrapper for wireless drivers, enabling better compatibility with Linux drivers.
Body:

  Add a acpi_evaluate_dsm() wrapper around the native implementation
  as needd by wireless drivers.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	dumbbell
  Differential Revision: https://reviews.freebsd.org/D50864

  (cherry picked from commit ba6460df5607e572e9c868413c75ce9bc5ce9a00)


   sys/compat/linuxkpi/common/include/acpi/acpi_bus.h |  6 ++++++
   sys/compat/linuxkpi/common/src/linux_acpi.c        | 19 +++++++++++++++++++
   2 files changed, 25 insertions(+)

[commit ddf9cecb559d1504d5024648e983a46ab3136739]
Date: 2025-06-15
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: acpi: provide union [linuxkpi]_acpi_(object|buffer)
Review: The LinuxKPI ACPI compatibility layer now provides union acpi_object and acpi_buffer as linuxkpi_ prefixed versions, with an optional LINUXKPI_WANT_LINUX_ACPI define for transitional driver compatibility. This change supports unmodified Linux driver compilation and affects drm-kmod and similar drivers using ACPI interfaces.
Body:

  Provide union acpi_(object|buffer) as linuxkpi_ versions and in Linux
  native lower case spelling so that driver code compiles unmodified.

  Use the linuxkpi_ prefix to avoid name clashes with the native ACPI
  implementation which uses CamelCase.

  Use the linuxkpi_ names internally and redefine the linuxkpi_ unions
  to their native names so they are avail as expected in drivers.

  As a transition to not break drm-kmod which has in-place (no #ifdef)
  changes from Linux spelling ot FreeBSD spelling, introduce
  LINUXKPI_WANT_LINUX_ACPI so we have the Linux spelling as an opt-in.
  That way the transition can happen gracefully and once "top-of-trees"
  are all sorted we can remove the #ifdefs here again.

  Bump __FreeBSD_version to be able to detect this change.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	wulf (previous version), dumbbell
  Differential Revision: https://reviews.freebsd.org/D50863

  (cherry picked from commit 2ddfcc013c251f13c8c9b24970b8134ddd49afea)


   sys/compat/linuxkpi/common/include/acpi/acpi.h | 76 ++++++++++++++++++++++++--
   1 file changed, 71 insertions(+), 5 deletions(-)

[commit 87e6f90667e5a841592d8a2522f90981fd3e3fff]
Date: 2025-06-22
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: MODULE_DEVICE_TABLE() factor out the bus specific MODULE_PNP_INFO()
Review: The commit refactors internal LinuxKPI macros for device table handling and adjusts bnxt(4) driver's auxiliary bus usage. These changes are internal to the Linux compatibility layer and driver infrastructure with no direct user-visible impact.
Body:

  In order to be able to use MODULE_DEVICE_TABLE() with multiple bus
  attachments, factor out the bus-specfic MODULE_PNP_INFO() and place
  it next to the structure defining the table.

  As it turns out bnxt(4) has been using the MODULE_DEVICE_TABLE() with
  PCI attachments for the "auxillary" bus so far.  That makes little sense.
  Define the MODULE_PNP_INFO() to nothing for that.  We may consider
  pulling these LinucKPI bits in semi-native drivers into LinuxKPI
  one day as that route is not really sustainabke.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	imp, dumbbell
  Differential Revision: https://reviews.freebsd.org/D51049

  (cherry picked from commit 2f5666c1727c949491f73e6c3277b7b542131714)


   sys/compat/linuxkpi/common/include/linux/pci.h | 7 +++++--
   sys/dev/bnxt/bnxt_en/bnxt_auxbus_compat.h      | 1 +
   2 files changed, 6 insertions(+), 2 deletions(-)

[commit 00544b72f65f3f160d829445a0b8a26b375bfab9]
Date: 2025-06-22
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: MODULE_DEVICE_TABLE() remove hard coded pci
Review: The commit removes a hard-coded PCI bus assumption in the LinuxKPI compatibility layer, making it more flexible for future bus types. This is an internal refactoring with no immediate user-visible impact.
Body:

  While we currently only use MODULE_DEVICE_TABLE() for pci (or so I
  thought [*]), this may soon change.  Remove a hard coded "pci" for
  the bus and use the bus name passed in as _bus.

  [*] see follow-up change

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	imp, dumbbell
  Differential Revision: https://reviews.freebsd.org/D51048

  (cherry picked from commit f58e032410c93d67c83d6bce8a3e6711f377a4be)


   sys/compat/linuxkpi/common/include/linux/pci.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit dbd83c481e1c9ccf9432f5c4cd482a8a53921d60]
Date: 2024-05-21
Score: 5
Status: proposed(include=no,score=35)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: add missing bus_dmamap_sync() calls or exclude them
Review: The commit adds missing bus_dmamap_sync() calls and adjusts DMA mapping functions in the LinuxKPI subsystem, which may affect compatibility with Linux driver modules, particularly for hardware like iwlwifi on arm64.
Body:

  Rename linux_dma_unmap() to lkpi_dma_unmap(), and linux_dma_map_phys()
  to lkpi_dma_map_phys() so that we get the full set of function
  arguments (direction and attributes were missing).
  Leave the old functions as wrappers as they are called from drm-kmod
  linuxkpi/bsd still, and leaving them also allows us to MFC this
  change.

  Add missing bus_dmamap_sync() calls.  Rather than inlining them
  in each inline function push them down to the actual implementation.
  From there do not inline them either but call the appropriate
  function dealing with the sync so that we do not have the same
  code splattered in many places.

  Adhere to the DMA_ATTR_SKIP_CPU_SYNC attribute and skip synching
  when requested.

  A previous, less complete version of this change already allowed
  me to load firmware on arm64 for iwlwifi (again).

  There are four more places which are not currently done as the
  functions which came with an OFED sync a long time ago seem to be
  unused these days.  Leaving a pr_debug("TODO") call there.

  Also dma_[un]map_resource() when brought in from drm-kmod/linuxkpi/bsd
  (D30933) should be adjusted to pass the full arguments as the amdgpu
  callers are requesting to skip synching.

  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D45294

  (cherry picked from commit f99d393f7f787ff080c12b92243adcc310ac7c58)


   .../linuxkpi/common/include/linux/dma-mapping.h    | 50 ++++++++++++----------
   sys/compat/linuxkpi/common/src/linux_pci.c         | 49 ++++++++++++++++++---
   2 files changed, 70 insertions(+), 29 deletions(-)

[commit 48c4eac328eaffe4eed0461d75e6c2bb463b3efc]
Date: 2025-06-22
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: bwn(4): BWN_GPL_PHY: make compile again
Review: The bwn(4) driver's GPL PHY component now compiles without enumeration type comparison errors, resolving a build issue that affected users building from source.
Body:

  compiler complains about error: comparison of different enumeration types
  ('bwn_phy_band_t' and 'bwn_band_t');  so use the correct enum value.

  Sponsored by:	The FreeBSD Foundation
  PR:		287695
  Reported by:	(tom.mcclean gmail.com)

  (cherry picked from commit 2f16c8d4fa0f5788d52d74fa875c386c475249ec)


   sys/gnu/dev/bwn/phy_n/if_bwn_phy_n_ppr.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 1f2679e83362eb49d036a2f8b66c602c68ec5c04]
Date: 2025-07-05
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: net80211: regdomain: ETSI: add missing 11a and 11na entries
Review: The wireless regulatory database for ETSI regions now includes missing 11a and 11na channel entries for the 5745-5865 MHz frequency range, correcting scan result reporting for affected channels.
Body:

  The frequency range 5745-5865 (channels 149-173) wrongly has a
  VHT160 channel listed (going up to 5885/177 which is not avail in
  ETSI) but no 11a, 11na listed.  Add the 11a and 11na in addition to
  the 11ac 20/40 and 80.
  Turns out the VHT40 entry for 5805-5845 was also missing. We already
  had the neccessary setting for taiwan, so just adjust the freqband ref.

  The problem is that without the 11a base channel ieee80211_find_channel()
  in ieee80211_lookup_channel_rxstatus() will fail and sta_recv_mgmt() will
  not get the correct channel but will use ic->ic_curchan (which is not
  updated on scan offloading) and the scan result entry will be added as
  channel 1.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	adrian (previous version)
  Differential Revision: https://reviews.freebsd.org/D51163

  (cherry picked from commit 07948e050808158567c0ca7d345ad035115c0d88)


   lib/lib80211/regdomain.xml | 44 ++++++++++++++++++++++++++++++++++++--------
   1 file changed, 36 insertions(+), 8 deletions(-)

[commit 5c16917bac65f6d44ec8208861ace61835d38825]
Date: 2025-06-18
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: net80211: in ieee80211_sta_join() only do_ht if HT is avail
Review: The commit fixes a kernel panic in the net80211 wireless stack when joining a network with VHT but no HT IEs. This prevents system crashes in specific wireless association scenarios.
Body:

  In ieee80211_sta_join() there are currently two ways to set
  "do_ht": (1) after checking HT IEs are avail, and (2) after
  checking VHT IEs are avail and we are not on 2GHz.

  In the latter case no one checks that HT IEs are available and
  when we hit ieee80211_ht_updateparams_final() htinfo may be NULL
  and we panic.

  Avoid this by only checking for VHT if do_ht was set.
  No VHT without HT IEs.

  While here switch do_ht to be a bool.

  Sponsored by:	The FreeBSD Foundation
  PR:		287625
  Fixes:		51172f62a753f
  Reviewed by:	adrian
  Differential Revision: https://reviews.freebsd.org/D50923

  (cherry picked from commit f51c794cbc80682931d47264e3c18329bae0a2c1)


   sys/net80211/ieee80211_node.c | 7 ++++---
   1 file changed, 4 insertions(+), 3 deletions(-)

[commit c87176dd16abdf3d957589eccf5c2864687e2674]
Date: 2025-06-18
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: fwget: pci_intel_video: do no log on no match
Review: The pci_intel_video driver no longer logs an error message when encountering an unsupported Intel GPU, preventing spurious messages in the installer.
Body:

  We should never "log" a statement on no match for a given device we
  do not know about.  We do not control the PCI ID assignments and thus
  cannot predict if we would even support such a device.

  This also triggers an invalid output in the installer.

  Leave it as log_verbose for now.

  Sponsored by:	The FreeBSD Foundation
  PR:		287639
  Reviewed by:	manu, emaste
  Differential Revision: https://reviews.freebsd.org/D50916

  (cherry picked from commit f1f71cc717aa672caf046ffe1f3dd77e622b8b35)


   usr.sbin/fwget/pci/pci_video_intel | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c4673251c9793353d52ed2e56b54fd6557466ac1]
Date: 2025-07-01
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: network.subr: MFC: correct return code in case of bad call to ifisup()
Review: The commit corrects a return code in a network script function, but the change is described as cosmetic and does not introduce user-visible behavior changes.
Body:

  This is rather cosmetic correction.

  PR:		287872

  (cherry picked from commit 24e8ed535ff673b9ea751c3d3b2a68ef0a29b0e2)


   libexec/rc/network.subr | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a5b6a029eb5ea6cfd5d285f7a5c08cb2c3b7b052]
Date: 2025-07-01
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: libexec/rc: MFC: improve performance of pccard_ether script
Review: The pccard_ether script in the rc system now uses ifconfig -n instead of ifconfig -ul, which improves performance when starting devd on systems with hundreds of network interfaces.
Body:

  Replace "ifconfig -ul" with "ifconfig -n" because netlink-enabled
  /sbin/ifconfig utility has sub-optimal performance for listing.

  Combined with the commit b1b17432aa1be670564161232d110461a5dde4ce,
  these changes mostly eliminate performance regression of the command
  "service devd start" for a system having hundreds of network interfaces
  created before devd starts, after FreeBSD 14+ switched
  /sbin/ifconfig to netlink(4)

  PR:		287872

  (cherry picked from commit 6d3bc576abbd84f736d917f5bfec4e3fe7e6c125)


   libexec/rc/network.subr | 20 ++++++++++++++++++++
   libexec/rc/pccard_ether | 17 +++++++++--------
   2 files changed, 29 insertions(+), 8 deletions(-)

[commit 8f43b39b1c38bde166314d4682daae7bf15a5445]
Date: 2025-07-01
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: ifconfig_netlink.c: MFC: optimise non-listing case
Review: The man:ifconfig[8] utility's performance for non-listing operations is restored after the switch to the netlink(4) API in FreeBSD 14+.
Body:

  This change produced by melifaro and the commit is concerted with him
  as he is pretty busy IRL these days.

  The change restores performance of /sbin/ifconfig utility
  for non-listing case after it switched from rtsock to netlink(4) API
  in FreeBSD 14+.

  PR:		287872

  (cherry picked from commit b1b17432aa1be670564161232d110461a5dde4ce)


   sbin/ifconfig/ifconfig_netlink.c | 6 ++++--
   1 file changed, 4 insertions(+), 2 deletions(-)

[commit af8af9b28c9d7c60f6f37971dc5b734c7f1bc413]
Date: 2025-07-01
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: fix parallel execution of swapon tests
Review: The commit fixes a test script for parallel execution and adjusts device detection, but these are internal test changes with no user-visible impact.
Body:

  And apparantly the CI env already has an md device so be relaxed about which md device is added.

  PR:	186252
  Reported by:	markj
  Fixes:	1ee33e3a578c35ff0e8ef5db87a8005f1f99546a "swapon: parse md.eli device for encrypted swapfile from fstab"
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1747

  (cherry picked from commit 83b08f40264177ecf03fce808474815816f9846f)


   sbin/swapon/tests/swapon_test.sh | 26 +++++++++++++-------------
   1 file changed, 13 insertions(+), 13 deletions(-)

[commit 0f15030a6eb6e4e0d7f22bffa27eb9be9ab233f8]
Date: 2025-06-26
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Network.general
Subject: pf: fix ICMP ECHO handling of ID conflicts
Review: The packet filter (PF) now correctly handles ICMP ECHO packets with duplicate IDs, such as from multiple Windows workstations pinging the same destination simultaneously. This resolves a regression where only one workstation could ping successfully after applying a security advisory.
Body:

  After applying FreeBSD-SA-24:05.pf, a problem with ICMP ECHO passing
  through PF NAT was raised: two or more Windows workstations cannot ping
  the same destination address at the same time. More precisely, only one
  workstation pings normally, while the pings of the others are rejected
  by the packet filter.

  The thing is that Windows always uses the same ICMP ID (1). Therefore,
  the state is created only for the workstation that started pinging
  earlier.

  In the pf_get_sport() function, we compare *nport with the ICMP_ECHO constant,
  while icmptype (virtual_type actually) is passed in the pd->ndport parameter.

  MFC after:	2 weeks
  Reviewed by:	kp

  (cherry picked from commit e7abf8829d8d496a8753946f67fb2016851b4f7c)


   sys/netpfil/pf/pf_lb.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 98e530b33891735cc573c538a90cdfde7ae99a96]
Date: 2025-07-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kern: add kern_nosys() and use it instead of type-punning the sys_nosys() arg
Review: Adds a new internal kernel function kern_nosys() and uses it to replace type-punning of sys_nosys() arguments, which is an internal refactoring with no user-visible impact.
Body:

  (cherry picked from commit 26061e4e542d220c577fb3437a9a9f108dc27698)


   sys/kern/kern_sig.c      | 9 +++++++--
   sys/kern/kern_syscalls.c | 5 +++--
   sys/kern/sysv_msg.c      | 2 +-
   sys/kern/sysv_sem.c      | 2 +-
   sys/kern/sysv_shm.c      | 2 +-
   sys/sys/syscallsubr.h    | 1 +
   6 files changed, 14 insertions(+), 7 deletions(-)

[commit d9290ae8657094879674ed280ee6ebfd89679eae]
Date: 2025-07-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sys/sysent.h: use two nibbles for flags, and remove unused SY_THR_FLAGMASK
Review: The commit is an internal kernel change that does not affect user-visible behavior, configuration, or interfaces.
Body:

  (cherry picked from commit baa15beed7f1f51c213ae434d3655c6664da8786)


   sys/sys/sysent.h | 9 ++++-----
   1 file changed, 4 insertions(+), 5 deletions(-)

[commit bc0d313bc84d3ef11be8c77ee65fe89cac73183b]
Date: 2025-07-07
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Kernel.general
Subject: aio: if there is at least one aio thread, hide an error from aio_init_aioinfo()
Review: The commit hides an error message from aio_init_aioinfo() when at least one aio thread exists, which may reduce spurious log noise for users of asynchronous I/O.
Body:

  (cherry picked from commit 0c38e3dbbf6eaa2755d34189149c9140cacd4bb1)


   sys/kern/vfs_aio.c | 9 ++++++++-
   1 file changed, 8 insertions(+), 1 deletion(-)

[commit bd5f7669c0fd14eec352552cb569915c5421e7c0]
Date: 2025-07-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: aio: handle errors from fork
Review: The aio subsystem now properly handles errors from fork, preventing potential kernel panics or undefined behavior when asynchronous I/O operations are active during a fork.
Body:

  (cherry picked from commit 4685fa8e4bef169e6a1ceaf07f149232326de805)


   sys/kern/vfs_aio.c | 35 +++++++++++++++++++++++++----------
   1 file changed, 25 insertions(+), 10 deletions(-)

[commit 48172ad390f7be9a0c6b6c141cdc266304157ca8]
Date: 2025-07-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: aio: make aio_init_aioinfo() and aio_aqueue() static
Review: The commit makes internal kernel functions static, which is a refactoring change with no user-visible impact.
Body:

  (cherry picked from commit c44439942cdb56cad8c7630444ff84447ca3866a)


   sys/kern/vfs_aio.c | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit dcb7a2befdeb26a3a7ed9e4f66ae649fc8266581]
Date: 2025-06-25
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: amd64 pmap: do not panic on inability to insert ptp into trie
Review: The kernel no longer panics when it cannot insert a page table page into the trie, improving system stability under certain memory pressure conditions.
Body:

  (cherry picked from commit 476d2d8f290f60cbbe6b546272a3485ef0316356)


   sys/amd64/amd64/pmap.c | 54 ++++++++++++++++++++++++++++++++++----------------
   1 file changed, 37 insertions(+), 17 deletions(-)

[commit 7b2ec2a562154c84f79140f1b174f649bfa0752f]
Date: 2025-06-22
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: amd64 pmap: update comment in pmap_demote_DMAP() explaining the len<NBPDP check
Review: Only updates a comment in the kernel's pmap code, with no user-visible changes.
Body:

  (cherry picked from commit ee502c8531833d7a0d4bc4c72cc05227f4a3715a)


   sys/amd64/amd64/pmap.c | 12 +++++++-----
   1 file changed, 7 insertions(+), 5 deletions(-)

[commit e02ab0b92fe253fba7052f5cd14a0a42a4bea76a]
Date: 2025-06-22
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: amd64 pmap: preallocate pt page for pmap_demote_pdpe() in pmap_demote_DMAP()
Review: The commit preallocates a page table page for pmap_demote_pdpe() in pmap_demote_DMAP() to prevent a potential kernel panic under high memory pressure. This change improves system stability when handling large direct map regions.
Body:

  (cherry picked from commit 6eb141a2c4731130bfac670708a8b90f7cdff742)


   sys/amd64/amd64/pmap.c | 53 ++++++++++++++++++++++++++++++++++++--------------
   1 file changed, 38 insertions(+), 15 deletions(-)

[commit 4c82dff1082bc1f8e7d6ae69a3ecd2cc97c2e758]
Date: 2025-06-22
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Drivers.device
Subject: dev/mem: use sx instead of rw lock
Review: The man:mem[4] driver now uses a sleepable lock (sx) instead of a reader-writer lock, which may affect performance or behavior of programs accessing /dev/mem.
Body:

  (cherry picked from commit ca554a7dea3f90f39fc2b7d25813d0be944e12e2)


   sys/dev/mem/memutil.c | 20 +++++++++-----------
   1 file changed, 9 insertions(+), 11 deletions(-)

[commit 1821af77efefd25ecdade590074f21fa976d086f]
Date: 2025-07-06
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.contrib
Subject: clang: install clang-scan-deps
Review: clang-scan-deps is installed by default. It is used to generate dependency information for C++20 modules and is required by build tools like CMake.
Body:

  clang-scan-deps is used to generate dependency information from C++20
  modules according to proposed standard ISO/IEC WG21 P1689R5[0].  It is
  required by common build tools (e.g., CMake) to build C++ sources
  that use modules.

  Since this is a core build tool, install it by default, not gated
  behind MK_CLANG_EXTRAS.

  [0] https://www.open-std.org/JTC1/SC22/WG21/docs/papers/2022/p1689r5.html

  MFC after:	3 days
  Reviewed by:	kevans, dim
  Approved by:	kevans (mentor)
  Requested by:	jbo
  Differential Revision:	https://reviews.freebsd.org/D51044

  (cherry picked from commit d3c06bed2c16b434dd49958dee5de8c55ad00b85)


   lib/clang/libclang/Makefile                        |  6 +++++
   usr.bin/clang/Makefile                             |  4 ++++
   usr.bin/clang/clang-scan-deps/Makefile             | 26 ++++++++++++++++++++++
   .../clang-scan-deps/clang-scan-deps-driver.cpp     | 18 +++++++++++++++
   4 files changed, 54 insertions(+)

[commit 103763fab4f7349df53f7367816f1f4ca2881005]
Date: 2024-05-24
Score: 5
Status: proposed(include=no,score=35)
Sponsor: Dell EMC Isilon
Section: undecided
Subject: vm_pageout_scan_inactive: take a lock break
Review: The commit improves system responsiveness by reducing lock contention in the pagedaemon, which may lower latency for applications accessing memory when the system is under memory pressure.
Body:

  In vm_pageout_scan_inactive, release the object lock when we go to
  refill the scan batch queue so that someone else has a chance to acquire
  it.  This improves access latency to the object when the pagedaemon is
  processing many consecutive pages from a single object, and also in any
  case avoids a hiccup during refill for the last touched object.

  Reviewed by:	alc, markj (previous version)
  Sponsored by:	Dell EMC Isilon
  Differential Revision:	https://reviews.freebsd.org/D45288

  (cherry picked from commit a216e311a70cc87a5646f4306e36c60a51706699)


   sys/vm/vm_pageout.c   | 16 +++++++++++++++-
   sys/vm/vm_pagequeue.h |  6 ++++++
   2 files changed, 21 insertions(+), 1 deletion(-)

[commit 791ac36668d518b3fff35c21176a31cab66c4e9b]
Date: 2025-07-03
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: random: Remove ARGSUSED annotations from random_harvestq.c
Review: Removes obsolete ARGSUSED annotations from the random device driver; no functional change.
Body:

  Such annotations are obsolete, the compiler tells us when parameters are
  unused.  No functional change intended.

  Reviewed by:	cem
  MFC after:	1 week
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51114

  (cherry picked from commit 5e213d8a7462968e10370506a4905eab0dd48e65)


   sys/dev/random/random_harvestq.c | 6 ------
   1 file changed, 6 deletions(-)

[commit 475a36762f9df862b8cce310fccaed3b36ae3cc6]
Date: 2025-07-03
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: random: Define a macro for getting the CPU cycle count
Review: Internal refactoring with no user-visible change.
Body:

  Entropy queue entries always include the low 32 bits of a CPU cycle
  count reading.  Introduce a macro for this instead of hard-coding
  get_cyclecount() calls everywhere; this is handy for testing purposes
  since this way, random(4)'s use of the cycle counter (e.g., the number
  of bits we use) can be changed in one place.

  No functional change intended.

  Reviewed by:	cem, delphij
  MFC after:	1 week
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51113

  (cherry picked from commit e2a96b83404fcee0a079a3c3adbb448b86a38d1e)


   sys/dev/random/random_harvestq.c | 9 +++++----
   sys/dev/random/random_harvestq.h | 9 +++++++++
   sys/dev/random/randomdev.c       | 6 +++---
   3 files changed, 17 insertions(+), 7 deletions(-)

[commit 11d1a5c57900b9cc77c6b56516c7be3fda4ecc0e]
Date: 2025-07-03
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: random: Move entropy harvest queue lock macros to random_harvestq.c
Review: Internal macros are moved from a header to a source file with no functional change.
Body:

  They can't be used externally, so it makes no sense to have them in a
  header.  No functional change intended.

  Reviewed by:	cem
  MFC after:	1 week
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51111

  (cherry picked from commit 4b8b872a9c55c040eb83f917fc8fd2bf908b96a9)


   sys/dev/random/random_harvestq.c | 5 +++++
   sys/dev/random/random_harvestq.h | 4 ----
   2 files changed, 5 insertions(+), 4 deletions(-)

[commit cf1b83414f1e6bbbcbc22470781e67fc7fe430c9]
Date: 2025-07-03
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Stormshield | Klara, Inc.
Section: undecided
Subject: random: Replace a comment with a static assertion
Review: No functional change; only a comment replaced with a static assertion.
Body:

  No functional change intended.

  Reviewed by:	cem
  MFC after:	1 week
  Sponsored by:	Stormshield
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D51110

  (cherry picked from commit 6ccf1801f225a5e3e71d5b707646731542a994c7)


   sys/dev/random/random_harvestq.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 7a96c75098afe071e49755f1beccaaf08f9ae13f]
Date: 2025-06-21
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Orange Business Services
Section: Network.general
Subject: pf: limit extra SCTP states
Review: The pf(4) firewall limits the number of extra SCTP endpoints per connection to 8 per side to prevent state table exhaustion from malicious use.
Body:

  For SCTP we create states for all combinations of endpoints, to allow multihoming to work.
  Malicious users could abuse this to fill our state table more easily
  than they otherwise could, because we create states between all
  combinations of endpoints. Limit this to no more than 8 extra endpoints
  for each side of the connection.

  MFC after:	2 weeks
  Sponsored by:	Orange Business Services

  (cherry picked from commit cd0169c9379c400ec75b77e87ca770e37f964276)


   sys/netpfil/pf/pf.c          | 11 +++++++++++
   tests/sys/netpfil/pf/sctp.py | 28 ++++++++++++++++++++++++++++
   2 files changed, 39 insertions(+)

[commit 5098a5b48357d4d51ad8369330d292e6bbd7490e]
Date: 2025-06-25
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Drivers.device
Subject: md: Use a larger buffer for the ident string
Review: The memory disk driver (man:md[4]) now uses a larger buffer for the ident string, preventing truncation and ensuring unique identifiers.
Body:

  With the old size, the string could easily be truncated, resulting in
  non-unique identifiers.

  PR:		287679
  Reported by:	Phil Krylov <phil@krylov.eu>
  Reviewed by:	kib
  MFC after:	2 weeks

  (cherry picked from commit 5286b96c56ff5aa3c1cee824ab8564f0ffffc381)


   sys/dev/md/md.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d162d59c393dacdcd6867e5ed7af2edc5cc0cddf]
Date: 2025-06-20
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: Userland.programs
Subject: localedef: Use consistent sorting order
Review: The localedef utility now uses unsigned comparisons for wide character sorting, ensuring consistent output ordering across platforms. This affects only the zh_CN.GB18030/LC_CTYPE locale file on systems with signed wchar_t.
Body:

  In several modules we build up an RB tree keyed by wide characters.
  wchar_t has different signedness on different platforms, so iteration
  over such a tree results in platform-dependent ordering.

  The ctype module uses this ordering when writing the output file, which
  creates reproducibility problems when comparing the results of cross
  builds and native builds (e.g., native amd64 vs. cross-building on
  arm64).

  Modify such comparisons to always be unsigned.  Introduce a helper
  function for this purpose.  In the other modules I believe the sort
  order does not affect program output.

  On systems with signed wchar_t, of the files in /usr/share/locale this
  only affects zh_CN.GB18030/LC_CTYPE.

  MFC after:	2 weeks
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50756

  (cherry picked from commit 770fba248daff6cc72ce0bfbd1f2a941c90dc99a)


   usr.bin/localedef/charmap.c   |  2 +-
   usr.bin/localedef/collate.c   |  2 +-
   usr.bin/localedef/ctype.c     |  2 +-
   usr.bin/localedef/localedef.h | 15 +++++++++++++++
   4 files changed, 18 insertions(+), 3 deletions(-)

[commit 10d14a37206e77e050676c8fbd96600f9101cf8b]
Date: 2025-06-20
Score: 5
Status: proposed(include=no,score=15)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: undecided
Subject: localedef: Fix a wchar_t comparison
Review: Fixes a bug in man:localedef[1] that only affects collation for the zh_CN.GB18030 locale on systems where wchar_t is signed.
Body:

  The intent here is to characterize wide characters which fit in a single
  byte.  When wchar_t is signed, this comparison is insufficient.

  On systems with signed wchar_t, of the files in /usr/share/locale this
  only affects zh_CN.GB18030/LC_COLLATE.

  MFC after:	2 weeks
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50757

  (cherry picked from commit a37bc4cb8d2c5c8402341c9df75580f60bb34186)


   usr.bin/localedef/collate.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6750c124c71c83eb6c4a6a349572ec24d7668441]
Date: 2025-07-03
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: md: Restore guards in mddestroy()
Review: The commit restores missing guards in the mddestroy() function, which could affect the reliability of memory disk device destruction and prevent potential use-after-free issues.
Body:

  (cherry picked from commit 5ae9f8e9ac5e1307fed4f7f2549347576f01b3fa)


   sys/dev/md/md.c | 25 ++++++++++++++++---------
   1 file changed, 16 insertions(+), 9 deletions(-)

[commit 20fb1e32a23175b5c555e32a36897783838a9f30]
Date: 2025-07-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: md(4): move type-specific data under union
Review: The commit restructures internal data representation in man:md[4] but does not introduce user-visible changes in behavior, features, or configuration.
Body:

  (cherry picked from commit e91022168101867664e08b4de1f3f09ed4af231c)


   sys/dev/md/md.c | 263 +++++++++++++++++++++++++++++++++-----------------------
   1 file changed, 155 insertions(+), 108 deletions(-)

[commit 39996120a019b620b89fea74f5fb77cfc0d80856]
Date: 2024-04-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Fix new users of MAXPHYS and hide it from the kernel namespace
Review: The commit changes kernel consumers from MAXPHYS to maxphys, which is an internal refactoring without user-visible impact. It does not affect functionality, configuration, or userland interfaces.
Body:

  This is partial MFC, that changes the kernel consumers to use maxphys
  instead of MAXPHYS, but leaves the header rearrangement out.

  (cherry picked from commit 13a5a46c49d0ec3e10e5476ad763947f165052e2)


   sys/compat/linux/linux_socket.c | 2 +-
   sys/dev/md/md.c                 | 6 +++---
   sys/dev/rtsx/rtsx.c             | 4 ++--
   3 files changed, 6 insertions(+), 6 deletions(-)

[commit 0dabd0382cf7bba6c94078589a65c9342b4d6479]
Date: 2025-06-27
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: nuageinit: fix log name
Review: The nuageinit script now logs to the correct log file name.
Body:

  (cherry picked from commit 7ad574b3e3a948113c3c16cbe90e27888dc7a423)


   libexec/rc/rc.d/nuageinit_user_data_script | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 7151c780ac95f90cc5f601eb06849f32e073d5b7]
Date: 2025-06-26
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: fix setting owner when only the user is set
Review: The nuageinit utility now correctly sets file ownership when only the user is specified, preventing potential permission errors.
Body:

  (cherry picked from commit 3969965c7f156f0fe3e1dc8799362375cb53208a)


   libexec/nuageinit/nuage.lua | 3 +++
   1 file changed, 3 insertions(+)

[commit 56054f0c6521d89d18e9f1b368e25ca0d4a1d958]
Date: 2025-06-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: nuageinit: write_files fix typo breaking tests
Review: Fixes a typo in nuageinit's Lua script that was causing test failures.
Body:

  (cherry picked from commit d9a4c24df1c438e7cd561396e57937be3b105135)


   libexec/nuageinit/nuage.lua | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 7508443b1604bf1adae99f866770deac1bcdce29]
Date: 2025-06-26
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.contrib
Subject: nuageinit: enhance sudo support
Review: nuageinit now supports both string and array-of-string formats for sudo rules, aligning with the cloudinit specification.
Body:

  from the cloudinit specification sudo rules can be a string or an
  array of string

  (cherry picked from commit b56d2195f124d48ce54369d179aa1d4663e5e64a)


   libexec/nuageinit/nuage.lua          | 8 +++++++-
   libexec/nuageinit/nuageinit.7        | 2 +-
   libexec/nuageinit/tests/nuageinit.sh | 8 +++++++-
   3 files changed, 15 insertions(+), 3 deletions(-)

[commit 8800003ecf9bbee04fba4447645f94c2d15cb74f]
Date: 2025-06-26
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.libraries
Subject: libyaml: add missing mtree entry
Review: The commit adds a missing mtree entry for libyaml, which ensures that the directory structure for libyaml is properly created during installation, affecting users who install or upgrade the system.
Body:

  (cherry picked from commit 442472e1b72a8b540df3fe038ed96615fc0abd68)


   etc/mtree/BSD.usr.dist | 2 ++
   1 file changed, 2 insertions(+)

[commit d056f72c358b4f962b09f5c752567ff543fe87c6]
Date: 2025-06-26
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: implement write_files
Review: The nuageinit utility now supports creating files at first boot via a write_files configuration, allowing plain text or base64-encoded content with options for permissions, ownership, and timing relative to package installation.
Body:

  write_files is a list of files that should be created at the first boot

  each file content can be either plain text or encoded in base64 (note
  that cloudinit specify that gzip is supported, but we do not support it
  yet.)

  All other specifier from cloudinit should work:
  by default all files will juste overwrite exesiting files except if
  "append" is set to true, permissions, ownership can be specified.
  The files are create before packages are being installed and user
  created.

  if "defer" is set to true then the file is being created after packages
  installation and package manupulation.

  This feature is requested for KDE's CI.

  (cherry picked from commit 19a7ea3cc4de5af80e2913fda70bd65ad72835c0)


   libexec/nuageinit/nuage.lua          | 88 +++++++++++++++++++++++++++++++++++-
   libexec/nuageinit/nuageinit          | 25 +++++++++-
   libexec/nuageinit/nuageinit.7        | 38 +++++++++++++++-
   libexec/nuageinit/tests/Makefile     |  1 +
   libexec/nuageinit/tests/addfile.lua  | 71 +++++++++++++++++++++++++++++
   libexec/nuageinit/tests/nuage.sh     | 10 +++-
   libexec/nuageinit/tests/nuageinit.sh | 37 ++++++++++++++-
   7 files changed, 264 insertions(+), 6 deletions(-)

[commit ee1fd6b260c04560f424e4dc974b966b41af8dba]
Date: 2025-06-25
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: OVHCloud
Section: Userland.config
Subject: nuageinit: launch post network script with postnet citype
Review: The nuageinit post-network script now runs with the postnet citype, ensuring proper execution order for network-dependent services.
Body:

  Sponsored by:	OVHCloud

  (cherry picked from commit dba00b1c6bc1bb9753bf0a554eab04077e85e214)


   libexec/rc/rc.d/nuageinit_post_net | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 4ea761b726fe6a3531a7f7a17933226c03a7c772]
Date: 2024-09-12
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.contrib
Subject: flua: add freebsd.kenv, kenv(2) bindings
Review: Adds kenv(2) bindings to flua, providing a way to retrieve kernel environment variables from Lua scripts. The new man:freebsd.kenv[3lua] module includes a get() function that returns either a key/value table of the entire kernel environment or the value for a specific key.
Body:

  Add bindings for kenv(2) right now only get() has been created
  it allows do dump into a key/value table the kernel environement if
  no argument is passed, or it returns the value associated to the
  provided key.

  Reviewed by:	imp, kevans, markj
  Accepted by:	imp, kevans
  Differential Revision:	https://reviews.freebsd.org/D46654

  (cherry picked from commit 696922fbfa3e1c400701a3a39dcadf7dee12b06c)


   libexec/flua/libfreebsd/Makefile               |  1 +
   libexec/flua/libfreebsd/Makefile.inc           |  2 +
   libexec/flua/libfreebsd/kenv/Makefile          |  5 ++
   libexec/flua/libfreebsd/kenv/freebsd.kenv.3lua | 44 ++++++++++++
   libexec/flua/libfreebsd/kenv/kenv.c            | 96 ++++++++++++++++++++++++++
   5 files changed, 148 insertions(+)

[commit 178a01e3b9a4497a424ca0f80f456f189bf6a635]
Date: 2024-09-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: freebsd.sys.linker: remove license to only keep SPDX line
Review: The commit removes license text from internal Lua modules, which does not affect user-visible functionality, configuration, or behavior.
Body:

  (cherry picked from commit fa4b5aa51f1b3971e92f831b8e67e83aaed3c212)


   .../libfreebsd/sys/linker/freebsd.sys.linker.3lua  | 21 ---------------------
   libexec/flua/libfreebsd/sys/linker/linker.c        | 22 ----------------------
   2 files changed, 43 deletions(-)

[commit 7a83385d4754542ddf4e1cac36787d3973ced86b]
Date: 2024-09-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: flua: install linker in the right patch
Review: The commit fixes a build-time installation path for an internal component (flua linker) with no user-visible impact.
Body:

  When moving the freebsd.sys.linker sources the installation path
  was lost.

  Fixes 7899f917b1c0ea178f1d2be0cfb452086d079d23

  (cherry picked from commit cbf53f5e370e2f6ed0dbd2305b48719fcfc6cec8)


   libexec/flua/libfreebsd/sys/Makefile.inc | 2 ++
   1 file changed, 2 insertions(+)

[commit cf48057f3ea9cf19e31fb03404bc2a73cc35ba43]
Date: 2024-09-09
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: flua: move modules source into the main source directory
Review: The commit moves flua module source directories and changes build integration, but does not introduce user-visible changes in functionality, features, or behavior. It is an internal build system reorganization.
Body:

  Follow the path of what is done with bsnmp, build the modules along
  with the main binary, this allows to build the modules at a moment
  where all needed libraries are already built and available in the
  linker path instead of having to declare all the libraries which a
  flua module will be linked to in _prebuild_libs.

  Discused with:	markj
  Reviewed by:	markj, jrtc27, kevans, imp
  Accepted by:	kevans, imp
  Differential Revision:	https://reviews.freebsd.org/D46610

  (cherry picked from commit 7899f917b1c0ea178f1d2be0cfb452086d079d23)


   Makefile.inc1                                              |  4 +---
   lib/Makefile                                               |  5 -----
   lib/flua/Makefile                                          |  6 ------
   lib/flua/libfreebsd/sys/linker/Makefile                    | 12 ------------
   lib/flua/libhash/Makefile                                  | 14 --------------
   libexec/flua/Makefile                                      |  5 +++++
   libexec/flua/Makefile.inc                                  |  5 +++++
   {lib => libexec}/flua/libfreebsd/Makefile                  |  0
   libexec/flua/libfreebsd/Makefile.inc                       |  1 +
   {lib => libexec}/flua/libfreebsd/sys/Makefile              |  0
   libexec/flua/libfreebsd/sys/Makefile.inc                   |  1 +
   libexec/flua/libfreebsd/sys/linker/Makefile                |  7 +++++++
   .../flua/libfreebsd/sys/linker/freebsd.sys.linker.3lua     |  0
   {lib => libexec}/flua/libfreebsd/sys/linker/linker.c       |  0
   libexec/flua/libhash/Makefile                              |  9 +++++++++
   {lib => libexec}/flua/libhash/hash.3lua                    |  0
   {lib => libexec}/flua/libhash/lhash.c                      |  0
   {lib => libexec}/flua/libhash/lhash.h                      |  0
   {lib => libexec}/flua/libjail/Makefile                     |  5 -----
   {lib => libexec}/flua/libjail/jail.3lua                    |  0
   {lib => libexec}/flua/libjail/lua_jail.c                   |  0
   {lib => libexec}/flua/libucl/Makefile                      |  3 ---
   stand/defs.mk                                              |  2 +-
   23 files changed, 30 insertions(+), 49 deletions(-)

[commit 0b31a05166b3594ade1ca3ab28df73b746b8bdd1]
Date: 2024-09-07
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: prebuild_libs: register libucl dependency on libm
Review: The commit adds a missing libm dependency for libucl, which may affect linking of programs using libucl.
Body:

  Reported by:	Rainer Hurling <rhurlin@gwdg.de>

  (cherry picked from commit 9f0f4e23a584b5aa965aae774bb2dc1e5892d24a)


   Makefile.inc1 | 1 +
   1 file changed, 1 insertion(+)

[commit 96c10cda41eee13182d1ac8b9e0842e5244711bf]
Date: 2024-09-07
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: flua: fix buildworld from a clean room
Review: Fixes a buildworld issue when building from a clean environment by adjusting library dependencies, ensuring the flua ucl module can link against libucl.
Body:

  now that the flua ucl module is built the lib directory, it is being
  build at a moment where it cannot link yet to libucl, push libucl in
  the _prebuild_libs to ensure it is present in a path to be linked
  against at the time the lua ucl module is being built.

  While here, remove libucl from boostrap as a dependence of flua as it is
  not needed anymore now that flua ucl module is dynamically loadable.


   Makefile.inc1 | 7 ++++---
   1 file changed, 4 insertions(+), 3 deletions(-)

[commit c3d3155c55cec77a7fb3dc9e44f24bdb6ae9ea84]
Date: 2024-09-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: flua: hook libfreebsd to the build
Review: The commit adds libfreebsd to the flua build, but this is an internal build system change without direct user-visible impact.
Body:


   lib/flua/Makefile | 1 +
   1 file changed, 1 insertion(+)

[commit 15c15f78b1209eead6d81f54d94aa7fd1915d5eb]
Date: 2024-09-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: lua_ucl: make sure flua gets build after libucl
Review: The commit adjusts a build order dependency between flua and libucl, which is an internal build system change with no user-visible impact.
Body:


   lib/Makefile | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 2cab763fc87f316a5a2972f9e7feaf5ed41ebcd1]
Date: 2024-09-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: freebsd.sys.linker: rename source file
Review: Internal refactoring only; no user-visible impact.
Body:

  Suggested by:	markj

  (cherry picked from commit 705583b76f3fba9e8c3cf77142e8ac84de721ac1)


   lib/flua/libfreebsd/sys/linker/Makefile                               | 2 +-
   lib/flua/libfreebsd/sys/linker/{lua_freebsd_sys_linker.c => linker.c} | 0
   2 files changed, 1 insertion(+), 1 deletion(-)

[commit d9b415c9f1c8201e828dfc08640927eca8b2f64c]
Date: 2024-09-06
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.libraries
Subject: flua: add freebsd module implementing kldload/kldunload
Review: The FreeBSD module for Lua adds man:freebsd.sys.linker[3lua] functions to load and unload kernel modules via kldload and kldunload. This provides Lua scripts with the ability to dynamically manage kernel modules.
Body:

  Reviewed by:	markj, imp
  Approved by:	imp
  Differential Revision:	https://reviews.freebsd.org/D46558


   etc/mtree/BSD.usr.dist                             |   4 +
   lib/flua/libfreebsd/Makefile                       |   3 +
   lib/flua/libfreebsd/sys/Makefile                   |   4 +
   lib/flua/libfreebsd/sys/linker/Makefile            |  12 +++
   .../libfreebsd/sys/linker/freebsd.sys.linker.3lua  |  67 +++++++++++++
   .../libfreebsd/sys/linker/lua_freebsd_sys_linker.c | 104 +++++++++++++++++++++
   6 files changed, 194 insertions(+)

[commit e6e6ac56887b6072cc6cafce454cb0ef3a4e6ad9]
Date: 2024-09-06
Score: 5
Status: proposed(include=no,score=35)
Sponsor: 
Section: undecided
Subject: flua: make the ucl module a dynamic module
Review: The flua ucl module is now built as a dynamic module instead of being statically linked.
Body:

  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D46569

  (cherry picked from commit bb2d016afb009920f4bb2400c15a86e557b2d55a)


   lib/flua/Makefile         |  1 +
   lib/flua/libucl/Makefile  | 17 +++++++++++++++++
   libexec/flua/Makefile     |  9 ++-------
   libexec/flua/linit_flua.c |  2 --
   4 files changed, 20 insertions(+), 9 deletions(-)

[commit a9475bf3dfb23782ce9e1d4da16473b2f9597d6b]
Date: 2025-07-01
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Rubicon Communications, LLC ("Netgate")
Section: undecided
Subject: bectl: Print activate message in a single line
Review: bectl now prints the activation message on a single line when using the -t flag.
Body:

  When -t parameter is used, bectl prints a complementary message "for
  next boot" on a second line.  Change it to print entire message on a
  single line.

  Reviewed by:	kevans
  MFC after:	1 week
  Sponsored by:	Rubicon Communications, LLC ("Netgate")
  Differential Revision:	https://reviews.freebsd.org/D49439

  (cherry picked from commit e690b6519ae70921b084d5df0e707abaf848d795)


   sbin/bectl/bectl.c | 8 +++++---
   1 file changed, 5 insertions(+), 3 deletions(-)

[commit cdba3a8f9fce453774833f2f1123536cd17003b8]
Date: 2025-07-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: gpio: attach gpiobus when the controller is ready
Review: The gpiobus attachment timing is corrected to ensure GPIO controllers are fully initialized before children devices attach. This prevents potential issues with GPIO device drivers that depend on proper controller initialization.
Body:

  Only attach gpiobus when the controller is fully initialized. Children
  of gpiobus expect this to be the case.

  Reviewed by:	mmel, imp, andrew
  Approved by:	imp (mentor)
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D51088

  (cherry picked from commit 4695e3aa7c685c092cb4b2662bee16c31be790f8)


   sys/arm/allwinner/aw_gpio.c               |  8 ++++----
   sys/arm/broadcom/bcm2835/bcm2835_gpio.c   |  6 +++---
   sys/arm/nvidia/as3722_gpio.c              |  2 +-
   sys/arm64/nvidia/tegra210/max77620_gpio.c |  2 +-
   sys/arm64/rockchip/rk_gpio.c              | 12 ++++++------
   sys/dev/gpio/pl061.c                      | 12 ++++++++++--
   sys/dev/gpio/pl061.h                      |  1 +
   sys/dev/gpio/pl061_acpi.c                 | 15 ++++-----------
   sys/dev/gpio/pl061_fdt.c                  | 15 ++++-----------
   sys/dev/gpio/qoriq_gpio.c                 | 11 ++++++-----
   sys/dev/iicbus/gpio/tca64xx.c             |  3 +--
   sys/powerpc/mpc85xx/mpc85xx_gpio.c        |  4 ++--
   12 files changed, 43 insertions(+), 48 deletions(-)

[commit c6a6b94b661378961179d832be6f1eceef91f953]
Date: 2025-07-04
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Drivers.device
Subject: gpiobus: add a gpiobus_add_bus function
Review: Adds a new gpiobus_add_bus function to allow drivers to postpone gpiobus attachment until hardware initialization is complete.
Body:

  Some drivers need to postpone the attachment of gpiobus until hardware
  init is done. Add a new gpiobus_add_bus function to accommodate this
  case.

  Suggested by:	mmel, andrew
  Reviewed by:	mmel, imp, andrew
  Approved by:	imp (mentor)
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D51133

  (cherry picked from commit 2c356c8b8f79c08d42b23a72b7a320b59d955a3f)


   sys/dev/gpio/gpiobus.c    | 20 ++++++++++++++++++--
   sys/dev/gpio/gpiobusvar.h |  1 +
   2 files changed, 19 insertions(+), 2 deletions(-)

[commit 32c90988d204ca2c7ede51de9474756db5be27d0]
Date: 2025-07-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: gpio: remove redundant calls to bus_attach_children
Review: Removes redundant calls to bus_attach_children in the GPIO drivers for mvebu and tegra hardware, which may slightly improve driver initialization efficiency but has no direct user-visible impact.
Body:

  gpiobus_attach_bus already calls it.

  Reviewed by:	mmel, imp, andrew
  Approved by:	imp (mentor)
  MFC after:	3 days
  Differential Revision:	https://reviews.freebsd.org/D51108

  (cherry picked from commit c2d8cca77152ebf72f488490163585be7e34eb0f)


   sys/arm/mv/mvebu_gpio.c     | 2 +-
   sys/arm/nvidia/tegra_gpio.c | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit f28690ec6a6a0e5cc8465c0cfb78c866df3b3272]
Date: 2024-11-13
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: pf.conf.5: use subsections and reword titles
Review: The man:pf.conf[5] man page is reorganized to improve clarity and navigation by moving parameters into subsections and rewording titles.
Body:

  The current manpage has two PARAMETERS top-level sections, which can be
  confusing when searching or browsing documentation quickly.

  Since the parameters described in these two sections are actually
  applicable within the scope of the sections they follow (ETHERNET
  FILTERING and PACKET FILTERING respectively), I propose we move them to
  subsections.

  I also propose we reword the title of one of those subsections to
  facilitate quick searching or browsing.

  MFC after: 3 days
  Reviewed by: imp, ziaee
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1516
  Closes: https://github.com/freebsd/freebsd-src/pull/1516

  (cherry picked from commit 12859ee366d084b5506d58b030079f839c4915e3)


   share/man/man5/pf.conf.5 | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 0077daf9cdc45cf36e7cc2ca3b65252194221400]
Date: 2024-11-07
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Docs.manpages
Subject: pf.conf.5: additional quoting for ranges in lists
Review: The man:pf.conf[5] man page now documents that network address ranges used as items in list macros must be quoted with additional single quotes.
Body:

  When defining network address ranges in macros that will later be used
  as items in list macro, these ranges must be quoted with additiona
  simple quotes.

  For instance, the following does not work and is rejected as a syntax
  error:

      usr = "192.168.1.0/24"
      srv = "192.168.2.10 - 192.168.29"
      nat_ranges = "{" $usr $srv "}"

  Defining ranges as the following instead will work:
      usr = "'192.168.1.0/24'"
      srv = "'192.168.2.10 - 192.168.29'"

  MFC after: 3 days
  Reviewed by: imp, ziaee
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1516

  (cherry picked from commit 54f278caf37f9ab578ee58fc70c7b66446ea7e84)


   share/man/man5/pf.conf.5 | 7 +++++++
   1 file changed, 7 insertions(+)

[commit 1a55bc50656bd46639dd1fbde2cc0ab8a85d1e7c]
Date: 2024-10-17
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: acpi_wmi.4: fall cleaning
Review: The commit updates the man:acpi_wmi[4] manual page with improved examples, a GitHub repository URL, and minor grammar and markup fixes. These changes enhance documentation clarity but do not introduce user-visible functional changes.
Body:

  + add descriptions to existing examples
  + github repo url in sysctls => port named in example using it
  + reword MOF description for consistency with external docs
  + restore standard link, move to STANDARDS
  + grammar and markup nits + tag SPDX

  MFC after:	3 days
  Reviewed by:	imp
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1477
  Closes:		https://github.com/freebsd/freebsd-src/pull/1477

  (cherry picked from commit 954ac4049852cc1cf6d6074d9247b67f02b84b12)


   share/man/man4/acpi_wmi.4 | 61 ++++++++++++++++++++++++++++-------------------
   1 file changed, 37 insertions(+), 24 deletions(-)

[commit 8cc376735c65a18c53a70c30957a5f56dd066b79]
Date: 2025-06-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: pfsync: Allocate and initialize buckets before attaching the interface
Review: The pfsync interface now initializes its buckets before attaching, preventing a potential race condition that could cause ioctl threads to see uninitialized data.
Body:

  This prevents a potential race that the ioctl threads see NULL or
  uninitialized buckets.

  Reviewed by:	kp
  Fixes:		4fc65bcbe3fb pfsync: Performance improvement
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51064

  (cherry picked from commit edc307eca9a9a9b0ce7445cff513b48f6489e5c6)


   sys/netpfil/pf/if_pfsync.c | 33 ++++++++++++++++-----------------
   1 file changed, 16 insertions(+), 17 deletions(-)

[commit efbaf14c5b681c8f1a04a47c7bf8740134fff098]
Date: 2025-06-28
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Network.general
Subject: pfsync: Destroy buckets mutexes on clone destroying interface
Review: The pfsync interface now properly destroys mutexes when a clone interface is destroyed, preventing resource leaks.
Body:

  So that the associated data with them will be freed.

  Reviewed by:	kp
  Fixes:		4fc65bcbe3fb pfsync: Performance improvement
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D51063

  (cherry picked from commit 8213c07c20586a67bc7f7152bd7ff76c02cbc007)


   sys/netpfil/pf/if_pfsync.c | 4 ++++
   1 file changed, 4 insertions(+)

[commit ff54b680383bb0f212e813b74e7a3f76423d2238]
Date: 2025-06-27
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: if_vlan: Fix up if_type before attaching the interface
Review: The vlan(4) interface type is now correctly reported as IFT_L2VLAN from creation, preventing race conditions and ensuring correct reporting to event listeners like netlink.
Body:

  ether_ifattach() does not touch if_type, so it is not mandatory to fix
  the if_type after ether_ifattach(). Without this change, the event
  listeners, e.g. netlink, will see wrong interface type IFT_ETHER rather
  than the correct one IFT_L2VLAN. There is also a potential race that
  other threads see inconsistent interface type, i.e. initially IFT_ETHER
  and eventually IFT_L2VLAN.

  As a nice effect, this change eliminates the memory allocation for
  if_hw_addr, as vlan(4) interfaces do not support setting or retrieving
  the hardware MAC address yet [1].

  [1] ddae57504b79 Persistently store NIC's hardware MAC address, and add a way to retrive it

  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50914

  (cherry picked from commit a19b353d354d4ef808965c53253103cb6e7e6708)


   sys/net/if_vlan.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 99d4e2870c03ce86855fa2edab2fe9af0d3ff410]
Date: 2025-06-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ifnet: Eliminate unnecessary synchronization of the interface index in the link layer address
Review: The commit removes unnecessary synchronization of interface indices in link layer addresses when moving interfaces between vnets, with no functional change intended.
Body:

  Change 80e60e236d85 made the if_index global, and for the whole lifecycle
  of an interface its index never changes, then there is no need to
  synchronize the interface index in the link layer address when moving
  interfaces from one vnet to another.

  No functional change intended.

  Reviewed by:	glebius
  Fixes:		80e60e236d85 ifnet: make if_index global
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50975

  (cherry picked from commit 0b4c4833ee3eab0ce46b3bdbf054bca4b6bb7429)


   sys/net/if.c | 15 ---------------
   1 file changed, 15 deletions(-)

[commit 3bb09e6b1930b58d9d92aa3f28515114631a1d6b]
Date: 2025-06-21
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Network.general
Subject: ethernet: Set maximum Ethernet header length based on the capability IFCAP_VLAN_MTU
Review: The maximum Ethernet header length is now automatically set based on the IFCAP_VLAN_MTU capability, reducing the need for per-driver adjustments.
Body:

  Lots of Ethernet drivers fix the header length after ether_ifattach().
  Well since the net stack can conclude it based on the capability
  IFCAP_VLAN_MTU, let the net stack do it rather than individual drivers.

  Reviewed by:	markj, glebius
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50846

  (cherry picked from commit 6ce8fd1978a9526ff0dc02ed98ef797f9154ec1f)


   sys/net/if_ethersubr.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 193f0bde3b048559d36c3e6db5d6b2be7daeaf6f]
Date: 2025-06-16
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: bridge: Remove a redundant assignment of if_type
Review: No user-visible change; internal cleanup only.
Body:

  ether_ifattach() no longer sets if_type to IFT_ETHER and keeps it as is
  since the change [1].

  [1] fc74a9f93a5f Stop embedding struct ifnet at the top of driver softcs

  No functional change intended.

  MFC after:	1 week

  (cherry picked from commit a07604e6264b88222941fa61c6f989bad5490765)


   sys/net/if_bridge.c | 1 -
   1 file changed, 1 deletion(-)

[commit 082a6da890f3487f1465c0757784798ebe38ef84]
Date: 2025-06-16
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: pfsync: Remove a redundant assignment of if_type
Review: No functional change; internal cleanup only.
Body:

  On initializing the interface, if_alloc(IFT_PFSYNC) has set if_type
  already.

  No functional change intended.

  MFC after:	1 week

  (cherry picked from commit 48af70e7c82150942fd095a38131e454e47ad162)


   sys/netpfil/pf/if_pfsync.c | 1 -
   1 file changed, 1 deletion(-)

[commit 3da0853d71197610375262b8bb06cadda6c8f4dc]
Date: 2025-06-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ng_iface(4): Remove a redundant assignment of if_type
Review: No user-visible change; internal cleanup only.
Body:

  That is unnecessary since change [1], as if_alloc(IFT_PROPVIRTUAL) has
  set if_type already.

  [1] fc74a9f93a5f Stop embedding struct ifnet at the top of driver softcs

  No functional change intended.

  MFC after:	1 week

  (cherry picked from commit c43d6dadf7e34a94f4d119ff6d7113ad9a9b4d38)


   sys/netgraph/ng_iface.c | 1 -
   1 file changed, 1 deletion(-)

[commit 1ddf7942c331d61657aefbbf9998d00c27c25bef]
Date: 2025-06-06
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: git-blame-ignore-revs: iflib style(9) tweaks
Review: Adds a commit hash to .git-blame-ignore-revs for internal tooling.
Body:

  Hash is updated to match MFC commit.

  (cherry picked from commit 898a886b4504cd9c7fe7dddd918cd64c068b1cfe)


   .git-blame-ignore-revs | 2 ++
   1 file changed, 2 insertions(+)

[commit a2989d11eabeb869b8c845a097d4214755d9a99f]
Date: 2025-06-06
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: iflib: Some style(9) tweaks
Review: Style-only changes with no user-visible impact.
Body:

  Prefer tab over eight whitespaces for indentation, and four spaces as
  second level idents.

  MFC after:	3 days

  (cherry picked from commit 721e783a2a3316826f92fb44c931e28163118b3f)


   sys/net/iflib.c | 208 ++++++++++++++++++++++++++++----------------------------
   1 file changed, 104 insertions(+), 104 deletions(-)

[commit 3bc1aea4cc8a448ffd2e1477950da5e494cf1375]
Date: 2025-06-01
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: if_firewire: Make firewire_broadcastaddr static const
Review: No functional change; internal variable scope and const qualifier change only.
Body:

  This global variable is used only in this file. While here, constify it
  since it is only used to read.

  No functional change intended.

  MFC after:	1 week

  (cherry picked from commit 517eb20e54e59173b9dbede0bb3356f6197b5aa9)


   sys/net/if_fwsubr.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 2466a18711548113d3ca4c61ccc7d6717adb6ade]
Date: 2025-05-22
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Network.general
Subject: ifnet: Initialize the address family dependent data region earlier
Review: The ifnet address family dependent data region is initialized earlier to prevent race conditions when interfaces are referenced via ifunit() or ifunit_ref(). This ensures that threads see the correct data for network interface operations.
Body:

  if_link_ifnet() adds the interface to the global network interface list,
  and it is a natural synchronization point. With this change, any threads
  that obtain the reference of the interface via ifunit(), ifunit_ref() etc.,
  will be guaranteed to see the address family dependent data rightly.

  The issue [1] reported by Mike Belanger also hints the potential race.

  MFC note: this change depends on e64fe5ad3a23, as calculating the max
  IPv6 MTU through all the interfaces requires the current interface to
  be added to the global network interface list firstly.

  [1] https://lists.freebsd.org/archives/freebsd-net/2025-May/006817.html

  Reviewed by:	glebius
  MFC after:	1 month
  MFC with:	e64fe5ad3a23 netinet6: Remove a set but not used global variable in6_maxmtu
  Differential Revision:	https://reviews.freebsd.org/D49358

  (cherry picked from commit 098b5d4dc744283a90b2d80c11395ecc18a84084)


   sys/net/if.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 077895676d3baf62a6d2e50626faaaa3e7ef2473]
Date: 2025-05-21
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: UPDATING: Add an entry for the removal of in6_maxmtu
Review: The commit adds a note to man:UPDATING[5] about the removal of the in6_maxmtu sysctl, informing users of a configuration change.
Body:

  (cherry picked from commit c485a58f51608e5473d8580ebd4bf9f4f42fab1a)


   UPDATING | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit f5195b1a63df2c84d05b29a908e96c107f86a029]
Date: 2025-05-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: netinet6: Remove a set but not used global variable in6_maxmtu
Review: Removes an unused global variable and its setter from the IPv6 stack. This is an internal cleanup with no user-visible impact.
Body:

  and its setter in6_setmaxmtu().

  This variable was introduced by the KAME projec [1]. It holds the max
  IPv6 MTU through all the interfaces, but is never used anywhere.

  [1] 82cd038d51e2 KAME netinet6 basic part(no IPsec,no V6 Multicast
                   Forwarding, no UDP/TCP for IPv6 yet)

  Reviewed by:	glebius
  MFC after:	1 month
  Differential Revision:	https://reviews.freebsd.org/D49357

  (cherry picked from commit e64fe5ad3a23a9f471ebf11e04e490588913c7af)


   sys/netinet6/in6.c          | 25 -------------------------
   sys/netinet6/in6_ifattach.c |  6 ------
   sys/netinet6/in6_var.h      |  4 ----
   sys/netinet6/nd6.c          |  4 ----
   sys/netinet6/nd6_rtr.c      |  8 ++------
   5 files changed, 2 insertions(+), 45 deletions(-)

[commit 839b9596b35d516f6df444898f477cfb3d00a8db]
Date: 2024-10-12
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: axgbe: Fix setting promisc mode
Review: The axgbe driver now respects IFF_PROMISC for in-kernel promiscuous mode requests, improving compatibility with subsystems like man:if_bridge[4] and man:bpf[4].
Body:

  Ethernet drivers should respect IFF_PROMISC rather than IFF_PPROMISC.
  The latter is for user-requested promisc mode, it implies the former
  but not vice versa. Some in-kernel components such as if_bridge(4) and
  bpf(4) will set promisc mode for interfaces on-demand.

  While here, update the debugging message to be not confusing.

  This was spotted while reviewing markj@ 's work D46524.

  Test from Franco shows that the interface seems to be unconditionally
  initialized to promisc mode regardless of this fix. That needs further
  investigation.

  Reviewed by:	markj, Franco Fichtner <franco@opnsense.org>
  Tested by:	Franco Fichtner <franco@opnsense.org>
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D46794

  (cherry picked from commit c7a2636889a649985e323de23fe495608b6fe483)


   sys/dev/axgbe/if_axgbe_pci.c | 10 ++++++----
   sys/dev/axgbe/xgbe-dev.c     |  2 +-
   2 files changed, 7 insertions(+), 5 deletions(-)

[commit 8ba6d328fdf85f9d048092533125421ef2fcf8e5]
Date: 2024-12-06
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: git-blame-ignore-revs: sys/sys/kernel.h: Various whitespace fixes
Review: Excluded because it is a meta-change to .git-blame-ignore-revs with no user-visible impact.
Body:

  Hash is updated to match MFC commit.

  (cherry picked from commit 99f7c0550433782cd228b518173cca5d23998c36)


   .git-blame-ignore-revs | 2 ++
   1 file changed, 2 insertions(+)

[commit f0931a31f536eb5af7d2cb3242008133ba38dbea]
Date: 2024-09-22
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: git-blame-ignore-revs: iflib: Many style fixes
Review: Adds a commit hash to .git-blame-ignore-revs to ignore style fixes in iflib for git blame output.
Body:

  Hash is updated to match MFC commit.

  (cherry picked from commit 0ca553d761e5832ad6ff6fab0a3b896c8fe9d813)


   .git-blame-ignore-revs | 2 ++
   1 file changed, 2 insertions(+)

[commit 72652c93e39695dc86814aa0ed99957015ed3b90]
Date: 2024-09-20
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: git-blame-ignore-revs: bpf: Some style and white space cleanup
Review: Excluded because it is a meta-change to .git-blame-ignore-revs with no user-visible impact.
Body:

  Hash is updated to match MFC commit.

  (cherry picked from commit 99215a19448343574ff615e382b2525cec597fe7)


   .git-blame-ignore-revs | 2 ++
   1 file changed, 2 insertions(+)

[commit 293e4c54b5363394b5c70db4e5e32aca8e9b5094]
Date: 2025-06-25
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: pf.4/pfsync.4: Separate sysctl/tunables >> SYNOPSIS
Review: The commit updates man pages for pf.4 and pfsync.4 to separate sysctl and tunable documentation, clarifying configuration options for users.
Body:

  MFC after:		3 days
  Reviewed by:		kp
  Differential Revision:	https://reviews.freebsd.org/D50856

  (cherry picked from commit dca2ab32e831dd5cedab182da8c5c51aaa828967)


   share/man/man4/pf.4     | 37 ++++++++++++++++++++++++++++++++++---
   share/man/man4/pfsync.4 | 30 ++++++++++++++++++++++++------
   2 files changed, 58 insertions(+), 9 deletions(-)

[commit f74d998093596c09d6216c91b6435a590dcc14a0]
Date: 2025-05-29
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Docs.manpages
Subject: uftdi.4: Makeover!
Review: The man:uftdi[4] manual page receives a comprehensive update with improved formatting, complete sysctl documentation, and clearer usage instructions.
Body:

  + tag SPDX
  + rewrite document description to one line in contemporary style
  + rewrite synopsis in vt/iwx/mtw/uart's style, adding all sysctls
    for brevity, in the future I will call this "possibilities style"
  + move ioctls into an ioctl section (we should use these more)
  + add a sysctl section listing all sysctls and their defaults
  + remove list of specific 20 year old usb serial adapters from hardware
  + move list of supported controllers to the hardware section
  + explain how the driver is loaded in description, and give usage hints

  MFC after:		3 days
  Thanks:			cperciva (devd calls devmatch at runtime)
  Thanks:			linimon (you dont need to be able to read *)
  Thanks:			adrian (here, you can find things in the code)
  Reviewed by:		adrian, ivy, mhorne (previous version)
  Differential Revision:	https://reviews.freebsd.org/D50608

  (cherry picked from commit 7176e1e3b5474a209f54cfd5d567a523bce3b9f6)


   share/man/man4/uftdi.4 | 119 +++++++++++++++++++++++++++----------------------
   1 file changed, 65 insertions(+), 54 deletions(-)

[commit 3e235a37e550233e9a04ccb8ca63708da97f5868]
Date: 2025-06-25
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: ng_patch.4: Clarify relative_offset
Review: The man:ng_patch[4] man page is updated to clarify the relative_offset option and fix a typo.
Body:

  While here, fix an extra space typo.

  PR:			251833
  Reviewed by:		imp
  Differential Revision:	https://reviews.freebsd.org/D51033

  (cherry picked from commit eab94b59a7743113c7f101846f498e539b2d094d)


   share/man/man4/ng_patch.4 | 13 ++++++++++++-
   1 file changed, 12 insertions(+), 1 deletion(-)

[commit 89acc594cef77db141ede18038fe3c8ed1916264]
Date: 2025-06-14
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: mlx.4: Improve HARDWARE
Review: The man:mlx[4] manual page now lists the specific SCSI adapter models supported by the mlx driver.
Body:

  These are paralel scsi adapters, list what kind the hardware supports.

  MFC after:		3 days
  Fixes:			e3307d05311e8c (mlx.4: Improve specificity)
  Reported by:		kbowling
  Reviewed by:		kbowling
  Approved by:		mhorne (mentor, implicit)
  Differential Revision:	https://reviews.freebsd.org/D50654

  (cherry picked from commit 63e98e05fcdbcf3a34113a2e6acab2f8cc23bba9)


   share/man/man4/mlx.4 | 24 ++++++++++++------------
   1 file changed, 12 insertions(+), 12 deletions(-)

[commit 992be3acfe68d315e081ba27f7087e8261dc4ecf]
Date: 2025-04-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ctfconvert.1: Minor cleanup
Review: The commit only performs minor cleanup and markup changes to the man page, with no user-visible functional changes.
Body:

  Alphabetize option table to improve first glance access.
  Markup semantics to differentiate them and add them to apropos.

  MFC after:		3 days
  Reviewed by:		Pau Amma <pauamma@gundo.com>
  Approved by:		mhorne (mentor, implicit)
  Differential Revision:	https://reviews.freebsd.org/D49883

  (cherry picked from commit 3fd42db26c3dd0882cf69c54850a59e79b027e33)


   cddl/usr.bin/ctfconvert/ctfconvert.1 | 40 +++++++++++++++++++++---------------
   1 file changed, 23 insertions(+), 17 deletions(-)

[commit 9acbcf1f0c13fee659b647e9d63acea4d6afafd7]
Date: 2025-01-17
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: snd_hda.4: Improve HARDWARE for HW Relnotes
Review: The commit updates the man: snd_hda[4] man page's HARDWARE section to improve hardware release notes and restructure according to mdoc(7). This is a documentation-only change with no functional impact.
Body:

  Rewrite the HARDWARE section to improve the hardware release notes.
  Move the section to achieve the structure in mdoc(7). Tag SPDX.

  MFC after:		3 days
  Discussed with:		mav
  Reviewed by:		christos
  Approved by:		mhorne (mentor, implicit)
  Differential Revision:	https://reviews.freebsd.org/D48503

  (cherry picked from commit 7b34c48e036e209321174100ab9d7fef19b4932a)


   share/man/man4/snd_hda.4 | 25 +++++++++++++------------
   1 file changed, 13 insertions(+), 12 deletions(-)

[commit f7776016fee89ba73d9054b37bcf32c82c9b6363]
Date: 2025-02-19
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: bectl: Use SPDX only license
Review: The commit updates license text in bectl and libbe to use SPDX format, which is an internal documentation change with no user-visible impact.
Body:

  bectl.8 had a truncated license without the required disclaimer.
  Correct it consistently by converting all bectl licenses to SPDX form.

  Approved by:		kevans
  Approved by:		Kyle Kneitinger <kyle@kneit.in>
  Approved by:		Wes Maag <wes@jwmaag.org>
  Approved by:		mhorne (mentor, implicit)
  Differential Revision:	https://reviews.freebsd.org/D49066

  (cherry picked from commit 54d2737e7fe48226c908dcccfbda2ca1c08e07fc)


   lib/libbe/be.c                 | 25 ++-----------------------
   lib/libbe/be.h                 | 25 ++-----------------------
   lib/libbe/be_access.c          | 25 ++-----------------------
   lib/libbe/be_error.c           | 25 ++-----------------------
   lib/libbe/be_impl.h            | 25 ++-----------------------
   lib/libbe/be_info.c            | 25 ++-----------------------
   sbin/bectl/bectl.8             | 12 +-----------
   sbin/bectl/bectl.c             | 25 ++-----------------------
   sbin/bectl/bectl.h             | 25 ++-----------------------
   sbin/bectl/bectl_jail.c        | 25 ++-----------------------
   sbin/bectl/bectl_list.c        | 25 ++-----------------------
   sbin/bectl/tests/bectl_test.sh | 23 +----------------------
   12 files changed, 22 insertions(+), 263 deletions(-)

[commit cf647f23c4b774e81144ebe2a4df958bc74580d7]
Date: 2025-06-02
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: mlx.4: Improve specificity for apropos + hw notes
Review: The commit updates man:mlx[4] to improve hardware note specificity and remove generalizations, which may affect users looking for hardware compatibility information.
Body:

  + There are decades of SCSIs, these are Ultra-SCSI
  + Remove generalizations from the end of HARDWARE
  + Tag SPDX

  MFC after:		3 days
  Reviewed by:		mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50545

  (cherry picked from commit e3307d05311e8c042e7e7ea2157fc51f50297369)


   share/man/man4/mlx.4 | 17 ++++++-----------
   1 file changed, 6 insertions(+), 11 deletions(-)

[commit db0f3a3c3f16f414e32fba5a0f7ea01302739bb7]
Date: 2025-05-15
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: usb/if_mos.c: Fix incorrect SPDX ID
Review: Fixes an incorrect SPDX license identifier in the if_mos driver source, which does not affect user-visible functionality.
Body:

  Fixes:			718cf2ccb995 (further adoption of SPDX)
  MFC after:		3 days
  Reviewed by:		carlavilla, imp, mhorne
  Approved by:		carlavilla, mhorne (mentors)
  Differential Revision: 	https://reviews.freebsd.org/D50374

  (cherry picked from commit ca47411ea5e8a38ac1a9a29df25bc32ffcaa2904)


   sys/dev/usb/net/if_mos.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 5e712379ae68ea1895817b8472b73598bafbc75b]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Docs.manpages
Subject: cdce.4: Improve HARDWARE
Review: The cdce.4 man page now describes cdce as the main USB tethering driver, reflecting its support for Android, iPhone, and potentially 5G hotspots using USB NCM.
Body:

  The cdce driver is the main USB tethering driver now that both Android
  and iPhone tethering are using USB NCM. I would like to test a recent
  5G hotspot to see what those are doing. Improve the HARDWARE section to
  reflect this.

  MFC after:		3 days
  Reviewed by:		mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50541

  (cherry picked from commit e8260f2cea3c447b0a16f1075ff580dc4ef06efc)


   share/man/man4/cdce.4 | 12 +++++++++---
   1 file changed, 9 insertions(+), 3 deletions(-)

[commit 62d26d696bf0b91daea25ad6b474555485b1333e]
Date: 2025-05-28
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: aue.4: Improve HARDWARE, specificity, and tag spdx
Review: The commit updates the man: aue.4 man page to improve hardware description and add SPDX tagging, but these are minor documentation edits without user-visible functional changes.
Body:

  + Improve HARDWARE introductory sentence for hardware release notes.
  + Mention "Fast" ethernet in title for apropos.
  + tag SPDX

  MFC after:		3 days
  Reviewed by:		mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50540

  (cherry picked from commit 420e58595d20b6fd0dfdf2f486462fbb572f3351)


   share/man/man4/aue.4 | 16 ++++++++++------
   1 file changed, 10 insertions(+), 6 deletions(-)

[commit ce2d22ee11d81785cbb427f22818df530642a26c]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: rtsx.4: Improve hardware, add history and spdx
Review: The man:rtsx[4] page is updated with improved hardware descriptions and a history note, and now includes SPDX license tagging.
Body:

  + tag spdx
  + massage hardware for inclusion in hardware release notes
  + note first appeared in 13.0R

  MFC after:		3 days
  Reviewed by:		mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50529

  (cherry picked from commit 7390e96107c81212b75b50e4b5c6cbcf14e34c84)


   share/man/man4/rtsx.4 | 22 ++++++++++------------
   1 file changed, 10 insertions(+), 12 deletions(-)

[commit 864874b5a2b72b453f62c753e398187d9bfdc6b2]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: axge.4: Create a HARDWARE section
Review: The commit adds a HARDWARE section to the man:axge[4] manual page, providing hardware compatibility details for users.
Body:

  For inclusion in the HW Relnotes.

  MFC after:		3 days
  Reviewed by:		mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50523

  (cherry picked from commit e3eae3b1e587ad3e99a064400b57111966a55005)


   share/man/man4/axge.4 | 18 +++++++++++++++++-
   1 file changed, 17 insertions(+), 1 deletion(-)

[commit 0961446b2382ab9aad9fe2a94029ee39d3ea5082]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: pam_xdg.8: Improve usage and standards
Review: The commit updates the man: pam_xdg[8] manual page to improve documentation of the directory created by the module, its usage, and standards information.
Body:

  Explain the directory created by this module,
  its usage, and a bit more about the standard.

  MFC after:		3 days
  Reviewed by:		mhorne, manu
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50440

  (cherry picked from commit 616bb0b230835e8b88d032e2026854ad031afea2)


   lib/libpam/modules/pam_xdg/pam_xdg.8 | 19 ++++++++++++++-----
   1 file changed, 14 insertions(+), 5 deletions(-)

[commit 132a75025ef91920f46202a95589d7fb30558acd]
Date: 2025-05-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: scc.4: Improve acronyms + tag SPDX
Review: The commit improves acronym usage and adds SPDX tags in man:scsictl[4] documentation, but these are minor editorial changes without user-visible impact.
Body:

  + tag spdx
  + remove duplicated acronym in manual title, reword for consistency
  + expand acronym in HARDWARE for HW Relnotes

  MFC after:		3 days
  Reviewed by:		mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50528

  (cherry picked from commit 1c7f8214e92e40907bf8faf8d43c9db0f98294a6)


   share/man/man4/scc.4 | 8 +++++---
   1 file changed, 5 insertions(+), 3 deletions(-)

[commit 621a175adf566b9da8abdbbd1f839112f9432fab]
Date: 2025-05-21
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: make.conf.5: add CPUTYPE?= note from UPDATING
Review: The man:make.conf[5] manual page now includes a note about setting CPUTYPE?= for cross-compilation, making this information more discoverable.
Body:

  Cross-compilation needs CPUTYPE to be set with ?= to be overideable via
  make targets. This has historically been mentioned in the FOOTNOTES of
  UPDATING. Note that in the CPUTYPE documentation in make.conf(5) for
  discoverability. Leave it in UPDATING for now to create no regression in
  the doc there.

  MFC after:		3 days
  Reviewed by:		carlavilla, ivy
  Approved by:		carlavilla (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50277

  (cherry picked from commit bbc0b39ef7df3007c78eec8822213fe77aae4d41)


   share/man/man5/make.conf.5 | 9 +++++++++
   1 file changed, 9 insertions(+)

[commit 5f35cb47c684493369100539c8ca35970bee4ffe]
Date: 2025-05-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Docs.manpages
Subject: build.7: PORTS_MODULES incompatible with pkgbase
Review: The man:build[7] manual page now includes a note that PORTS_MODULES is incompatible with pkgbase. This informs users of a known limitation when building the system.
Body:

  Add a note until we can fix this.

  Reviewed by:		carlavilla, emaste, ivy
  Approved by:		carlavilla (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50355

  (cherry picked from commit 1a060e4f1ba9b9f9363e291aba2134b37b938fae)


   share/man/man7/build.7 | 4 ++++
   1 file changed, 4 insertions(+)

[commit 9c3d1064e17e533094d6838209b3b3c8fe2b6e50]
Date: 2025-05-15
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: SPDX: Tag BSD-4.3TAHOE
Review: This commit only updates SPDX license tags in source files and documentation, which is an internal administrative change with no user-visible impact.
Body:

  TIL traceroute.8 has one of the oldest liceses, predating BSD-4-Clause!
  The SPDX tag was not even on Wikipedia. These are all the files I could
  find in the tree with git grep that look like the license reported on
  the SPDX website, including one that was misfiled.

  Ref:			https://spdx.org/licenses/BSD-4.3TAHOE.html
  MFC after:		3 days
  Reported by:		brooks
  Reviewed by:		brooks, carlavilla, imp, ivy
  Approved by:		carlavilla (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50362

  (cherry picked from commit 7098712bbfd60df9db324decbc1a5dd8f751356f)


   lib/libc/stdtime/strftime.c      | 2 ++
   usr.sbin/cron/cron/popen.c       | 2 ++
   usr.sbin/ppp/arp.c               | 2 +-
   usr.sbin/traceroute/traceroute.8 | 3 +++
   4 files changed, 8 insertions(+), 1 deletion(-)

[commit b59d777bc7af2ac815d78a4408120e96e7ec8319]
Date: 2025-05-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: bhyvectl.8: Polish
Review: The commit updates the man:bhyvectl[8] manual page with improved examples, formatting, and minor clarifications, but does not introduce any user-visible functional changes or new features.
Body:

  + Add how to find open VMs in the example, linking `apropos Pa=/dev/vmm`
  + Move note about additional bhyve options after options for flow
  + Reclaim some space by shortening <filename> to <file>
  + Align options list width, tested at MANWIDTH 59 and 80
  + Remove unnecessary roff quoting and tag SPDX

  MFC after:		3 days
  Reviewed by:		carlavilla, markj, mhorne
  Approved by:		carlavilla, mhorne (mentors)
  Differential Revision:	https://reviews.freebsd.org/D48401

  (cherry picked from commit 22348fb999385edaef38ce5e4308f44135f0326c)


   usr.sbin/bhyvectl/bhyvectl.8 | 46 ++++++++++++++++++++++++++------------------
   1 file changed, 27 insertions(+), 19 deletions(-)

[commit f2e6f24440984dce314a8eb3f9009cef3aae62b8]
Date: 2025-06-13
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: Klara, Inc.
Section: Storage.general
Subject: p9fs: Call VN_LOCK_ASHARE on new vnodes
Review: p9fs now uses shared locks for new vnodes, improving performance in multi-threaded access scenarios.
Body:

  We set MNTK_LOOKUP_SHARED on p9fs mounts, but disable shared locking of
  vnodes (i.e., LK_SHARED requests are automatically translated to
  LK_EXCLUSIVE.

  Reviewed by:	kib
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50759

  (cherry picked from commit 5defdd5342c392880e3917ba0873fb49ddafc4c6)


   sys/fs/p9fs/p9fs_vfsops.c | 2 ++
   1 file changed, 2 insertions(+)

[commit 256be6bf6c5d62c60cf4b95ac84b3b6ac7db2e5a]
Date: 2025-05-27
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: namei: Fix cn_flags width in 9pfs
Review: Fixes a harmless truncation in 9pfs internal flags; no user-visible impact.
Body:

  This truncation is mostly harmless today, but fix it anyway to avoid
  pain later down the road.

  Reviewed by:	olce, kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50417

  (partially cherry picked from commit 0d224af399a66f00a5b33e5512fc018062cabf1d)


   sys/fs/p9fs/p9fs_vnops.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b7ef7f8b0b65e67da6ab11441b365684f231250f]
Date: 2025-04-08
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Arm Ltd
Section: Drivers.device
Subject: virtio_p9fs: Support attaching to pci and mmio
Review: The virtio_p9fs driver now attaches to both PCI and MMIO virtio transports, enabling support for 9p filesystem access on platforms like Arm FVP.
Body:

  Some implementations of the virtio 9p transport are implemented on
  virtio_mmio, e.g. the Arm FVP. Use the correct macro so the driver
  attaches when this is the case.

  Reviewed by:	markj
  Sponsored by:	Arm Ltd
  Differential Revision:	https://reviews.freebsd.org/D49600

  (cherry picked from commit fd9f67e689e83f20e29edf63cc6488402de5901c)


   sys/dev/virtio/p9fs/virtio_p9fs.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit fc393006c0ec18c5519cc9309e7ac77d1bad6abf]
Date: 2024-11-07
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: p9fs.5: rename to p9fs.4
Review: The p9fs(4) man page is moved from section 5 to section 4 to correctly reflect that it documents a filesystem driver rather than a file format.
Body:

  This is a filesystem (driver), not a file format, so it should be in
  section 4.

  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1520

  (cherry picked from commit 5b62dc782d4891845b47f2c0dfbb7717cbfe3897)


   ObsoleteFiles.inc                      | 3 +++
   share/man/man4/Makefile                | 1 +
   share/man/{man5/p9fs.5 => man4/p9fs.4} | 4 ++--
   share/man/man5/Makefile                | 1 -
   4 files changed, 6 insertions(+), 3 deletions(-)

[commit d888c75dd49e0f07f3bce297c87850f7c06f3938]
Date: 2024-11-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: p9fs: Use UNLINKAT instead of REMOVE to implement removals
Review: The p9fs filesystem now uses UNLINKAT instead of REMOVE for file removal operations, improving handling of hard links and compatibility with qemu and bhyve.
Body:

  REMOVE doesn't work properly in the face of hard links.  Use UNLINKAT
  instead, which is implemented by qemu and bhyve and lets the client
  specify the name being removed.

  PR:		282432
  Reviewed by:	dfr
  Differential Revision:	https://reviews.freebsd.org/D47438

  (cherry picked from commit 1d99e8d9a37e1ba528628186df57b79fe74e196c)


   sys/fs/p9fs/p9_client.c   | 21 +++++++++++++++++++++
   sys/fs/p9fs/p9_client.h   |  1 +
   sys/fs/p9fs/p9_protocol.h |  2 ++
   sys/fs/p9fs/p9fs_vnops.c  | 21 ++++++++++++++-------
   4 files changed, 38 insertions(+), 7 deletions(-)

[commit f3478cfc7817afcd47e8c9caee143fb807220ffc]
Date: 2024-10-25
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Klara, Inc.
Section: Drivers.device
Subject: virtio_p9fs: Fix handling of a full request queue
Review: The virtio_p9fs driver now correctly rebuilds scatter-gather lists after sleeping when the request queue is full, preventing data corruption or incorrect request submission.
Body:

  If, when submitting a request, the virtqueue is full, we sleep until an
  interrupt has fired, then restart the request.  However, while sleeping
  the channel lock is dropped, and in the meantime another thread may have
  reset the per-channel SG list, so upon retrying we'd (re)submit whatever
  happened to be left over in the previous request.

  Fix the problem by rebuilding the SG list after sleeping.

  Sponsored by:	Klara, Inc.

  (cherry picked from commit fff518117b40cbc3bca49073eed85dc725ebae4c)


   sys/dev/virtio/p9fs/virtio_p9fs.c | 3 +--
   1 file changed, 1 insertion(+), 2 deletions(-)

[commit f3289f2528549160afa09fca09b141cbb7f36c32]
Date: 2024-10-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Klara, Inc.
Section: undecided
Subject: virtio_p9fs: Fix some style issues
Review: The commit only fixes style issues and removes an unneeded SYSINIT with no functional change, so it has no user-visible impact.
Body:

  - Remove superfluous newlines.
  - Use bool literals.
  - Replace an unneeded SYSINIT with static initialization.

  No functional change intended.

  Sponsored by:	Klara, Inc.

  (cherry picked from commit b9500cbd38967686a801b1ed3ab1dd5b5b5571fb)


   sys/dev/virtio/p9fs/virtio_p9fs.c | 26 ++++++--------------------
   1 file changed, 6 insertions(+), 20 deletions(-)

[commit a23bc2ddb5409bfb3c1186d8062438b504ea41c7]
Date: 2024-10-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Klara, Inc.
Section: undecided
Subject: p9fs: Fix whitespace in request tag handling functions
Review: No user-visible changes; whitespace-only fix with no functional impact.
Body:

  No functional change intended.

  Sponsored by:	Klara, Inc.

  (cherry picked from commit f86e328d324d4d67ab4db4a89ef6239c8978bb87)


   sys/fs/p9fs/p9_client.c | 22 +++++++++++-----------
   1 file changed, 11 insertions(+), 11 deletions(-)

[commit 2e7e267e7fcbcd0dfb9957fb9809308232276f15]
Date: 2024-08-04
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Storage.general
Subject: p9fs: Properly handle paths containing "."
Review: The p9fs filesystem now correctly handles paths containing "." characters, preventing lookup failures that could occur with certain 9P servers.
Body:

  Fixes:	56e4622588ed ("p9fs: fix lookup of "." for lib9p-based 9P servers")
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1361

  (cherry picked from commit 62bb18abed25a831a29e1e5b6e6f7fdddbba6403)


   sys/fs/p9fs/p9fs_vnops.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit f5cc62e54a7f8ae9b8bb1484e0ebb22352c95d36]
Date: 2024-07-06
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Drivers.device
Subject: virtio_p9fs: fix panic on qemu/kvm
Review: The virtio_p9fs driver no longer panics when used with qemu/kvm due to an unsupported configuration read size.
Body:

  When the module is loaded on a system running on qemu/kvm the "modern"
  virtio infrastructure is used and virtio_read_device_config() will end
  up calling vtpci_modern_read_dev_config(). This function cannot read
  values of arbitrary sizes and will panic if the p9fs mount tag size is
  not supported by it.

  Use virtio_read_device_config_array() instead. It was tested on both
  bhyve and qemu/kvm.

  PR: 280098
  Co-authored-by: Mark Peek <mp@FreeBSD.org>
  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1320

  (cherry picked from commit 814bf1fddd27aea69740f9e7426302354285cad4)


   sys/dev/virtio/p9fs/virtio_p9fs.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 201d2e45f51fee2b1438bcc0a53a51bd6416ea73]
Date: 2024-06-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: p9fs: use M_WAITOK where appropriate
Review: The commit changes memory allocation flags in the p9fs driver to use M_WAITOK, which is an internal implementation detail with no direct user-visible impact. It does not introduce new features, change behavior, affect configuration, or require user actions.
Body:

  device_attach routines are allowed to sleep, and this routine already
  has other M_WAITOK allocations.

  Reported by:	markj
  Reviewed by:	markj
  Fixes: 1efd69f933b6 ("p9fs: move NULL check immediately after alloc...")
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D45721

  (cherry picked from commit e6b88237c6c33fe2f66cad9836858b877900871a)


   sys/dev/virtio/p9fs/virtio_p9fs.c | 7 +------
   1 file changed, 1 insertion(+), 6 deletions(-)

[commit 0d1dd7c4863ab0856c93becf103d59acb917623d]
Date: 2024-06-24
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: p9fs: move NULL check immediately after allocation
Review: The commit moves a NULL check after a memory allocation, which is an internal code refactoring with no user-visible impact.
Body:

  Reported by:	Shawn Webb (HardenedBSD)
  Reviewed by:	dfr
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D45719

  (cherry picked from commit 1efd69f933b6ad4177ecda78cf4891aa9a1e8f6b)


   sys/dev/virtio/p9fs/virtio_p9fs.c | 11 +++++------
   1 file changed, 5 insertions(+), 6 deletions(-)

[commit 99f8e26e29a62714061998ace211f26e3f724af3]
Date: 2024-06-24
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: https://www.patreon.com/valpackett
Section: Storage.general
Subject: p9fs: implement working putpages (fix mmap write)
Review: The p9fs filesystem now supports mmap write operations via putpages, enabling memory-mapped writes to work correctly.
Body:

  Mostly copied from smbfs. This driver in its current state has the exact
  same issue that prevents the generic putpages implementation from
  working.

  Sponsored by:		https://www.patreon.com/valpackett
  Reviewed by:		dfr
  Differential Revision:	https://reviews.freebsd.org/D45639
  MFC after:		3 months

  (cherry picked from commit daa2c99c89f224200911aa6c8cdee07bc354947a)


   sys/fs/p9fs/p9fs_vfsops.c |  6 ++++
   sys/fs/p9fs/p9fs_vnops.c  | 79 +++++++++++++++++++++++++++++++++++++++++++++++
   2 files changed, 85 insertions(+)

[commit 03f840f9cc8b5d02e776f59b033fe6165fc2cf4a]
Date: 2024-06-24
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: p9fs: fix lookup of "." for lib9p-based 9P servers
Review: The p9fs filesystem now handles lookups of "." correctly for lib9p-based 9P servers, preventing errors when accessing the current directory.
Body:

  The lib9p implementation takes a strict interpretation of the Twalk RPC
  call and returns an error for attempts to lookup ".".  The workaround is
  to fake the lookup locally.

  Reviewed by: Val Packett <val@packett.cool>
  MFC after: 3 months

  (cherry picked from commit 56e4622588ed2eec0197ac47c3059d3db439f5c0)


   sys/fs/p9fs/p9fs_vnops.c | 6 ++++++
   1 file changed, 6 insertions(+)

[commit ab63bdaf1d1f96a3a682886dccd13936a8cb0a5d]
Date: 2024-06-19
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Storage.general
Subject: p9fs: Fix the build for 32-bit kernels
Review: The p9fs filesystem now builds correctly on 32-bit kernels.
Body:

  MFC after: 3 months

  (cherry picked from commit b2ebcd19f467f518aa969b84527018c03fb0286e)


   sys/fs/p9fs/p9fs_vnops.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 615fba7c6b39ac40239beb5624025d0d0576fdc0]
Date: 2022-12-06
Score: 5
Status: added(include=yes,score=90)
Sponsor: 
Section: Storage.general
Subject: Add an implementation of the 9P filesystem
Review: Adds a new 9P filesystem implementation (p9fs) for use with bhyve virtio-9p devices. It allows guests to access host files via share mappings and can be used as a root or non-root filesystem. The driver is loaded via 'virtio_p9fs_load=YES' in loader.conf.
Body:

  This is derived from swills@ fork of the Juniper virtfs with many
  changes by me including bug fixes, style improvements, clearer layering
  and more consistent logging. The filesystem is renamed to p9fs to better
  reflect its function and to prevent possible future confusion with
  virtio-fs.

  Several updates and fixes from Juniper have been integrated into this
  version by Val Packett and these contributions along with the original
  Juniper authors are credited below.

  To use this with bhyve, add 'virtio_p9fs_load=YES' to loader.conf. The
  bhyve virtio-9p device allows access from the guest to files on the host
  by mapping a 'sharename' to a host path. It is possible to use p9fs as a
  root filesystem by adding this to /boot/loader.conf:

  	vfs.root.mountfrom="p9fs:sharename"

  for non-root filesystems add something like this to /etc/fstab:

  	sharename /mnt p9fs rw 0 0

  In both examples, substitute the share name used on the bhyve command
  line.

  The 9P filesystem protocol relies on stateful file opens which map
  protocol-level FIDs to host file descriptors. The FreeBSD vnode
  interface doesn't really support this and we use heuristics to guess the
  right FID to use for file operations.  This can be confused by privilege
  lowering and does not guarantee that the FID created for a given file
  open is always used for file operations, even if the calling process is
  using the file descriptor from the original open call. Improving this
  would involve changes to the vnode interface which is out-of-scope for
  this import.

  Differential Revision: https://reviews.freebsd.org/D41844
  Reviewed by: kib, emaste, dch
  MFC after: 3 months
  Co-authored-by: Val Packett <val@packett.cool>
  Co-authored-by: Ka Ho Ng <kahon@juniper.net>
  Co-authored-by: joyu <joyul@juniper.net>
  Co-authored-by: Kumara Babu Narayanaswamy <bkumara@juniper.net>

  (cherry picked from commit e97ad33a89a78f55280b0485b3249ee9b907a718)


   share/man/man5/Makefile           |    1 +
   share/man/man5/p9fs.5             |  127 +++
   sys/conf/files                    |    7 +
   sys/conf/options                  |    1 +
   sys/dev/virtio/p9fs/virtio_p9fs.c |  511 +++++++++
   sys/dev/virtio/p9fs/virtio_p9fs.h |   39 +
   sys/fs/p9fs/p9_client.c           | 1311 ++++++++++++++++++++++
   sys/fs/p9fs/p9_client.h           |  168 +++
   sys/fs/p9fs/p9_debug.h            |   45 +
   sys/fs/p9fs/p9_protocol.c         |  632 +++++++++++
   sys/fs/p9fs/p9_protocol.h         |  280 +++++
   sys/fs/p9fs/p9_transport.c        |   70 ++
   sys/fs/p9fs/p9_transport.h        |   53 +
   sys/fs/p9fs/p9fs.h                |  203 ++++
   sys/fs/p9fs/p9fs_proto.h          |   42 +
   sys/fs/p9fs/p9fs_subr.c           |  411 +++++++
   sys/fs/p9fs/p9fs_vfsops.c         |  602 +++++++++++
   sys/fs/p9fs/p9fs_vnops.c          | 2148 +++++++++++++++++++++++++++++++++++++
   sys/kern/vfs_mountroot.c          |    1 +
   sys/modules/Makefile              |    1 +
   sys/modules/p9fs/Makefile         |    8 +
   sys/modules/virtio/Makefile       |    2 +-
   sys/modules/virtio/p9fs/Makefile  |   32 +
   23 files changed, 6694 insertions(+), 1 deletion(-)

[commit 3a2e1feea91ea1c9f6ebb9a0450a7158f6871d57]
Date: 2025-06-27
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: amd64 ddb 'show pte': print both pte VA in recursive map and pte content
Review: The ddb 'show pte' command now prints both the page table entry virtual address in the recursive map and the page table entry content.
Body:

  (cherry picked from commit 289a7a790cf74c679123a543ae95ac1be7659fad)


   sys/amd64/amd64/pmap.c | 10 +++++-----
   1 file changed, 5 insertions(+), 5 deletions(-)

[commit 0f62297dd1f2084af942924265b7c46b60525699]
Date: 2025-06-24
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Kernel.general
Subject: amd64: switch to la57 mode before creating kernel page tables
Review: The amd64 kernel now enables 5-level paging (LA57) earlier during boot, allowing the kernel to use more than 128 TiB of virtual address space on compatible CPUs.
Body:

  (cherry picked from commit 4e1d69b9fbff280962e5ae5258624b60d5ab4618)


   sys/amd64/amd64/locore.S |   2 +
   sys/amd64/amd64/pmap.c   | 207 ++++++++++++++++-------------------------------
   2 files changed, 72 insertions(+), 137 deletions(-)

[commit 0e33dd60f617bd2386f7600dd60283d29e6e9d28]
Date: 2025-06-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: amd64: eliminate asm symbols DMAP_MIN/MAX_ADDRESS
Review: The commit removes internal assembly symbols DMAP_MIN/MAX_ADDRESS, which are not user-visible and have no impact on user applications or system behavior.
Body:

  (cherry picked from commit 3d1b33d9233936efbdd819c55d75569db1dd8690)


   sys/amd64/amd64/genassym.c | 2 --
   1 file changed, 2 deletions(-)

[commit 9f685f4f2f930316f04ab180843e342897034dc4]
Date: 2025-06-20
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Kernel.general
Subject: amd64: remove dmapbase, dmapend symbols
Review: The dmapbase and dmapend symbols are removed from the kernel, which may affect kernel modules or debugging tools that rely on these symbols.
Body:

  (cherry picked from commit 96f6283cc7af8342fd7965f3791d22352a028022)


   sys/amd64/amd64/locore.S | 4 +---
   1 file changed, 1 insertion(+), 3 deletions(-)

[commit b6fb125330dd4c079ebb734e97e7378e30fc2c89]
Date: 2025-06-16
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: amd64: express KV4ADDR() using KV5ADDR()
Review: The commit refactors an internal macro definition without any user-visible impact, such as changes to functionality, configuration, or behavior.
Body:

  (cherry picked from commit 2b09d177bd058ae1d8e03e1d65cf82ab351ae011)


   sys/amd64/include/pmap.h | 7 +------
   1 file changed, 1 insertion(+), 6 deletions(-)

[commit 0cc03e473ed74fb495c4ebe21d3ba2d92c5c4968]
Date: 2025-06-25
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Drivers.device
Subject: uchcom: add support for CH9102 and CH343 uarts
Review: The man:uchcom[4] driver now supports CH9102 and CH343 USB-to-serial adapters. CH343 devices support baud rates up to 6 Mbps.
Body:

  The CH343 devices support any baud rate up to 6 Mbps.
  PR:	272803
  Reviewed by:	imp
  Tested by:	joerg, Tomasz "CeDeROM" CEDRO <tomek_AT_cedro_DOT_info>
  Differential Revision:	https://reviews.freebsd.org/D46290

  (cherry picked from commit 1395712cab8e95808064ba68c5a792b7cd0fe35f)


   share/man/man4/uchcom.4     |  27 +---
   sys/dev/usb/serial/uchcom.c | 353 +++++++++++++++++++++++++-------------------
   sys/dev/usb/usbdevs         |   4 +-
   3 files changed, 208 insertions(+), 176 deletions(-)

[commit 8d93877c013fa3bc00b8b9841e545a941e80b2ca]
Date: 2025-07-02
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: Add sys/stdarg.h
Review: Adds a new sys/stdarg.h header for consistent va_list and va_*() definitions across architectures, simplifying compiler-dependent handling.
Body:

  While the type of va_list and implementation of va_*() psuedo functions
  varies (sometimes greatly) by architecture, they will always be defined
  by the compiler in a consistant way that does not require machine
  dependent handling.

  MFC after:	1 week

  Reviewed by:	imp
  Exp-run by:	antoine (PR 286274)
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1595

  (cherry picked from commit 2d92a5abefc9cf6aa81fb7d23f8fcca4f1d6026d)


   include/Makefile | 4 ++--
   sys/sys/stdarg.h | 6 ++++++
   2 files changed, 8 insertions(+), 2 deletions(-)

[commit c6e0defd489fb139e753435ccb7ecb722e9ae499]
Date: 2025-06-14
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: gve: Relax a static assertion
Review: The commit relaxes a static assertion in the gve driver to allow MCLBYTES to be larger than the default receive buffer size, which may affect driver compatibility or performance for certain configurations.
Body:

  It's okay if MCLBYTES is larger than the default receive buffer size.

  Fixes:	71702df61262 ("gve: Add support for 4k RX Buffers when using DQO queue formats")

  (cherry picked from commit 3b4bc5d70e1c2066fcb6e8535941258c88999fa2)


   sys/dev/gve/gve.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit fc03742b2512127a403b7624b49ce4a94fd26244]
Date: 2025-06-13
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: gve: Add support for 4k RX Buffers when using DQO queue formats
Review: The gve(4) driver now supports 4K RX buffers when using DQO queue formats, enabled via a boot-time tunable. This allows the driver to use larger buffer sizes when hardware LRO is enabled or when MTU exceeds 2048 bytes.
Body:

  This change adds support for using 4K RX Buffers when using DQO queue
  formats when a boot-time tunable flag is set to true by the user.
  When this flag is enabled, the driver will use 4K RX Buffer size either
  when HW LRO is enabled or mtu > 2048.

  Signed-off-by: Vee Agarwal <veethebee@google.com>

  Reviewed by:	markj, ziaee
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50786

  (cherry picked from commit 71702df6126226b31dc3ec66459388e32b993be1)


   share/man/man4/gve.4     |  8 ++++++++
   sys/dev/gve/gve.h        | 20 ++++++++++++++++++++
   sys/dev/gve/gve_adminq.c |  5 ++++-
   sys/dev/gve/gve_dqo.h    |  8 ++++++--
   sys/dev/gve/gve_main.c   | 30 +++++++++++++++++++++++++++---
   sys/dev/gve/gve_rx_dqo.c | 26 +++++++++++++++-----------
   sys/dev/gve/gve_sysctl.c |  4 ++++
   7 files changed, 84 insertions(+), 17 deletions(-)

[commit 3230a622ac083b5d2a24184c7c0495963a735a41]
Date: 2025-06-16
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: ptrace: Rename the internal command range constants
Review: Internal renaming of ptrace constants with no functional change.
Body:

  No functional change intended.

  Reviewed by:	kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50866

  (cherry picked from commit ee609560ad2a5fa7cacf06a3879987e118588625)


   sys/compat/freebsd32/freebsd32_misc.c | 2 +-
   sys/kern/sys_process.c                | 2 +-
   sys/sys/ptrace.h                      | 8 ++++----
   3 files changed, 6 insertions(+), 6 deletions(-)

[commit 336fec57a6cc0a4ee58ed9a094905ad4ad7030fe]
Date: 2025-06-13
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Klara, Inc.
Section: Hardware.virtualization
Subject: linux: Fix usage of ptrace(PT_GET_SC_ARGS)
Review: The Linuxulator ptrace(2) command PT_GET_SC_ARGS is fixed by introducing a new Linux-specific command PTLINUX_GET_SC_ARGS. This resolves a mismatch in syscall argument array sizes between native and emulated handlers.
Body:

  The native handler expects the argument to be a pointer to an array of 8
  syscall arguments, whereas the emulation provided an array that holds up
  to 6.

  Handle this by adding a new range of Linuxulator-specific ptrace
  commands.  In particular, introduce PTLINUX_GET_SC_ARGS, which always
  copies exactly six arguments.  This fixes the problem and removes the
  hack of checking the target thread ABI to decide whether to apply a
  Linux-specific quirk to PT_GET_SC_ARGS.

  Reviewed by:	kib
  MFC after:	2 weeks
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50758

  (cherry picked from commit 48a656c588f9fb995b9c524b57dd5febd9f69168)


   sys/compat/freebsd32/freebsd32_misc.c |  3 +++
   sys/compat/linux/linux_ptrace.c       | 18 ++++--------------
   sys/kern/sys_process.c                | 27 +++++++++++++++++++++------
   sys/sys/ptrace.h                      |  8 ++++++++
   4 files changed, 36 insertions(+), 20 deletions(-)

[commit f56b66f1260a33e49c65bbc05213ec8267978a93]
Date: 2025-05-28
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: tests: Add a regression test for commit 7587f6d4840f8
Review: Only adds a regression test; no user-visible changes.
Body:

  Reviewed by:	kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50533

  (cherry picked from commit a5dac34f6e98c47bd7cb1946e39cc45432e167a8)


   tests/sys/kern/Makefile           |   2 +
   tests/sys/kern/jail_lookup_root.c | 171 ++++++++++++++++++++++++++++++++++++++
   2 files changed, 173 insertions(+)

[commit 53963866f7088dd96f6d56169e6b4fb899277306]
Date: 2025-05-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: namei: clear internal flags in NDREINIT()
Review: The commit fixes an internal kernel namei flag handling issue with no direct user-visible impact.
Body:

  same as it is done for NDRESTART()

  Fixes:  e05e33041c252
  Reported and tested by:	pho
  Reviewed by:	markj
  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 58b2bd33aff71c0268d99d63e9c83f6544d3beb3)


   sys/sys/namei.h | 1 +
   1 file changed, 1 insertion(+)

[commit a66767844690dfd82e14df2d22bd9bc40e46546b]
Date: 2025-05-28
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: vfs: Don't clobber namei flags in vn_open_cred()
Review: The vn_open_cred() function now preserves namei flags set by callers, preventing unexpected flag clearing that could affect filesystem operations.
Body:

  Otherwise NAMEILOOKUP is cleared.  More generally it seems quite
  surprising that the flags set by vn_open_cred() callers are not
  automatically preserved.  Modify open2nameif() such that it takes
  already-set namei flags into account.

  Reviewed by:	olce, kib
  Fixes:		7587f6d4840f ("namei: Make stackable filesystems check harder for jail roots")
  Differential Revision:	https://reviews.freebsd.org/D50531

  (cherry picked from commit e05e33041c252dc236939683c01ca4b7b083562c)


   sys/kern/vfs_vnops.c | 22 ++++++++++++++--------
   1 file changed, 14 insertions(+), 8 deletions(-)

[commit 031cd548775c26314e6ae9cad35b01c5ab1aea6c]
Date: 2025-05-27
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: vfs cache: Add NAMEILOOKUP to the whitelist of fastpath lookup flags
Review: The commit fixes a regression that inadvertently disabled the lockless name lookup path, restoring performance for certain file system operations.
Body:

  Otherwise the lockless name lookup path is inadvertently disabled since
  NAMEILOOKUP isn't recognized.

  Reviewed by:	olce, kib
  Fixes:		7587f6d4840f ("namei: Make stackable filesystems check harder for jail roots")
  Differential Revision:	https://reviews.freebsd.org/D50532

  (cherry picked from commit f4158953007f557061d91f99d2374d48d8376cc6)


   sys/kern/vfs_cache.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3f4efe392b7039686057838d723a2d43ae144be5]
Date: 2025-05-23
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: namei: Remove a now-unused variable
Review: The commit removes an unused variable with no user-visible impact.
Body:

  Reported by:	bapt
  Fixes:		7587f6d4840f ("namei: Make stackable filesystems check harder for jail roots")

  (cherry picked from commit 14ec281a09d7818def2083ef0c3e28f8101f4268)


   sys/kern/vfs_cache.c | 4 +---
   1 file changed, 1 insertion(+), 3 deletions(-)

[commit 3feafab4a34c95209cd4fc3e6224c324efc056f3]
Date: 2025-05-23
Score: 5
Status: added(include=yes,score=85)
Sponsor: 
Section: Storage.general
Subject: namei: Make stackable filesystems check harder for jail roots
Review: The man:nullfs[5] and man:unionfs[5] filesystems now perform stricter checks for jail root vnodes during dotdot lookups, preventing a potential chroot escape vulnerability.
Body:

  Suppose a process has its cwd pointing to a nullfs directory, where the
  lower directory is also visible in the jail's filesystem namespace.
  Suppose that the lower directory vnode is moved out from under the
  nullfs mount.  The nullfs vnode still shadows the lower vnode, and
  dotdot lookups relative to that directory will instantiate new nullfs
  vnodes outside of the nullfs mountpoint, effectively shadowing the lower
  filesystem.

  This phenomenon can be abused to escape a chroot, since the nullfs
  vnodes instantiated by these dotdot lookups defeat the root vnode check
  in vfs_lookup(), which uses vnode pointer equality to test for the
  process root.

  Fix this by extending nullfs and unionfs to perform the same check,
  exploiting the fact that the passed componentname is embedded in a
  nameidata structure to avoid changing the VOP_LOOKUP interface.  That
  is, add a flag to indicate that containerof can be used to get the full
  nameidata structure, and perform the root vnode check on the lower vnode
  when performing a dotdot lookup.

  PR:		262180
  Reviewed by:	olce, kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50418

  (cherry picked from commit 7587f6d4840f8d363e457cddc14c184cf1fe7cc1)


   sys/fs/nullfs/null_vnops.c   | 28 ++++++++++++++++++----------
   sys/fs/unionfs/union_vnops.c | 21 +++++++++++++++++++++
   sys/kern/vfs_cache.c         | 11 +----------
   sys/kern/vfs_lookup.c        | 41 ++++++++++++++++++++++++++++++-----------
   sys/sys/namei.h              |  5 ++++-
   5 files changed, 74 insertions(+), 32 deletions(-)

[commit 9a26b661ac5bed21364d89bb58e2836099ccce93]
Date: 2025-06-23
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: mididumpl.1: update link to Standard MIDI-File Format Spec. 1.1, updated
Review: Updates the link to the Standard MIDI-File Format Specification 1.1 in the man:mididump[1] manual page.
Body:

  PR:		287588
  MFC after:	1 week

  (cherry picked from commit 27aec148ea4bfa2ccd2170ed1ccc6665aa819607)


   usr.bin/mididump/mididump.1 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit bc6ec9642b5a045fd0932fbbc9f73bd9564c1af3]
Date: 2025-06-04
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.contrib
Subject: kyua: increase cleanup_timeout to 300s
Review: The man:kyua[1] test cleanup timeout is increased from 60 to 300 seconds, preventing test failures for long-running cleanup operations.
Body:

  Test cleanup times out after 60 seconds, causing the test to fail if the
  cleanup hasn't finished in time.  This timeout should be configurable,
  but it currently is not.

  Several tests (e.g. bridge, pf) are now reaching this limit; as a
  workaround, increase the timeout to 300 seconds.

  Reviewed by:	igoro, kevans, des
  Approved by:	des (mentor), kevans (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50499

  (cherry picked from commit 0e33211f911c906b47cd0c457a86372c4b5daf87)


   contrib/kyua/engine/scheduler.cpp | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 6506b22772fbcc2b3f2d05bf12a23f877a26fa86]
Date: 2025-06-04
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Network.general
Subject: if_vlan_var.h: fix value of DOT1Q_VID_MAX
Review: The maximum valid VLAN ID is corrected from 4095 to 4094, aligning with the IEEE 802.1Q standard.
Body:

  This should be 4094 (0xFFE), not 4095 (0xFFF), since 0xFFF is not a
  valid VID.

  Fixes:	c59492025073 ("sys/net: add DOT1Q_VID_{MIN,MAX}")
  MFC after:	3 days
  Reviewed by:	kevans, kp, adrian
  Approved by:	kevans (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50576

  (cherry picked from commit d9b6b10e5ebbb517a079e89ac0de99be3b815c8d)


   sys/net/if_vlan_var.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e0c9d85cab833493b893ee023cc09e15d37c641e]
Date: 2025-06-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: libc: expose __getosreldate in private version
Review: The commit exposes __getosreldate in libc's private version for compatibility with libthr, but this is an internal library change without direct user-visible impact.
Body:

  This put stable/14 on par with HEAD where __getosreldate is exported
  from libsys, and can be used by libthr.  This is direct commit to
  stable/14.

  Sponsored by:	The FreeBSD Foundation


   lib/libc/gen/Symbol.map | 1 +
   1 file changed, 1 insertion(+)

[commit 4b8788dd08f1c5ecacb0fe16b2bb39e5082243d1]
Date: 2025-06-25
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: amd64 locore: fix typo in comment
Review: Only a typo fix in a comment with no user-visible impact.
Body:

  (cherry picked from commit 39c0792b15505436235a0bfd24abee59d6d535d2)


   sys/amd64/amd64/locore.S | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3131e7a41725acd53d7612da8cb9de278f81e244]
Date: 2025-06-24
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: csu: C standard requires errno on main() entry
Review: The C Standard requires errno to be set to zero on entry to main(). This ensures consistent behavior for programs relying on errno initialization.
Body:

  (cherry picked from commit 64584008139f73b07fa7c7979c41780be458b8cc)


   lib/libc/csu/libc_start1.c | 9 +++++++++
   1 file changed, 9 insertions(+)

[commit 7db7118976b5d8a8d981a801c0e5e5fcbccad462]
Date: 2025-06-01
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.libraries
Subject: libthr/amd64: do not set THR_C_RUNTIME for thr_new() if the main thread did used AMD64_SET_TLSBASE
Review: The commit fixes a threading issue on amd64 where THR_C_RUNTIME is incorrectly set for new threads when the main thread uses AMD64_SET_TLSBASE, potentially affecting thread-local storage behavior in userland applications.
Body:

  (cherry picked from commit 6b96e7a5731795e76fe33df5a23edfb136f2e508)


   lib/libthr/arch/aarch64/include/pthread_md.h |  2 ++
   lib/libthr/arch/amd64/Makefile.inc           |  2 ++
   lib/libthr/arch/amd64/amd64/thr_machdep.c    | 48 ++++++++++++++++++++++++++++
   lib/libthr/arch/amd64/include/pthread_md.h   |  2 ++
   lib/libthr/arch/arm/include/pthread_md.h     |  2 ++
   lib/libthr/arch/i386/include/pthread_md.h    |  2 ++
   lib/libthr/arch/powerpc/include/pthread_md.h |  2 ++
   lib/libthr/arch/riscv/include/pthread_md.h   |  2 ++
   lib/libthr/thread/thr_create.c               |  4 ++-
   lib/libthr/thread/thr_init.c                 |  2 +-
   lib/libthr/thread/thr_private.h              |  2 ++
   11 files changed, 68 insertions(+), 2 deletions(-)

[commit ec88c48413850768692a92736229e85b5d262935]
Date: 2024-11-10
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Drivers.device
Subject: ns8250: use LSR_THRE instead of LSR_TEMT for checking tx flush
Review: The ns8250 UART driver now uses LSR_THRE instead of LSR_TEMT for checking transmit flush completion, ensuring proper flushing of the hold register. The diagnostic message is updated to report which registers could not be flushed.
Body:

  LSR_TEMT bit is set if both transmit hold and shift registers are
  empty, but the flush command flushes only the hold register.

  While here, update the diagnostic message to report which registers
  could not be flushed.

  (cherry picked from commit 0d2fd5b99c95329085d0700a4dd38507a054a50d)


   sys/dev/uart/uart_dev_ns8250.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit ce773fbaec9b4fd790803ce253232405bee89f91]
Date: 2021-09-24
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: rk_i2s: correct some bit-field definitions, add more bits
Review: The commit corrects bit-field definitions and adds more bits for the Rockchip I2S driver, which may affect audio hardware support on compatible systems.
Body:

  (cherry picked from commit 3fc4ddb0151d1a4fec5ba6c878f4b8afc6aa83b8)


   sys/arm64/rockchip/rk_i2s.c | 8 ++++++--
   1 file changed, 6 insertions(+), 2 deletions(-)

[commit b4e40a47d37939713196a2530b4759a7a8e11148]
Date: 2025-03-30
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Drivers.device
Subject: ads111x: initialize the lock earlier, before it's used
Review: The commit moves lock initialization earlier to prevent a potential race condition during device setup, which could affect stability when using the ads111x ADC driver.
Body:

  The first use can be in ads111x_add_channels.

  (cherry picked from commit eda3a7ac755c5e02f92ff971db63d0a702963d66)


   sys/dev/iicbus/adc/ads111x.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 19fdd9fd613d2a0b7bfb19ad3d3b96a54c04a4b7]
Date: 2025-05-19
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Drivers.device
Subject: dwc_otg_fdt: do not create and leak extra usbus child
Review: The commit removes duplicate USB bus creation in the dwc_otg_fdt driver, preventing a resource leak. This resolves a bug that could cause system instability or resource exhaustion on affected hardware.
Body:

  dwc_otg_init() already takes care of creating the bus and setting up sc
  to point to it.

  Fixes:		518da7ace813e

  (cherry picked from commit 97c799661a76b78963fd9f92a7e6bb452ebba999)


   sys/dev/usb/controller/dwc_otg_fdt.c | 4 ----
   1 file changed, 4 deletions(-)

[commit 17ee60307cc91375192820e9a1b835508aef13ba]
Date: 2025-05-19
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.config
Subject: OptionalObsoleteFiles: etc/rc.d/powerd is used/useful without ACPI/APM
Review: The etc/rc.d/powerd script is removed from the list of obsolete files, allowing it to remain installed even when ACPI/APM is not present.
Body:

  Just like powerd daemon does not depend on ACPI/APM, its rc script does
  not either.

  Fixes:		20eb6bd8c598f

  (cherry picked from commit 28d74f18f1c222022ee4e9a2cdc63b1c21037392)


   tools/build/mk/OptionalObsoleteFiles.inc | 4 ----
   1 file changed, 4 deletions(-)

[commit bf73594fe0bd3d56b1035478cbbbdf58c05fe80e]
Date: 2024-12-05
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Kernel.general
Subject: pmap_growkernel(): do not panic immediately, optionally return the error
Review: The pmap_growkernel() function no longer panics immediately on failure and instead returns an error, which may affect kernel stability during low-memory conditions.
Body:

  (cherry picked from commit ef9017aa174db96ee741b936b984f2b5d61dff9f)


   sys/amd64/amd64/pmap.c              | 40 +++++++++++++++++++++++++++++--------
   sys/arm/arm/pmap-v6.c               | 23 ++++++++++++++++++---
   sys/arm64/arm64/pmap.c              | 26 +++++++++++++++++++-----
   sys/i386/i386/pmap.c                |  6 ++++--
   sys/i386/i386/pmap_base.c           | 14 +++++++++++--
   sys/i386/include/pmap_base.h        |  2 +-
   sys/powerpc/aim/mmu_radix.c         | 13 ++++++------
   sys/powerpc/include/mmuvar.h        |  4 ++--
   sys/powerpc/powerpc/pmap_dispatch.c | 19 +++++++++++++++++-
   sys/riscv/riscv/pmap.c              | 26 ++++++++++++++++++++----
   sys/vm/pmap.h                       |  2 +-
   sys/vm/vm_map.c                     |  9 +++++++--
   12 files changed, 147 insertions(+), 37 deletions(-)

[commit fad4064226b2aa3de6a6c83adb7e0e0108e69bd3]
Date: 2024-03-05
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Cloud Software Group
Section: Hardware.virtualization
Subject: x86/xen: fix accounted interrupt time
Review: The fix corrects accounted interrupt time for Xen virtual machines, preventing statclock() from incorrectly reporting idle time as interrupt time.
Body:

  The current addition to the interrupt nesting level in
  xen_arch_intr_handle_upcall() needs to be compensated in
  xen_intr_handle_upcall(), otherwise interrupts dispatched by the upcall handler
  end up seeing a td_intr_nesting_level of 2 or more, which makes them assume
  there's been an interrupt nesting.

  Such extra interrupt nesting count lead to statclock() reporting idle time as
  interrupt, as the call from interrupt context will always be seen as a nested
  one (td->td_intr_nesting_level >= 2) due to the nesting count increase done by
  both xen_arch_intr_handle_upcall() and intr_execute_handlers().

  Fix this by adjusting the nested interrupt count before dispatching interrupts
  from xen_intr_handle_upcall().

  PR: 277231
  Reported by: Matthew Grooms <mgrooms@shrew.net>
  Fixes: af610cabf1f4 ('xen/intr: adjust xen_intr_handle_upcall() to match driver filter')
  Sponsored by: Cloud Software Group
  Reviewed by: Elliott Mitchell <ehem+freebsd@m5p.com>

  (cherry picked from commit f750dce972efaea614aa6d03ecdb24aa962a38a4)


   sys/dev/xen/bus/xen_intr.c | 21 ++++++++++++++++++++-
   1 file changed, 20 insertions(+), 1 deletion(-)

[commit 533f1a4d6b6ef0ba575d99b16a45b96fb5e91e59]
Date: 2025-06-16
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Kernel.general
Subject: audit: move the wait from the queue length from the commit to alloc
Review: The audit subsystem now waits for available queue space during allocation rather than during commit, which may affect performance and behavior of audit logging under heavy load.
Body:

  PR:	287566

  (cherry picked from commit 0452f5f7b37af81dba3953c7127385fe6f307790)


   sys/security/audit/audit.c | 27 +++++++++++----------------
   1 file changed, 11 insertions(+), 16 deletions(-)

[commit 478f977862637cc48e97ad71885ce3ebb16280c0]
Date: 2025-06-10
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation | Klara, Inc.
Section: undecided
Subject: libclang_rt: Descend into libclang_rt to clean
Review: The commit fixes a build system issue where object files in libclang_rt were not cleaned during a clean buildworld, but this is an internal build process change without direct user-visible impact.
Body:

  Otherwise, during a clean buildworld we don't descend into libclang_rt
  to remove object files.

  Reviewed by:	brooks, dim, emaste
  MFC after:	2 weeks
  Sponsored by:	The FreeBSD Foundation
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50766

  (cherry picked from commit 20c636620c6955795f97619d22c7eca9f8599ad7)


   lib/Makefile | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 1b09c94e950cf1444e29c07a1e25c33324f271df]
Date: 2025-06-16
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Obsoletefiles.inc: Correct paths for some man pages
Review: The commit only updates internal build metadata (ObsoleteFiles.inc) to correct paths for removed man pages, with no direct user-visible impact.
Body:

  Reported by:	dougm
  MFC after:	1 week
  Fixes:		87b646630c48 ("vm_page: Consolidate page busy sleep mechanisms")

  (cherry picked from commit 18117f3f1269c3b70c04ed741cc1ca3f3ecd8be9)


   ObsoleteFiles.inc | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 0ee191f2f035b8b491a51ad30e41c79581655cad]
Date: 2025-06-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: fcntl.h: warn that bits for O_* flags are scarce
Review: A warning comment is added to fcntl.h noting that O_* flag bits are scarce and that future additions must be coordinated with srcmgr@. This has no direct user-visible impact.
Body:

  Running out of O_* flag bits will end out ability to make additions that
  are source compatible with other operating systems.

  Add a warning to coordinate all additions with srcmgr@.

  Reviewed by:	markj, emaste
  Differential Revision:	https://reviews.freebsd.org/D50703

  (cherry picked from commit 6d0a335aaa81d3ddce95de8d862a23c97bb038a6)


   sys/sys/fcntl.h | 10 ++++++++++
   1 file changed, 10 insertions(+)

[commit 6ff6a0b589810f41cea06fbcdf21c5b0dd72e602]
Date: 2025-06-11
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: Don't rely on sys/_types.h including sys/cdefs.h
Review: The commit fixes header inclusion issues that could affect compilation of user programs using certain headers, ensuring proper macro definitions.
Body:

  These headers relied in __BEGIN_DECS/__END_DECLS being defined when
  sys/_types.h was included, but there's not a requirement that this be
  the case.

  Reviewed by:	imp
  Exp-run by:	antoine (PR 286274)
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1595

  (cherry picked from commit b01e971fd39d10273a387788019457792873e81c)
  (cherry picked from commit 4f4c465b45d42ed8d2b65c8b4c909246987ac877)
  (cherry picked from commit 12913e4ddf710e517f3ae00b7b420b783cca9b37)


   contrib/libexecinfo/execinfo.h | 2 ++
   include/dlfcn.h                | 1 +
   lib/msun/aarch64/fenv.h        | 1 +
   lib/msun/arm/fenv.h            | 1 +
   lib/msun/riscv/fenv.h          | 1 +
   lib/msun/src/math.h            | 1 +
   sys/arm/include/sysarch.h      | 2 ++
   sys/arm64/include/sysarch.h    | 2 ++
   sys/sys/procdesc.h             | 1 +
   9 files changed, 12 insertions(+)

[commit 953119c5f5ce79865f21d642fcdd582285cd5c89]
Date: 2025-06-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: nuageinit.7: language and grammar improvements
Review: The commit only improves language and grammar in a man page without introducing user-visible functional changes.
Body:

  Reviewed by:	bapt

  (cherry picked from commit b78b7fa01fc775c9bb95ac7d68fbf3994a5ab5c5)


   libexec/nuageinit/nuageinit.7 | 20 ++++++++++----------
   1 file changed, 10 insertions(+), 10 deletions(-)

[commit 14237ecfd28cd664fcb0f1645deb632cd059d579]
Date: 2025-06-17
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: nuageinit.7: language and grammar fixes mostly
Review: The commit updates the man:nuageinit[7] manual page with language and grammar fixes.
Body:

  (cherry picked from commit 1049c079c013e17b72d64f6b558e9f7e777714f1)


   libexec/nuageinit/nuageinit.7 | 54 +++++++++++++++++++++----------------------
   1 file changed, 26 insertions(+), 28 deletions(-)

[commit 1970a6c273649e9e6c6a307c0c0b541d322badc2]
Date: 2025-06-20
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: nuageinit(7) tests: Fix extra space in test output expectation
Review: Test-only change with no user-visible impact.
Body:

  This fixes the test case libexec.nuageinit.nuageinit.config2_userdata_packages

  Signed-off-by: Siva Mahadevan <me@svmhdvn.name>

  Event:		Kitchener-Waterloo Hackathon 202506
  Sponsored by:	The FreeBSD Foundation
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1734

  (cherry picked from commit 7067bab893e60c60d56f52322a686bc7e7cd4955)


   libexec/nuageinit/tests/nuageinit.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 808038a38f05c8d5f52b3d58d7acede7b26f1e78]
Date: 2025-06-16
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Docs.manpages
Subject: nuageinit: write a documentation
Review: The man:nuageinit[7] manual page is added, documenting the nuageinit utility.
Body:

  Reviewed by:	imp, ziaee (both a previous version)
  Differential Revision:	https://reviews.freebsd.org/D50878

  (cherry picked from commit 5ec727ea1a1e65f3a784d70f7392d0a75d38d0a6)


   libexec/nuageinit/Makefile    |   1 +
   libexec/nuageinit/nuageinit.7 | 288 ++++++++++++++++++++++++++++++++++++++++++
   2 files changed, 289 insertions(+)

[commit 56d0667e3f42f85029827c91e69f08c5e96c77c5]
Date: 2025-06-16
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: nuageinit: fix typo
Review: Fixes a typo in the nuageinit script.
Body:

  (cherry picked from commit dba559e8066457fbb5105dcc09616ba6eb766345)


   libexec/nuageinit/nuageinit | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit bb3bc92f4df63bf4b071816de04605d3033e390a]
Date: 2025-06-16
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: add a post network script
Review: nuageinit now executes in three phases during boot: pre-networking, post-networking/pre-servers, and rc.local time. This allows network-dependent operations like package installation to occur after networking is available, and user creation to succeed when non-standard shells are requested.
Body:

  refactor nuageinit to allow a 3rd execution point during boot:
  1. nuageinit is invoked before NETWORKING with a minimalistic network setup
     for openstrack and potentially other network config setup. it tries
     to configure everything which is not requiring any network.
  2. nuageinit is invoked again post NETWORKING but pre SERVERS, in the
     phase it does all that requires network, like dealing with packages.
     Note that creating users have been moved to this phase to allow the
     installation of shells like bash or zsh prior the creation of the
     users, before that the user creation was failing if a non installed
     shell was requested.
  3. nuageinit will execute at the rc.local time all the specified scripts
     and commands.

  MFC After: 1 week

  (cherry picked from commit 2a05d577ab30dcefcf51def4c65a64af30610c85)


   libexec/nuageinit/nuageinit          | 399 ++++++++++++++++++++---------------
   libexec/nuageinit/tests/nuageinit.sh |  34 +--
   libexec/rc/rc.d/Makefile             |   1 +
   libexec/rc/rc.d/nuageinit_post_net   |  25 +++
   4 files changed, 275 insertions(+), 184 deletions(-)

[commit 5540b9eb9e2a560ba89e0a94ad665eaa8bf245cc]
Date: 2025-06-15
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: add support for sudo
Review: The nuageinit utility now supports sudo for privilege escalation, allowing users to run commands with elevated privileges when needed.
Body:

  (cherry picked from commit 6a54f886bede6e6193ebc82ec5fca85679b7dc41)


   libexec/nuageinit/nuage.lua          | 39 +++++++++++++++++++++++++++++++++++-
   libexec/nuageinit/nuageinit          |  3 +++
   libexec/nuageinit/tests/nuageinit.sh |  2 ++
   3 files changed, 43 insertions(+), 1 deletion(-)

[commit 3406fba999d1e86d8b3f1580fcb4748d733ffb7a]
Date: 2025-06-14
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: support "fqdn" and "hostname"
Review: The nuageinit utility now supports 'fqdn' and 'hostname' options, allowing users to configure the fully qualified domain name and hostname during initialization.
Body:

  (cherry picked from commit f1dd507b2c44f16c94395e67f82125c491ebddf2)


   libexec/nuageinit/nuageinit          |  6 ++++++
   libexec/nuageinit/tests/nuageinit.sh | 22 ++++++++++++++++++++++
   2 files changed, 28 insertions(+)

[commit 7ee737e8de267ed85a3abef37ac90c5bee8bfbde]
Date: 2025-06-13
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: nuageinit: fix typo
Review: Fixes a typo in the nuageinit_user_data_script script.
Body:

  PR:	287503
  Reported by:	crest@rlwinm.de

  (cherry picked from commit cae3d6c8d40a417f32be165aa9a9b4be86bb7f49)


   libexec/rc/rc.d/nuageinit_user_data_script | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 279f98470572f39c6ead7ecce973c4eefbceeecf]
Date: 2025-06-10
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: nuageinit: pet luacheck
Review: Minor internal code refactoring with no user-visible impact.
Body:

  Rename path into ni_path (ni stands for nuageinit) which is more
  understandable and avoid a shadowing warning because we also use a
  variable named path later.

  Add a missing local

  (cherry picked from commit f678c47590276aa8acdacdecfb78cc6c44bbf449)


   libexec/nuageinit/nuageinit | 16 ++++++++--------
   1 file changed, 8 insertions(+), 8 deletions(-)

[commit f27b5d04f4df8556908e9af8db28460ac4536a9f]
Date: 2025-06-10
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: nuageinit: runcmd should also be executed late
Review: nuageinit now executes the runcmd directive at the same late stage as the user_data script, aligning with cloudinit specifications.
Body:

  Execute the runcmd specified in cloudinit at the same moment as the
  user_data script aka late in the boot process, to respect cloudinit
  specifications

  (cherry picked from commit 8feca60d6ee983ef3c81903675b4d9c3218c7e7a)


   libexec/nuageinit/nuageinit                | 13 ++++++++++---
   libexec/nuageinit/tests/nuageinit.sh       | 12 +++++++-----
   libexec/rc/rc.d/nuageinit_user_data_script |  4 ++++
   3 files changed, 21 insertions(+), 8 deletions(-)

[commit b5bf10d30b40c44797bcbf9a213357f480e40f36]
Date: 2025-06-10
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.contrib
Subject: nuageinit: fix using user_data as a script
Review: nuageinit now properly handles user_data scripts starting with '#!' by copying them to /var/cache/nuageinit/user_data and executing them via a new rc.d script during boot. This fixes compatibility with cloud providers like Digital Ocean that set executable permissions on user_data scripts.
Body:

  In official cloudinit, when a user_data file starts with '#!' it
  should be execute late in the boot process. To respect this nuageinit
  now copy the user_data script into a /var/cache/nuageinit/user_data if
  found and a new "firsboot" rcscript anchored to the 'local' rc script is
  responsible to execute it if found.

  Note by doing this, we fix another issue we had with nuageinit, if the
  cloudinit provider provides the user_data scriptout with the executable
  permission, previous implementation was not working, like apparently
  what Digital Ocean is doing.

  PR:		287183
  Reported by:	olgeni@

  (cherry picked from commit 09545628f0cd58406a47f302fb8584a5292d4b1a)


   libexec/nuageinit/nuageinit                | 15 ++++++++++-----
   libexec/nuageinit/tests/nuageinit.sh       | 30 ++++++++++++++++++++++++++++--
   libexec/rc/rc.d/Makefile                   |  3 ++-
   libexec/rc/rc.d/nuageinit_user_data_script | 25 +++++++++++++++++++++++++
   4 files changed, 65 insertions(+), 8 deletions(-)

[commit 09e960f1aa85cc0aa6c64f50c25f50862ba6ce7e]
Date: 2025-06-06
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: OVHCloud
Section: Userland.programs
Subject: nuageinit: more package related functions
Review: The nuageinit tool now includes package_update and package_upgrade functions, allowing users to update package metadata and upgrade packages within the nuageinit environment.
Body:

  Implement package_update and package_upgrade, which allows to launch
  an update of the metadata and an upgrade of the packages.

  Sponsored by:	OVHCloud

  (cherry picked from commit 682af9601aebb71357d05bb9ffbc137958a437cf)


   libexec/nuageinit/nuage.lua          | 20 +++++++++++++++++++-
   libexec/nuageinit/nuageinit          |  7 +++++++
   libexec/nuageinit/tests/nuageinit.sh | 33 +++++++++++++++++++++++++++++++++
   3 files changed, 59 insertions(+), 1 deletion(-)

[commit 27522eaa4c0cb4bc1348fd212ee79449e5da79bd]
Date: 2025-06-06
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: OVHCloud
Section: Userland.programs
Subject: nuageinit: implement packages
Review: nuageinit now installs a list of packages during initialization.
Body:

  Installs a list of packages

  Sponsored by:	OVHCloud

  (cherry picked from commit 076fec1b88de8e14f370127cc4aeaa737eda92a8)


   libexec/nuageinit/nuage.lua          | 22 +++++++++++++++++-
   libexec/nuageinit/nuageinit          | 19 ++++++++++++++++
   libexec/nuageinit/tests/nuageinit.sh | 44 ++++++++++++++++++++++++++++++++++++
   3 files changed, 84 insertions(+), 1 deletion(-)

[commit f08ebb3a66563a6e5397f2994fdcffae2aace58d]
Date: 2025-06-06
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: OVHCloud
Section: Userland.programs
Subject: nuageinit: add a function to bootstrap pkg if needed
Review: The nuageinit script now automatically bootstraps the pkg package manager if it is not already installed, simplifying initial package management setup.
Body:

  Sponsored by:	OVHCloud

  (cherry picked from commit 43b82d69b252ddd50ac82e54481f2184b8212869)


   libexec/nuageinit/nuage.lua | 12 +++++++++++-
   1 file changed, 11 insertions(+), 1 deletion(-)

[commit 5444803b745efe61f5cbb5cb56e41369b16e7228]
Date: 2025-06-05
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: OVHCloud
Section: Userland.programs
Subject: nuageinit: implement runcmd
Review: The nuageinit utility now supports a 'runcmd' configuration option that executes a list of commands in order during initialization.
Body:

  runcmd contains a list of string, each item will be executed in order.

  Sponsored by:	OVHCloud

  (cherry picked from commit 2f35a5218323b3da7fb71933778c03bbb1c2bb7f)


   libexec/nuageinit/nuageinit          |  9 ++++++++-
   libexec/nuageinit/tests/nuageinit.sh | 37 ++++++++++++++++++++++++++++++++++++
   2 files changed, 45 insertions(+), 1 deletion(-)

[commit de9af281156426f8608299f761c3fb525c7b990c]
Date: 2025-06-05
Score: 5
Status: proposed(include=no,score=5)
Sponsor: OVHCloud
Section: undecided
Subject: nuageinit: helper function to setup adduser
Review: The commit adds a helper function for internal unit testing of nuageinit, which is a build-time tool for cloud image creation. This change does not affect end users or system behavior; it is only for development and testing purposes.
Body:

  To carry out the userdata unit tests, you need to set up the environment in
  order to skip adding the default user (nuage.adduser(default_user)

  Sponsored by:	OVHCloud

  (cherry picked from commit e38f521f53d70423064a987be08c3bd5debe3a2e)


   libexec/nuageinit/tests/nuageinit.sh | 16 ++++++++++++++++
   1 file changed, 16 insertions(+)

[commit 548d4b2af90b5cf95eab24ffc4d0dfa5a1f348eb]
Date: 2025-06-06
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: OVHCloud
Section: Userland.programs
Subject: nuageinit: log nuageinit execution
Review: The nuageinit startup script now logs its execution, providing users with visibility into its startup process.
Body:

  Sponsored by:	OVHCloud

  (cherry picked from commit 9a62e1d98dc79c69f0d20439bd34a16149106046)


   libexec/rc/rc.d/nuageinit | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit eb9f57c2458bbae5be4ab52590bae9b2ac65026c]
Date: 2025-06-03
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Ports.packaging
Subject: pkg.conf: add valid configurations for kmods for all branches
Review: The commit adds kernel module (kmod) configuration to pkg's quarterly-release configuration file, allowing users to install kernel modules via pkg on quarterly-release branches.
Body:

  MFC After:	1 week
  Reviewed by:	cperciva
  Differential Revision: 	https://reviews.freebsd.org/D50668

  (cherry picked from commit db6f6cc583bde6c21618ab4a4ab926f9d57b1641)


   usr.sbin/pkg/FreeBSD.conf.latest            |  2 +-
   usr.sbin/pkg/FreeBSD.conf.quarterly         |  2 +-
   usr.sbin/pkg/FreeBSD.conf.quarterly-release | 23 +++++++++++++++++++++++
   usr.sbin/pkg/Makefile                       |  2 +-
   4 files changed, 26 insertions(+), 3 deletions(-)

[commit 05275cf75a19e9f5919bf0a2ee86b5b946d0dc07]
Date: 2025-05-15
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: FreeBSD Foundation
Section: Userland.libraries
Subject: libusb: add SUPER_PLUS in speed enum.
Review: Adds LIBUSB_SPEED_SUPER_PLUS enumeration to libusb to prevent compile errors with applications using this newer USB speed constant.
Body:

  Summary:
  Some application(like usbmuxd) start to use LIBUSB_SPEED_SUPER_PLUS now.
  Though we don't have the corresponding infra in kernel right now, it is
  harmless to have this enum value in userspace to prevent the compile error

  Reviewed By: bapt
  Sponsored By: FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50359

  (cherry picked from commit f938c0a90313125a9518307e80ca92d4c71f7745)


   lib/libusb/libusb.3       | 2 +-
   lib/libusb/libusb.h       | 1 +
   lib/libusb/libusb01.c     | 2 ++
   lib/libusb/libusb10.c     | 5 +++++
   lib/libusb/libusb20.3     | 1 +
   lib/libusb/libusb20.h     | 1 +
   usr.sbin/usbconfig/dump.c | 2 ++
   7 files changed, 13 insertions(+), 1 deletion(-)

[commit 884ca28b97e73f297b512aaf04deb6f951854c02]
Date: 2025-05-15
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: libusb: use eventfd
Review: libusb now uses eventfd(2) instead of pipe(2) for inter-thread event handling, which may improve performance and simplify internal event mechanisms.
Body:

  Simplify libusb code by replacing pipe(2) inter thread event mecanism
  with eventfd(2).

  MFC After:	3 weeks
  Reviewed by:	kevans
  Differential Revision:	https://reviews.freebsd.org/D50360

  (cherry picked from commit ae28929b7c78267815e994e0ad12e3cc7db361bc)


   lib/libusb/libusb10.c    | 20 +++++++-------------
   lib/libusb/libusb10.h    |  2 +-
   lib/libusb/libusb10_io.c |  5 ++---
   3 files changed, 10 insertions(+), 17 deletions(-)

[commit 33f65f12eba10588827a13d232337616f6f4facf]
Date: 2025-06-14
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: bnxt: Fix BASE-T, 40G AOC, 1G-CX, autoneg and unknown media lists
Review: The bnxt driver now correctly builds media lists for BASE-T, 40G AOC, 1G-CX, autonegotiation, and unknown media types, restoring proper link reporting and configuration.
Body:

  This was broken in c63d67e137f3, the early returns prevent building the
  media lists as expected.

  The BASE-T parts of the patch were suggested by "cyric@mm.st", while I
  am adding the additional 40G AOC, 1CX, autoneg and unknown PHY fixes
  based on code inspection.  There may be additional work left here for
  Broadcom but this is certainly better than the returns.

  PR:		287395

  Reported by:	mickael.maillot@gmail.com, cyric@mm.st
  Tested by:	Einar Bjarni Halldrsson <einar@isnic.is>

  (cherry picked from commit 5e6e4f752833acc96f1efc893318d3f6b74b9689)


   sys/dev/bnxt/bnxt_en/if_bnxt.c | 14 +++++++-------
   1 file changed, 7 insertions(+), 7 deletions(-)

[commit ef360183df813e3e89f3eb9dcf2ad0e47a58102c]
Date: 2025-05-29
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Intel Corporation
Section: undecided
Subject: qat: update API files to use SPDX identifier
Review: License headers in QAT API header files are updated to use SPDX identifiers for consistency.
Body:

  API files are updated to have SPDX identifier and remove
  longer form of license to ensure consistency with the
  license format across all files.

  Reviewed by:	markj, ziaee
  MFC after:	2 weeks
  Sponsored by:   Intel Corporation
  Differential Revision:  https://reviews.freebsd.org/D50379

  (cherry picked from commit 2542189532b3025577fa4e782904494f3587008b)


   sys/dev/qat/qat_api/include/cpa.h               | 37 ++-----------------------
   sys/dev/qat/qat_api/include/cpa_dev.h           | 37 ++-----------------------
   sys/dev/qat/qat_api/include/cpa_types.h         | 37 ++-----------------------
   sys/dev/qat/qat_api/include/dc/cpa_dc.h         | 37 ++-----------------------
   sys/dev/qat/qat_api/include/dc/cpa_dc_bp.h      | 37 ++-----------------------
   sys/dev/qat/qat_api/include/dc/cpa_dc_chain.h   | 37 ++-----------------------
   sys/dev/qat/qat_api/include/dc/cpa_dc_dp.h      | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_common.h | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_dh.h     | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_dsa.h    | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_ec.h     | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_ecdh.h   | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_ecdsa.h  | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_ecsm2.h  | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_im.h     | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_key.h    | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_kpt.h    | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_ln.h     | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_prime.h  | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_rsa.h    | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_sym.h    | 37 ++-----------------------
   sys/dev/qat/qat_api/include/lac/cpa_cy_sym_dp.h | 37 ++-----------------------
   22 files changed, 44 insertions(+), 770 deletions(-)

[commit a66d631a385ea35db9f3b31cecc355725a16022d]
Date: 2025-05-07
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Intel Corporation
Section: undecided
Subject: qat: refactor error handling and add mutex locks
Review: The commit refactors internal error handling and adds mutex locks in the QAT driver, which are internal changes without direct user-visible impact.
Body:

  Error handling in qat driver code has been refactored.
  Mutex lock handling has also been added during driver
  attach and detach. Also pci_disable_busmaster() is called in
  adf_detach() to ensure proper cleanup during device detachment.

  Reviewed by:	markj, ziaee
  MFC after:	2 weeks
  Sponsored by:   Intel Corporation
  Differential Revision:  https://reviews.freebsd.org/D50379

  (cherry picked from commit ae1dc27639c88038d150660c4096753e210aec42)


   sys/dev/qat/qat_common/adf_init.c         | 13 -------------
   sys/dev/qat/qat_hw/qat_200xx/adf_drv.c    | 23 +++++++++++++++++------
   sys/dev/qat/qat_hw/qat_4xxx/adf_drv.c     | 23 +++++++++++++++++------
   sys/dev/qat/qat_hw/qat_4xxxvf/adf_drv.c   | 22 ++++++++++++++++++----
   sys/dev/qat/qat_hw/qat_c3xxx/adf_drv.c    | 23 +++++++++++++++++------
   sys/dev/qat/qat_hw/qat_c4xxx/adf_drv.c    | 23 +++++++++++++++++------
   sys/dev/qat/qat_hw/qat_c62x/adf_drv.c     | 23 +++++++++++++++++------
   sys/dev/qat/qat_hw/qat_dh895xcc/adf_drv.c | 24 ++++++++++++++++++------
   8 files changed, 121 insertions(+), 53 deletions(-)

[commit cabd847e400f2c738e15cf6760939f80e24cf8a9]
Date: 2025-05-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: qat: driver updates to improve code and fix bugs
Review: The commit includes bug fixes and improvements for the qat driver, which may affect users relying on Intel QuickAssist Technology hardware for cryptographic acceleration and compression.
Body:

  Bug fixes and improvements are done for the qat code base
  to improve code quality.

  Reviewed by:	markj, ziaee
  MFC after:	2 weeks
  Sponsored by:   Intel Corporation
  Differential Revision:  https://reviews.freebsd.org/D50379

  (cherry picked from commit ded037e65e5239671b1292ec987a2e0894b217b5)


   sys/dev/qat/include/adf_cfg_device.h               |  4 +-
   sys/dev/qat/include/adf_gen4vf_hw_csr_data.h       |  4 +-
   sys/dev/qat/include/adf_pfvf_vf_msg.h              |  3 +-
   sys/dev/qat/include/common/adf_accel_devices.h     |  2 +
   sys/dev/qat/include/common/adf_cfg_common.h        |  4 +-
   sys/dev/qat/include/common/adf_common_drv.h        |  3 +-
   sys/dev/qat/include/common/adf_gen4_hw_data.h      |  6 +-
   sys/dev/qat/include/common/adf_pfvf_msg.h          |  8 ++-
   sys/dev/qat/include/icp_qat_fw_init_admin.h        |  2 +-
   .../qat/qat_api/common/compression/dc_datapath.c   | 11 +++-
   .../qat_api/common/crypto/sym/key/lac_sym_key.c    |  8 +++
   .../qat/qat_api/common/crypto/sym/lac_sym_hash.c   | 11 ++--
   .../common/crypto/sym/qat/lac_sym_qat_cipher.c     | 35 +++++++++---
   sys/dev/qat/qat_api/common/ctrl/sal_compression.c  |  8 +--
   sys/dev/qat/qat_api/common/ctrl/sal_crypto.c       |  4 +-
   .../qat_api/common/include/sal_types_compression.h |  4 +-
   sys/dev/qat/qat_api/include/icp_sal_versions.h     |  4 +-
   sys/dev/qat/qat_common/adf_aer.c                   | 11 +++-
   sys/dev/qat/qat_common/adf_cfg_device.c            | 14 ++++-
   .../qat/qat_common/adf_freebsd_cnvnr_ctrs_dbg.c    |  1 +
   sys/dev/qat/qat_common/adf_freebsd_dev_processes.c | 20 ++-----
   sys/dev/qat/qat_common/adf_gen2_hw_data.c          |  6 +-
   sys/dev/qat/qat_common/adf_gen4_pfvf.c             |  3 +-
   sys/dev/qat/qat_common/adf_gen4vf_hw_csr_data.c    |  8 +--
   sys/dev/qat/qat_common/adf_init.c                  | 66 +++++++++++++++++++++-
   sys/dev/qat/qat_common/adf_pfvf_vf_msg.c           | 20 ++++++-
   sys/dev/qat/qat_common/adf_pfvf_vf_proto.c         | 17 ++++--
   sys/dev/qat/qat_common/adf_vf_isr.c                | 15 ++++-
   sys/dev/qat/qat_common/qat_hal.c                   | 17 ++++--
   sys/dev/qat/qat_common/qat_uclo.c                  | 12 ++--
   sys/dev/qat/qat_hw/qat_200xx/adf_200xx_hw_data.h   |  6 +-
   sys/dev/qat/qat_hw/qat_4xxx/adf_4xxx_hw_data.c     |  3 +
   sys/dev/qat/qat_hw/qat_4xxx/adf_drv.c              |  5 --
   sys/dev/qat/qat_hw/qat_4xxxvf/adf_4xxxvf_hw_data.c |  3 +
   sys/dev/qat/qat_hw/qat_c3xxx/adf_c3xxx_hw_data.h   |  6 +-
   sys/dev/qat/qat_hw/qat_c4xxx/adf_c4xxx_hw_data.c   |  6 +-
   36 files changed, 262 insertions(+), 98 deletions(-)

[commit 9c521111487295819f34a44f3d6b27c90d9dbb73]
Date: 2025-05-01
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Intel Corporation
Section: undecided
Subject: qat: reimplement cpaCyGetXXXInstances as a wrapper
Review: The commit refactors internal QAT driver code to reduce duplication but does not introduce any user-visible changes in functionality, performance, or configuration.
Body:

  Currently code from sal_instances.c and sal_crypto.c
  for getting cy instances or number of instances is duplicated.

  This commit replaces cpaCyGetXXXInstances implementation with
  Lac_GetCyXXXInstancesByType invocation.

  Reviewed by:	markj, ziaee
  MFC after:	2 weeks
  Sponsored by:   Intel Corporation
  Differential Revision:  https://reviews.freebsd.org/D50379

  (cherry picked from commit e745eee59c821c1d8ae7f5b25dfbdf0049b4787c)


   sys/dev/qat/qat_api/common/ctrl/sal_crypto.c       | 205 ++-------------------
   .../qat/qat_api/common/ctrl/sal_get_instances.c    | 177 ++++++++++++++----
   .../qat_api/common/include/lac_sal_types_crypto.h  |  23 ++-
   3 files changed, 182 insertions(+), 223 deletions(-)

[commit ef712e91a8669c9ab8bc6456d02027fced6920fc]
Date: 2025-04-30
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: qat: restrict sysctl access to privileged users
Review: Access to QAT driver sysctl nodes for firmware counters and transport debugging is now restricted to privileged users only.
Body:

  Access to crucial QAT driver internals, such as
  firmware counters and transport debug via
  sysctl, has been limited to privileged users only.

  Reviewed by:	markj, ziaee
  MFC after:	2 weeks
  Sponsored by:   Intel Corporation
  Differential Revision:  https://reviews.freebsd.org/D50379

  (cherry picked from commit 8aa51e6d7de0a828020de64560d1385e15955a1c)


   sys/dev/qat/qat_common/adf_cfg_sysctl.c            | 15 ++++-
   sys/dev/qat/qat_common/adf_clock.c                 | 34 +++++++++--
   sys/dev/qat/qat_common/adf_freebsd_cfg_dev_dbg.c   |  6 +-
   .../qat/qat_common/adf_freebsd_cnvnr_ctrs_dbg.c    |  4 ++
   sys/dev/qat/qat_common/adf_freebsd_heartbeat_dbg.c | 66 +++++++++++++++++++---
   sys/dev/qat/qat_common/adf_freebsd_pfvf_ctrs_dbg.c |  6 +-
   .../qat/qat_common/adf_freebsd_transport_debug.c   |  9 ++-
   sys/dev/qat/qat_common/adf_freebsd_ver_dbg.c       | 10 ++++
   sys/dev/qat/qat_common/adf_fw_counters.c           |  4 ++
   sys/dev/qat/qat_hw/qat_c4xxx/adf_c4xxx_ae_config.c |  7 ++-
   .../qat_hw/qat_c4xxx/adf_c4xxx_misc_error_stats.c  |  6 +-
   .../qat_hw/qat_c4xxx/adf_c4xxx_pke_replay_stats.c  |  6 +-
   sys/dev/qat/qat_hw/qat_c4xxx/adf_c4xxx_ras.c       | 15 ++++-
   13 files changed, 167 insertions(+), 21 deletions(-)

[commit 84af3e5b2f6704130b3b5b67cef0a7ee4f4489ef]
Date: 2025-04-30
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Intel Corporation
Section: undecided
Subject: qat: move debugfs handling to separate file
Review: The commit refactors debugfs handling for QAT drivers, moving it to a separate file and adjusting when debugfs entries are created. This change does not introduce new user-visible features, remove functionality, or alter configuration; it is an internal code reorganization.
Body:

  Moved handling of debugfs entries to a separate file.
  In addition, it will allow to consolidate the addition of
  debugfs entries to a single location in the code.

  This implementation adds infrastructure to create (and remove)
  debugfs entries at two different stages.
  - Done when a device is probed, allows to keep debugfs entries
  persistent between a transition in device state (up to down or
  vice versa).
  - Done after the initialization phase, allows to have debugfs
  entries that are accessible only when the device is up.

  In addition, moved the creation of debugfs entries for configuration
  of the newly created function adf_dbgfs_init() and replace symbolic
  permissions with octal permissions when creating the debugfs files.

  Added sysctl oids storage for proper cleanup on device down.

  Reviewed by:	markj, ziaee
  MFC after:	2 weeks
  Sponsored by:   Intel Corporation
  Differential Revision:  https://reviews.freebsd.org/D50379

  (cherry picked from commit c38bafee7e182fbcdc3c346b2785ed258230cb06)


   sys/dev/qat/include/adf_dbgfs.h                    | 11 +++
   sys/dev/qat/include/adf_heartbeat.h                |  6 +-
   sys/dev/qat/include/common/adf_accel_devices.h     |  4 +
   sys/dev/qat/qat_common/adf_cfg.c                   | 42 ++--------
   .../qat/qat_common/adf_freebsd_cnvnr_ctrs_dbg.c    | 55 +++++++-----
   sys/dev/qat/qat_common/adf_freebsd_dbgfs.c         | 68 +++++++++++++++
   sys/dev/qat/qat_common/adf_freebsd_heartbeat_dbg.c | 98 ++++++++++++++--------
   sys/dev/qat/qat_common/adf_freebsd_ver_dbg.c       | 98 ++++++++++++++--------
   sys/dev/qat/qat_common/adf_fw_counters.c           | 42 ++++++----
   sys/dev/qat/qat_common/adf_init.c                  |  7 +-
   sys/dev/qat/qat_hw/qat_200xx/adf_drv.c             |  8 +-
   sys/dev/qat/qat_hw/qat_4xxx/adf_drv.c              |  8 +-
   sys/dev/qat/qat_hw/qat_4xxxvf/adf_drv.c            |  6 +-
   sys/dev/qat/qat_hw/qat_c3xxx/adf_drv.c             |  8 +-
   sys/dev/qat/qat_hw/qat_c4xxx/adf_drv.c             |  8 +-
   sys/dev/qat/qat_hw/qat_c62x/adf_drv.c              |  8 +-
   sys/dev/qat/qat_hw/qat_dh895xcc/adf_drv.c          |  8 +-
   sys/modules/qat/qat_common/Makefile                |  1 +
   18 files changed, 325 insertions(+), 161 deletions(-)

[commit 8de50b4e29ef7496e99597ebbd64bfb6e16dc364]
Date: 2025-04-30
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: qat: update 4xxx capabilities handling
Review: The QAT driver for 4xxx series hardware updates capability handling for symmetric cryptography services. It corrects the detection of available cipher and authentication capabilities based on hardware slices, ensuring proper functionality for both PF and VF devices.
Body:

  Some capabilities were not properly fused out based on
  the hardware slices. Hence updated the function accordingly.
  Both PF and VF are changed.

  This change also streamlines capability handling for SYM service:
  - Lack of UCS slice does not mean that CIPHER capabilities are not
    available.
  - SYM capabilities should be considered disabled only if both
    AUTH and CIPHER capabilities are not present.
  - AUTH capability shouldn't disable CIPHER.

  SMX slice mask for qat_4xxx is also corrected to check for
  both SM3 and SM4 support.

  Reviewed by:	markj, ziaee
  MFC after:	2 weeks
  Sponsored by:   Intel Corporation
  Differential Revision:  https://reviews.freebsd.org/D50379

  (cherry picked from commit 4da5c15e5c84738903fd306b54b18a0aaf166d5f)


   sys/dev/qat/qat_hw/qat_4xxx/adf_4xxx_hw_data.c     | 98 +++++++++++++---------
   sys/dev/qat/qat_hw/qat_4xxx/adf_4xxx_hw_data.h     |  4 +-
   sys/dev/qat/qat_hw/qat_4xxxvf/adf_4xxxvf_hw_data.c | 89 +++++++++++++-------
   sys/dev/qat/qat_hw/qat_4xxxvf/adf_4xxxvf_hw_data.h | 14 +++-
   4 files changed, 133 insertions(+), 72 deletions(-)

[commit 82172ed4c98c4dd56b735a351bfa7174def9b9cc]
Date: 2025-04-29
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: qat: add disable safe dc mode for QAT SPR devices
Review: Adds a sysctl option dev.qat.X.disable_safe_dc_mode to allow overriding the 'History Buffer' mitigation on QAT SPR devices, which can increase decompression throughput but may risk data leaks if multiple user processes are present. The driver must be built with the QAT_DISABLE_SAFE_DC_MODE option to enable this feature.
Body:

  Build and sysctl configuration modes are introduced for QAT SPR
  devices to disable safe dc mode. A new QAT driver build option
  QAT_DISABLE_SAFE_DC_MODE is required to build the QAT driver
  with code that allows a request to be sent to FW to override the
  History Buffer mitigation. Default QAT driver builds do not
  include this QAT_DISABLE_SAFE_DC_MODE build option. Even if the
  QAT driver was built with code that allows a request to be sent to
  FW to override the History Buffer mitigation, the QAT driver must
  still be configured using sysctl to request an override of the
  History Buffer mitigation if desired. The default QAT driver
  configuration option sysctl dev.qat.X.disable_safe_dc_mode does not
  allow override of the mitigation. The new sysctl attribute
  disable_safe_dc_mode is to be set to 1 for overriding the history
  buffer mitigation. Firmware for qat_4xxx is updated for this change.
  If this mode is enabled, decompression throughput increases but may
  result in a data leak if num_user_processes is more than 1.
  This option is to be enabled only if your system is not prone to
  user data leaks.

  Reviewed by:	markj, ziaee
  MFC after:	2 weeks
  Sponsored by:   Intel Corporation
  Differential Revision:  https://reviews.freebsd.org/D50379

  (cherry picked from commit 5a8e5215cef0dac1115853889e925099f61bb5fa)


   share/man/man4/qat.4                           |  11 +++-
   sys/conf/NOTES                                 |   3 +
   sys/conf/options                               |   3 +
   sys/contrib/dev/qat/qat_4xxx.bin               | Bin 665356 -> 665356 bytes
   sys/dev/qat/include/common/adf_accel_devices.h |   8 ++-
   sys/dev/qat/include/icp_qat_fw_init_admin.h    |   7 ++-
   sys/dev/qat/qat_hw/qat_4xxx/adf_4xxx_hw_data.c |   4 ++
   sys/dev/qat/qat_hw/qat_4xxx/adf_drv.c          |  75 +++++++++++++++++++++++++
   sys/modules/qat/qat/Makefile                   |  13 ++++-
   sys/modules/qat/qat_api/Makefile               |  13 ++++-
   sys/modules/qat/qat_common/Makefile            |  13 ++++-
   sys/modules/qat/qat_hw/Makefile                |  13 ++++-
   12 files changed, 154 insertions(+), 9 deletions(-)

[commit 5c78efa63b44588d0597f7ae56a62334fe4fce13]
Date: 2025-04-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Intel Corporation
Section: undecided
Subject: qat: fix typos and formatting issues
Review: The commit only fixes typos, formatting issues, and copyright license updates in QAT driver source files. These are internal code quality improvements with no user-visible impact.
Body:

  Multiple typos are corrected across the source code.
  Formatting corrections are done to improve code quality
  and maintainability. Some files which did not have proper
  Copyright license are updated.

  Reviewed by:	markj, ziaee
  MFC after:	2 weeks
  Sponsored by:   Intel Corporation
  Differential Revision:  https://reviews.freebsd.org/D50379

  (cherry picked from commit 25f09d4a9c358c5452435d299e00c1a1bdafff87)


   sys/dev/qat/include/common/adf_uio_cleanup.h       |  3 +-
   sys/dev/qat/include/common/adf_uio_control.h       |  3 +-
   sys/dev/qat/qat/qat_ocf.c                          |  3 +-
   .../qat/qat_api/common/compression/dc_datapath.c   | 12 +----
   .../common/crypto/sym/include/lac_session.h        | 26 ++++-----
   .../qat_api/common/crypto/sym/include/lac_sym.h    | 12 ++---
   .../common/crypto/sym/include/lac_sym_alg_chain.h  |  7 +--
   .../qat_api/common/crypto/sym/include/lac_sym_cb.h |  6 +--
   .../common/crypto/sym/include/lac_sym_cipher.h     |  6 +--
   .../common/crypto/sym/include/lac_sym_hash.h       | 13 ++---
   .../common/crypto/sym/include/lac_sym_hash_defs.h  |  4 +-
   .../crypto/sym/include/lac_sym_hash_precomputes.h  |  6 +--
   .../common/crypto/sym/include/lac_sym_key.h        | 21 ++++----
   .../common/crypto/sym/include/lac_sym_partial.h    |  4 +-
   .../common/crypto/sym/include/lac_sym_qat.h        |  4 +-
   .../common/crypto/sym/include/lac_sym_qat_cipher.h |  4 +-
   .../common/crypto/sym/include/lac_sym_qat_hash.h   |  6 +--
   .../sym/include/lac_sym_qat_hash_defs_lookup.h     |  4 +-
   .../common/crypto/sym/include/lac_sym_stats.h      |  6 +--
   .../qat_api/common/crypto/sym/key/lac_sym_key.c    | 22 +++-----
   .../qat_api/common/crypto/sym/lac_sym_alg_chain.c  | 10 ++--
   .../qat/qat_api/common/crypto/sym/lac_sym_api.c    | 14 ++---
   .../qat_api/common/crypto/sym/lac_sym_auth_enc.c   |  3 +-
   sys/dev/qat/qat_api/common/crypto/sym/lac_sym_cb.c | 15 +++---
   .../qat/qat_api/common/crypto/sym/lac_sym_cipher.c |  7 ++-
   .../common/crypto/sym/lac_sym_compile_check.c      |  7 +--
   sys/dev/qat/qat_api/common/crypto/sym/lac_sym_dp.c |  7 +--
   .../qat/qat_api/common/crypto/sym/lac_sym_hash.c   |  3 +-
   .../crypto/sym/lac_sym_hash_sw_precomputes.c       |  4 +-
   .../qat/qat_api/common/crypto/sym/lac_sym_queue.c  |  4 +-
   .../qat_api/common/crypto/sym/qat/lac_sym_qat.c    |  6 +--
   .../common/crypto/sym/qat/lac_sym_qat_cipher.c     | 23 ++++----
   .../crypto/sym/qat/lac_sym_qat_hash_defs_lookup.c  |  8 +--
   sys/dev/qat/qat_api/common/ctrl/sal_crypto.c       | 22 +-------
   sys/dev/qat/qat_api/common/include/lac_common.h    |  3 +-
   sys/dev/qat/qat_api/common/include/lac_hooks.h     |  4 +-
   sys/dev/qat/qat_api/common/include/lac_mem.h       |  6 +--
   sys/dev/qat/qat_api/common/include/lac_mem_pools.h | 14 ++---
   sys/dev/qat/qat_api/common/include/lac_sal.h       | 10 ++--
   sys/dev/qat/qat_api/common/include/lac_sal_types.h |  6 +--
   .../qat/qat_api/common/include/sal_qat_cmn_msg.h   |  4 +-
   .../qat/qat_api/common/qat_comms/sal_qat_cmn_msg.c |  4 +-
   sys/dev/qat/qat_api/common/utils/lac_buffer_desc.c |  6 +--
   sys/dev/qat/qat_api/firmware/include/icp_qat_fw.h  |  7 ++-
   .../qat/qat_api/firmware/include/icp_qat_fw_comp.h | 15 ++----
   .../qat/qat_api/firmware/include/icp_qat_fw_la.h   | 10 ++--
   .../qat/qat_api/firmware/include/icp_qat_fw_mmp.h  | 14 +++--
   .../qat_api/firmware/include/icp_qat_fw_mmp_ids.h  |  5 +-
   .../qat/qat_api/firmware/include/icp_qat_fw_pke.h  |  4 +-
   sys/dev/qat/qat_api/firmware/include/icp_qat_hw.h  |  6 +--
   .../qat_api/firmware/include/icp_qat_hw_20_comp.h  |  3 +-
   sys/dev/qat/qat_api/include/cpa.h                  | 12 ++---
   sys/dev/qat/qat_api/include/cpa_dev.h              | 18 +++----
   sys/dev/qat/qat_api/include/cpa_types.h            | 12 ++---
   sys/dev/qat/qat_api/include/dc/cpa_dc.h            | 23 ++++----
   sys/dev/qat/qat_api/include/dc/cpa_dc_bp.h         | 14 ++---
   sys/dev/qat/qat_api/include/dc/cpa_dc_chain.h      | 56 +++++++++----------
   sys/dev/qat/qat_api/include/dc/cpa_dc_dp.h         | 12 ++---
   sys/dev/qat/qat_api/include/icp_buffer_desc.h      |  9 ++--
   sys/dev/qat/qat_api/include/icp_sal_user.h         |  6 +--
   sys/dev/qat/qat_api/include/lac/cpa_cy_common.h    | 12 ++---
   sys/dev/qat/qat_api/include/lac/cpa_cy_dh.h        | 12 ++---
   sys/dev/qat/qat_api/include/lac/cpa_cy_dsa.h       | 12 ++---
   sys/dev/qat/qat_api/include/lac/cpa_cy_ec.h        | 20 +++----
   sys/dev/qat/qat_api/include/lac/cpa_cy_ecdh.h      | 12 ++---
   sys/dev/qat/qat_api/include/lac/cpa_cy_ecdsa.h     | 12 ++---
   sys/dev/qat/qat_api/include/lac/cpa_cy_im.h        | 12 ++---
   sys/dev/qat/qat_api/include/lac/cpa_cy_key.h       | 12 ++---
   sys/dev/qat/qat_api/include/lac/cpa_cy_kpt.h       | 20 +++----
   sys/dev/qat/qat_api/include/lac/cpa_cy_ln.h        | 12 ++---
   sys/dev/qat/qat_api/include/lac/cpa_cy_prime.h     | 12 ++---
   sys/dev/qat/qat_api/include/lac/cpa_cy_rsa.h       | 12 ++---
   sys/dev/qat/qat_api/include/lac/cpa_cy_sym.h       | 62 ++++++++++++----------
   sys/dev/qat/qat_api/include/lac/cpa_cy_sym_dp.h    | 16 +++---
   .../qat_api/qat_direct/include/icp_accel_devices.h |  4 +-
   .../qat/qat_api/qat_direct/include/icp_adf_init.h  |  4 +-
   .../qat_kernel/src/lac_adf_interface_freebsd.c     |  6 +--
   sys/dev/qat/qat_api/qat_utils/include/qat_utils.h  |  7 ++-
   .../qat/qat_api/qat_utils/src/QatUtilsServices.c   |  4 +-
   sys/dev/qat/qat_common/qat_uclo.c                  |  1 +
   80 files changed, 385 insertions(+), 467 deletions(-)

[commit b089e31356855b7a64ac31218481b0d67b286821]
Date: 2025-06-04
Score: 5
Status: proposed(include=no,score=20)
Sponsor: Innovate UK
Section: undecided
Subject: dtrace tests: Fix nits in some test programs
Review: The commit fixes spurious test failures in DTrace test programs, which may affect test results for users running these tests.
Body:

  Otherwise these tests fail spuriously, depending on which compiler is
  installed as cc.

  MFC after:	2 weeks
  Sponsored by:	Innovate UK

  (cherry picked from commit fdaba0128c17ecb3d6e2a458bdc00a7b36a4da51)


   .../opensolaris/cmd/dtrace/test/tst/common/usdt/tst.multiprov.ksh  | 7 ++++---
   .../cmd/dtrace/test/tst/common/usdt/tst.sameprovmulti.ksh          | 5 +++--
   2 files changed, 7 insertions(+), 5 deletions(-)

[commit f3ab96aeb509c4c645e5e3ea63ec2f1002a2c070]
Date: 2025-06-05
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: gve: Fix timestamp invalidation for DQO queue formats
Review: Fixes a bug in the gve driver where TX timeout detection could incorrectly fire for cleared packets when using DQO queue formats.
Body:

  We need to invalidate timestamps when a TX queue is cleared so that the
  TX timeout detection callout does not mistakenly fire for cleared
  packets. When using DQO queue formats, timestamps are set on the pending
  packet array whose length is not the same as the length of the
  descriptor ring itself. This commit fixes logic which invalidated the
  wrong number of pending packets.

  Signed-off-by: Jasper Tran O'Leary <jtranoleary@google.com>

  Fixes:		3d2957336c7d ("gve: Add callout to detect and handle TX timeouts")
  Reviewed by:	markj
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50688

  (cherry picked from commit 46fce000843215ff3d574d1c24fc24771975973e)


   sys/dev/gve/gve_tx_dqo.c | 7 +++----
   1 file changed, 3 insertions(+), 4 deletions(-)

[commit 0d698e74fb6b188037fffb626efc050e41b5afcd]
Date: 2025-05-29
Score: 5
Status: proposed(include=no,score=20)
Sponsor: Klara, Inc.
Section: undecided
Subject: devfs: Set eofflag in devfs_readdir()
Review: The devfs_readdir() function now sets the eofflag appropriately, which prevents a potential assertion failure when INVARIANTS is enabled.
Body:

  At least vn_dir_next_dirent() checks that eofflag is set appropriately
  when INVARIANTS is enabled, so the omission here could cause an
  assertion failure.

  Reviewed by:	kib
  MFC after:	2 weeks
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50598

  (cherry picked from commit 198d2ed2d4c6c921928a9175f825d0d8345e5a46)


   sys/fs/devfs/devfs_vnops.c | 2 ++
   1 file changed, 2 insertions(+)

[commit 021eb07a8b2806f875aed20de4320cd2d2a90ab7]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Drivers.device
Subject: igc: Fix some issues in igc_neweitr()
Review: The igc driver's interrupt moderation logic is corrected, which may affect network performance and stability for users of Intel 2.5Gb Ethernet adapters.
Body:

  The justification is the same as in commit
  fb876eef219e ("e1000: Fix some issues in em_newitr()").

  Reviewed by:	kbowling
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50548

  (cherry picked from commit ef062029ceffacb6bde3a5639a2bd8c4d59ca1df)


   sys/dev/igc/if_igc.c | 40 ++++++++++++++++++++++------------------
   1 file changed, 22 insertions(+), 18 deletions(-)

[commit 7fcba358114b147026d83c6952adb7948f4a1585]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Drivers.device
Subject: igc: Initialize helper variables in igc_neweitr()
Review: Initializes helper variables in the igc driver's interrupt moderation routine to prevent potential uninitialized use.
Body:

  The justification is the same as in commit
  a5b5220b1807 ("e1000: Initialize helper variables in em_newitr()").

  Reviewed by:	kbowling
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50547

  (cherry picked from commit d6a9f49185797c6b67e517a3d83ef63436c8d4f3)


   sys/dev/igc/if_igc.c | 1 +
   1 file changed, 1 insertion(+)

[commit 0700107b4b7c7fcb858b5ed70a85d64bcb75d7cd]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Innovate UK
Section: Kernel.general
Subject: dtrace: Add compiler barriers around updates to per-CPU flags
Review: The commit adds compiler barriers to prevent memory access reordering around per-CPU DTrace flags, which could otherwise turn DTrace errors into fatal exceptions.
Body:

  Otherwise there's nothing preventing reordering of memory accesses with
  respect to these flags being set or cleared.  Since their most common
  use is to create a section in dtrace probe context where memory faults
  are intercepted by dtrace_trap(), such reordering can turn dtrace errors
  into fatal exceptions.

  MFC after:	2 weeks
  Sponsored by:	Innovate UK

  (cherry picked from commit 0440b3d2cbf83afb55209a9938b31a48912f222c)


   sys/cddl/contrib/opensolaris/uts/common/dtrace/dtrace.c |  2 ++
   sys/cddl/contrib/opensolaris/uts/common/sys/dtrace.h    | 16 +++++++++++-----
   2 files changed, 13 insertions(+), 5 deletions(-)

[commit f3ac4f027b264fa25a11c53f8a37cf9c90addd1a]
Date: 2025-06-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Innovate UK
Section: Userland.contrib
Subject: dtrace/profile: Stop storing the probe name in struct profile_probe
Review: The commit removes an unused probe name storage in the DTrace profile provider, eliminating a potential buffer overflow vulnerability when creating probes with long names. This improves security for users of man:profile[4].
Body:

  It's unused, and the naked strcpy() was susceptible to buffer overflow
  if one creates, say, a probe called "profile-2000000000ns".

  Reported by:	CHERI
  MFC after:	1 week
  Sponsored by:	Innovate UK

  (cherry picked from commit 98ef590f77392159938d2e6f9fd45bf31d10b9c1)


   sys/cddl/dev/profile/profile.c | 2 --
   1 file changed, 2 deletions(-)

[commit d22903d79b48b119388ebe5fd8c246da2237155b]
Date: 2025-05-27
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: namei: Fix cn_flags width in various places
Review: Fixes a truncation issue in cn_flags width across several filesystems and kernel components, preventing potential future problems.
Body:

  This truncation is mostly harmless today, but fix it anyway to avoid
  pain later down the road.

  Reviewed by:	olce, kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50417

  (cherry picked from commit 0d224af399a66f00a5b33e5512fc018062cabf1d)


   sys/fs/cd9660/cd9660_lookup.c | 2 +-
   sys/fs/fuse/fuse_vnops.c      | 9 ++++-----
   sys/fs/smbfs/smbfs_vnops.c    | 2 +-
   sys/fs/unionfs/union_vnops.c  | 2 +-
   sys/kern/uipc_mqueue.c        | 3 ++-
   sys/kern/vfs_cache.c          | 2 +-
   6 files changed, 10 insertions(+), 10 deletions(-)

[commit 35e91b0447f185085624ee9c5e529f35bf556184]
Date: 2025-05-27
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Drivers.device
Subject: e1000: Fix some issues in em_newitr()
Review: The e1000 driver's interrupt moderation logic is improved for better counter handling and type safety.
Body:

  - Load packet and byte counters exactly once, as they can be
    concurrently mutated.
  - Rename bytes_packets to bytes_per_packet, which seems clearer.
  - Use local variables that have the same types as the counter values,
    rather than truncating unsigned long to u32.

  Reviewed by:	kbowling
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50416

  (cherry picked from commit 731c145612dd6ffe457a562959a5c027acf13334)


   sys/dev/e1000/if_em.c | 40 ++++++++++++++++++++++------------------
   1 file changed, 22 insertions(+), 18 deletions(-)

[commit 18dac500d86f95c1a2399f2f3d94566e5a1e42c4]
Date: 2025-05-27
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Drivers.device
Subject: e1000: Initialize helper variables in em_newitr()
Review: The e1000 driver now initializes helper variables to prevent uninitialized memory use during packet handling, which could affect network stability.
Body:

  Due to races with the threaded transmit and receive paths, it's possible
  to have r/tx_bytes != 0 && r/tx_packets == 0, in which case the maximum
  byte count could be left uninitialized.  Initialize them to zero to
  handle this case.

  PR:		286819
  Reviewed by:	kbowling
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50416

  (cherry picked from commit e0267657f3965a56d877075fe3d4d41b8afb2faf)


   sys/dev/e1000/if_em.c | 1 +
   1 file changed, 1 insertion(+)

[commit 4b3ee88ea7f886ea4cd15f7838007e9cf7d3fcd5]
Date: 2025-05-08
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Klara, Inc. | The FreeBSD Foundation
Section: Userland.programs
Subject: makefs: Use gmtime() instead of localtime for timestamps
Review: The man:makefs[8] utility now uses gmtime() for timestamps in msdos filesystems, making output independent of the local timezone configuration.
Body:

  Otherwise the output file's contents will depend on the configured time
  zone.

  Reviewed by:	emaste
  MFC after:	1 month
  Sponsored by:	Klara, Inc.
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D50198

  (cherry picked from commit 018493d32ac2a637bfb9196bc80ecff89789b808)


   usr.sbin/makefs/msdos/msdosfs_vnops.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 1e3b1b09c3b3f723125ddeb414466c05afa7771d]
Date: 2025-05-08
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: Klara, Inc. | The FreeBSD Foundation
Section: Userland.programs
Subject: makefs: Make sure that directory entry order is consistent
Review: makefs now sorts directory entries when building filesystem images, ensuring consistent ordering regardless of filesystem type or build parallelism. This improves reproducibility of generated filesystem images.
Body:

  When walking a directory hierarchy (as opposed to reading an mtree),
  makefs builds up a tree of file nodes.  Within a directory, the order of
  the sibling nodes is determined by the order they're returned by
  readdir(), which isn't very reproducible (e.g., depends on filesystem,
  build parallelism).

  Add a routine which sorts entries within a directory after its contents
  have been read.  This is a bit more expensive, but I wasn't able to
  measure a significant runtime cost (and I don't think makefs has been
  optimized very much to begin with), and we avoid this cost in mtree mode
  anyway.  This fixes some sources of reproducibility problems.

  In mtree mode, for now we let the ordering of METALOG entries determine
  the ordering in the fsnode tree.  It might be worth sorting these too,
  since with parallel installworld they won't have a consistent ordering,
  and single-threaded installworld is pretty slow.

  Reviewed by:	emaste
  MFC after:	1 month
  Sponsored by:	Klara, Inc.
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D50197

  (cherry picked from commit 31c3ef95ec430d130363a664e96135eb7abebd7b)


   usr.sbin/makefs/makefs.c |  8 +++++
   usr.sbin/makefs/walk.c   | 83 ++++++++++++++++++++++++++++++------------------
   2 files changed, 60 insertions(+), 31 deletions(-)

[commit f7a5aab53f26f364def01e3006dd9ef7c90f9ab8]
Date: 2025-05-20
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: gve: Add callout to detect and handle TX timeouts
Review: The gve(4) driver now includes a timer-based mechanism to detect and handle transmit timeouts, which can prevent queues from becoming stuck and improve network reliability.
Body:

  A TX timeout occurs when the driver allocates resources on a TX queue
  for a packet to be sent, prompts the hardware to send the packet, but
  does not receive a completion for the packet within a given timeout
  period. An accumulation of TX timeouts can cause one or more queues to
  run out of space and cause the entire driver to become stuck.

  This commit adds a lockless timer service that runs periodically and
  checks queues for timed out packets. In the event we detect a timeout,
  we prompt the completion phase taskqueue to process completions. Upon
  the next inspection of the queue we still detect timed out packets, if
  the last "kick" occurred within a fixed cooldown window, we opt to
  reset the driver, even if the prior kick successfully freed timed out
  packets.

  Signed-off-by: Jasper Tran O'Leary <jtranoleary@google.com>

  Reviewed by:	markj, ziaee
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50385

  (cherry picked from commit 3d2957336c7ddaa0a29cf60cfd458c07df1f5be9)


   share/man/man4/gve.4     |  8 ++++-
   sys/dev/gve/gve.h        | 47 +++++++++++++++++++++++++++++
   sys/dev/gve/gve_main.c   | 78 ++++++++++++++++++++++++++++++++++++++++++++++--
   sys/dev/gve/gve_sysctl.c |  6 +++-
   sys/dev/gve/gve_tx.c     | 32 ++++++++++++++++++++
   sys/dev/gve/gve_tx_dqo.c | 32 +++++++++++++++++++-
   sys/dev/gve/gve_utils.c  | 43 ++++++++++++++++++++++++++
   7 files changed, 241 insertions(+), 5 deletions(-)

[commit 4e8531ec2633ea101fa29c09acf73f48cf2bcc17]
Date: 2025-05-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: gve: Use load-acquire to fetch generation bits
Review: The commit changes internal synchronization in the gve driver to use load-acquire semantics for generation bits, which is a low-level implementation detail with no direct user-visible impact.
Body:

  When running the driver using the DQO queue format, we must load the
  generation bit and check it before possibly reading the rest of the
  descriptor's fields.

  Previously, we guarded against reordering of reads using an explicit
  thread fence. This commit changes the thread fence to a load with
  acquire semantics. Because the tx and rx generation fields are in a
  bitfield, we cannot explicitly address them in an atomic load. Instead
  we load the respective containing bytes in the descriptor and mask them
  appropriately.

  Signed-off-by: Jasper Tran O'Leary <jtranoleary@google.com>

  Reviewed by:	markj
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50384

  (cherry picked from commit b044f125373e05c20ca16edfd29cccad1f4025bd)


   sys/dev/gve/gve_adminq.h |  3 ++-
   sys/dev/gve/gve_dqo.h    | 20 ++++++++++++++++----
   sys/dev/gve/gve_rx_dqo.c | 24 +++++++++++++++++-------
   sys/dev/gve/gve_tx_dqo.c | 25 +++++++++++++++++--------
   4 files changed, 52 insertions(+), 20 deletions(-)

[commit 1225d1a7c948dd1f1ef6afce231d276a8269c36e]
Date: 2025-05-20
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: capsicum: Statically initialize commonly used capability rights
Review: No functional change intended; commit is an internal refactoring with no user-visible impact.
Body:

  Rather than initializing all of these sets during boot, define a macro
  which can do so at compile-time.  This lets us get rid of the silly
  sysinit and furthermore allows the sets to live in .rodata, where they
  ought to be anyway.

  The CAP_RIGHTS_INITIALIZER2 macro can create a set out of up to two
  capsicum rights.  This could be made more general, but we currently
  don't have any use for a more abstract implementation, so just keep it
  simple for now.

  Also remove the unused cap_chflags_rights symbol.

  No functional change intended.

  Reviewed by:	olce, oshogbo, kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50420

  (cherry picked from commit 1f922483cc993e282329ffed9096f437799b630e)


   sys/kern/subr_capability.c | 153 ++++++++++++++++-----------------------------
   sys/sys/caprights.h        |  90 +++++++++++++-------------
   sys/sys/capsicum.h         |  18 ++++++
   3 files changed, 117 insertions(+), 144 deletions(-)

[commit 2060337c0937f08d9960d629eb59ce737339640c]
Date: 2025-05-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: file: Qualify pointers to capsicum rights as const
Review: The commit adds const qualifiers to capsicum rights pointers in kernel file descriptor lookup routines, which does not result in any functional or user-visible changes.
Body:

  File descriptor lookup routines typically take a set of capsicum rights
  as input to the lookup, so that the fd's rights can be atomically
  checked.  This set should be qualified with const.

  No functional change intended.

  Reviewed by:	olce, oshogbo, brooks, kib
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50419

  (cherry picked from commit 5319cb21610ad947c56fd0cd4f18ef5b58bc8db7)


   sys/kern/kern_descrip.c  | 52 +++++++++++++++++++++++++++---------------------
   sys/kern/sys_procdesc.c  |  5 +++--
   sys/kern/uipc_mqueue.c   |  5 +++--
   sys/kern/uipc_sem.c      |  6 +++---
   sys/kern/uipc_syscalls.c |  7 ++++---
   sys/kern/vfs_syscalls.c  |  5 +++--
   sys/sys/file.h           | 21 +++++++++----------
   sys/sys/filedesc.h       | 19 +++++++++---------
   sys/sys/namei.h          |  4 ++--
   sys/sys/procdesc.h       |  6 ++++--
   sys/sys/socketvar.h      |  4 ++--
   11 files changed, 74 insertions(+), 60 deletions(-)

[commit 9a20657ac79d206723f2841683fa3fa6f364b37f]
Date: 2025-06-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libarchive/test: fix build when memcpy() is a macro
Review: The commit fixes a build issue in libarchive tests when memcpy() is a macro, which is an internal build fix without user-visible impact.
Body:

  After importing the latest libarchive into FreeBSD, Shawn Webb @
  HardenedBSD noted that the test build is broken when FORTIFY_SOURCE=2
  while building the base system.  Braced initializer lists are a special
  case that need some extra fun parentheses when we're dealing with the
  preprocessor.

  While it's not a particularly common setup, the extra parentheses don't
  really hurt readability all that much so it's worth fixing for wider
  compatibility.

  This corresponds to libarchive PR #2660

  Reported by:	Shawn Webb (HardenedBSD)

  (cherry picked from commit e2a605e7ab7ff83d15b1a0b994223768169b0f1e)


   .../test/test_write_format_mtree_preset_digests.c  | 68 +++++++++++-----------
   1 file changed, 34 insertions(+), 34 deletions(-)

[commit bcaefdc4267a1ed0e4cc5a4691fa0b7e28b7e854]
Date: 2025-06-02
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: libarchive: fix duplicate entry in tests Makefile
Review: Internal test build fix with no user-visible impact.
Body:

  Reported by:	des
  MFC after:	2 weeks (together with 2e113ef82)

  (cherry picked from commit 331f2c1c46584510fa9104c86f31f44ece3838c5)


   lib/libarchive/tests/Makefile | 1 -
   1 file changed, 1 deletion(-)

[commit 47552b548d5ad4509ef342324910e748318fee77]
Date: 2025-05-20
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: usbhid.4: Add cross-references to "other USB HID drivers"
Review: The man:usbhid[4] page now includes cross-references to other USB HID drivers, improving documentation navigation.
Body:

  Reviewed by:	ziaee
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50437

  (cherry picked from commit 084046ad8f859d270a3cf900a82c5254153afcac)


   share/man/man4/usbhid.4 | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit 421d49371d33aa475099d592738ecccbd1782b0e]
Date: 2025-03-28
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.programs
Subject: mount_nfs: make temporary DNS failure non-fatal with background mode
Review: mount_nfs now treats temporary DNS resolution failures as non-fatal when background mode is used, allowing NFS mounts to retry during system boot instead of failing immediately. This addresses the 'server room boot race' problem where DNS servers may not be available at boot time.
Body:

  Typical problem with network mounts is remote equipment not being
  available when our host boots up after a power failure.  Even if you
  properly configure boot order of all local services and wait for link
  coming up on your NIC, you still may boot faster than some intermediate
  switch on the network or the DNS server itself.  Let's refer to this as a
  "server room boot race".  For NFS mounts with hostname in hosts(5) the
  race is addressed by a retry loop on NFS mount timeout.  However, a DNS
  resolution timeout is treated differently to NFS mount timeout.  We fail
  on the former and keep retrying on the latter.

  With feedback received on current@, I see that the problem is so old, that
  people got used to it and see it as a desired behavior rather than a
  problem.  And for those who is affected by the problem, they suggest
  hosts(5) as a solution.  Note that using hosts(5) isn't scalable, and
  using bare IP addresses is neither scalable, nor compatible with
  Kerberized mounts.

  A trade-off solution would be to enable the retry cycle over DNS timeouts
  only when background mode is specified, which is a typical use in fstab(5)
  and very uncommon in a command line.  That would address the server room
  boot race problem without breaking POLA for command line.

  Reviewed by:		rmacklem
  Differential Revision:	https://reviews.freebsd.org/D49145

  (cherry picked from commit 5fa093b6efcb7eb16a17d9830dbd4404bff5a565)


   sbin/mount_nfs/mount_nfs.c | 59 ++++++++++++++++++++++++++--------------------
   1 file changed, 34 insertions(+), 25 deletions(-)

[commit 8d98d889e1fcdf38488b107b7191c38f3ea662d2]
Date: 2025-03-28
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: libc/getaddrinfo(2): return EAI_AGAIN on nameserver timeout
Review: man:getaddrinfo(3) now returns EAI_AGAIN instead of EAI_ADDRFAMILY when a nameserver times out, allowing applications to distinguish temporary resolution failures from permanent ones.
Body:

  A nameserver timeout is a soft failure, future attempts may succeed.
  Returning EAI_AGAIN is crucial for API users to tell a soft name
  resolution failure from negative resolution result.

  Before the change we would return EAI_ADDRFAMILY, which I believe, is a
  regression from 144361386696, and before that revision we used to return
  EAI_NONAME in most of the cases.

  Reviewed by:		kib
  Differential Revision:	https://reviews.freebsd.org/D49411

  (cherry picked from commit d803854bccb9ea527c1769ac403e011ff0e121e5)


   lib/libc/net/getaddrinfo.c | 58 ++++++++++++++++++++++++++++++++++------------
   1 file changed, 43 insertions(+), 15 deletions(-)

[commit ca5be69fb96dac9eb005154fd0702731e5f45b08]
Date: 2025-06-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: nfsd: Fix the build for 1749465947a8
Review: The commit fixes a build breakage introduced by a previous change, but it does not introduce any new user-visible features, changes in behavior, or configuration impacts. It is an internal build fix.
Body:

  Fixes:	1749465947a8 ("nfsd: Fix accumulating nfslockfile structures")

  (cherry picked from commit 4be12de1d630383ab5e0c0f3ff48aa9f2f192ab6)


   sys/fs/nfsserver/nfs_nfsdserv.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a2408c4e976a9499358e40cc326cb1ce4bd6de7a]
Date: 2025-06-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: nfsd: Fix accumulating nfslockfile structures
Review: The NFS server no longer leaks memory when an NFSv4 client attempts an exclusive open on an existing file, which previously caused an unreferenced lock structure to accumulate.
Body:

  If a NFSv4 client does an exclusive open where the file
  already exists, the server returns EEXIST.  However,
  without this patch, a partially filled in nfslockfile
  structure is allocated, but is not referenced by any open
  and, as such, never gets freed.

  This patch fixes the bug by checking for EEXIST before
  calling nfsvno_open().

  (cherry picked from commit 1749465947a807caa53ce09b90a30b820eaab62e)


   sys/fs/nfsserver/nfs_nfsdserv.c | 28 ++++++++++++++++------------
   1 file changed, 16 insertions(+), 12 deletions(-)

[commit 26f6f73931557a2f2f298c3ae275d041412d7563]
Date: 2025-06-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: bridge: fix vlan(4) on a bridge member
Review: Fixes VLAN traffic on bridge members when net.link.bridge.member_ifaddrs=0, restoring previous behavior where VLAN-tagged frames were not passed to the host.
Body:

  If an interface is a bridge member, and a vlan(4) is also created on
  that interface, and net.link.bridge.member_ifaddrs=0, then vlan(4)
  will never see any incoming frames because bridge doesn't pass them
  to the host for processing.

  Work around this by checking for locally-addressed frames using the
  MAC address of the interface we received the frame on, but only if
  the frame has a .1q tag and there's a vlan trunk on the interface.

  This behaviour is almost certainly "wrong" and it's not clear if we
  really want to support this, but it did work in the past and the
  member_ifaddrs change was not supposed to break it, so this restores
  the previous behaviour.

  PR:	287150
  MFC after:	1 week
  Reviewed by:	kevans, des
  Approved by:	kevans (mentor), des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50623

  (cherry picked from commit a5fe142e08447c7116b89159c110d02e860ac6a1)


   sys/net/if_bridge.c             | 23 ++++++++-----------
   tests/sys/net/if_bridge_test.sh | 51 +++++++++++++++++++++++++++++++++++++++++
   2 files changed, 61 insertions(+), 13 deletions(-)

[commit 8f56270e2045ebc06671a3d1f1f054d019241ee0]
Date: 2025-06-12
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: The FreeBSD Foundation (iwlwifi)
Section: Docs.manpages
Subject: iwlwifi.4/rtw88.4/rtw89.4: adjust note about loading from loader
Review: The man:iwlwifi[4], man:rtw88[4], and man:rtw89[4] man pages are updated to clarify that loading these wireless drivers from loader(8) is not possible due to module blacklisting.
Body:

  Despite being discouraged in the man page already,  people are trying
  to load the driver(s) from loader.  Now that the drivers are on
  module_blacklist="" simply state that it is not possible.
  If someone wants anyway they can figure out how to remove it from there,
  load the driver, and loader the firmware file(s) upfront.

  Sponsored by:	The FreeBSD Foundation (iwlwifi)
  PR:		287480
  Reviewed by:	pauamma_gundo.com
  Differential Revision: https://reviews.freebsd.org/D50816

  (cherry picked from commit eb8a794662d2e694a99f927d7161b6efffdd295d)


   share/man/man4/iwlwifi.4 |  2 +-
   share/man/man4/rtw88.4   | 33 ++++-----------------------------
   share/man/man4/rtw89.4   | 27 +++------------------------
   3 files changed, 8 insertions(+), 54 deletions(-)

[commit ca8d1e4f2d4dcf6dac078760e9a50799b1dc2b7d]
Date: 2025-06-11
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: iwlwifi.4: add a note on how to bootstrap firmware files
Review: The man:iwlwifi[4] manual page now includes instructions for manually bootstrapping firmware files when no networking is available.
Body:

  In case someone ends up without any networking and no firmware files
  add short instructions on how firmware can be bootstrapped manually.
  This was prompted by PR287393 and D50777 during the 14.3-RELEASE days
  after firmware was removed from the stable/14 and only available via
  ports/package/fwget.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	ziaee, pauamma_gundo.com
  Differential Revision: https://reviews.freebsd.org/D50791

  (cherry picked from commit 458308acf38bd53bc957a4f7ebbe1f6bc4ce1bf4)


   share/man/man4/iwlwifi.4 | 13 ++++++++++++-
   1 file changed, 12 insertions(+), 1 deletion(-)

[commit 669062384f5548098bb1c70ca904574aa81a1f98]
Date: 2025-06-11
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: linuxkpi.4, linuxkpi_wlan.4: add short man pages and connect to build
Review: Adds man:linuxkpi[4] and man:linuxkpi_wlan[4] manual pages, providing brief documentation on the LinuxKPI and its 802.11 compatibility features.
Body:

  Add brief documentation on LinuxKPI.
  Add brief documentation on LinuxKPI 802.11 compat so we can refer to
  something about which features are supported.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	dumbbell, ziaee, pauamma_gundo.com
  Differential Revision: https://reviews.freebsd.org/D50790

  (cherry picked from commit bfaec3e6474139c592f39b4adbdbeb35c9026c25)
  (cherry picked from commit 1563b306d19db25f5bbf071897b60429b192040c)
  (cherry picked from commit 8b399d613f5420bb7e57be94806e156e4c1579fb)


   share/man/man4/Makefile        |   2 +
   share/man/man4/linuxkpi.4      |  42 +++++++++++++
   share/man/man4/linuxkpi_wlan.4 | 130 +++++++++++++++++++++++++++++++++++++++++
   3 files changed, 174 insertions(+)

[commit 97a52002d3de2b6715779965b58aad38974f9b44]
Date: 2025-06-11
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreBSD Foundation
Section: Docs.manpages
Subject: wlan.4: add rtw89 driver to see also
Review: The commit adds a reference to the rtw89 driver in the wlan.4 manual page, making users aware of its documentation.
Body:

  Sponsored by:	The FreBSD Foundation
  X-MFC:		no iwx.4 in stable/14 yet
  Reviewed by:	ziaee
  Differential Revision: https://reviews.freebsd.org/D50788

  (cherry picked from commit a3d38c1abf6c7987ece04c5eb27b0a48ecd88c0d)


   share/man/man4/wlan.4 | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit a22c61e954086eab0e64ed0844db3769f6c8496c]
Date: 2025-06-12
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: The FreeBSD Foundation
Section: Bootloader.general
Subject: loader.conf: add LinuxKPI based wireless drivers to module_blacklist
Review: LinuxKPI-based wireless drivers are added to the module_blacklist in loader.conf to prevent system panics when loaded during boot without firmware. Users who still need to load these drivers from loader must manually remove them from the blacklist and preload firmware files.
Body:

  Despite being discouraged in the man page people are trying to load
  the driver from loader.  In that case firmware is missing and the
  root file system is not there yet and the LinuxKPI based drivers
  will panic the system on boot.  Simply avoid any further support
  trouble by disallowing them to be loaded from loader.
  If someone still wants to do it, they will need to figure out how
  to remove them from the blocklst and how to loader the firmware
  file(s) in advance themselves.

  Sponsored by:	The FreeBSD Foundation
  PR:		287480
  Reviewed by:	imp
  Differential Revision: https://reviews.freebsd.org/D50817

  (cherry picked from commit 55efb3bf2b6edb8e1b888dc7ed52046f5b9b6591)


   stand/defaults/loader.conf | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4e50831dc9af6b1b30a41b35f0988501b89e3a5d]
Date: 2025-06-10
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: iwlwifi: add message how to install firmware on FreeBSD
Review: The iwlwifi driver now prints a message directing users to man:fwget[8] when firmware is not found.
Body:

  While it is too late for 14.3-R point people at fwget(8) to install
  firmware if the driver cannot find any.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	emaste, ziaee
  Differential Revision: https://reviews.freebsd.org/D50777

  (cherry picked from commit 8ac82ba19efbaeec065621215c3843f054fa419e)


   sys/contrib/dev/iwlwifi/iwl-drv.c | 3 +++
   1 file changed, 3 insertions(+)

[commit 9425e8051e091f6597cf6f08790eb1c375a2bf75]
Date: 2025-05-20
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: elf.5: Add NT_FREEBSD_FCTL_LA48 and NT_FREEBSD_FCTL_LA57
Review: The man:elf[5] manual page now documents the NT_FREEBSD_FCTL_LA48 and NT_FREEBSD_FCTL_LA57 note types used for controlling 48-bit and 57-bit linear address support in core dumps.
Body:

  Reviewed by:	kib
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50443

  (cherry picked from commit 059fbe9a716d5023d559424bf2ab2aa62eae6ec8)


   share/man/man5/elf.5 | 4 ++++
   1 file changed, 4 insertions(+)

[commit 056cf3be3464589c73a9c6683cd6e9cf5afff8dc]
Date: 2025-05-26
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: elf.5: Add description of .ctors and .dtors
Review: The man:elf[5] manual page now includes descriptions of the .ctors and .dtors sections, improving documentation for developers working with ELF binaries.
Body:

  Reviewed by:	kib
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50536

  (cherry picked from commit 136053f7db824b72ede67b40b0e7a393f6686a8c)


   share/man/man5/elf.5 | 16 +++++++++++++++-
   1 file changed, 15 insertions(+), 1 deletion(-)

[commit 2c2edbe9acf7f22b6ff4cdb3f9c280155c67c46e]
Date: 2025-05-16
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: elf.5: Document .init_array and .fini_array
Review: The man:elf[5] manual page now documents the .init_array and .fini_array sections and notes that .init and .fini are legacy interfaces.
Body:

  And note that .init and .fini are legacy interfaces.

  Reviewed by:	kib
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50380

  (cherry picked from commit 4eabcb77d5bbf418aa86efae6523375d28150d4d)


   share/man/man5/elf.5 | 33 ++++++++++++++++++++++++++++++---
   1 file changed, 30 insertions(+), 3 deletions(-)

[commit abd596c4e0ef8145cb15931088aaeb0c34ff13b8]
Date: 2025-05-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: release/pkg-stage: Put each package on a separate line
Review: The commit only changes formatting of a script variable to put each package on a separate line, which is an internal maintenance change with no user-visible impact.
Body:

  The list of packages included in dvd1.iso is maintained in pkg-stage.sh
  itself, and sees regular additions and deletions.  Rearrange the
  beginning and end of the variable so that each package is alone on a
  line, to make it easier to track changes.

  Reviewed by:	cperciva
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50221

  (cherry picked from commit 16d0fe1f721f63d15c741ff4c0072390aaa27e73)


   release/scripts/pkg-stage.sh | 6 ++++--
   1 file changed, 4 insertions(+), 2 deletions(-)

[commit c8c759c23e2eb0ef3a5f18d55b8671f20b442190]
Date: 2025-06-13
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: src.conf.5: Update MALLOC_PRODUCTION diag options
Review: Updates the man:src.conf.5 manual page to reflect changes in the MALLOC_PRODUCTION diagnostic options. This clarifies the available build-time memory allocator debugging controls.
Body:

  PR:		287502
  Reviewed by:	kbowling, ziaee
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50834

  (cherry picked from commit 9eb6cafe377e11d4fe8cbeb22f3cd64909a44ce9)


   share/man/man5/src.conf.5                     | 9 +++++++--
   tools/build/options/WITHOUT_MALLOC_PRODUCTION | 7 ++++++-
   tools/build/options/WITH_MALLOC_PRODUCTION    | 7 ++++++-
   3 files changed, 19 insertions(+), 4 deletions(-)

[commit 0e8890a425bc778d323566c881e26bad7c54baf2]
Date: 2024-06-03
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Kernel.general
Subject: Add a new sysctl in order to diffrentiate UEFI architectures
Review: A new sysctl, machdep.efi_arch, is added to report the UEFI architecture (e.g., 32-bit or 64-bit) used at boot. This allows users and scripts to differentiate boot modes on systems with multiple UEFI loaders.
Body:

  With the new 32-bit UEFI loader, it's convenient to have a sysctl to
  figure out how we booted. Can be accessed at machdep.efi_arch

  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1098

  (cherry picked from commit b538d4911004ca541507166b8ec9689d2e87d1aa)

  Approved by: imp (mentor)


   stand/efi/loader/bootinfo.c |  8 +++++++-
   sys/amd64/amd64/machdep.c   | 21 +++++++++++++++++++++
   sys/x86/include/metadata.h  |  1 +
   3 files changed, 29 insertions(+), 1 deletion(-)

[commit 14fc135014091e3df222f3276cfba1412b17c208]
Date: 2025-06-16
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: config.5: Bump .Dd to reflect latest update
Review: Updates the man:config[5] manual page date to reflect recent documentation changes.
Body:

  MFC with:       1bdf1b818635 ("config.5: Document CONF_CFLAGS under 'makeoptions'")
  Event:          Kitchener-Waterloo Hackathon 202506
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 956100d60fa86daebc1bd46ea62f207f6b54d93d)

  Fixed the "MFC with" tag (which is wrong in main).

  Event:          Kitchener-Waterloo Hackathon 202506


   usr.sbin/config/config.5 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit bb5a2106555d810bb6a5ec0a80584abf8154cfbd]
Date: 2025-05-27
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: config.5: Document CONF_CFLAGS under 'makeoptions'
Review: The man:config[5] manual page now documents the CONF_CFLAGS makeoption, which allows users to adjust kernel CFLAGS from the kernel configuration file for custom builds.
Body:

  This variable serves to tweak CFLAGS from the kernel configuration file,
  easing some custom kernel builds.  It was introduced by bde@ in 1999.

  The description has been kept simple on purpose.  It does not completely
  reflect reality as the build infrastructure actually appends variables
  to CFLAGS after CONF_CFLAGS has been processed in a few cases.  However,
  these cases do not collide with expected common uses of CONF_CFLAGS, so
  have not been mentioned.

  Reviewed by:    markj (older version)
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50544

  (cherry picked from commit 1bdf1b8186359d4ea26e26de03e03b7c1543b707)

  Event:          Kitchener-Waterloo Hackathon 202506


   usr.sbin/config/config.5 | 17 +++++++++++++++++
   1 file changed, 17 insertions(+)

[commit 9e185ae1d4b5c589b2cf8d940eb775520bc945ee]
Date: 2025-06-13
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: mac_do(4): Bump .Dd to reflect latest update
Review: Updates the man:mac_do[4] manual page date to reflect recent changes.
Body:

  MFC with:       94828b338033 ("mac_do(4): Examples: Fix some descriptions and a typo")
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 7747d826573a38e6caa06619f5596b792dc5a976)

  Event:          Kitchener-Waterloo Hackathon 202506


   share/man/man4/mac_do.4 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 27955ed58e1900549d9da48b3fb7d615c0470e40]
Date: 2025-06-11
Score: 5
Status: proposed(include=no,score=15)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: mac_do(4): Examples: Fix some descriptions and a typo
Review: Typographical errors and minor description fixes in man:mac_do[4].
Body:

  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 94828b33803314b5c8e833b233ca6894a340aa88)

  Event:          Kitchener-Waterloo Hackathon 202506


   share/man/man4/mac_do.4 | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit d4922e20a980de452a66b014fb56d5492c60d934]
Date: 2025-06-09
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: timeout(1) tests: atf_fail requires a reason
Review: The commit only modifies a test script comment, which has no user-visible impact.
Body:

  (cherry picked from commit 4078e0d1d6f8189bff44fcad04df256220035f76)


   bin/timeout/tests/timeout_test.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5c2e905a75996a5a2aa16631f951502b7c43cc3e]
Date: 2025-06-09
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): pass full 32bit error return code from the exited child
Review: The man:timeout[1] utility now passes the full 32-bit error return code from the exited child process, providing more detailed exit status information to the user.
Body:

  (cherry picked from commit 81ef00125056a68ca3bba1424d6cb13533bf474c)


   bin/timeout/timeout.c | 58 ++++++++++++++++++++++++++++++++-------------------
   1 file changed, 37 insertions(+), 21 deletions(-)

[commit b535341df32cccaa097da4be304b0fad2290ab43]
Date: 2025-06-08
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): only start the child command after the parent is fully set up
Review: The man:timeout[1] utility now waits for the parent process to be fully set up before starting the child command, preventing race conditions in process initialization.
Body:

  (cherry picked from commit aa8cdb7cae7b7550d5cb81d85ee294c4f182f694)


   bin/timeout/timeout.c | 17 ++++++++++++++++-
   1 file changed, 16 insertions(+), 1 deletion(-)

[commit 1adea6e97f814194d986daeaf2ae1327183a6156]
Date: 2025-06-07
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): print errno when signalling syscalls failed
Review: The man:timeout[1] utility now prints the errno value when signalling syscalls fail, providing more detailed error information to users.
Body:

  (cherry picked from commit bff05e8a8c3c64bfe6152870cb758d00991ec66b)


   bin/timeout/timeout.c | 14 ++++++++------
   1 file changed, 8 insertions(+), 6 deletions(-)

[commit c55fd0184a17d2cb56884e6e2a15e70ad503ff76]
Date: 2025-06-07
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): silence warnings for ESRCH
Review: The man:timeout[1] utility no longer prints warnings when a child process terminates with ESRCH.
Body:

  (cherry picked from commit 15e4b8d5ef845066819c4cbb5d03b63148688298)


   bin/timeout/timeout.c | 13 ++++++++++---
   1 file changed, 10 insertions(+), 3 deletions(-)

[commit 91dc8fcff09013ee44f72ee2c202466cb446afcb]
Date: 2025-04-03
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Docs.manpages
Subject: timeout(1): Document the reaper implementation and behaivor
Review: The man:timeout[1] manual page now documents the reaper implementation and behavior, providing users with details on how the utility manages child processes.
Body:

  (cherry picked from commit c362781c8d6a878ac93f3debc45d401bd5296eee)


   bin/timeout/timeout.1 | 37 +++++++++++++++++++++++++++++++++----
   1 file changed, 33 insertions(+), 4 deletions(-)

[commit 08d43f70eabf1d769c7038dec1953b1275ea690e]
Date: 2025-04-16
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: timeout(1): adapt the preserve_status test to the new behaviour
Review: The commit adapts a test for the timeout(1) utility to match new behavior, but this is a test-only change with no user-visible impact.
Body:

  (cherry picked from commit a25b03791764b7817a1a3e05ac1ab91c75a946ac)


   bin/timeout/tests/timeout_test.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit de24ba56a663c608edf8091900a49b48d088896c]
Date: 2025-04-03
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): Kill self with the same signal that terminated the child
Review: The man:timeout[1] utility now kills itself with the same signal that terminated the child process, improving consistency in signal handling.
Body:

  (cherry picked from commit 613310263ae1f0f65df498dc8e98f460b781946d)


   bin/timeout/timeout.1 | 51 ++++++++++++++++++++++++---------------------------
   bin/timeout/timeout.c | 35 +++++++++++++++++++++++++++++++++--
   2 files changed, 57 insertions(+), 29 deletions(-)

[commit 795153bda6dae27ceac4a7298106c00ca706b0ec]
Date: 2025-04-03
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): Catch all signals and propagate them
Review: The man:timeout[1] utility now catches all signals and propagates them, improving reliability when handling interruptions.
Body:

  (cherry picked from commit 844cef26e810d903e11bf83cc6f6fd2e22a299f1)


   bin/timeout/timeout.1 | 22 ++++++++++++
   bin/timeout/timeout.c | 92 +++++++++++++++++++++++++++++++--------------------
   2 files changed, 79 insertions(+), 35 deletions(-)

[commit 1fe93549714d01e16e76af0d279bd05c5a7e0c7d]
Date: 2025-04-03
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): Fix the inheritance of signal dispositions
Review: The man:timeout[1] utility now correctly inherits signal dispositions from the parent process, fixing cases where signals were not properly propagated.
Body:

  (cherry picked from commit 2390cbfe55f55916eca25e8ba94a3320535e01c9)


   bin/timeout/timeout.1 | 10 +++++++++-
   bin/timeout/timeout.c | 50 ++++++++++++++++++++++++++++++--------------------
   2 files changed, 39 insertions(+), 21 deletions(-)

[commit f358b8dc7418776592470b9f08585431ac81632e]
Date: 2025-04-03
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): Improve to show more verbose log messages
Review: The man:timeout[1] utility now logs more verbose messages when it terminates a command due to timeout, aiding in debugging and monitoring.
Body:

  (cherry picked from commit 8e1d9fe06621e22b9de6b3bf1b6164a00f0f26b5)


   bin/timeout/timeout.1 |  6 +++++-
   bin/timeout/timeout.c | 16 ++++++++++++++++
   2 files changed, 21 insertions(+), 1 deletion(-)

[commit e59571c5a78988a13eeaa473302a4029a459022f]
Date: 2025-04-03
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): Fix the handling of repeated terminating signals
Review: The man:timeout[1] utility now correctly handles repeated termination signals, preventing potential hangs when signals are sent multiple times.
Body:

  (cherry picked from commit aae3eb24dfdbbe0a9e62fe7239d6038060cd07f6)


   bin/timeout/timeout.c | 14 --------------
   1 file changed, 14 deletions(-)

[commit e76807eb2360f56a823569b9b751ee574e24aceb]
Date: 2025-04-03
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): Also send SIGCONT because the child may be stopped
Review: The man:timeout[1] utility now sends SIGCONT to a stopped child process before terminating it, ensuring that stopped processes are properly resumed and terminated.
Body:

  (cherry picked from commit 06c74693c286185f299410afcd312fc54a96a052)


   bin/timeout/timeout.c | 18 ++++++++++++++++++
   1 file changed, 18 insertions(+)

[commit 48cbc068c88f96cc19c658bd6f759496e00fcca4]
Date: 2025-04-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: timeout(1): Enhance send_sig() and prepare for later updates
Review: The commit modifies the internal implementation of the timeout utility without any user-visible changes, such as new options, behavior changes, or bug fixes affecting usage.
Body:

  (cherry picked from commit 086f17853677d072b8c5f4b2440f9e3a9aea7bdf)


   bin/timeout/timeout.c | 46 ++++++++++++++++++++++++++++++++--------------
   1 file changed, 32 insertions(+), 14 deletions(-)

[commit 865510547e2499cb536137633419f47c7e4f5dea]
Date: 2025-04-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): Add -f and -p options as per POSIX.1-2024
Review: The man:timeout[1] utility now supports the -f and -p options as specified in POSIX.1-2024, improving standards compliance.
Body:

  (cherry picked from commit 8a9927ecd4b6e8cb306e4b940201b4efbfbc5dcb)


   bin/timeout/timeout.1 |  8 ++++----
   bin/timeout/timeout.c | 35 ++++++++++++++++++++---------------
   2 files changed, 24 insertions(+), 19 deletions(-)

[commit a56833c9f72703ad6438c7236e60c2c44030c6ea]
Date: 2025-04-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: timeout(1): Handle sig_alrm and sig_term together to dedup code
Review: The man:timeout[1] utility now handles SIGALRM and SIGTERM signals together, reducing code duplication but without user-visible functional changes.
Body:

  (cherry picked from commit c5cdc13045650a9daf33dd6316ef57496e4a5dbc)


   bin/timeout/timeout.c | 37 ++++++++++++-------------------------
   1 file changed, 12 insertions(+), 25 deletions(-)

[commit 8461d567cfab1d108768f2ceb21bd0a5773d1fab]
Date: 2025-04-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: timeout(1): Multiple minor tweaks and cleanups
Review: The man:timeout(1) utility receives minor tweaks and cleanups with no user-visible changes.
Body:

  (cherry picked from commit 790e3617361a686c76276e0c2252a761726cd919)


   bin/timeout/timeout.1 |  65 ++++++++++++++------------
   bin/timeout/timeout.c | 124 +++++++++++++++++++++++++-------------------------
   2 files changed, 97 insertions(+), 92 deletions(-)

[commit 6081c375d6e6582df95c97aa79606694867c03de]
Date: 2025-04-02
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): sig_atomic_t variables must also be 'volatile'
Review: The man:timeout[1] utility now declares sig_atomic_t variables as volatile to ensure correct signal handling in all environments.
Body:

  (cherry picked from commit 92f8006e8901f876af1b97d996dd245aa2c92ec0)


   bin/timeout/timeout.c | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit d9e4b110fe919c1e96ba3bd5fdba177f03d365c5]
Date: 2025-04-02
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): Use _exit(2) instead of err() in child if exec failed
Review: The man:timeout[1] utility now uses _exit(2) instead of err(3) in the child process after a failed exec, which prevents potential duplicate error messages and ensures proper process termination.
Body:

  (cherry picked from commit 35503fe28eb51ef606cf4ae077a96b3c717199d3)


   bin/timeout/timeout.c | 12 ++++--------
   1 file changed, 4 insertions(+), 8 deletions(-)

[commit a073aed45e9d5f5b955e33301286874111df7add]
Date: 2025-04-16
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: timeout(1): fix test after improvement of error messages
Review: The commit fixes a test script after an improvement to error messages, which is an internal test-only change with no user-visible impact.
Body:

  (cherry picked from commit 672ee7eb800c43a9e29c6e38e7e9927c40cb2477)


   bin/timeout/tests/timeout_test.sh | 10 +++++-----
   1 file changed, 5 insertions(+), 5 deletions(-)

[commit b57a0597fc1adc207cd5c4298288916c65699908]
Date: 2025-04-02
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.programs
Subject: timeout(1): Improve duration parsing and error messages
Review: The man:timeout[1] utility now provides more informative error messages for invalid duration arguments and improves parsing of duration strings.
Body:

  (cherry picked from commit e7bf1e5f1d62c2e735d343c462275e7e2aaf0286)


   bin/timeout/timeout.c | 20 ++++++++++----------
   1 file changed, 10 insertions(+), 10 deletions(-)

[commit 52b047555dec4f1ac7ff603ca86378bf522d8138]
Date: 2024-01-03
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: bin/timeout: remove unreachable break after usage()
Review: The commit removes an unreachable break statement in man:timeout[1], which is an internal code cleanup with no user-visible impact.
Body:

  (cherry picked from commit 4d8d9111a4bf79c6d5b41340b47cf768f2c6d080)


   bin/timeout/timeout.c | 1 -
   1 file changed, 1 deletion(-)

[commit b748dd9ab46bf604ac79debef94c5e690a480317]
Date: 2023-12-26
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: timeout_test.sh: Fix typo
Review: Fixes a typo in a test script with no user-visible impact.
Body:

  (cherry picked from commit fd4fafa8732203a3e20f5404a65de83d37687e3a)


   bin/timeout/tests/timeout_test.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4027e17c179573c428143d3c3cb2aeef3f446b42]
Date: 2025-06-11
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: snd_hda: Patch Lenovo T420s
Review: The commit adds a patch for the Lenovo T420s to the snd_hda driver, improving audio support for this specific laptop model.
Body:

  PR:		222636
  Tested by:	vermaden@interia.pl
  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 day

  (cherry picked from commit 84e73074412719ec83143fb514625c09d27f468c)


   sys/dev/sound/pci/hda/hdaa_patches.c | 16 ++++++++++++++++
   sys/dev/sound/pci/hda/hdac.h         |  1 +
   2 files changed, 17 insertions(+)

[commit f482411563d6c9ef1dfef3e59bb9e7fe3b6b4d91]
Date: 2025-06-12
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: snd_hda: fix attaching to some AMD Radeon GPUs
Review: The snd_hda driver now attaches to some older AMD Radeon GPUs, enabling HDMI audio output where it previously failed with a 'Invalid corb size' error.
Body:

  HDMI audio did not work on my older Radeon GPU, the error message
  during attach was:

  hdac0: hdac_get_capabilities: Invalid corb size (0)

  This is fixed by calling hdac_reset() before the HDA device
  capabilities are retrieved. This solution was proposed by Andriy Gapon
  in 2010, but apparently did not solve the problem reported at the time.

  Approved by:	christos
  Differential Revision:	https://reviews.freebsd.org/D50737

  (cherry picked from commit dab9ef5448682c3c35e34d857b17ac1c23445321)


   sys/dev/sound/pci/hda/hdac.c | 1 +
   1 file changed, 1 insertion(+)

[commit f1830ad9e727f990d0124e89d9a9f7cd759d42a6]
Date: 2025-06-12
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Userland.libraries
Subject: rtld amd64: extend osrel check to enable tlsbase op on stable/14
Review: The dynamic linker on amd64 now enables the tlsbase optimization on stable/14, which may improve performance for some threaded applications.
Body:

  This is a direct commit to stable/14.

  Reported by:	Mark Millard <marklmi@yahoo.com>
  Sponsored by:	The FreeBSD Foundation


   libexec/rtld-elf/amd64/reloc.c | 6 +++++-
   1 file changed, 5 insertions(+), 1 deletion(-)

[commit d752f91d7f0aa33654f4564c732b70ef2daec0bf]
Date: 2025-05-31
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: kern_thr.c: fix typo
Review: Fixes a typo in kernel code with no user-visible impact.
Body:

  (cherry picked from commit 3556ffa6adff34ed689185ac8c68a2fc9432741a)


   sys/kern/kern_thr.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a24bbfb09f43303bfaa65c774bcbe7bdde07dddd]
Date: 2025-05-31
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: thr_new(2): check param.flags for reserved bits
Review: The thr_new(2) system call now validates that reserved bits in the param.flags field are zero, causing the call to return EINVAL if any reserved bits are set.
Body:

  (cherry picked from commit c25ddffc51a1e2c0e03fa6f168abc022955d598f)


   sys/kern/kern_thr.c | 3 +++
   1 file changed, 3 insertions(+)

[commit 49e940dbc6ce2e9a97798b0662af49a7705cb79a]
Date: 2025-05-31
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Kernel.general
Subject: amd64: Add AMD64_DISABLE_TLSBASE
Review: The commit adds a new sysctl, hw.amd64.disable_tlsbase, which allows disabling the use of the %fs base MSR for TLS on AMD64. This provides a workaround for compatibility issues with some hypervisors or debugging tools.
Body:

  (cherry picked from commit 3a94bbfdcd09c655031e2a1ae343af6292d97d5d)


   sys/amd64/amd64/sys_machdep.c | 6 ++++++
   sys/x86/include/sysarch.h     | 1 +
   2 files changed, 7 insertions(+)

[commit c9c7058c319beaaef7538833d8d3f464f71885ad]
Date: 2025-05-30
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: amd64: set PCB_TLSBASE pcb flag only for new C runtime threads
Review: The commit adjusts thread-local storage (TLS) handling for new C runtime threads on amd64, which may affect compatibility with certain threaded applications or libraries.
Body:

  (cherry picked from commit 16ce7f1a3603fce5262cf0656a01c4177c75fa50)


   sys/amd64/amd64/vm_machdep.c | 5 ++++-
   1 file changed, 4 insertions(+), 1 deletion(-)

[commit 29b1c09ab4770970f7f6497213c120e7c7a55c1f]
Date: 2025-05-30
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: thr_new.2: document THR_C_RUNTIME
Review: The man:thr_new[2] manual page now documents the THR_C_RUNTIME constant, providing users with information about this thread creation flag.
Body:

  (cherry picked from commit 6fd3288c39c493c4f252b715e8354e0d27d5ef90)


   lib/libc/sys/thr_new.2 | 9 +++++++++
   1 file changed, 9 insertions(+)

[commit ebf989f4010b537ee55e8e4680594511c73f06d8]
Date: 2025-05-30
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: thr_new: add a flag indicating that the thread is created by C runtime
Review: The commit adds an internal flag for threads created by the C runtime, which is an implementation detail with no direct user-visible impact.
Body:

  (cherry picked from commit 89ca5cddec22f5676e9f9a91c2adfdbc574c78ca)


   lib/libthr/thread/thr_create.c | 2 +-
   sys/sys/thr.h                  | 1 +
   2 files changed, 2 insertions(+), 1 deletion(-)

[commit 94285af19eaef053de3b6d77d2a4f30c6a07618c]
Date: 2025-05-30
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: cpu_machdep.9: update documentation for cpu_set_user_tls()
Review: The man:man9 page for cpu_machdep.9 is updated to document the cpu_set_user_tls() function.
Body:

  (cherry picked from commit 461afb106107f38b4af23f42f5f99470ceef0877)


   share/man/man9/cpu_machdep.9 | 11 ++++++++++-
   1 file changed, 10 insertions(+), 1 deletion(-)

[commit f89a24766cb811dba1aa74a65f70df72bc1fe00a]
Date: 2025-05-30
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: thr_new: pass params.flags to cpu_set_user_tls()
Review: The commit passes thread creation flags to cpu_set_user_tls(), which may affect thread-local storage initialization for userland threads, but the specific user-visible impact is unclear without further context.
Body:

  (cherry picked from commit 2b8b37c8f516a5955f81a6fc35c7aac01ddf4a3a)


   sys/amd64/amd64/vm_machdep.c       | 2 +-
   sys/arm/arm/vm_machdep.c           | 2 +-
   sys/arm64/arm64/vm_machdep.c       | 2 +-
   sys/arm64/linux/linux_machdep.c    | 2 +-
   sys/i386/i386/vm_machdep.c         | 2 +-
   sys/kern/kern_thr.c                | 2 +-
   sys/powerpc/powerpc/exec_machdep.c | 2 +-
   sys/riscv/riscv/vm_machdep.c       | 2 +-
   sys/sys/proc.h                     | 2 +-
   9 files changed, 9 insertions(+), 9 deletions(-)

[commit 011c1f2f06bb434aa6e8064158f5c17fd8bb2139]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Kernel.general
Subject: amd64: revert unintended changes in ia32_exception.S
Review: The commit reverts unintended changes in ia32_exception.S, which may affect 32-bit compatibility exception handling on amd64 systems.
Body:

  (cherry picked from commit 71186b6eaa070dda5229af374b584e5f65ce5fb3)


   sys/amd64/ia32/ia32_exception.S | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 88359641132766cc0a8eed283a7a704595c7c119]
Date: 2025-05-22
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.libraries
Subject: amd64: switch to amd64_set_tlsbase to set tls base
Review: The dynamic linker on amd64 now uses amd64_set_tlsbase to set the TLS base, which may affect thread-local storage handling for some applications.
Body:

  (cherry picked from commit aef025fc9b6c8b06677086a93c866ee09622f6fa)


   libexec/rtld-elf/amd64/reloc.c | 6 ++++--
   sys/x86/include/tls.h          | 2 +-
   2 files changed, 5 insertions(+), 3 deletions(-)

[commit 9bac318a7d7ad52a0acdf53b28935f749f8c1283]
Date: 2025-05-22
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.libraries
Subject: amd64: add amd64_set_tlsbase(3)
Review: Adds the amd64_set_tlsbase(3) function to set the TLS base for amd64 threads.
Body:

  (cherry picked from commit 2e7cf772a4114b78eb0ab2687d91d563de89e206)


   lib/libc/amd64/Symbol.map              |  4 +++
   lib/libc/amd64/sys/Makefile.inc        |  3 +-
   lib/libc/amd64/sys/amd64_set_tlsbase.c | 55 ++++++++++++++++++++++++++++++++++
   sys/x86/include/sysarch.h              |  1 +
   4 files changed, 62 insertions(+), 1 deletion(-)

[commit 4937026659c6b2bfad27ad5392c439048fc03b76]
Date: 2025-05-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: amd64: add ptrace PT_{GET,SET}TLSBASE requests
Review: The ptrace(2) interface on amd64 now supports PT_GETTLSBASE and PT_SETTLSBASE requests for reading and writing the TLS base register.
Body:

  (cherry picked from commit 7171e591a4c70eb4ee616e33373fd62773ad5a08)


   sys/amd64/amd64/ptrace_machdep.c | 21 +++++++++++++++++++++
   sys/x86/include/ptrace.h         |  2 ++
   2 files changed, 23 insertions(+)

[commit fa10e2fb88224b1b30abb6c94a9cf4c99ce5103f]
Date: 2025-05-22
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.libraries
Subject: amd64: add mc_tlsbase member to mcontext
Review: The amd64 mcontext structure now includes a mc_tlsbase member, affecting userland programs that inspect or manipulate thread-local storage contexts.
Body:

  (cherry picked from commit eea3e4dd9703a252509d75814049aa8da5007ebb)


   sys/amd64/amd64/exec_machdep.c | 6 ++++++
   sys/x86/include/frame.h        | 1 +
   sys/x86/include/ucontext.h     | 8 ++++++--
   3 files changed, 13 insertions(+), 2 deletions(-)

[commit b7291e0da6ff485854ba07a0f8e18fb7b60ef5ba]
Date: 2025-05-22
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: Bump __FreeBSD_version and provide P_OSREL_TLSBASE for amd64 set_tlsbase
Review: The __FreeBSD_version number is incremented, and a new macro P_OSREL_TLSBASE is defined for amd64 to support setting the TLS base address.
Body:

  (cherry picked from commit 0ec732913fceb9aae2d56c2dd667203711b76550)


   sys/sys/param.h | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit cb089f00996cdbf2e7930b4e5598fcbbd43aae53]
Date: 2025-05-20
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Kernel.general
Subject: amd64: add pcb_tlsbase
Review: The commit adds support for a per-thread TLS base address on amd64, affecting signal handling and system call interfaces. This change may be visible to users of low-level threading or signal handling libraries that rely on TLS base adjustments.
Body:

  (cherry picked from commit 68ba38dad388b566877ba79ff02ed12a53b0ff3f)


   sys/amd64/amd64/exec_machdep.c     |  6 ++++--
   sys/amd64/amd64/sys_machdep.c      | 17 ++++++++++++++++-
   sys/amd64/amd64/vm_machdep.c       |  8 ++++----
   sys/amd64/ia32/ia32_signal.c       |  1 +
   sys/amd64/include/pcb.h            |  4 +++-
   sys/amd64/linux/linux_sysvec.c     |  2 +-
   sys/amd64/linux32/linux32_sysvec.c |  7 ++++---
   sys/x86/include/sysarch.h          |  2 ++
   8 files changed, 35 insertions(+), 12 deletions(-)

[commit 0f44d9df994b398ba4591141559da6db18fff557]
Date: 2025-05-19
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Kernel.general
Subject: amd64: do not handle fs/gs bases conditionally on the selector
Review: The commit removes conditional handling of fs/gs segment bases on amd64, which may affect user-space programs that rely on segment register behavior, particularly those using thread-local storage or certain system call interfaces.
Body:

  (cherry picked from commit ddab534cd6f6557740c24ff2019642880ad8bef6)


   sys/amd64/amd64/cpu_switch.S    |  6 ------
   sys/amd64/amd64/exception.S     | 29 -----------------------------
   sys/amd64/amd64/machdep.c       |  6 ++----
   sys/amd64/ia32/ia32_exception.S |  3 +--
   4 files changed, 3 insertions(+), 41 deletions(-)

[commit 784331b56d54807cf64c79b0b60215a83ba8e653]
Date: 2025-06-12
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: bsd-family-tree: add DragonFly 6.4.1 and 6.4.2, FreeBSD 14.3
Review: The bsd-family-tree file is updated to include DragonFly 6.4.1, 6.4.2, and FreeBSD 14.3.
Body:

  MFC after:	3 days


   share/misc/bsd-family-tree | 17 ++++++++++++-----
   1 file changed, 12 insertions(+), 5 deletions(-)

[commit 6cd0117bdb2c4b90cb31f90712431fbe125d9755]
Date: 2025-06-08
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Kernel.general
Subject: exit1(): Ensure that SIGCHLD from reparented child is queued to reaper
Review: The SIGCHLD signal from a reparented child process is now queued to the reaper process, ensuring reliable signal delivery in certain process re-parenting scenarios.
Body:

  (cherry picked from commit 8dda34d0ef79d0d247b3487ae0499bdf12c9209e)


   sys/kern/kern_sig.c | 9 ++++++++-
   1 file changed, 8 insertions(+), 1 deletion(-)

[commit 2713657663e6757576951d2cbe4990f75058932c]
Date: 2025-06-09
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kern_sigsuspend: rename wchan
Review: The commit renames an internal kernel wait channel string from 'sigsuspend' to 'pause', which is an internal implementation detail with no user-visible impact.
Body:

  (cherry picked from commit 2be717b45a33b733d7a79c996897f60c8ed70735)


   sys/kern/kern_sig.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 73bddd004855bd1114931d5e44622a20e4c1a639]
Date: 2025-06-08
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: kern_sigsuspend(): style
Review: Only style changes with no user-visible impact.
Body:

  (cherry picked from commit 8226a8b588101b7540249fa208a7ea67e4523c73)


   sys/kern/kern_sig.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit df6406ca958c9d622037bf969f05b978b1d5faad]
Date: 2025-06-03
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Storage.general
Subject: pseudofs: make dup name an error instead of panic
Review: The pseudofs filesystem now returns an error instead of panicking when a duplicate name is encountered during node creation. This improves system stability by preventing kernel panics in such cases.
Body:

  (cherry picked from commit e9897199576a40360440aa4d2aa48d61c4010f11)


   sys/fs/pseudofs/pseudofs.c | 53 +++++++++++++++++++++++++++++++---------------
   1 file changed, 36 insertions(+), 17 deletions(-)

[commit 0ad45b82d7be07f1ece6130440dd54105f757d65]
Date: 2025-06-03
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: pseudofs: enhance KASSERT with more information
Review: Enhanced KASSERT debugging output in the pseudofs filesystem provides more detailed diagnostic information during kernel panics.
Body:

  (cherry picked from commit 9a139facd06e4a1159a9c2cb992d04bcf1079e7e)


   sys/fs/pseudofs/pseudofs.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 0c071c3ebdf12438fd880fa81a7fd5c93130c59d]
Date: 2025-06-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: ktrace: trace and decode thr_new() thr_param
Review: The ktrace utility now traces and decodes the thr_new() and thr_param() system calls, allowing users to monitor thread creation and parameter changes.
Body:

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 week

  (cherry picked from commit 56a4d1a4cc151cf8356704aafd2d2ec0fd009701)


   sys/kern/kern_thr.c   |  8 ++++++++
   sys/sys/ktrace.h      |  2 ++
   usr.bin/kdump/kdump.c | 21 +++++++++++++++++++++
   3 files changed, 31 insertions(+)

[commit a4babbe7ec72da7c9b097b7ba78defd41642ff15]
Date: 2025-06-04
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libsysdecode: correct regexp for thr_new flags
Review: The commit fixes a regular expression in an internal table generation script, which does not produce any user-visible changes.
Body:

  (cherry picked from commit c27f7d6b9cf6d4ab01cb3d0972726c14e0aca146)


   lib/libsysdecode/mktables | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 7dc4599cabd8e8e44a155e699ea0a85b23a06e73]
Date: 2024-02-15
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Drivers.device
Subject: net: bandaid for plugging a fw_com leak in fwip_detach()
Review: The commit adds a temporary workaround to prevent a memory leak in the firewire IP driver (if_fwip) when unloading the module, which previously caused a warning about leaked fw_com memory.
Body:

  Adding a temporary workaround for plugging a fw_com upon if_fwip unloading.

  Steps to reproduce(needs two hosts connected with firewire):

    while true; do
      ifconfig fwip0 10.0.0.5 up
      fwcontrol -r
      ping -c 10.0.0.3
      kldunload if_fwip
    done

  There's a chance that the unloading of if_fwip.ko triggers following warning:

  	Warning: memory type fw_com leaked memory on destroy (1 allocations, 64 bytes leaked).

  commit d79b6b8ec267e7eef6e07cf4245159705e24acd5 (origin/main, origin/HEAD)

  (cherry picked from commit 25a5bb7318052322190a2880e0e7ef18e06d54bd)


   sys/net/if_fwsubr.c | 1 +
   1 file changed, 1 insertion(+)

[commit 65b472e58cd516b58d8cf9d4ec4f4072e0201cbd]
Date: 2025-06-11
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: sound: Add AFMT_FLOAT to feed_volume_info_tab
Review: The commit adds AFMT_FLOAT format support to the volume feeder table, enabling volume control for floating-point audio formats in the sound subsystem.
Body:

  Fixes:		e1bbaa71d62c ("sound: Implement AFMT_FLOAT support")
  Reported by:	bz
  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 day
  Reviewed by:	bz
  Differential Revision:	https://reviews.freebsd.org/D50793

  (cherry picked from commit 4a7b8cd7057f0c37b4fc4b47b0ef3ec8402b0eb9)


   sys/dev/sound/pcm/feeder_volume.c | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit 5dbdbff46b08277e79e73c713c4706c56148ca5b]
Date: 2025-06-02
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Intel Corporation
Section: Drivers.device
Subject: ice(4): Update E830-XXV device ids
Review: The man:ice(4) driver now supports updated device IDs for E830-XXV adapters and removes a subdevice ID for a cancelled OCP 3.0 variant.
Body:

  Device ID for E830-XXV adapters was changed from 12D3
  to 12DE. Update driver accordingly and bump version
  number.

  Also remove subdevice id for E830-XXV-4 for OCP 3.0,
  which was cancelled.

  Signed-off-by: Krzysztof Galazka <krzysztof.galazka@intel.com>

  Approved by:	kbowling (mentor), erj (mentor)
  Tested by:	Gowthamkumar K S <gowtham.kumar.ks@intel.com>
  Sponsored by:   Intel Corporation
  Differential Revision:	https://reviews.freebsd.org/D50327

  (cherry picked from commit 0fed8828c95a9d2cbcb43147ff851ca6f2c21d0f)


   sys/dev/ice/ice_devids.h   |  2 +-
   sys/dev/ice/ice_drv_info.h | 25 ++++++++++---------------
   2 files changed, 11 insertions(+), 16 deletions(-)

[commit 950343a170f06a0651b725058e0669b8d03b9d24]
Date: 2025-06-01
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.wireless
Subject: net80211: fix TKIP trailer trimming w/ no rx parameters given
Review: Fixes TKIP trailer trimming for drivers like man:iwn[4] that do not provide RX status parameters, restoring correct behavior for TKIP-encrypted networks.
Body:

  Previous work made trimming the TKIP trailer an optional thing
  based on what the driver indicated it did with the received
  frame.  However, for drivers that aren't populating an RX frame
  with an rx status - notably iwn(4) - exposed this bug.

  If the driver doesn't expose any RX status then just restore
  the previous behaviour.

  This matches what was done in the CCMP code in ccmp_decap().

  Locally tested:

  * iwn(4), STA mode, CCMP + TKIP groupwise network

  Differential Revision:	https://reviews.freebsd.org/D50638
  Fixes:	731ff40069d28
  Reviewed by:	bz

  (cherry picked from commit 36fcd52c2bd5a8a4b3d584564852f417fb83e762)


   sys/net80211/ieee80211_crypto_tkip.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit f7682d82f1b7e7cef32be48f06de0a77b57fb179]
Date: 2025-06-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: ifconfig: 802.11: decode more information elements (IEs)
Review: ifconfig now decodes additional 802.11 information elements, including HE_CAPA, HE_OPER, MU_EDCA_PARAM_SET, and SUP_OP_CLASS, providing more detailed wireless network information.
Body:

  Start dealing with Element ID Extension present (IE T=255) and start
  parsing elemants from the Element ID Extension set.

  Namely (partially) decode HE_CAPA, HE_OPER, MU_EDCA_PARAM_SET,
  and as well as SUP_OP_CLASS.

  For length reasons also rename UNKNOWN_ELEMID_%d to ELEMID_%d.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	adrian
  Differential Revision: https://reviews.freebsd.org/D50678

  (cherry picked from commit a2a15732eb1db4616aa628ae8bfd4047c40dbaee)


   sbin/ifconfig/ifieee80211.c | 229 +++++++++++++++++++++++++++++++++++++++++++-
   1 file changed, 226 insertions(+), 3 deletions(-)

[commit 8925b9c8d375bbc7d89fa9d604dc0236d9751637]
Date: 2025-06-03
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: net80211: LinuxKPI: migrate HE defines to net80211, put correct values
Review: The commit migrates and corrects High Efficiency (HE) wireless definitions from LinuxKPI to net80211, improving support for Wi-Fi 6 (802.11ax) features in the wireless stack. This may affect drivers and utilities that rely on these definitions for HE operation.
Body:

  Migrate most LinuxKPI 802.11 definitions for HE IEs to net80211.
  During that process also properly define them as most of them only
  had dummy values.  Some of the definitions are sparse;  that is, only
  the bits used by drivers so far were listed and annotated with the
  standards section.

  There seems to be little point to mangle the names and have two copies
  of all these bit field definitions.  We can add "_S" (shift/mask)
  variants to those we need in net80211 (if we do).

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	adrian
  Differential Revision: https://reviews.freebsd.org/D50677

  (cherry picked from commit 2ab7cbdc346e2a174a7bee4ce44c4f78b1ca093b)


   .../linuxkpi/common/include/linux/ieee80211.h      |   4 -
   sys/compat/linuxkpi/common/include/net/cfg80211.h  | 172 +----------------
   sys/net80211/ieee80211.h                           | 209 ++++++++++++++++++++-
   3 files changed, 209 insertions(+), 176 deletions(-)

[commit 63c4cdb166a7b58fef9f0b027d7c45c853368a77]
Date: 2025-06-02
Score: 5
Status: proposed(include=no,score=20)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: net80211: LinuxKPI: migrate HE IE structs from LinuxKPI to net80211
Review: The commit migrates HE IE structures from LinuxKPI to net80211, affecting ifconfig(8) parsing of HE capabilities. It does not introduce new user-visible features or changes, but refactors internal structures for consistency.
Body:

  Take the HE IE structures as they are used by drivers and put them
  into net80211 rather than LinuxKPI.  There is little need to
  re-invent the wheel on those.  They settled for long enough.

  Do not export them by default to user space as some also overlap with
  wpa and we still do not have a clear distinction for what is available
  only in kernel and what to user space.   In our case ifconfig(8)
  is a consumer of these structs which it can setting WANT_NET80211 like
  we have done for some VHT bits before.

  Add struct net80211_he_cap which holds the IE fields but also a bool
  and is meant to be put into ic/vap/ni.  The bool will give us the same
  naming for all layers rather than having individual flags in each part
  which was highly confusing.  In theory this struct should be in
  ieee80211_var.h but that would pull things apart.

  Extend struct ieee80211_mu_edca_param_set by a union as it will help
  ifconfig(8) parsing the bk/be/vi/vo parts.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	adrian
  Differential Revision: https://reviews.freebsd.org/D50676

  (cherry picked from commit 8be200cf968f0c7f72f75c8a73d7b2bee43f935d)


   sys/compat/linuxkpi/common/include/net/cfg80211.h | 24 +-------
   sys/compat/linuxkpi/common/include/net/mac80211.h |  5 --
   sys/net80211/ieee80211.h                          | 70 +++++++++++++++++++++++
   3 files changed, 71 insertions(+), 28 deletions(-)

[commit 9c3afe71b10a000ac2c3d45c439f000bbc25f147]
Date: 2025-04-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: ifconfig: 802.11: decode RSNXE IE
Review: The man:ifconfig[8] utility now decodes the RSNXE (Robust Security Network Extension) Information Element for 802.11 wireless interfaces, providing additional security information in verbose output.
Body:

  Sponsored by:	The FreeBSD Foundation
  MFC after:	3 days
  Differential Revision: https://reviews.freebsd.org/D50675

  (cherry picked from commit 1313f1c2a35f7dbaba1b2948d2f0c4a1f4113f67)


   sbin/ifconfig/ifieee80211.c | 31 +++++++++++++++++++++++++++++++
   1 file changed, 31 insertions(+)

[commit eca9d8e7fa0839015106595911d6624997191e17]
Date: 2025-05-27
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: ifconfig: 802.11: factor out keyix printing
Review: The man:ifconfig[8] output for 802.11 key display changes: the node unicast key (PTK) now shows as 'ucast' instead of a large negative number, and key index printing is refactored.
Body:

  The node unicast key (PTK) uses a key index of (-1) and printing
  a 64k number does not look great.  Factor out printing the key
  number into a buffer and use 'ucast' for the node unicast key.
  Hope is that this will be useful for the future as well when we
  will have more/different keys possibly.

  Looks like (with -vk):
          AES-CCM 2:128-bit <xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx> rsc 0 tsc 0 rx
          AES-CCM 3:128-bit <xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx> rsc 0 tsc 0 rx
          AES-GCM ucast:128-bit <xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx> rsc 0 tsc 0 tx+rx

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	adrian
  Differential Revision: https://reviews.freebsd.org/D50555

  (cherry picked from commit 164bf9ffbe1a9fc8768b2f597fd4b32b3e406ac1)


   sbin/ifconfig/ifieee80211.c | 31 ++++++++++++++++++++++---------
   1 file changed, 22 insertions(+), 9 deletions(-)

[commit b0963bfc69b3975507143bda20df3ba13e6c230f]
Date: 2025-05-27
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: ifconfig: 802.11: print node unicast key (PTK) if available in STA mode
Review: ifconfig now prints the node unicast key (PTK) when querying key information in STA mode, which aids debugging and testing of wireless security features.
Body:

  Add a variable when querying the BSSID so we can later use it rather
  than losing the "data" buffer.

  When printing key information also query the node unicast key if in
  STA mode (the key for the BSSID).  Do not error in case we fail.
  This is helpful for debugging mostly; was also useful when testing
  GCMP support.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	adrian
  Differential Revision: https://reviews.freebsd.org/D50554

  (cherry picked from commit e277735ce05911aaee336cd61ec3a12435f46d8d)


   sbin/ifconfig/ifieee80211.c | 24 ++++++++++++++++++++----
   1 file changed, 20 insertions(+), 4 deletions(-)

[commit 39763d9916993a2a5a79e3c66c6ad3af728626b7]
Date: 2025-05-27
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: ifconfig: 802.11: also print IEEE80211_CIPHER_AES_GCM_128 information
Review: The ifconfig utility now displays IEEE80211_CIPHER_AES_GCM_128 cipher information for 802.11 wireless interfaces, providing more complete cryptographic details during network diagnostics.
Body:

  While we currently do not print the STA unicast key (PTK) we will not
  see this but it is for fullness and in preparations for follow-up
  hanges.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	adrian
  Differential Revision: https://reviews.freebsd.org/D50553

  (cherry picked from commit 54ad06cad10c3822784389b0956f92a1c7041abd)


   sbin/ifconfig/ifieee80211.c | 6 ++++++
   1 file changed, 6 insertions(+)

[commit a118aa0c307f402ce22a0411822e1d5965795cf6]
Date: 2025-06-08
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: rtw89: prevent a NULL pointer deref in rtw89_swap_chanctx()
Review: The rtw89 wireless driver now includes a NULL pointer check to prevent a crash when swapping channel contexts, improving stability for users of the 8852CE and similar hardware.
Body:

  It is currently unclear if this is a result of the driver itself already
  or the way LinuxKPI drives channels and the driver simply accepting and
  acting on things it no longer should.
  For now put the bandaid into place to make the driver work and pass
  packets.  For better resilience the check does not hurt anyway.

  The moment we enter rtw89_chanctx_ops_add() the first time,
  entity_map 0x00000001 has the lowest bit set and find_next_zero_bit()
  will return 1. As a result the driver will try to swap chanctxs and
  trip over a NULL pointer in rtw89_swap_chanctx().  See comment there
  for how to (likely) trigger it.

  Sponsored by:	The FreeBSD Foundation
  Reported by:	Axel Rau (Axel.Rau Chaos1.DE) with 8852CE

  (cherry picked from commit 3a427b8320840f1e69779efeccc5898eb2972030)


   sys/contrib/dev/rtw89/chan.c | 21 +++++++++++++++++++++
   1 file changed, 21 insertions(+)

[commit 88508506680e82c5236338a481f1ea772bb84b11]
Date: 2025-04-16
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11; update frag_threshold and rts_threshold
Review: The LinuxKPI 802.11 compatibility layer updates the fragmentation and RTS thresholds after association, which may improve wireless performance and reliability for Linux wireless drivers.
Body:

  Update threshold values once we are associated.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 6e7a6a66b239180778bb31da9fa8544bbd977cde)


   sys/compat/linuxkpi/common/src/linux_80211.c | 6 ++++++
   1 file changed, 6 insertions(+)

[commit 88d897ec1a957bb8be41e52495f9c32c56b38e96]
Date: 2025-06-05
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: fix lkpi_scan_ies_add() channel lookup
Review: The commit fixes a channel lookup issue in the LinuxKPI 802.11 compatibility layer, which may improve wireless scanning reliability for Linux driver compatibility.
Body:

  When looking up the channel we may not get a result if no flags are
  passed in as net80211 channel list setup and lookup coding requires a
  matching flag (band).  So pass in IEEE80211_CHAN_[AG] depending on band
  to increase the chances of finding a base channel and from that derive
  rates, etc.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit f1a110f1f0f2ef83758f7d0a984b14f512ea00fd)


   sys/compat/linuxkpi/common/src/linux_80211.c | 16 +++++++++++++++-
   1 file changed, 15 insertions(+), 1 deletion(-)

[commit c43bd922a7724d5fd6919e6bbd222566f7a483f1]
Date: 2025-06-05
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: stop queues during key updates
Review: The LinuxKPI 802.11 subsystem stops and restarts transmit queues during key updates to prevent packets from being passed to the driver, improving reliability for some wireless configurations.
Body:

  When beginning key updates do stop and afterwards re-enable the tx queues
  to avoid packets being passed to the driver.  This is a theoretical
  problem at this point but helps some cases.  These functions will likely
  need refinement in the future.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit db480c29879cac1afba1d887d7b8871aa4eef6db)


   sys/compat/linuxkpi/common/src/linux_80211.c | 11 +++++++++++
   1 file changed, 11 insertions(+)

[commit b2420591ff02b9ada66ff64b2d030a5198d6ea3c]
Date: 2025-06-05
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: improve queue locking
Review: The commit improves queue locking in the LinuxKPI 802.11 subsystem to prevent side effects with some drivers, but it is an internal implementation change without direct user-visible impact.
Body:

  Introduce an internal lkpi_ieee80211_wake_queues_locked() function
  that can be used from context holding the wiphy lock.
  Make linuxkpi_ieee80211_wake_queues() a wrapper with locking around
  this.

  Equally apply the wiphy lock to linuxkpi_ieee80211_wake_queue().

  In lkpi_ieee80211_wake_queues() only wakeup the driver if the queue
  is not empty;  otherwise weird sideeffects can happen with some drivers.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit bc24342d96aa816b448bec4d32b1f5e4a5793886)


   sys/compat/linuxkpi/common/src/linux_80211.c | 19 +++++++++++++++----
   1 file changed, 15 insertions(+), 4 deletions(-)

[commit 2c9d26761453793b36c2e39e4ab0d9088b6e4ae4]
Date: 2025-06-05
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: place lock asserts for key operation
Review: The commit adds lock assertions and simplifies internal locking code in the LinuxKPI 802.11 subsystem, but does not introduce any user-visible changes in behavior, features, or configuration.
Body:

  Since b8dfc3ecf7031 we hold the wiphy lock over any key updates.
  Assert that on function entry.

  Given this invariant there is no need to recheck a kay under lock now,
  as the first lookup already is under the lock, so simplify the code.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 284af342971d102702df950a2f1e5479eaabdf0b)


   sys/compat/linuxkpi/common/src/linux_80211.c | 35 +++++++++++++++-------------
   1 file changed, 19 insertions(+), 16 deletions(-)

[commit dcc99bf830b2b97bae91ca07f5daf15f30d4db14]
Date: 2025-06-05
Score: 5
Status: proposed(include=no,score=20)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: adjust logging for key handling
Review: Adjusts logging in the LinuxKPI 802.11 subsystem to include thread ID and jiffies for debugging key handling issues.
Body:

  Given there are still problems observed (at least in the Lab) adjust
  crypto key handling routines and enhance logging with td_tid, jiffies.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 80386ed954aaa33b849877e8a86918de9365a087)


   sys/compat/linuxkpi/common/src/linux_80211.c | 62 ++++++++++++++++------------
   1 file changed, 35 insertions(+), 27 deletions(-)

[commit e95893ce015e7f7b071d6a30b685fe82977f06f6]
Date: 2025-06-02
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Network.wireless
Subject: net80211: add the beginning of the extfield information elements (IE ext)
Review: The wireless networking stack now includes support for extended information elements (IE ext) from IEEE 802.11-2020 and 802.11ax-2021 standards. This enables man:ifconfig[8] to display additional AP and station details for AX-enabled networks, improving visibility and debugging.
Body:

  The original list of IEs got expanded from TLV to TLextTV.
  If the T matches 255 then we have a second list of IEs where the
  meaning of TL stays the same. That means the 1 octet extT is part
  of the length and the value starts at ie+3.

  Start populating the list with IEEE802.11-2020 and 802.11ax-2021
  values.

  They will be initially used to start decoding some of the announced IEs
  for ifconfig [-v] list (scan|sta).  That should help users with
  AX-enabled APs to see this (rather than no or UNKNOWN_ELEMID_255 and
  make debugging easier once we implement 11ax.

  Sposored by:	The FreeBSD Foundation
  Reviewed by:	adrian
  Differential Revision: https://reviews.freebsd.org/D50674

  (cherry picked from commit fa02d9fceab7d452d5b3312a89b4e7b95529edcd)


   sys/net80211/ieee80211.h | 69 ++++++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 69 insertions(+)

[commit c4c77498a34c35ac4cccf300243e236a5296b1cb]
Date: 2025-04-22
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: net80211: update IE list for 802.11-2020
Review: The net80211 subsystem updates its information element definitions to align with the IEEE 802.11-2020 standard, improving compatibility with newer wireless hardware and protocols.
Body:

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	emaste
  Differential Revision: https://reviews.freebsd.org/D50673

  (cherry picked from commit beb51893cc292f24b3284b1465a58cba4c3059d7)


   sys/net80211/ieee80211.h | 76 +++++++++++++++++++++++++++++++++++-------------
   1 file changed, 55 insertions(+), 21 deletions(-)

[commit 6b45bbba70487a9ffa0d5d2b7e3cb5b0db63d9c6]
Date: 2020-12-08
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: net80211: add more information elements (IEs) definitions
Review: The net80211 subsystem adds more information element definitions and marks some as obsolete, which reduces unknown IEs displayed in man:ifconfig[8] and other tools.
Body:

  Annotate a few which are obsolete (gone).
  Naming as usual is questionable and I contemplated using the names
  from wpa with a different prefix but then we end up with another mix.

  While updating the reference to the newer standard I haven't made
  a full pass again and I cannot say which version I used in 2020.

  The motivation for this is to get rid of unknown IEs displayed in
  ifconfig and elsewhere.

  Sponsored by:	The FreeBSD Foundation
  Fixes:		50982d26e45ba (MMIC -> MGMT_MIC)
  Reviewed by:	adrian
  Differential Revision: https://reviews.freebsd.org/D50671

  (cherry picked from commit 173bbdba8f5197f5514100846727726b0875a39a)


   sys/net80211/ieee80211.h | 130 ++++++++++++++++++++++++++++++++++++++++++++---
   1 file changed, 124 insertions(+), 6 deletions(-)

[commit 897906f49ef2e7497db295a978e5aac40e3e02aa]
Date: 2025-06-05
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: 802.11: WEP noise
Review: The commit adds proper key length checks for WEP40 and WEP104 in the LinuxKPI 802.11 compatibility layer, aligning with net80211's WEP handling. This ensures correct key validation for drivers that still support WEP, preventing potential configuration errors.
Body:

  While we decided that we will not provide WEP support for the LinuxKPI
  802.11 compat code, some of it is in there already (also because drivers
  still support it).  Put proper keylen checks in place as net80211 only
  knows about WEP while LinuxKPI has WEP40 and WEP104.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit aaee0ed3d163a1d29ea74d7e4d2c3658a51cfb27)


   sys/compat/linuxkpi/common/src/linux_80211.c | 9 +++++++--
   1 file changed, 7 insertions(+), 2 deletions(-)

[commit e7a49e39d261b3cfd3549405cce16865ad89d7d2]
Date: 2025-04-22
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Network.wireless
Subject: LinuxKPI: 802.11: add support for GCMP hw crypto offload
Review: The LinuxKPI 802.11 stack now supports hardware crypto offload for GCMP (AES-GCM-128) for drivers like iwlwifi, rtw88, and rtw89, enabling improved performance for GCMP-encrypted Wi-Fi connections.
Body:

  For iwlwifi, rtw88, and rtw89 we can treat GCMP the same way as we
  treat CCMP which allows us to re-use the CCMP code for now.
  Add the missing case statements and factor out some common code.

  Allow IEEE80211_CRYPTO_AES_GCM_128 through our filter of supported
  cipher suites to announce it to net80211.

  Sponsored by;	The FreeBSD Foundation

  (cherry picked from commit 29ddd583693aced69be48b545e1c7e7249bdfb9c)


   sys/compat/linuxkpi/common/src/linux_80211.c | 23 ++++++++++++++---------
   1 file changed, 14 insertions(+), 9 deletions(-)

[commit 5d1d86b3dd4dfc48d14c5af74270a97a26d71a95]
Date: 2025-05-27
Score: 5
Status: proposed(include=no,score=35)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: make synching from HT more resilient
Review: The LinuxKPI 802.11 subsystem now more gracefully handles a rare case where HT capabilities are incorrectly reported, preventing potential issues with wireless connectivity.
Body:

  During testing I hit a case where htcap->mcs.rx_mask[0,1] were zero.
  This should not happen as that would mean we are not supporting HT.
  After adding extra caution for debugging I could no longer reproduce
  the case.

  So just to deal with the eventuality make synching from HT more
  resilient by checking that we have nss > 0 or otherwise disable
  HT operations.

  Move setting the bandwidth below this check to not alter it in
  case of the now early return.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 58dae28f665b32650f452730378693de40e96d68)


   sys/compat/linuxkpi/common/src/linux_80211.c | 20 ++++++++++++--------
   1 file changed, 12 insertions(+), 8 deletions(-)

[commit 2888dc2e5d781de3ea17f4598e247ab0673096da]
Date: 2025-06-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: update HE structures
Review: LinuxKPI 802.11 structures are updated to support 802.11ax (HE) wireless standards, improving compatibility with Linux wireless drivers.
Body:

  Update strutures needed for 11ax (HE) to be correct.  Add references
  to the standard.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 71f854e5a01a347174d09d594b3d490f806cf850)


   sys/compat/linuxkpi/common/include/net/cfg80211.h | 28 ++++++++++++++---------
   1 file changed, 17 insertions(+), 11 deletions(-)

[commit e7d1282ccacd99c1e0eb9eb538c823d2aa21f2fd]
Date: 2025-05-26
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: 802.11: add ieee80211_purge_tx_queue()
Review: Adds a dummy function needed for rtw88 SDIO driver support.
Body:

  Add ieee80211_purge_tx_queue() dummy function needed by rtw88 SDIO.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 9cac7351868d0e896a648ffe354b001ced55acfa)


   sys/compat/linuxkpi/common/include/net/mac80211.h | 9 ++++++++-
   1 file changed, 8 insertions(+), 1 deletion(-)

[commit ec4021380ce71c1845e37c0480a805fbf136efdd]
Date: 2024-07-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: skbuff: add dummy skb_copy_header()
Review: A dummy function is added to the LinuxKPI compatibility layer for future use; there is no immediate user-visible impact.
Body:

  There's one case which needs skb_copy_header();  add a dummy function
  for now until we get to the code which uses it to test an implementation.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 84c5998ccb0b3e8a401d1f2b5a32649e88847d63)


   sys/compat/linuxkpi/common/include/linux/skbuff.h | 7 +++++++
   1 file changed, 7 insertions(+)

[commit e4d034ed0bcd5d5a8104ffe92ae422c01123e7cb]
Date: 2025-05-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: use macros for locking
Review: The commit changes internal locking macros in the LinuxKPI subsystem without affecting user-visible behavior, configuration, or functionality.
Body:

  Rather than using inline functions use macros so we know where we are
  taking the lock in the code rather than only recording the inline
  function location.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit d87ee937ed852cd22eac808bc8fcf7b0e34c9ec1)


   sys/compat/linuxkpi/common/include/net/cfg80211.h | 17 ++++-------------
   1 file changed, 4 insertions(+), 13 deletions(-)

[commit 87cb97dcdef3f2f271d5fcad6a1155408f0b4a97]
Date: 2025-05-14
Score: 5
Status: proposed(include=no,score=25)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: move rx_nss check to be at least 1 into sync function
Review: The LinuxKPI 802.11 subsystem ensures the receive spatial streams (rx_nss) value is at least 1, preventing potential driver issues.
Body:

  We set rx_nss to at least 1 and the sync functions for HT and VHT are
  careful not to set it to 0.   Rather than relying on that and any
  possible future call to lkpi_sta_sync_from_ni() migrate the MAX()
  call into the sync function after each standard level went through
  to make sure that at the end we at least have rx_nss set to 1.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 34c150cc5fdb3c599bb6ff14eb56afee00c45258)


   sys/compat/linuxkpi/common/src/linux_80211.c | 8 +++++++-
   1 file changed, 7 insertions(+), 1 deletion(-)

[commit a6b0e518170f4f61a0fac6fd6e932c401fbc4605]
Date: 2025-05-10
Score: 5
Status: proposed(include=no,score=30)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: netdev features style, annotate, and add %b decoding mask
Review: The commit adds bit definitions for netdevice features for use with printf(9) %b decoding, improving readability in LinuxKPI 802.11 code.
Body:

  Start to sort through the netdevice features to match them with
  FreeBSD.  Annotate them a bit more verbose though the names are
  pretty telling already.

  While here adjust style(9) as well.

  Lastly add the bit definitions for use with printf(9) %b as names
  read easier than bitmasks.  We will use that in LinuxKPI 802.11.

  No functional changes.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 4b6b9c1368b346f7093153d14e7931403ac3202d)


   .../common/include/linux/netdev_features.h         | 24 +++++++++++++---------
   1 file changed, 14 insertions(+), 10 deletions(-)

[commit bba50bee339b8665ff11bec9ae8e8f06907d4a35]
Date: 2025-05-10
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: skbuff: make csum_unfold return __wsum
Review: The commit adjusts an internal type in the LinuxKPI compatibility layer without any user-visible impact.
Body:

  Given the internal field now stores a __wsum csum (after we added
  the type) also make sure csum_unfold() returns a __wsum.

  Sponsored by:	The FreeBSD Foundation
  Fixes:		59481c7db234

  (cherry picked from commit 36ca21722c2700e00e41444a29aeabf246eea90d)


   sys/compat/linuxkpi/common/include/linux/skbuff.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 24d7e316092cba9ea284aad38f45e4bd22a7e2c1]
Date: 2025-04-30
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: switch to m_get3()
Review: The LinuxKPI 802.11 subsystem now uses m_get3() to support frames up to 11K, preventing potential failures with large frames in wireless drivers like rtwn(4).
Body:

  Start using m_get3() instead of m_get2() as we may get up to 11K
  frames and m_get2() only gives us up to MJUMPAGESIZE (8K).

  Sponsored by:	The FreeBSD Foundation
  Discovered by:	adrian with rtwn(4) [see D50049].

  (cherry picked from commit 02382a0ac822b88e17d86643e27964eba18479e0)


   sys/compat/linuxkpi/common/src/linux_80211.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5c6453c588e8e1bad37d7dc5ad1cdb7e04576814]
Date: 2025-04-23
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: ensure bandwidth <= channel bandwidth
Review: The LinuxKPI 802.11 subsystem now ensures the station bandwidth does not exceed the channel bandwidth, preventing potential issues when VHT160 is disabled or unsupported by the AP.
Body:

  While we could select our own channel width and station bandwidth
  indepedent of net80211 that is not a good idea and will lead to
  trouble.  Make sure the station bandwidth we select does not
  exceed the bandwidth of the channel we are tuned into.

  Now that VHT160 work we may locally disable it (-vht160) and the
  AP may still support it but we would be on a 80Mhz channel.
  Or we do support VHT160 but the AP does not.  Again we would be
  on a 80Mhz channel and not support 160Mhz.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 9df0d1f3d1f3dd8823800210dd49e40170d5abd8)


   sys/compat/linuxkpi/common/src/linux_80211.c | 26 +++++++++++++++++++++++---
   1 file changed, 23 insertions(+), 3 deletions(-)

[commit 3e4a3e161c00273303cd9fa9e0dc09ead3499a8a]
Date: 2025-05-27
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Userland.contrib
Subject: Tag zfs-2.2.8
Review: OpenZFS updated to version 2.2.8.
Body:

  META file and changelog updated.

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>


   META | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 21ad6444c77e45c0098d6b9303b7157678e8f37d]
Date: 2025-06-10
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ZTS: Enable io_uring on CentOS Stream 9 and 10 also
Review: The commit enables io_uring testing for CentOS Stream 9 and 10 in ZFS test suite automation, which is an internal testing change without direct user impact.
Body:

  The io_uring interface is available as a Technology Preview.
  Details: https://access.redhat.com/solutions/4723221

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes #17447

   .github/workflows/scripts/qemu-6-tests.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit b53120be165637066b06203f246364a128041a2f]
Date: 2025-06-03
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: if_bridge.4: clarify how if_bridge assigns a MAC address
Review: The man:bridge[4] page now clarifies how the bridge interface assigns a MAC address, improving documentation for users configuring network bridges.
Body:

  PR:		283400
  MFC after:	1 week

  (cherry picked from commit 08bc0097734824ff436769a95569e32575b51da3)


   share/man/man4/bridge.4 | 10 ++++++----
   1 file changed, 6 insertions(+), 4 deletions(-)

[commit 7c05f298cdcc53fa60a2fa85b24713bf7b095d62]
Date: 2025-06-04
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: pseudofs: fix typo in comment
Review: Typo fix in comment only; no user-visible impact.
Body:

  (cherry picked from commit b63f298b1ff90d9c25dee09df7fdd0e509185587)


   sys/fs/pseudofs/pseudofs.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6f6ca5288060110c7385b9424e4729b192ed6308]
Date: 2025-06-06
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Network.general
Subject: pf: fix panic in pf_return()
Review: The panic in man:pf[4] when undoing NAT transformations is fixed, preventing system crashes under specific packet handling conditions.
Body:

  We (correctly) NULL out sk and nk before calling pf_return(), but that
  function still tried to use them to undo NAT transformations.

  Store the old port numbers and use those rather than sk/nk.

  This is a partial import of e11dacbf8484adc7bbb61b20fee3ab8385745925
  (osport/odport), and the missing parts of
  bdea9cbcf2decafeb4da5a0280313efccc09e1b3.

  Direct commit to stable/14.

  PR:		287254


   sys/net/pfvar.h     |  6 ++++--
   sys/netpfil/pf/pf.c | 31 ++++++++++++++++---------------
   2 files changed, 20 insertions(+), 17 deletions(-)

[commit b608b95247748b6b19124ca37e61c091cd852685]
Date: 2025-06-05
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Linux build: silence objtool warnings
Review: The commit silences objtool warnings in the Linux kernel module build, which is an internal build fix with no user-visible impact.
Body:

  After #17401 the Linux build produces some stack related warnings.

  Silence them with the `STACK_FRAME_NON_STANDARD` macro.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Signed-off-by: Attila Flp <attila@fueloep.org>
  Co-authored-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #17410

   config/kernel-objtool.m4                       | 19 +++++++++++++++++++
   include/sys/frame.h                            |  8 ++++++++
   module/icp/asm-x86_64/modes/aesni-gcm-x86_64.S | 17 +++++++++++++++++
   module/icp/asm-x86_64/sha2/sha256-x86_64.S     | 17 +++++++++++++++++
   module/icp/asm-x86_64/sha2/sha512-x86_64.S     | 13 +++++++++++++
   5 files changed, 74 insertions(+)

[commit 730405499ecb63f84b0f0aa9a866dbfd1250e75b]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Kernel.general
Subject: PT_CONTINUE: undo transparent attach consequences
Review: The ptrace(2) PT_CONTINUE operation no longer leaves the target process in a state that can cause unexpected behavior after a transparent attach.
Body:

  PR:	287050

  (cherry picked from commit 99976934274de6fa19f049a0b6eac10856710f96)


   sys/kern/sys_process.c | 22 ++++++++++++++++++++++
   1 file changed, 22 insertions(+)

[commit 5e4d56259e9f1d18a3c65fadd2ff7c6ca03d962a]
Date: 2025-05-28
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: PT_CONTINUE: if pc is set, mark the thread state as modified by user
Review: The commit adds a check to mark thread state as modified by user when pc is set, which may affect debugging and process control interfaces.
Body:

  (cherry picked from commit def0c056d3380b91ca7422d0a8727c6a4c8f6dae)


   sys/kern/sys_process.c | 1 +
   1 file changed, 1 insertion(+)

[commit 84074e207ee30928b304d918a46a1150a44a021a]
Date: 2025-05-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kern_sig.c: make pt_attach_transparent global
Review: The pt_attach_transparent variable is made global, which is an internal kernel change with no direct user-visible impact.
Body:

  (cherry picked from commit b57eb80596651c1f5972f3b6cd21ef95cc95ac85)


   sys/kern/kern_sig.c | 2 +-
   sys/sys/signalvar.h | 1 +
   2 files changed, 2 insertions(+), 1 deletion(-)

[commit 6573b7db71438f852fb80f10b3f5539f596f23f8]
Date: 2025-05-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: add struct_group_tagged()
Review: The commit adds a new macro struct_group_tagged() to the LinuxKPI subsystem, which may affect compatibility with Linux kernel modules. However, the change is primarily an internal refactoring and addition of a macro for structure grouping, with no clear user-visible impact such as new features, behavior changes, or configuration updates.
Body:

  Restructure struct_group() into a wrapper around __struct_group().
  Various callers have arguments annotated as /* no foo */ so try to
  add all we can find.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	dumbbell
  Differential Revision: https://reviews.freebsd.org/D50157

  (cherry picked from commit 54d0e1772fb6b83d72725764e0a5d3ead8337673)


   sys/compat/linuxkpi/common/include/linux/stddef.h | 26 ++++++++++++++++++-----
   1 file changed, 21 insertions(+), 5 deletions(-)

[commit 0a2e5ab96a7da51690f38d962305214e2973989d]
Date: 2025-05-24
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: net80211: make sure to not start a BGSCAN if not enabled
Review: The wireless scanning subsystem now properly checks for driver support before initiating background scans, preventing scanning issues on drivers that do not support IEEE80211_C_BGSCAN.
Body:

  On drivers not supporting background scanning (not having announced
  IEEE80211_C_BGSCAN) we repeatedly have seen scanning issues and
  BGSCAN was "on" according to, e.g., ddb show com /a.

  Turns out there are multiple problems:
  (a) the ioctl scanreq code can pass IEEE80211_[IOC_]SCAN_BGSCAN in
      (ifconfig wlanX scan will do so by default).  That flag ends up
      on flags in the scanning code which have no other checks, and
      we are doing a BGSCAN.
      So make sure BGSCAN is announced by the driver and enabled
      (and it's STA mode for the full check) or filter the BGSCAN out.

  (b) ieee80211_bg_scan() never checked if background scanning was
      available/enabled.  Do so now.

  (c) ieee80211_swscan_start_scan_locked() as a consequence of (a) would
      start the BGSCAN unconditionally.  Also check for BGSCAN to be
      available/enabled here.

  Lastly, we should no longer reach ieee80211_swscan_bg_scan() without
  background scanning being available/enabled, so document that fact
  by placing a KASSERT.  That will also help in case future changes
  will open a new hole or there are further which I have not noticed.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	adrian
  Differential Revision: https://reviews.freebsd.org/D50513

  (cherry picked from commit 32af70fae827ecab34e995b49ea7656ea6e70608)


   sys/net80211/ieee80211_ioctl.c   | 12 ++++++++++++
   sys/net80211/ieee80211_scan.c    | 13 +++++++++++++
   sys/net80211/ieee80211_scan_sw.c |  8 +++++++-
   3 files changed, 32 insertions(+), 1 deletion(-)

[commit c8b89c058f6dbc11ad7d839868dbe30d06e34b2f]
Date: 2025-05-27
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: ifconfig: 802.11: fix a warning message
Review: The commit fixes a typo in an 802.11 warning message in man:ifconfig[8], changing 'can' to 'cannot'. This correction clarifies the error message for users.
Body:

  s/can/cannot/

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	emaste
  Differential Revision: https://reviews.freebsd.org/D50552

  (cherry picked from commit 08471a76e3d27ffa9e2605dab0ff3c4968e7fef6)


   sbin/ifconfig/ifieee80211.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 5f8831f2fe50a0e2a8b04f1cbfe70c72027ddec9]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Userland.contrib
Subject: caroot: Update certdata URL for GitHub switch
Review: Updates the source URL for Mozilla's certificate data to reflect its migration to GitHub, ensuring that the certificate bundle can be fetched from the new location.
Body:

  Mozilla has migrated its projects' source code to GitHub, update certdata URL
  along with it.

  Reference: https://github.com/curl/curl/pull/17321

  Reviewed by:	jrm (mentor), otis (mentor), kevans
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50575

  (cherry picked from commit 87c46facc3cf1744c30ecc9f63c10a778a1af104)


   secure/caroot/Makefile | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 0344bfb6096103209f485503f8cc541d264e1f3e]
Date: 2024-04-17
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: Enable L1SS handling on RPI4 pcib
Review: The commit enables L1SS handling on Raspberry Pi 4 PCIe bridges, which resolves Serrors with many PCIe add-in cards that lack clreq# pin connections.
Body:

  Thanks to @kevans91 for pointing me in the right direction. FreeBSD had
  the same bug as Linux (see
  https://bugzilla.kernel.org/show_bug.cgi?id=217276) where the ultimate
  solution was to honor the brcm,enable-l1ss FDT property.

  In current versions of the dtb files this property has been added by
  default.

  Without this on many, many pcie addin cards the pcib will Serror when
  trying to assert the clreq# pin on the pcie bus. Many cards do not have
  these hooked up.

  PR:		260131, 277638, 277605
  Reviewed-by:	emaste
  Signed-off-by: HP van Braam <hp@tmm.cx>
  Pull-request: https://github.com/freebsd/freebsd-src/pull/1179
  (cherry picked from commit 10e0c34bf842885b4bd78adbbdbd7fb00f133cb5)


   sys/arm/broadcom/bcm2835/bcm2838_pci.c | 22 ++++++++++++++++++----
   1 file changed, 18 insertions(+), 4 deletions(-)

[commit 22bf043892879a9334217589072e500d6b054e4c]
Date: 2025-02-20
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.config
Subject: vt: add US International keymap
Review: The US International keyboard layout is now available in the vt console, using dead keys to generate diacritics such as accents, cedillas, and umlauts.
Body:

  This adds support for the US International keyboard layout to vt. It
  uses dead keys to generate diacritics such as accents, cedillas and
  umlauts.

  PR:             72465
  Co-authored-by: Helge Oldach <freebsd@oldach.net>
  Reviewed-by:    Serjei Mikailov <serjeimikailov19@proton.me>
  Reviewed-by:    Warner Losh <imp@FreeBSD.org>
  MFC-after:      2 weeks
  Pull-Request: https://github.com/freebsd/freebsd-src/pull/1601
  (cherry picked from commit a049678039e40bdf523230852f78887a12435def)


   share/vt/keymaps/INDEX.keymaps   |   7 ++
   share/vt/keymaps/us.intl.acc.kbd | 141 +++++++++++++++++++++++++++++++++++++++
   2 files changed, 148 insertions(+)

[commit d0ea4c617b18b20ead4e15adff16a4adee60aef6]
Date: 2025-05-31
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: linux/zvol_os: don't try to set disk ops if alloc fails
Review: The commit fixes a potential kernel crash in the ZFS on Linux compatibility layer when memory allocation fails, preventing a null pointer dereference. This improves system stability under low-memory conditions.
Body:

  If the kernel fails to allocate the gendisk, zvo_disk will be NULL, and
  derefencing it will explode. So don't do that.

  Sponsored-by: Klara, Inc.
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Signed-off-by: Rob Norris <rob.norris@klarasystems.com>
  Closes #17396

   module/os/linux/zfs/zvol_os.c | 6 ++++--
   1 file changed, 4 insertions(+), 2 deletions(-)

[commit f336a04960b608d2caeaf964663c3a8425f31d71]
Date: 2025-04-08
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: ure.4: add a HARDWARE section + add RTL8156BG as a compatible controller
Review: The man:ure[4] page now includes a HARDWARE section and lists the RTL8156BG controller as compatible. It also standardizes the spelling of "Realtek".
Body:

  While here, rename all instances of "RealTek" to "Realtek" for
  authenticity.

  Reviewed by: imp, lwshu, zaiee
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1649

  (cherry picked from commit 76ed6f2db316bf2240d36d3c92316da4d1e5b174)


   share/man/man4/ure.4 | 30 ++++++++++++++++--------------
   1 file changed, 16 insertions(+), 14 deletions(-)

[commit b529a06d1db4bb27895465ba8692d6c4427e32d8]
Date: 2024-08-14
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: ure.4: description consistencies + tag spdx
Review: The commit updates the man:ure[4] manual page to improve description consistency, mention newly added adapters, and reference related drivers.
Body:

  + consistent document description languague with other USB-BaseT drivers
  + mention newly added adapters from 6ea4d9
  + attempt to mention rgephy(4) phys feed into ure interfaces

  Fixes:		6ea4d9 (Move RTL8156 from cdce(4) to ure(4))
  MFC after:	3 days

  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1384

  (cherry picked from commit 4c72525953fdf618a3fc0a45f3ef3f071dcc0c52)


   share/man/man4/ure.4 | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 827153d21219f76cf006d50af4cdf85f22b75de0]
Date: 2025-04-13
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: puc.4: Add a HARDWARE section based off device data from pucdata.c
Review: The man: puc[4] manual page now includes a HARDWARE section listing supported devices, improving documentation for users of the puc driver.
Body:

  While here, change applicable uses of "ports" to "adapters" to be more
  precise and improve searchability.

  This is a 14.3 candate since it affects (positively) the release notes
  generated from the hardware secionts.

  MFC After: 3 days
  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1663

  (cherry picked from commit 794ee43e75066bfcbc00545b5bf600b9cda2d5f1)


   share/man/man4/puc.4 | 551 ++++++++++++++++++++++++++++++++++++++++++++++++++-
   1 file changed, 549 insertions(+), 2 deletions(-)

[commit ae08f93663462b4b557806bda8c5446d39a0345f]
Date: 2025-05-16
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: Intel Corporation
Section: Hardware.virtualization
Subject: ppt: Fix panic when configuring unavailable MSI-X vector
Review: The PPT driver now returns an error when a VM requests setup for more MSI-X vectors than available, preventing a panic observed with SR-IOV on Intel E810 Ethernet adapters.
Body:

  In some cases VM may have different idea about number
  of available MSI-X vectors then PPT driver. Return
  an error when VM requests setup for more vectors
  than expected.

  It was observed while using SR-IOV on an Intel E810 Ethernet adapter.
  VF driver in a VM sees a correct number of available MSI-X vectors,
  which depends on num-queues assigned in iovctl.conf, while
  pci_msix_count in the PPT driver always returns 1.

  Signed-off-by: Krzysztof Galazka <kgalazka@FreeBSD.org>
  Reviewed By:	#bhyve, jhb
  Approved by:	erj (mentor), kbowling (mentor)
  Sponsored by:	Intel Corporation
  Differential Revision:	https://reviews.freebsd.org/D48812

  (cherry picked from commit 413197cef9ccbf22831eb914c2ef469880468d97)


   sys/amd64/vmm/io/ppt.c | 3 +++
   1 file changed, 3 insertions(+)

[commit 5317335a9ac0fcaf7fd4eba2dc9859a2b2350b9a]
Date: 2025-05-31
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: cxgb(4): Fix two typos in a source code comment
Review: Only fixes typos in a source code comment, no user-visible impact.
Body:

  - s/cotaining/containing/

  (cherry picked from commit e86d9dd6cee18b035a34d54dbab93fc1ad6b527e)


   sys/dev/cxgb/cxgb_sge.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 831c4e51886eadec6fc394f722ce781220bae529]
Date: 2025-05-31
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: syscons(4): Fix a typo in a source code comment
Review: Fixes a typo in a source code comment only; no user-visible impact.
Body:

  - s/contants/constants/

  (cherry picked from commit 62b3bac1a280e765f86901926c9e8d5f5b431bff)


   sys/dev/syscons/syscons.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 9b09a560d8fa61df9ba42b56314e4b5ce8666332]
Date: 2025-05-31
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: ipsec(4): Fix a typo in a source code comment
Review: Only a typo fix in a source code comment; no user-visible impact.
Body:

  - s/limitiation/limitation/

  (cherry picked from commit 56a9d245eb16e774fece0334fcf0761058d59a0c)


   sys/netipsec/ipsec.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit beae50a72396e26e0caab50ade2d6c2ec6ca38eb]
Date: 2025-05-25
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.programs
Subject: fsck_ffs: change struct bufarea member b_index type to uint64_t
Review: The fsck_ffs utility now supports larger filesystem indices by changing an internal type to uint64_t, which may affect handling of very large filesystems.
Body:

  (cherry picked from commit e36f069ecb478b9775b7ad717768d011251d479e)


   sbin/fsck_ffs/fsck.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 4ee13684b921627e075dc1d6171ab1848a468fda]
Date: 2025-04-30
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Storage.general
Subject: cred: properly pass and test creds on other threads (#17273)
Review: The commit fixes credential handling in ZFS for operations that run on separate kernel threads, ensuring proper permission checks for tasks like snapshots. This prevents potential security issues where permissions might not be correctly enforced.
Body:

  Various admin operations will be invoked by some userspace task, but the
  work will be done on a separate kernel thread at a later time. Snapshots
  are an example, which are triggered through zfs_ioc_snapshot() ->
  dsl_dataset_snapshot(), but the actual work is from a task dispatched to
  dp_sync_taskq.

  Many such tasks end up in dsl_enforce_ds_ss_limits(), where various
  limits and permissions are enforced. Among other things, it is necessary
  to ensure that the invoking task (that is, the user) has permission to
  do things. We can't simply check if the running task has permission; it
  is a privileged kernel thread, which can do anything.

  However, in the general case it's not safe to simply query the task for
  its permissions at the check time, as the task may not exist any more,
  or its permissions may have changed since it was first invoked. So
  instead, we capture the permissions by saving CRED() in the user task,
  and then using it for the check through the secpolicy_* functions.

  The current code calls CRED() to get the credential, which gets a
  pointer to the cred_t inside the current task and passes it to the
  worker task. However, it doesn't take a reference to the cred_t, and so
  expects that it won't change, and that the task continues to exist. In
  practice that is always the case, because we don't let the calling task
  return from the kernel until the work is done.

  For Linux, we also take a reference to the current task, because the
  Linux credential APIs for the most part do not check an arbitrary
  credential, but rather, query what a task can do. See
  secpolicy_zfs_proc(). Again, we don't take a reference on the task, just
  a pointer to it.

  We change to calling crhold() on the task credential, and crfree() when
  we're done with it. This ensures it stays alive and unchanged for the
  duration of the call.

  On the Linux side, we change the main policy checking function
  priv_policy_ns() to use override_creds()/revert_creds() if necessary to
  make the provided credential active in the current task, allowing the
  standard task-permission APIs to do the needed check. Since the task
  pointer is no longer required, this lets us entirely remove
  secpolicy_zfs_proc() and the need to carry a task pointer around as
  well.

  Sponsored-by: https://despairlabs.com/sponsor/

  Signed-off-by: Rob Norris <robn@despairlabs.com>
  Reviewed-by: Pavel Snajdr <snajpa@snajpa.net>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Kyle Evans <kevans@FreeBSD.org>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>


   include/os/freebsd/spl/sys/policy.h |  1 -
   include/os/linux/zfs/sys/policy.h   |  1 -
   include/sys/dmu_recv.h              |  1 -
   include/sys/dsl_dataset.h           |  4 +---
   include/sys/dsl_dir.h               |  4 ++--
   include/sys/zcp.h                   |  1 -
   include/sys/zfs_context.h           |  4 +++-
   lib/libzpool/kernel.c               |  7 ------
   module/os/freebsd/spl/spl_policy.c  |  7 ------
   module/os/linux/zfs/policy.c        | 44 ++++++++++++++--------------------
   module/zfs/dmu_objset.c             | 25 ++++++++++++-------
   module/zfs/dmu_recv.c               | 48 ++++++++++++++++++++++++-------------
   module/zfs/dsl_dataset.c            | 29 ++++++++++++++--------
   module/zfs/dsl_dir.c                | 42 +++++++++++++++-----------------
   module/zfs/zcp.c                    |  8 +++++--
   module/zfs/zcp_synctask.c           |  2 --
   16 files changed, 116 insertions(+), 112 deletions(-)

[commit ef4014882ee1413eba75a78f6e307e16123c63d1]
Date: 2025-05-02
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: Fix incorrect version introduced in manual pages
Review: Manual pages for man:psignal(3), man:rtld_get_var(3), man:getsockopt(2), and man:setcred(2) now correctly document the FreeBSD version where features were introduced.
Body:

  Several manual pages for releng/14.3 incorrectly claim that features
  were first introduced in FreeBSD 15.0.

  I discovered these by running:

    git checkout origin/releng/14.3
    git grep -F '.Fx 15.0'

  MFC After: 3 days
  Reviewed by: imp, ziaee
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1685

  (cherry picked from commit 5b9660caff69c70c9b6d9df5e04a3f21f8cf7996)


   lib/libc/gen/psignal.3      | 2 +-
   lib/libc/gen/rtld_get_var.3 | 2 +-
   lib/libc/sys/getsockopt.2   | 2 +-
   lib/libc/sys/setcred.2      | 2 +-
   4 files changed, 4 insertions(+), 4 deletions(-)

[commit 0a73e91d2c8084268ba5504132484074ab2556c4]
Date: 2025-03-26
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: iXsystems, Inc.
Section: Storage.general
Subject: Block remap for cloned blocks on device removal
Review: The commit addresses a potential data corruption issue in ZFS block pointer remapping during device removal by skipping cloned blocks to prevent double remapping or premature freeing. This change prevents assertion failures and data overwrites, enhancing data integrity for users performing device removal operations.
Body:

  When after device removal we handle block pointers remap, skip blocks
  that might be cloned.  BRTs are indexed by vdev id and offset from
  block pointer's DVA[0].  So if we start addressing the same block by
  some different DVA, we won't get the proper reference counter.  As
  result, we might either remap the block twice, that may result in
  assertion during indirect mapping condense, or free it prematurely,
  that may result in data overwrite, or free it twice, that may result
  in assertion in spacemap code.

  Reviewed-by: Ameer Hamza <ahamza@ixsystems.com>
  Reviewed-by: Paul Dagnelie <pcd@delphix.com>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by:  Alexander Motin <mav@FreeBSD.org>
  Sponsored by:   iXsystems, Inc.
  Closes #15604
  Closes #17180

   module/zfs/metaslab.c | 8 ++++++++
   1 file changed, 8 insertions(+)

[commit b7e24dc13651db7fa79bb59f24e00d27d6f3ea80]
Date: 2025-05-30
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: CI: Retire Fedora 40 builder
Review: Fedora 40 builder is retired from CI workflows as it has reached end of life.
Body:

  Fedora 40 has gone EOL as of May 2025, retire the CI builder.

  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #17408

   .github/workflows/scripts/qemu-2-start.sh    | 5 -----
   .github/workflows/scripts/qemu-4-build-vm.sh | 2 +-
   .github/workflows/zfs-qemu-packages.yml      | 2 +-
   .github/workflows/zfs-qemu.yml               | 4 ++--
   4 files changed, 4 insertions(+), 9 deletions(-)

[commit cbcfc2b37d481121510f65ad6cf79d938e0ee9c5]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Kernel.general
Subject: conf: Make sanitizer configs include the debug config
Review: The sanitizer kernel configurations (GENERIC-KASAN, GENERIC-KCSAN, GENERIC-KMSAN) now include the debug configuration, enabling additional debugging features by default.
Body:

  This is a direct commit to stable/14.


   sys/amd64/conf/GENERIC-KASAN | 2 +-
   sys/amd64/conf/GENERIC-KCSAN | 2 +-
   sys/amd64/conf/GENERIC-KMSAN | 2 +-
   sys/arm64/conf/GENERIC-KASAN | 2 +-
   4 files changed, 4 insertions(+), 4 deletions(-)

[commit f7d9af32d84f12172da018c1a876f3b66fd9ca34]
Date: 2025-04-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: du: Add regression tests
Review: The commit adds regression tests for the du utility, which is an internal testing change without user-visible impact.
Body:

  Reviewed by:	markj
  MFC after:	1 month
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1648

  (cherry picked from commit 3e5550d25c6d614f422506373f7068c6c366fa85)


   usr.bin/du/tests/du_test.sh | 130 +++++++++++++++++++++++++++++++++++++++++++-
   1 file changed, 129 insertions(+), 1 deletion(-)

[commit 5ea5220d17881015df67e4f182e337bd269b9f34]
Date: 2025-04-07
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.programs
Subject: du: Fix threshold on non-directory files
Review: The man:du[1] utility now correctly applies the size threshold to non-directory files, fixing a bug where the threshold was ignored for regular files.
Body:

  PR:		265200
  Reviewed by:	markj
  MFC after:	1 month
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1648

  (cherry picked from commit 0ae2b9e866d3aea1e9141841488561f12603f879)


   usr.bin/du/du.c | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit ea8b5e7f57dd0e18506cd71eb55763e466649704]
Date: 2025-04-14
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: sysrc: Add some regressions tests
Review: The commit adds regression tests for sysrc, which is an internal change without user-visible impact.
Body:

  Reviewed by:	markj
  MFC after:	1 month
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1664

  (cherry picked from commit eeb2d4ffe95b4332811c14b56cfdf5fc6ea821b0)


   etc/mtree/BSD.tests.dist           |   2 +
   usr.sbin/sysrc/Makefile            |   4 +
   usr.sbin/sysrc/tests/Makefile      |   3 +
   usr.sbin/sysrc/tests/sysrc_test.sh | 351 +++++++++++++++++++++++++++++++++++++
   4 files changed, 360 insertions(+)

[commit f00a7faf050370d77292cac4c622a5a8d98ab13d]
Date: 2025-04-14
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: sysrc: Fix check flag logic for append and subtract
Review: The man:sysrc[8] utility now correctly reports the check flag (-c) return values for append (+=) and subtract (-=) operations.
Body:

  When using sysrc with the check flag (-c), the append (+=) and subtract
  (-=) operations result in incorrect return values because on the check
  path the necessary union/difference calculation logic is not performed.

  However, the correct union/difference calculation is already performed
  when running without the check flag. We fix the issue on the check path
  by using the results from the existing union/difference calculation in
  the check logic to get the correct return values.

  PR:		279200
  Reviewed by:	markj
  MFC after:	1 month
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1664

  (cherry picked from commit c97460c4d97db1bd46dab9f2bdbc90cd1ed7757f)


   usr.sbin/sysrc/sysrc | 52 +++++++++++++++++++++++++---------------------------
   1 file changed, 25 insertions(+), 27 deletions(-)

[commit cdf6e2d9feec03b0995c54be46d70471c3d69e5f]
Date: 2025-05-09
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: krb5: Fix handling of transient crypto request failures
Review: Fixes handling of transient crypto request failures in the Kerberos AES crypto module, preventing potential hangs or panics on transient errors.
Body:

  - Instead of using CRYPTO_F_DONE to decide whether a request has
    completed, use a custom protocol of setting crp_opaque = NULL in the
    callback and checking that instead.  CRYPTO_F_DONE is set independent
    of whether an error occurred, but for transient errors signaled by
    EAGAIN, we want to simply retry the request.
  - Clear CRYPTO_F_DONE before retrying the request.
  - Panic if the request truly failed, as we currently have no way to
    pass hard errors back up.

  Reviewed by:	jhb
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D50238

  (cherry picked from commit 04421fda140b92eb0d22bc4c0f81b6de05f21225)


   sys/kgssapi/krb5/kcrypto_aes.c | 30 +++++++++++++++++++-----------
   1 file changed, 19 insertions(+), 11 deletions(-)

[commit 226076aa20f311f7c2d21aa862ce14441db5d078]
Date: 2025-04-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Klara, Inc. | OPNsense
Section: Network.general
Subject: netinet6: Do not forward or send ICMPv6 messages to the unspec address
Review: The IPv6 stack now prevents forwarding packets to the unspecified address (::) and avoids generating ICMPv6 error messages in response to packets from the unspecified address, as required by RFC 4443.
Body:

  As in f7174eb2b4c4 ("netinet: Do not forward or ICMP response to
  INADDR_ANY"), the IPv6 stack should avoid sending packets to the
  unspecified address.  In particular:
  - Make sure that we do not forward received packets to the unspecified
    address; the check in ip6_input() catches this in the common case, but
    after commit 40faf87894ff it's possible for a pfil hook to bypass this
    check and pass the packet to ip6_forward() using the
    PACKET_TAG_IPFORWARD tag.
  - Make sure that we do not reflect packets back to the unspecified
    address; RFC 4443 section 2.4 states that we must not generate error
    messages in response to packets from the unspecified address.

  Reviewed by:	zlei, glebius
  Reported by:	Franco Fichtner <franco@opnsense.org>
  MFC after:	1 month
  Sponsored by:	Klara, Inc.
  Sponsored by:	OPNsense
  Differential Revision:	https://reviews.freebsd.org/D49339

  (cherry picked from commit b7a61e09e4ad5fda44b7f4b6fee14f1b53996b41)


   sys/netinet6/icmp6.c       | 6 ++++++
   sys/netinet6/ip6_forward.c | 3 ++-
   2 files changed, 8 insertions(+), 1 deletion(-)

[commit 8ba7ac5a15e7b5276c6b75934bb604ff5c98ce67]
Date: 2025-05-08
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Klara, Inc. | The FreeBSD Foundation
Section: Userland.programs
Subject: makefs: Ensure that FFS superblocks are reproducible
Review: The man:makefs[8] utility now writes zeroes to a previously uninitialized field in FFS superblocks, ensuring that generated filesystem images are reproducible.
Body:

  The superblock structure has space reserved for a pointer to an
  in-memory structure that gets created at mount time.  makefs populates
  it since that simplifies code elsewhere.  However, the pointer value
  ends up in the output file, which breaks reproducibility.

  Zero the field when writing the superblock instead, as its on-disk value
  is ignored.

  Reviewed by:	emaste
  MFC after:	2 weeks
  Sponsored by:	Klara, Inc.
  Sponsored by:	The FreeBSD Foundation
  Differential Revision:	https://reviews.freebsd.org/D50196

  (cherry picked from commit 764ccf410c3c5453c4656113d75cd81fcf01828d)


   usr.sbin/makefs/ffs/mkfs.c | 12 ++++++++++--
   1 file changed, 10 insertions(+), 2 deletions(-)

[commit 001fc46caa5469c1693f5f64c801815cb0dedbf1]
Date: 2025-05-13
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Klara, Inc.
Section: undecided
Subject: file: Simplify an INVARIANTS check in _fdrop()
Review: Internal refactoring with no user-visible impact.
Body:

  No functional change intended.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.

  (cherry picked from commit a2e22ed3420d92d9d98a1e9681b5c9b1fbe40fca)


   sys/kern/kern_descrip.c | 9 +++------
   1 file changed, 3 insertions(+), 6 deletions(-)

[commit 1a03846b405093048324ea2783a19d88a469d5e6]
Date: 2025-05-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: Klara, Inc.
Section: undecided
Subject: vfs cache: Simplify cache_enter_time() a bit
Review: No functional change; only internal code simplification.
Body:

  The condition `flag == NFC_ISDOTDOT && vp != NULL && vp->v_type != VDIR`
  is never true at this point in the function.  This is asserted slightly
  earlier.  So, remove some dead code and simplify control flow.

  N.B. we set v_cache_dd for all vnode types, not just VDIR.  This seems
  to be intentional, see commit ce575cd0e2f9069.  For regular files it
  appears to effectively represent the most recently entered cache entry
  for the vnode.

  No functional change intended.

  Reviewed by:	olce, kib
  MFC after:	2 weeks
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50107

  (cherry picked from commit 01435e28211220f985c66569f60939e440f0887f)


   sys/kern/vfs_cache.c | 34 +++++++++++++---------------------
   1 file changed, 13 insertions(+), 21 deletions(-)

[commit 12effd95c300eca04c8b2ec68c6c1d20f983a8ce]
Date: 2025-05-02
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Klara, Inc.
Section: undecided
Subject: vfs cache: Move hash row lookup loops into a subroutine
Review: No user-visible changes; internal refactoring only.
Body:

  No functional change intended.

  Reviewed by:	olce, kib
  MFC after:	2 weeks
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50106

  (cherry picked from commit cc25864d4568079cadef46291ddf7d501c81d60a)


   sys/kern/vfs_cache.c | 129 +++++++++++++++++++++++++--------------------------
   sys/sys/vnode.h      |   1 +
   2 files changed, 65 insertions(+), 65 deletions(-)

[commit b080a04e25113112e0d94a20c8d1c1241a3387e9]
Date: 2025-05-02
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Klara, Inc.
Section: undecided
Subject: vfs cache: Add a predicate for testing cache entries
Review: No functional change intended.
Body:

  No functional change intended.

  Reviewed by:	olce, kib
  MFC after:	2 weeks
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50105

  (cherry picked from commit 029ed5f574f61443fd12e0e70c7ab4dc296b81e5)


   sys/kern/vfs_cache.c | 40 ++++++++++++++++++++--------------------
   1 file changed, 20 insertions(+), 20 deletions(-)

[commit ad5eecbfca54cfd2247c8fb3799ba292bf9668ed]
Date: 2025-05-20
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ifnet: Integrate if_unroute() into if_down()
Review: Internal refactoring of ifnet interface management with no user-visible functional change.
Body:

  if_unroute() is static since 2004 and is not used anywhere except for
  if_down().

  This also makes it easier to grep by the pattern `if_flags &= ~IFF_UP`.

  No functional change intended.

  Reviewed by:	glebius
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D49356

  (cherry picked from commit 0693c3f7cb3d9e5389863a0c131ddef799c77091)


   sys/net/if.c | 29 ++++++++---------------------
   1 file changed, 8 insertions(+), 21 deletions(-)

[commit c20e7eb53d47fb0359e393fab08aef793ce614b3]
Date: 2025-05-19
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: ifnet: Fix a typo in a source code comment
Review: Typo fix in a source code comment only, no user-visible impact.
Body:

  - s/possiable/possible

  MFC after:	3 days

  (cherry picked from commit ad2d7e594f6d519be6e9674c8048a406a453fef9)


   sys/net/if.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 7d88b0e3dbe46da939bd9f95164b2d332e9fd53d]
Date: 2025-05-14
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.libraries
Subject: rc.subr: remove the dependency on bsdconfig
Review: The rc.subr script no longer depends on bsdconfig for the 'enable' and 'disable' commands, using built-in rc.conf editing instead. This reduces dependencies for the rc(8) system.
Body:

  rc.subr uses sysrc(8) for the 'enable' and 'disable' commands, which
  means the entire rc(8) stack depends on bsdconfig.  Instead, provide a
  minimal amount of rc.conf-editing functionality in rc.subr and use it to
  implement these commands.

  Reviewed by:	des, bapt
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50325

  (cherry picked from commit f6328f052518d56c01f10e14cd9ef1f2675c01a4)


   libexec/rc/rc.subr | 102 ++++++++++++++++++++++++++++++++++++++++++++---------
   1 file changed, 86 insertions(+), 16 deletions(-)

[commit cf624ffa812c90f8bd4b37f42488db1e782be883]
Date: 2025-05-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: ifconfig: reject netmask and broadcast for inet6
Review: man:ifconfig[8] now rejects attempts to set netmask or broadcast addresses for IPv6 addresses, preventing a crash that occurred when users tried to configure these unsupported parameters.
Body:

  We don't support setting netmask or broadcast address for INET6
  addresses, and trying to do crashes ifconfig.  Handle this the
  same way as af_link, by rejecting attempts to configure these
  parameters.

  PR:	286910
  Reported by:	Hayzam Sherif <hayzam@alchemilla.io>
  MFC after:	3 days
  Reviewed by:	zlei, kevans, des, cy
  Approved by:	kevans (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50413

  (cherry picked from commit 59ee9260e6bbcc3b5654126eed6e9490315c81f1)

  ifconfig tests: remove incorrect #!

  Fixes: 59ee9260e6bb ("ifconfig: reject netmask and broadcast for inet6")

  Reviewed by:	des
  Differential Revision:	https://reviews.freebsd.org/D50566

  (cherry picked from commit 6ab70fbec4236a940275a42e301f76ade7faacbf)


   sbin/ifconfig/af_inet6.c     |  5 +++
   sbin/ifconfig/tests/Makefile |  6 ++--
   sbin/ifconfig/tests/inet6.sh | 83 ++++++++++++++++++++++++++++++++++++++++++++
   3 files changed, 92 insertions(+), 2 deletions(-)

[commit 59f18f852c7e665e609341f87c862e83966eec67]
Date: 2025-05-23
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: bridge: check allow_llz_overlap before member_ifaddrs
Review: The bridge interface now correctly removes IPv6 link-local addresses from a member interface before checking for existing IP addresses when allow_llz_overlap=0 and member_ifaddrs=0. This restores the ability to add interfaces with link-local addresses to a bridge without causing an 'Invalid argument' error.
Body:

  When adding a new interface to a bridge and allow_llz_overlap=0, which
  is the default value, if_bridge checks if the interface has IPv6 link
  local addresses assigned, and if it does, it calls in6_ifdetach() to
  remove all IPv6 addresses from the interface.

  This means it was possible to do this:

  	% ifconfig bridge1 create inet6 -ifdisabled auto_linklocal up
  	% ifconfig epair20 create inet6 -ifdisabled auto_linklocal up
  	% ifconfig bridge1 addm epair20a

  ... with the result that the link-local address on epair20a would be
  removed, then the interface would be added to the bridge.

  If member_ifaddrs=0, which is also the default value, this no longer
  works:

  	% ifconfig bridge1 addm epair20a
  	ifconfig: BRDGADD epair20a: Invalid argument

  This is because the member_ifaddrs check runs before allow_llz_overlap
  does its thing, and returns EINVAL since the new interface has IP
  addresses on it.

  To restore the previous behaviour, reverse the order of these two
  checks, so the IPv6 addresses are removed before we check whether
  the interface has IPv6 addresses.

  MFC after:	1 week
  Reviewed by:	kevans, kp
  Approved by:	kevans (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50477

  (cherry picked from commit da2dbdc297c948d5923812e3d3b777b790d3bf43)


   sys/net/if_bridge.c | 39 ++++++++++++++++++++-------------------
   1 file changed, 20 insertions(+), 19 deletions(-)

[commit 56da5c5ed35ad297538395b07654e31ac425ca30]
Date: 2025-05-22
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Drivers.device
Subject: mac_do(4): allow compiling into kernel
Review: The man:mac_do[4] driver can now be compiled into the kernel, matching the documentation.
Body:

  The manual page says this is possible, but it's not.  Make it possible.

  Reviewed by:	olce, kevans
  Approved by:	kevans (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50451

  (cherry picked from commit c8d8cac2a8479009bcdca6c0cb9852af514896f2)


   sys/conf/NOTES   | 1 +
   sys/conf/files   | 3 ++-
   sys/conf/options | 1 +
   3 files changed, 4 insertions(+), 1 deletion(-)

[commit 1b9a53e3805deb0b95760fd34025d4d0a4f96f41]
Date: 2025-01-10
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: zfsboot: fix misuse of the phrase zpool
Review: The commit fixes a minor terminology error in the zfsboot script, changing 'zpool' to 'pool' where appropriate. This has no functional impact and is purely a documentation or wording correction.
Body:

  A pool is not a zpool.

  Reviewed by:	jbh, ivy
  Approved by:	des (mentor)
  MFC after:	1 week
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1569

  (cherry picked from commit f69afe4201ff33da0b3c3ca464a92e2e0b07ac43)


   usr.sbin/bsdinstall/scripts/zfsboot | 30 +++++++++++++++---------------
   1 file changed, 15 insertions(+), 15 deletions(-)

[commit c6f345bda5171ce879caa2d588d24ffb5aff37d2]
Date: 2025-05-29
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Ports.packaging
Subject: pkg/FreeBSD.conf: Fix comments to reflect -kmods
Review: The commit updates comments in pkg configuration files to clarify how to disable both the FreeBSD and FreeBSD-kmods repositories.
Body:

  Now that this file lists two repositories, the text "to disable *this*
  repository" no longer makes sense.  Also, expand the example to list
  how to disable both FreeBSD and FreeBSD-kmods repositories.

  Reported by:	Graham Perrin
  MFC after:	3 days

  (cherry picked from commit 955ab1a8f21ec1a662a87fc5e76e6d5690e09085)


   usr.sbin/pkg/FreeBSD.conf.latest    | 5 +++--
   usr.sbin/pkg/FreeBSD.conf.quarterly | 5 +++--
   2 files changed, 6 insertions(+), 4 deletions(-)

[commit 93aeb68a8933e7458c795b31589900cbeae49e38]
Date: 2025-05-24
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Klara, Inc.
Section: Userland.contrib
Subject: atf: Don't be deterred by weird umasks.
Review: ATF now handles unusual umask values without error, allowing tests to verify code behavior under non-standard umasks.
Body:

  If the current umask is weird, ATF goes to great lengths to tell us that
  it can't possibly work in these conditions, instead of just dealing with
  it.  This makes it unreasonably hard to use ATF to test how our own code
  handles unusual umasks.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	igoro, kevans, ngie
  Differential Revision:	https://reviews.freebsd.org/D50267

  (cherry picked from commit 1a6a36a98ad5dc86862541b91686b00cf88e9f76)


   contrib/atf/atf-c/check_test.c       |  8 +---
   contrib/atf/atf-c/detail/fs.c        | 91 ++++--------------------------------
   contrib/atf/atf-c/detail/fs_test.c   | 44 ++++++++---------
   contrib/atf/atf-sh/atf-check_test.sh | 24 +++++-----
   4 files changed, 43 insertions(+), 124 deletions(-)

[commit 1e8f26125fe8442ebf499b2bb25d78d779ddb574]
Date: 2025-05-24
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Userland.libraries
Subject: libc: set close-on-exec for temp socket used to detect IPv6 support
Review: The libc sysconf function now sets close-on-exec for a temporary socket used to detect IPv6 support, preventing potential file descriptor leaks into child processes.
Body:

  (cherry picked from commit eba403923626f2ecfd724e131da992a7c3cb7240)


   lib/libc/gen/sysconf.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 12f150851bad6c1e41075ba489f6440f2b43554b]
Date: 2025-05-30
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: ZTS: Enable io_uring support on el9/el10
Review: The commit enables io_uring support in ZFS test suites for Red Hat Enterprise Linux 9 and 10 environments, allowing testing of this interface where it is available as a Technology Preview.
Body:

  The io_uring interface is available as a Technology Preview.
  Details: https://access.redhat.com/solutions/4723221

  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes #17397


   .github/workflows/scripts/qemu-6-tests.sh        | 7 +++++++
   tests/zfs-tests/tests/functional/io/io_uring.ksh | 7 -------
   2 files changed, 7 insertions(+), 7 deletions(-)

[commit 564b641f88d1a75217142ccab5acbe9a89e4aeab]
Date: 2025-05-30
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: ZTS: Add AlmaLinux 10
Review: Adds AlmaLinux 10 to the ZFS test suite (ZTS) for continuous integration testing.
Body:

  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes #17397


   .github/workflows/scripts/qemu-2-start.sh   | 5 +++++
   .github/workflows/scripts/qemu-3-deps-vm.sh | 2 +-
   .github/workflows/zfs-qemu-packages.yml     | 2 +-
   .github/workflows/zfs-qemu.yml              | 4 ++--
   4 files changed, 9 insertions(+), 4 deletions(-)

[commit 50a027f798f36f7be435b6b8817242a46a30c9d4]
Date: 2025-05-30
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: CI: Retire Ubuntu 20.04 builder
Review: The commit removes the Ubuntu 20.04 CI builder from the project's GitHub Actions workflows.
Body:

  Ubuntu 20.04 has gone EOL as of April 2025, retire the CI builder.

  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #17403

   .github/workflows/scripts/qemu-2-start.sh   | 5 -----
   .github/workflows/scripts/qemu-3-deps-vm.sh | 4 +---
   .github/workflows/zfs-qemu.yml              | 4 ++--
   3 files changed, 3 insertions(+), 10 deletions(-)

[commit c1848f7261a949d972df6f2860feffd0fa8d9752]
Date: 2025-05-30
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Linux build: always use objtool
Review: The commit removes internal build flags for Linux kernel module compilation and does not affect FreeBSD users or any user-visible functionality.
Body:

  We silence `objtool` warnings on some object files using
  `OBJECT_FILES_NON_STANDARD_some_file.o`. Nowadays `objtool` is
  needed for CPU vulnerability mitigations and a lot more
  functionality so its use is desirable.

  Just remove the `OBJECT_FILES_NON_STANDARD` definitions. A follow-up
  commit is needed to make the offending files standard and address
  the compile time warnings.

  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Attila Flp <attila@fueloep.org>
  Closes #17401
  Closes #17364

   module/Kbuild.in | 13 -------------
   1 file changed, 13 deletions(-)

[commit 6f9b2071b8435ed366310a16cf0cb8f2e2797ae5]
Date: 2025-05-16
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Storage.general
Subject: nfs_clrpcops.c: Fix handling of a CreateLayGet reply
Review: The NFS client now correctly handles CreateLayGet replies from pNFS servers that issue delegations, preventing potential issues when using the 'pnfs' mount option.
Body:

  Without this patch, the CreateLayGet RPC did not handle a NFSv4.1/4.2
  reply for a pNFS server that also issued delegations.

  This patch fixes the problem.

  Detected at the recent NFSv4 Bakeathon testing event.

  This bug would only affect the rare case where the FreeBSD client
  is mounted to a pNFS server that issues delegations, where the
  "pnfs" mount option is specified.

  (cherry picked from commit e647a222a1a74bd3b2bbdd7903fb30e4e30b6b09)


   sys/fs/nfsclient/nfs_clrpcops.c | 7 +++++++
   1 file changed, 7 insertions(+)

[commit e5c544f95ab4d56d7b8ee73415c40135db84579b]
Date: 2025-05-15
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: nfs_clrpcops.c: Fix acquisition of post-op attributes for link
Review: The NFS client now acquires post-operation attributes for link operations in NFSv4, ensuring that cached st_nlinks attributes are updated correctly when a new hard link is created.
Body:

  Without this patch, the link RPC (done by nfsrpc_link()) did not
  acquire post link operation attributes for the file object for NFSv4.
  For some recent Linux NFSv4 servers that support delegations, this
  would result in the client's cached attribute for st_nlinks not being
  increased right away, because the delegation would indicate that the
  now stale cached attributes were still valid.

  This patch fixes the problem by acquiring post link attributes and
  updating the client's cached copy in the same manner as the NFSv3
  RPC did.

  Detected at the recent NFSv4 Bakeathon testing event.

  Applications will only be affected if they examine st_nlinks after
  a new hard link is created for a file object.

  (cherry picked from commit 772258c89f28501546844a60616211f44f55f4ce)


   sys/fs/nfs/nfs_commonsubs.c     |  2 +-
   sys/fs/nfsclient/nfs_clrpcops.c | 40 +++++++++++++++++++++++++++-------------
   2 files changed, 28 insertions(+), 14 deletions(-)

[commit 75f7d9cbff26264640fcfcd2e3c5c4ca1d0ea0a6]
Date: 2025-05-24
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: m4: Fix OOB access displaying MIN_INT
Review: The m4(1) utility no longer accesses out-of-bounds memory when displaying INT_MIN, preventing a potential crash.
Body:

  Previously displaying INT_MIN resulted in an out of bounds access to
  digits[-8].  In twos-complement -INT_MIN is still negative.

  PR:		287013
  Reviewed by:	emaste

  (cherry picked from commit ab4edcd552c967a400e85afc0fd3e6729fa9ee2c)


   usr.bin/m4/misc.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d4f5d3a4eade118694a537564e35c64fdd779f9a]
Date: 2025-05-23
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.programs
Subject: m4: Allow empty base argument in eval()
Review: The m4(1) utility now accepts an empty base argument in the eval() builtin, aligning with POSIX and fixing a previous error for blank or unspecified radix.
Body:

  POSIX specifies "The second argument, if specified, shall set the radix
  for the result; if the argument is blank or unspecified, the default
  is 10."  Previously we reported an invalid

  PR:		287015
  Reviewed by:	emaste

  (cherry picked from commit ac196a5845757a4d92cdfc4927170576dce5de9d)


   usr.bin/m4/eval.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 9c34a6876a60dc10fda6ad6a0cbe8f99a372aadc]
Date: 2023-10-05
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: certctl: Split certificate bundles before processing.
Review: The certctl utility now splits certificate bundles before processing, handles untrusted certificates gracefully, converts line endings for cross-platform compatibility, and reverts to symlinks to avoid extraction issues with tar.
Body:

  This allows 'certctl rehash' to do the right thing when ca_root_nss is
  installed, instead of linking the entire bundle to the hash of the
  first certificate it contains.

  MFC after:	3 days
  Reviewed by:	allanjude
  Differential Revision:	https://reviews.freebsd.org/D42087

  (cherry picked from commit a401c8cb26b22688087ad7c5ee527718459df15a)

  certctl: Fix recent regressions.

  - If an untrusted certificate is also found in the list of trusted
    certificate, issue a warning and skip it, but don't fail.
  - Split on -+BEGIN CERTIFICATE-+ instead of "Certificate:" since
    that's what we're really looking for.

  Also fix a long-standing bug: .crl files are not certificates, so we
  should not include them when searching for certificates.

  Reported by:	madpilot, netchild, tijl
  Reviewed by:	netchild, allanjude
  Differential Revision:	https://reviews.freebsd.org/D42276

  (cherry picked from commit 87945a082980260b52507ad5bfb3a0ce773a80da)

  certctl: Convert line endings before inspecting files.

  This ensures that certificate files or bundles with DOS or Mac line
  endings are recognized as such and handled identically to those with
  Unix line endings.

  PR:		274952
  Reviewed by:	allanjude
  Differential Revision:	https://reviews.freebsd.org/D42490

  (cherry picked from commit f7d16a627efa8ba610eb9b8a12dd67b6cdbb2542)

  certctl: Revert to symlinks.

  Unfortunately tar will not be able to extract base.txz to a system where
  /etc and /usr are not on the same filesystem if the certificates are
  hard links.

  PR:		277828
  Reviewed by:	mp
  Differential Revision:	https://reviews.freebsd.org/D44496

  (cherry picked from commit 3fed4f0db53a66a0135bea5c491431eb3348cf51)


   usr.sbin/certctl/certctl.sh | 105 ++++++++++++++++++++++++++++----------------
   1 file changed, 68 insertions(+), 37 deletions(-)

[commit d92827b820eea5b3ef632089cc7ee662b18a2fda]
Date: 2025-05-28
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Linux 6.15 compat: META
Review: The commit updates an internal META file to note compatibility with Linux kernel 6.15, which is an internal tracking change without direct user impact.
Body:

  Update the META file to reflect compatibility with the 6.15
  kernel.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17393

   META | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c81e37f15db3329edcbb2f9c45cc626720cc53af]
Date: 2025-05-29
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Storage.general
Subject: [zfs-2.2.8] Revert "vdev_disk: default to classic submission for 2.2.x"
Review: The ZFS vdev_disk driver reverts to using the classic I/O submission mode, which resolves a panic condition that could occur when using the newer submission mode.
Body:

  This reverts commit eebf00bee91de2c7b7d03a9c1e5e2f3e5fd66c9e.

  Classic mode is causing assertions on both this branch and master:

  VERIFY3(page_count(page) > 0) failed (0 > 0)
  PANIC at abd_os.c:1069:bio_map()

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>


   man/man4/zfs.4                  | 31 +++++++++----------------------
   module/os/linux/zfs/vdev_disk.c |  8 +++-----
   2 files changed, 12 insertions(+), 27 deletions(-)

[commit 000236716af950811aa1b974d1813241fda4fa02]
Date: 2025-05-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ZTS: Stop zpool_status tests from spamming stdout (#17292)
Review: The commit fixes a test script to suppress output, which is an internal change with no user-visible impact.
Body:

  zpool_status_003 and zpool_status_004_pos use 'dd' to trigger a read of
  a file without specifying 'of=/dev/null'.  This spams the ZTS logs
  with ~20MB of garbage data. This commit adds 'of=/dev/null'.

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>

   .../tests/functional/cli_root/zpool_status/zpool_status_003_pos.ksh     | 2 +-
   .../tests/functional/cli_root/zpool_status/zpool_status_004_pos.ksh     | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit b760fa5bf0e965210f8df05cef9ff46c68377d2a]
Date: 2025-05-29
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: snd_dummy: Make callout stopping more robust
Review: The commit fixes a potential panic in the snd_dummy sound driver when detaching the device, preventing a use-after-free condition during callout rescheduling.
Body:

  If the callout gets rescheduled during detach, we might access freed
  pcm_channel resources in dummy_chan_io(), which will cause a panic
  similar to this:

  panic: ASan: Invalid access, 8-byte read at 0xfffffe00479f65d8, UMAUseAfterFree(fd)
  cpuid = 1
  time = 1747433047
  KDB: stack backtrace:
  db_trace_self_wrapper() at db_trace_self_wrapper+0xa5/frame 0xfffffe0046a8d730
  kdb_backtrace() at kdb_backtrace+0xc6/frame 0xfffffe0046a8d890
  vpanic() at vpanic+0x226/frame 0xfffffe0046a8da30
  panic() at panic+0xb5/frame 0xfffffe0046a8db00
  kasan_code_name() at kasan_code_name/frame 0xfffffe0046a8dbd0
  __mtx_lock_flags() at __mtx_lock_flags+0xd3/frame 0xfffffe0046a8dcc0
  chn_intr() at chn_intr+0x3d/frame 0xfffffe0046a8dce0
  dummy_chan_io() at dummy_chan_io+0x9c/frame 0xfffffe0046a8dd10
  softclock_call_cc() at softclock_call_cc+0x2bb/frame 0xfffffe0046a8de80
  softclock_thread() at softclock_thread+0x162/frame 0xfffffe0046a8def0
  fork_exit() at fork_exit+0xa3/frame 0xfffffe0046a8df30
  fork_trampoline() at fork_trampoline+0xe/frame 0xfffffe0046a8df30

  Reviewed by:	adrian
  Differential Revision:	https://reviews.freebsd.org/D50386

  (cherry picked from commit 0432b2183f25ddba7e13a33adf1dd6f9563b0bd1)


   sys/dev/sound/dummy.c | 17 +++++++++++++++--
   1 file changed, 15 insertions(+), 2 deletions(-)

[commit 0c6aa445ec0c85e7c9653d20562907742569de6f]
Date: 2025-05-29
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: sound: Terminate stream properly when closing vchans
Review: The sound subsystem now properly terminates DMA streams when closing virtual audio channels, preventing continuous hardware interrupts after applications exit.
Body:

  When a channel is closed, dsp_close() either calls vchan_destroy() on vchans,
  or chn_abort()/chn_flush() on primary channels. However, the problem with this
  is that, when closing a vchan, we end up not terminating the stream properly.

  The call sequence we are interested in is the following:

  	vchan_destroy(vchan) -> chn_kill(vchan) -> chn_trigger(vchan) ->
  	vchan_trigger(vchan) -> chn_notify(parent)

  Even though chn_notify() contains codepaths which call chn_abort(parent),
  apparently we do not execute any of those codepaths in this case, so the
  DMA remains unterminated, hence why we keep seeing the primary
  channel(s) being interrupted even once the application has exited:

  root@freebsd:~ # sndctl interrupts
  dsp0.play.0.interrupts=1139
  dsp0.record.0.interrupts=0
  root@freebsd:~ # sndctl interrupts
  dsp0.play.0.interrupts=1277
  dsp0.record.0.interrupts=0
  root@freebsd:~ # sndctl interrupts
  dsp0.play.0.interrupts=1394
  dsp0.record.0.interrupts=0

  The only applications that do not have this issue are those (e.g., mpv) that
  manually call ioctls which end up calling chn_abort(), like SNDCTL_DSP_HALT, to
  abort the channel(s) during shutdown. For all other applications that do not
  manually abort the channel(s), we can confirm that chn_abort()/chn_flush(), or
  even chn_trigger(PCMTRIG_ABORT) on the parent, doesn't happen during shutdown.

  root@freebsd:~ # dtrace -n 'fbt::chn_abort:entry,fbt::chn_flush:entry { printf("%s", args[0]->name); stack(); }'
  dtrace: description 'fbt::chn_abort:entry,fbt::chn_flush:entry ' matched 2 probes
  dtrace: buffer size lowered to 1m
  ^C

  [...]

  root@freebsd:~ # dtrace -n 'fbt::chn_trigger:entry /args[1] == -1/ { printf("%s", args[0]->name); stack(); }'
  dtrace: description 'fbt::chn_trigger:entry ' matched 1 probe
  dtrace: buffer size lowered to 1m
  CPU     ID                    FUNCTION:NAME
    0  68037                chn_trigger:entry dsp0.virtual_play.0
  	      sound.ko`chn_kill+0x134
  	      sound.ko`vchan_destroy+0x94
  	      sound.ko`dsp_close+0x39b
  	      kernel`devfs_destroy_cdevpriv+0xab
  	      kernel`devfs_close_f+0x63
  	      kernel`_fdrop+0x1a
  	      kernel`closef+0x1e3
  	      kernel`closefp_impl+0x76
  	      kernel`amd64_syscall+0x151
  	      kernel`0xffffffff8103841b1

  To fix this, modify dsp_close() to execute the primary channel case on both
  primary and virtual channels. While what we really care about are the
  chn_abort()/chn_flush() calls, it shouldn't hurt to call the rest of the
  functions on the vchans as well, to avoid complicating things; they get deleted
  right below, anyway.

  With the patch applied:

  root@freebsd:~ # dtrace -n 'fbt::chn_trigger:entry /args[1] == -1/ { printf("%s", args[0]->name); stack(); }'
  dtrace: description 'fbt::chn_trigger:entry ' matched 1 probe
  dtrace: buffer size lowered to 1m
  CPU     ID                    FUNCTION:NAME
    1  68037                chn_trigger:entry dsp0.virtual_play.0
                sound.ko`chn_flush+0x2a
                sound.ko`dsp_close+0x330
                kernel`devfs_destroy_cdevpriv+0xab
                kernel`devfs_close_f+0x63
                kernel`_fdrop+0x1a
                kernel`closef+0x1e3
                kernel`closefp_impl+0x76
                kernel`amd64_syscall+0x151
                kernel`0xffffffff8103841b

    0  68037                chn_trigger:entry dsp0.play.0
                sound.ko`chn_notify+0x4ce
                sound.ko`vchan_trigger+0x105
                sound.ko`chn_trigger+0xb4
                sound.ko`chn_flush+0x2a
                sound.ko`dsp_close+0x330
                kernel`devfs_destroy_cdevpriv+0xab
                kernel`devfs_close_f+0x63
                kernel`_fdrop+0x1a
                kernel`closef+0x1e3
                kernel`closefp_impl+0x76
                kernel`amd64_syscall+0x151
                kernel`0xffffffff8103841b

  Above we can see a chn_trigger(PCMTRIG_ABORT) on the parent (dsp0.play.0),
  which is coming from the chn_abort() (inlined) in chn_notify():

  root@freebsd:~ # dtrace -n 'kinst::chn_abort:entry { stack(); }'
  dtrace: description 'kinst::chn_abort:entry ' matched 5 probes
  dtrace: buffer size lowered to 1m
  CPU     ID                    FUNCTION:NAME
    1  72580                  chn_notify:1192
                sound.ko`0xffffffff8296cab4
                sound.ko`vchan_trigger+0x105
                sound.ko`chn_trigger+0xb4
                sound.ko`chn_flush+0x2a
                sound.ko`dsp_close+0x330
                kernel`devfs_destroy_cdevpriv+0xab
                kernel`devfs_close_f+0x63
                kernel`_fdrop+0x1a
                kernel`closef+0x1e3
                kernel`closefp_impl+0x76
                kernel`amd64_syscall+0x151
                kernel`0xffffffff8103841b

  We can also confirm the primary channel(s) are not interrupted anymore:

  root@freebsd:/mnt/src # sndctl interrupts
  dsp0.play.0.interrupts=0
  dsp0.record.0.interrupts=0

  In collaboration with:	adrian
  Tested by:		adrian, christos, thj
  Sponsored by:		The FreeBSD Foundation
  MFC after:		2 days
  Reviewed by:		thj, adrian, emaste
  Differential Revision:	https://reviews.freebsd.org/D50488

  (cherry picked from commit f6430bc61df78be070209d52b4452ae9cf4cd015)


   sys/dev/sound/pcm/dsp.c | 33 +++++++++++++++++++--------------
   1 file changed, 19 insertions(+), 14 deletions(-)

[commit 8a2ce9f9dd6745e77bdfe78f03e96ddc8ad1b9d7]
Date: 2025-05-28
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: Amazon
Section: Ports.packaging
Subject: pkg.conf: Use kmod repositories
Review: pkg.conf now includes kmod repositories by default, enabling automatic installation of kernel modules such as graphics drivers without manual configuration.
Body:

  The kmod repositories were added shortly after 14.2-RELEASE.  Point at
  them here so that users don't need to manually add the configuration
  in order to get e.g. working graphics.

  MFC after:	1 minute
  Sponsored by:	Amazon
  Differential Revision:	https://reviews.freebsd.org/D50583

  (cherry picked from commit 29f076ae0cb536d1e891d3375edf28f1bc82df79)


   usr.sbin/pkg/FreeBSD.conf.latest    | 7 +++++++
   usr.sbin/pkg/FreeBSD.conf.quarterly | 7 +++++++
   2 files changed, 14 insertions(+)

[commit 5c10e8eae0f071799744f55bc99ef3b712b698ba]
Date: 2025-05-25
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: open.2: add a note about conversion of a file descriptor into O_PATH
Review: The man:open[2] manual page now includes a note about converting a file descriptor into O_PATH, clarifying behavior for users.
Body:

  (cherry picked from commit fae33d1d12a51ca2bbdc7f5f189f7a4362fb48f7)


   lib/libc/sys/open.2 | 7 +++++++
   1 file changed, 7 insertions(+)

[commit f23326ff2c7cad9579061291b6de7feb5ea7302a]
Date: 2025-05-25
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.programs
Subject: systat/top: Update ZFS sysctl names
Review: The systat and top utilities now use updated ZFS ARC sysctl names, ensuring compatibility with current kernel interfaces and preventing future breakage.
Body:

  Some of ARC statistic sysctls changed years ago, but those tools
  are still using legacy shims, that are going to be removed.

  MFC after:	3 days

  (cherry picked from commit 8aad1e6148d3389df100bb0391e2d3a909f26ecf)


   usr.bin/systat/main.c | 6 +++---
   usr.bin/top/machine.c | 6 +++---
   2 files changed, 6 insertions(+), 6 deletions(-)

[commit 93af4971207b514a525e60bfac928539e5891e49]
Date: 2025-05-27
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: [zfs-2.2.8] GCC: Fix array subscript check
Review: Fixes a GCC array bounds warning in the ZFS module, which may affect compilation on systems with stricter compiler checks.
Body:

  Fix a zfs-2.2.8 GCC check on Fedora 42:

  module/zfs/ddt.c:445:9: warning: array subscript -1 is below array
  bounds of 'ddt_stat_t[64]' {aka 'struct ddt_stat[64]'} [-Warray-bounds=]
    445 |         ddt_stat_add(&ddh->ddh_stat[bucket], &dds, neg);

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>


   module/zfs/ddt.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 5b93750f6f12cd60850292bcf9cc1f29323d9f70]
Date: 2025-03-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Linux 6.14 compat: META (#17098) (#17172)
Review: The commit updates a META file to indicate compatibility with Linux kernel 6.14, which is an internal metadata change without direct user-visible impact.
Body:

  Update the META file to reflect compatibility with the 6.14
  kernel.

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Rob Norris <robn@despairlabs.com>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: @ImAwsumm

   META | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 0765d247359f6fb566f6a3d9e3d8a0d968337cc3]
Date: 2025-02-27
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Linux 6.13 compat: META (#17098)
Review: The commit updates the META file to reflect compatibility with the Linux 6.13 kernel, which is an internal documentation change without user-visible impact.
Body:

  Update the META file to reflect compatibility with the 6.13 kernel.

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Rob Norris <rob.norris@klarasystems.com>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>

   META | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 81c62bc9e593ee725fe79859dda905d6bca10c0b]
Date: 2025-04-16
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: GCC 15: Fix unterminated-string-initialization (#17244)
Review: Fixes build errors with GCC 15 by ensuring certain character arrays are NULL-terminated, preventing compilation failures on newer compilers.
Body:

  Fix build errors on Fedora 42 like:

    module/zcommon/zfs_valstr.c:193:16: error: initializer-string for
    array of 'char' truncates NUL terminator but destination lacks
    'nonstring' attribute (3 chars into 2 available)

  The arrays in zpool_vdev_os.c and zfs_valstr.c don't need to be
  NULL terminated, but we do so to make GCC happy.

  Closes: #17242

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>

   cmd/zpool/os/linux/zpool_vdev_os.c      | 3 ++-
   module/zcommon/zfs_valstr.c             | 4 +++-
   tests/zfs-tests/cmd/file/largest_file.c | 2 +-
   3 files changed, 6 insertions(+), 3 deletions(-)

[commit dcabac71e8d60f691a07f24baee98e1f40a8a19f]
Date: 2025-04-07
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: debian: Add libtirpc-dev dependency (#17220)
Review: This commit updates a Debian packaging file to add a build dependency, which is an internal packaging detail with no direct user-visible impact on FreeBSD systems.
Body:

  Debian requires libtirpc-dev.  Update our debian/control file to
  match Debian's upstream one.

  Closes: #17197

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: @manfromafar

   contrib/debian/control | 1 +
   1 file changed, 1 insertion(+)

[commit 3d087fde6e96acc48e095b9a2776f869c708afe4]
Date: 2024-11-07
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Use <fcntl.h> instead of <sys/fcntl.h>
Review: The commit changes internal include paths for compatibility with musl libc, but does not introduce any user-visible changes in behavior, features, or configuration.
Body:

  When building on musl, we get:

  ```
  In file included from tests/zfs-tests/cmd/getversion.c:22:
  /usr/include/sys/fcntl.h:1:2: error: #warning redirecting incorrect
   #include <sys/fcntl.h> to <fcntl.h> [-Werror=cpp]
   1 | #warning redirecting incorrect #include <sys/fcntl.h> to <fcntl.h>

  In file included from module/os/linux/zfs/vdev_file.c:36:
  /usr/include/sys/fcntl.h:1:2: error: #warning redirecting incorrect
   #include <sys/fcntl.h> to <fcntl.h> [-Werror=cpp]
   1 | #warning redirecting incorrect #include <sys/fcntl.h> to <fcntl.h>
  ```

  Bug: https://bugs.gentoo.org/925235
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Sam James <sam@gentoo.org>
  Closes #15925

   module/os/linux/zfs/vdev_file.c  | 4 +++-
   tests/zfs-tests/cmd/getversion.c | 2 +-
   2 files changed, 4 insertions(+), 2 deletions(-)

[commit b800ad856ef94a09f1fe33795f3b30c07d5b81c0]
Date: 2023-11-29
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: Fix zoneid when USER_NS is disabled
Review: Fixes zone ID handling when user namespaces are disabled, ensuring consistent behavior across configurations.
Body:

  getzoneid() should return GLOBAL_ZONEID instead of 0 when USER_NS is disabled.

  Reviewed-by: Richard Yao <richard.yao@alumni.stonybrook.edu>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Ilkka Sovanto <github@ilkka.kapsi.fi>
  Closes #15560

   lib/libspl/os/linux/zone.c | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit c4f7df8266461244bc447b8f8da0fa1a19034b06]
Date: 2024-12-20
Score: 5
Status: proposed(include=no,score=20)
Sponsor: iXsystems, Inc.
Section: undecided
Subject: ZTS: Remove non-standard awk hex numbers usage
Review: The commit removes non-standard awk usage in ZFS test scripts to align with FreeBSD's awk changes, ensuring tests continue to run correctly.
Body:

  FreeBSD recently removed non-standard hex numbers support from awk.
  Neither it supports -n argument, enabling it in gawk.  Instead of
  depending on those rewrite list_file_blocks() fuction to handle the
  hex math in shell instead of awk.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Signed-off-by:Alexander Motin <mav@FreeBSD.org>
  Sponsored by: iXsystems, Inc.
  Closes #11141


   tests/zfs-tests/include/blkdev.shlib | 19 ++++---------------
   1 file changed, 4 insertions(+), 15 deletions(-)

[commit 3b58dd5e1aa293288335b936b49b0ea15591d274]
Date: 2025-04-30
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: RPM: Hold back incompatible kernel packages on Fedora
Review: The commit addresses a packaging issue specific to Fedora's RPM and ZFS DKMS, which does not affect FreeBSD users or systems.
Body:

  A user reported that when your upgrade your kernel packages on Fedora
  with ZFS installed, only the kernel-devel package gets held back to the
  ZFS-supported version, but not the other kernel packages. So if ZFS only
  supports the 6.13 kernel, Fedora will still happily upgrade the kernel
  RPM to 6.14, but hold back kernel-devel at 6.13, for example.

  This commit includes version checks for the 'kernel-uname-r' dependency,
  typically provided by the 'kernel-core' package.

  Original-patch-by: @jkool702
  Reviewed-by: @jkool702
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17265
  Closes #17271

   rpm/generic/zfs-dkms.spec.in | 6 ++++++
   1 file changed, 6 insertions(+)

[commit f86e7140685c2a5947c0ffedeb143614647a64a5]
Date: 2025-01-06
Score: 5
Status: proposed(include=no,score=25)
Sponsor: 
Section: undecided
Subject: Support for cross-compiling kernel modules
Review: The build system now supports cross-compiling kernel modules by recognizing KERNEL_-prefixed environment variables for ARCH and CROSS_COMPILE, enabling cross-compilation setups.
Body:

  In order to correctly cross-compile, one has to pass ARCH and
  CROSS_COMPILE make flags to kernel module build calls. Facilitate this
  in the same way as for custom CC flag by recognizing KERNEL_-prefixed
  configure environment variables of same name.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: Phil Sutter <phil@nwl.cc>
  Closes #16924


   config/kernel.m4             | 5 +++++
   config/zfs-build.m4          | 2 ++
   module/Makefile.in           | 2 ++
   rpm/generic/zfs-kmod.spec.in | 4 +++-
   rpm/redhat/zfs-kmod.spec.in  | 4 +++-
   5 files changed, 15 insertions(+), 2 deletions(-)

[commit 92ae463715cdfae84e529f756d2ca0d80d48781c]
Date: 2024-11-20
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Ports.packaging
Subject: fix: block incompatible kernel from being installed
Review: The commit adds a conflict rule to the ZFS DKMS RPM spec to prevent installation of incompatible kernels, which helps avoid system breakage after kernel updates.
Body:

  The current "Requires" lines only ensure the old kernel is
  available on the system but it does not prevent fedora from
  updating to an incompatible and breaking user's system.

  Set Conflicts to block incompatible kernels from being installed.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Signed-off-by: tleydxdy <shironeko.github@tesaguri.club>
  Closes #16139

   rpm/generic/zfs-dkms.spec.in | 1 +
   1 file changed, 1 insertion(+)

[commit b86e4bdeb9310d3fac5ed38f31f84a9a41528780]
Date: 2025-05-20
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Add Quality Assurance to pull request template
Review: Adds a Quality Assurance checkbox to the pull request template.
Body:

  PRs like #17352 have no applicable checkbox, so let us add one.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Rob Norris <robn@despairlabs.com>
  Signed-off-by: Richard Yao <richard@ryao.dev>
  Closes #17354

   .github/PULL_REQUEST_TEMPLATE.md | 1 +
   1 file changed, 1 insertion(+)

[commit 0b742a94cad9802ec52a0852bc0c42fd5ca29518]
Date: 2025-05-13
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: runners: Add option to install custom kernel on Fedora
Review: Adds an option to install a custom kernel from Fedora experimental repositories on GitHub runners for testing ZFS with newer kernels.
Body:

  Allow installing a custom kernel version from the Fedora experimental
  kernel repos onto the github runners.  This is useful for testing if
  ZFS works against a newer kernel.

  Fedora has a number of repos with experimental kernel packages. This
  PR allows installs from kernels in these repos:

  @kernel-vanilla/stable
  @kernel-vanilla/mainline
  (https://fedoraproject.org/wiki/Kernel_Vanilla_Repositories)

  You will need to manually kick of a github runner to test with a custom
  kernel version.  To do that, go to the github actions tab under
  'zfs-qemu' and click the drop-down for 'run workflow'.  In there you
  will see a text box to specify the version (like '6.14').  The scripts
  will do their best to match the version to the newest matching version
  that the repos support (since they're may be multiple nightly versions
  of, say, '6.14').  A full list of kernel versions can be seen in the
  dependency stage output if you kick off a manual run.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17156

   .github/workflows/scripts/qemu-3-deps-vm.sh | 26 ++++++++++++++++++++++++++
   .github/workflows/scripts/qemu-3-deps.sh    | 15 ++++++++++++++-
   .github/workflows/zfs-qemu.yml              | 17 +++++++++++++++--
   3 files changed, 55 insertions(+), 3 deletions(-)

[commit ebab942b13bda8a195e09d7e169747457ce301d9]
Date: 2025-04-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ZTS: Optimize KSM on Linux and remove it for FreeBSD
Review: The commit modifies CI workflow scripts for ZFS test suite performance tuning, which is internal infrastructure without direct user impact.
Body:

  Don't use KSM on the FreeBSD VMs and optimize KSM settings for
  Linux to have faster run times.

  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes #17247

   .github/workflows/scripts/generate-ci-type.py |  1 +
   .github/workflows/scripts/qemu-1-setup.sh     | 44 ++++++---------------------
   .github/workflows/scripts/qemu-2-start.sh     | 19 ++++++++++--
   .github/workflows/scripts/qemu-5-setup.sh     | 34 ++++++++-------------
   .github/workflows/scripts/qemu-6-tests.sh     | 15 ++++++---
   .github/workflows/scripts/qemu-7-prepare.sh   |  4 +--
   .github/workflows/scripts/qemu-8-summary.sh   |  2 +-
   7 files changed, 53 insertions(+), 66 deletions(-)

[commit 254b6f35191e7075326494997c57e2d29a7cf71f]
Date: 2025-04-28
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ZTS: Use Ubuntu default url for cloud-image
Review: Updates the ZFS Test Suite (ZTS) to use the Ubuntu default URL for cloud images in its QEMU startup script. This change affects automated testing environments that rely on fetching cloud images.
Body:

  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes #17278

   .github/workflows/scripts/qemu-2-start.sh | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 2281350b516284cfa2cec6f7b595e27df48d8f4d]
Date: 2025-04-23
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: ZTS: Update FreeBSD version numbers
Review: Updates version numbers in ZFS test suite automation scripts for FreeBSD 13, 14, and 15 release, stable, and current branches.
Body:

  All defined variants:
  - freebsd13-4r, freebsd13-5r, freebsd14-1r, freebsd14-2r (RELEASE)
  - freebsd13-5s, freebsd14-2s (STABLE)
  - freebsd15-0c (CURRENT)

  Used for testing:
  - freebsd13-4r (RELEASE)
  - freebsd14-2s (STABLE)
  - freebsd15-0c (CURRENT)

  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes: #17260

   .github/workflows/scripts/qemu-2-start.sh   | 23 +++++++++++++++++------
   .github/workflows/scripts/qemu-3-deps-vm.sh |  1 +
   .github/workflows/zfs-qemu.yml              |  2 +-
   3 files changed, 19 insertions(+), 7 deletions(-)

[commit d122a9f2e8ccce1fd7ccbbdecdb46d82a8da8088]
Date: 2025-04-16
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: CI: Add Fedora 42 runner (#17249)
Review: Adds support for Fedora 42 as a CI runner in the ZFS test suite.
Body:

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>

   .github/workflows/scripts/qemu-2-start.sh   | 5 +++++
   .github/workflows/scripts/qemu-3-deps-vm.sh | 3 +++
   .github/workflows/zfs-qemu-packages.yml     | 2 +-
   .github/workflows/zfs-qemu.yml              | 4 ++--
   4 files changed, 11 insertions(+), 3 deletions(-)

[commit bc01722a19a6de18fc22dc30373d7ecddbe688f8]
Date: 2025-03-26
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: runners: Fix tarball build for zfs-qemu-packages workflow (#17158)
Review: The commit fixes an internal build issue for a GitHub Actions workflow related to ZFS packages, but it does not introduce any user-visible changes, new features, or configuration impacts for FreeBSD users.
Body:

  The initial tarballs we built for for zfs-2.3.1 were incorrect since
  they did not have a ./configure script, and their files were not
  in a top level zfs-2.3.1/ directory.  This commit copies the way we
  built them on buildbot so the tarballs are created as expected.

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>

   .github/workflows/scripts/qemu-4-build-vm.sh | 28 ++++++++++++++++++----------
   1 file changed, 18 insertions(+), 10 deletions(-)

[commit 7a008070c0c9e3def17553ef8b442a967279bfe6]
Date: 2025-03-26
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: runners: Fix zfs-release RPM creation (#17173)
Review: The commit fixes an internal workflow issue with RPM artifact copying that does not affect FreeBSD users or systems.
Body:

  The zfs-qemu-packages workflow was incorrectly copying the built
  zfs-release RPMs to ~/zfsonlinux.github.com rather than ~/zfs.  This
  meant that the RPMs were not being correctly picked in the artifacts
  files.  This fixes the issue.

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: @ImAwsumm
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>

   .github/workflows/scripts/qemu-4-build-vm.sh | 5 +++--
   1 file changed, 3 insertions(+), 2 deletions(-)

[commit e6463a6281da93c8cbacb6d3cae6ea39e4dd8c7a]
Date: 2025-03-20
Score: 5
Status: proposed(include=no,score=15)
Sponsor: iXsystems, Inc.
Section: undecided
Subject: CI: Remove FreeBSD 13.3 and 14.1 tests (#17162)
Review: Removes FreeBSD 13.3 and 14.1 from CI testing due to end of support and resource constraints.
Body:

  They are out of support and we are really low on CI resources.

  Signed-off-by:	Alexander Motin <mav@FreeBSD.org>
  Sponsored by:	iXsystems, Inc.
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: George Melikov <mail@gmelikov.ru>

   .github/workflows/scripts/qemu-2-start.sh | 13 -------------
   .github/workflows/zfs-qemu.yml            |  6 +++---
   2 files changed, 3 insertions(+), 16 deletions(-)

[commit 3587fc6c94e9653cc44d08380d78c718be181949]
Date: 2025-03-05
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: Add 'zfs-qemu-packages' workflow for RPM building
Review: Adds a new GitHub workflow for building and testing ZFS RPM packages, intended for ZFS administrators. This is an internal development tool and does not affect FreeBSD users directly.
Body:

  Add a new 'zfs-qemu-packages' GH workflow for manually building RPMs
  and test installing ZFS RPMs from a yum repo. The workflow has a
  dropdown menu in the Github runners tab with two options:

  Build RPMs - Build release RPMs and tarballs and put them into an
               artifact ZIP file.  The directory structure used in
               the ZIP file mirrors the ZFS yum repo.

  Test repo -  Test install the ZFS RPMs from the ZFS repo.  On
               Almalinux, this will do a DKMS and KMOD test install
               from both the regular and testing repos.  On Fedora,
               it will do a DKMS install from the regular repo.  All
               test install results will be displayed in the Github
               runner Summary page. Note that the workflow provides an
               optional text box where you can specify the full URL to
               an alternate repo.  If left blank, it will install from
               the default repo from the zfs-release RPM.

  Most developers will never need to use this workflow.  It is intended
  to be used by the ZFS admins for building and testing releases.

  This commit also modularizes many of the runner scripts so they can
  be used by both the zfs-qemu and zfs-qemu-packages workflows.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17005

   .github/workflows/checkstyle.yaml                  |   2 +-
   .github/workflows/scripts/qemu-2-start.sh          |   9 +
   .github/workflows/scripts/qemu-3-deps-vm.sh        | 232 +++++++++++++
   .github/workflows/scripts/qemu-3-deps.sh           | 238 +------------
   .github/workflows/scripts/qemu-4-build-vm.sh       | 370 +++++++++++++++++++++
   .github/workflows/scripts/qemu-4-build.sh          | 150 +--------
   .github/workflows/scripts/qemu-5-setup.sh          |   4 +-
   .github/workflows/scripts/qemu-7-prepare.sh        |   5 +-
   .../workflows/scripts/qemu-prepare-for-build.sh    |   8 +
   .github/workflows/scripts/qemu-test-repo-vm.sh     |  90 +++++
   .github/workflows/scripts/qemu-wait-for-vm.sh      |  10 +
   .../scripts/replace-dupes-with-symlinks.sh         |  32 ++
   .github/workflows/zfs-qemu-packages.yml            | 140 ++++++++
   .github/workflows/zfs-qemu.yml                     |  31 +-
   .github/workflows/zloop.yml                        |   2 +-
   15 files changed, 917 insertions(+), 406 deletions(-)

[commit 6a91dd3d1a728fc440e5145e362b0b23ea3b4ed6]
Date: 2025-01-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ZTS: add centos stream10 (#16904)
Review: The commit adds CentOS Stream 10 as an optional test runner in GitHub Actions for ZFS testing, which is an internal CI/CD change without direct user impact.
Body:

  Added centos as optional runners via workflow_dispatch

  removed centos-stream9 from the FULL_OS runner list as CentOS is not
  officially support by ZFS. This commit will add preliminary support for
  EL10 and allow testing ZFS ahead of EL10 codebase solidifying in ~6
  months

  Signed-off-by: James Reilly <jreilly1821@gmail.com>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>

   .github/workflows/scripts/qemu-2-start.sh |  6 ++++++
   .github/workflows/scripts/qemu-3-deps.sh  |  2 +-
   .github/workflows/zfs-qemu.yml            | 27 ++++++++++++++++++++++++++-
   3 files changed, 33 insertions(+), 2 deletions(-)

[commit e7876b0dc9639aeb30e70deb66a28eed3c8f97dc]
Date: 2024-12-19
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: CI: Fix FreeBSD 13.4 STABLE build
Review: The commit adds an rtl8139 NIC to a VM in a CI script to work around a buggy virtio NIC in FreeBSD 13.x, but this is an internal CI infrastructure change with no direct user-visible impact on FreeBSD releases.
Body:

  In #16869 we added FreeBSD 13.4 STABLE, but forget the special
  thing, that the virtio nic within FreeBSD 13.x is buggy.

  This fix adds the needed rtl8139 nic to the VM.

  Reviewed-by: George Melikov <mail@gmelikov.ru>
  Reviewed-by:  Alexander Motin <mav@FreeBSD.org>
  Signed-off-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Closes #16885

   .github/workflows/scripts/qemu-2-start.sh | 1 +
   1 file changed, 1 insertion(+)

[commit 5de9d00311b64a17c92838c410eff3136a173cbf]
Date: 2024-12-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: CI: Add FreeBSD 14.2 RELEASE+STABLE builds
Review: The commit updates CI configuration to add FreeBSD 14.2 builds, which is an internal infrastructure change without user-visible impact.
Body:

  Update the CI to include FreeBSD 14.2 as a regularly tested platform.

  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Signed-off-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes #16869

   .github/workflows/scripts/qemu-2-start.sh | 20 ++++++++++----------
   .github/workflows/zfs-qemu.yml            |  9 +++++----
   2 files changed, 15 insertions(+), 14 deletions(-)

[commit e665098c8588c115f336fb8d3330a108b990d6bf]
Date: 2024-11-04
Score: 5
Status: proposed(include=no,score=10)
Sponsor: iXsystems, Inc.
Section: undecided
Subject: CI: Automate some GitHub PR status labels manipulations
Review: The commit adds automation for GitHub PR label management, which is an internal infrastructure change without direct user-visible impact.
Body:

  - Set/remove "Work in Progress"/"Code Review Needed" for drafts.
   - Remove "Accepted", "Inactive", "Revision Needed" and "Stale" on
  pushes and reopens.

  I hope this reduce chances of PRs being forgotten after requested
  modifications done due to stale labels.  It is better to have no
  labels than incorrect ones saying there is nothing to look at.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by:	Alexander Motin <mav@FreeBSD.org>
  Sponsored by:	iXsystems, Inc.
  Closes #16721

   .github/workflows/labels.yml | 49 ++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 49 insertions(+)

[commit be72364ad64ac3c350cbd47130794db254fc77b0]
Date: 2025-05-06
Score: 5
Status: proposed(include=no,score=40)
Sponsor: iXsystems, Inc.
Section: undecided
Subject: ARC: Avoid overflows in arc_evict_adj() (#17255)
Review: The ARC eviction adjustment logic now includes limits to prevent overflow conditions, improving stability under certain workloads.
Body:

  With certain combinations of target ARC states balance and ghost
  hit rates it was possible to get the fractions outside of allowed
  range.  This patch limits maximum balance adjustment speed, which
  should make it impossible, and also asserts it.

  Fixes #17210
  Signed-off-by:	Alexander Motin <mav@FreeBSD.org>
  Sponsored by:	iXsystems, Inc.
  Reviewed-by: Rob Norris <robn@despairlabs.com>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  (cherry picked from commit b1ccab17213b38aa269e85c6b371d69eb25b6ca9)
  (cherry picked from commit 677cb91ffee6d54501c96323c6308a024cb62268)


   module/zfs/arc.c | 15 ++++++++++-----
   1 file changed, 10 insertions(+), 5 deletions(-)

[commit 827fd20d07a46879c66bb6899ad1d780845b1b6c]
Date: 2025-05-20
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Storage.general
Subject: dmu_objset_hold_flags() should call dsl_dataset_rele_flags() on error
Review: Fixes a reference counting error in ZFS that could lead to resource leaks or system instability.
Body:

  This was caught when doing a manual check to see if #17352 needed to be
  improved to catch mismatches across stack frames of the kind that were
  first found in #17340.

  Reviewed-by: George Amanakis <gamanakis@gmail.com>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Signed-off-by: Richard Yao <richard@ryao.dev>
  Closes #17353
  (cherry picked from commit 83fa80a5500ed7baccedfa90ad55ac879af710c9)
  (cherry picked from commit 07d815f2a06573514f51c8601aa60db6fe1a76ad)


   module/zfs/dmu_objset.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 3a84c630f2361763f8cd1390847677dfe8fb0b01]
Date: 2025-04-08
Score: 5
Status: proposed(include=no,score=35)
Sponsor: 
Section: undecided
Subject: Linux 6.2/6.15: del_timer_sync() renamed to timer_delete_sync()
Review: The commit updates the Linux kernel compatibility layer to handle a rename of del_timer_sync() to timer_delete_sync() in Linux 6.2 and removal of the wrapper in 6.15, ensuring continued functionality for ZFS on newer Linux kernels.
Body:

  Renamed in 6.2, and the compat wrapper removed in 6.15. No signature or
  functional change apart from that, so a very minimal update for us.

  Sponsored-by: https://despairlabs.com/sponsor/
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Pavel Snajdr <snajpa@snajpa.net>
  Signed-off-by: Rob Norris <robn@despairlabs.com>
  Closes #17229
  (cherry picked from commit 841be1d0495224a47d3dbfd8647c7fcbf58b205c)
  (cherry picked from commit 1dc9becb962c7355fef0fb2ba42fe23168d8b6b2)


   config/kernel-timer.m4          | 32 ++++++++++++++++++++++++++++++++
   config/kernel.m4                |  2 ++
   module/os/linux/spl/spl-taskq.c |  7 ++++++-
   3 files changed, 40 insertions(+), 1 deletion(-)

[commit 3f94332a7ada27c71b813df405b5e6c87e57e9db]
Date: 2025-04-04
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Drivers.device
Subject: Linux 6.15: mkdir now returns struct dentry *
Review: The commit updates the Linux compatibility layer for ZFS to handle changes in Linux kernel 6.15's mkdir interface, which now returns a struct dentry pointer. This ensures ZFS remains compatible with newer Linux kernels, affecting users running ZFS on Linux-based systems.
Body:

  The intent is that the filesystem may have a reference to an "old"
  version of the new directory, eg if it was keeping it alive because a
  remote NFS client still had it open.

  We don't need anything like that, so this really just changes things so
  we return error codes encoded in pointers.

  Sponsored-by: https://despairlabs.com/sponsor/
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Pavel Snajdr <snajpa@snajpa.net>
  Signed-off-by: Rob Norris <robn@despairlabs.com>
  Closes #17229
  (cherry picked from commit bb740d66de2b03a24bd7bfc9cef1844ad3e22a74)


   config/kernel-mkdir.m4           | 57 +++++++++++++++++++++++++++++-----------
   module/os/linux/zfs/zpl_ctldir.c | 12 ++++++++-
   module/os/linux/zfs/zpl_inode.c  | 17 +++++++++---
   3 files changed, 67 insertions(+), 19 deletions(-)

[commit 050517c41b0ce7f85712cfd2d0c460ac40951503]
Date: 2025-05-19
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: icp: Use explicit_memset() exclusively in gcm_clear_ctx()
Review: The commit replaces memset() with explicit_memset() in the gcm_clear_ctx() function to prevent compiler optimizations from removing sensitive data clearing, enhancing security against potential information leaks.
Body:

  d634d20d1be31dfa8cf06ef2dc96285baf81a2fb had been intended to fix a
  potential information leak issue where the compiler's optimization
  passes appeared to remove `memset()` operations that sanitize sensitive
  data before memory is freed for use by the rest of the kernel.

  When I wrote it, I had assumed that the compiler would not remove the
  other `memset()` operations, but upon reflection, I have realized that
  this was a bad assumption to make. I would rather have a very slight
  amount of additional overhead when calling `gcm_clear_ctx()` than risk a
  future compiler remove `memset()` calls. This is likely to happen if
  someone decides to try doing link time optimization and the person will
  not think to audit the assembly output for issues like this, so it is
  best to preempt the possibility before it happens.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Rob Norris <robn@despairlabs.com>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Jorgen Lundman <lundman@lundman.net>
  Signed-off-by: Richard Yao <richard@ryao.dev>
  Closes #17343
  (cherry picked from commit d8a33bc0a5d3b72ab6a0e7930345705e1d3d954b)


   module/icp/algs/modes/modes.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit b144b160b65206518412a133d8246579d03c7811]
Date: 2025-05-19
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Storage.general
Subject: Fix 2 bugs in non-raw send with encryption
Review: Fixes a bug in non-raw send with encryption that could cause a kernel panic when exporting the sending pool or unloading the zfs module after a send from an encrypted filesystem.
Body:

  Bisecting identified the redacted send/receive as the source of the bug
  for issue #12014. Specifically the call to
  dsl_dataset_hold_obj(&fromds) has been replaced by
  dsl_dataset_hold_obj_flags() which passes a DECRYPT flag and creates
  a key mapping. A subsequent dsl_dataset_rele_flag(&fromds) is missing
  and the key mapping is not cleared. This may be inadvertedly used, which
  results in arc_untransform failing with ECKSUM in:
   arc_untransform+0x96/0xb0 [zfs]
   dbuf_read_verify_dnode_crypt+0x196/0x350 [zfs]
   dbuf_read+0x56/0x770 [zfs]
   dmu_buf_hold_by_dnode+0x4a/0x80 [zfs]
   zap_lockdir+0x87/0xf0 [zfs]
   zap_lookup_norm+0x5c/0xd0 [zfs]
   zap_lookup+0x16/0x20 [zfs]
   zfs_get_zplprop+0x8d/0x1d0 [zfs]
   setup_featureflags+0x267/0x2e0 [zfs]
   dmu_send_impl+0xe7/0xcb0 [zfs]
   dmu_send_obj+0x265/0x360 [zfs]
   zfs_ioc_send+0x10c/0x280 [zfs]

  Fix this by restoring the call to dsl_dataset_hold_obj().

  The same applies for to_ds: here replace dsl_dataset_rele(&to_ds) with
  dsl_dataset_rele_flags().

  Both leaked key mappings will cause a panic when exporting the
  sending pool or unloading the zfs module after a non-raw send from
  an encrypted filesystem.

  Contributions-by: Hank Barta <hbarta@gmail.com>
  Contributions-by: Paul Dagnelie <paul.dagnelie@klarasystems.com>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Richard Yao <richard.yao@alumni.stonybrook.edu>
  Reviewed-by: Rob Norris <robn@despairlabs.com>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Signed-off-by: George Amanakis <gamanakis@gmail.com>
  Closes #12014
  Closes #17340
  (cherry picked from commit ea74cdedda8b9575d7e94198d38f12943ac41343)


   module/zfs/dmu_send.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 20bf8c6638d031927ce6a0e7d36d1fb866101c3b]
Date: 2025-05-14
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: iXsystems, Inc.
Section: Hardware.virtualization
Subject: Linux: Stop using NR_FILE_PAGES for ARC scaling
Review: The ZFS ARC scaling calculation in Linux environments now uses NR_ACTIVE_FILE + NR_INACTIVE_FILE instead of NR_FILE_PAGES, which prevents incorrect memory accounting in QEMU/KVM guests and avoids OOM conditions.
Body:

  I've found that QEMU/KVM guest memory accounted as shared also
  included into NR_FILE_PAGES.  But it is actually a non-evictable
  anonymous memory.  Using it as a base for zfs_arc_pc_percent
  parameter makes ARC to ignore shrinker requests while page cache
  does not really have anything to evict, ending up in OOM killer
  killing the QEMU process.

  Instead use of NR_ACTIVE_FILE + NR_INACTIVE_FILE should represent
  the part of a page cache that is actually evictable, which should
  be safer to use as a reference for ARC scaling.

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Ameer Hamza <ahamza@ixsystems.com>
  Reviewed-by: Pavel Snajdr <snajpa@snajpa.net>
  Signed-off-by:	Alexander Motin <mav@FreeBSD.org>
  Sponsored by:	iXsystems, Inc.
  Closes #17334
  (cherry picked from commit 0aa83dce99e47ccd533be24b82332268766b68db)


   include/os/linux/kernel/linux/page_compat.h | 4 ++--
   man/man4/zfs.4                              | 4 +++-
   2 files changed, 5 insertions(+), 3 deletions(-)

[commit c88e5a380c6aa1cc1bc83383f1489372b34c4419]
Date: 2025-04-10
Score: 5
Status: proposed(include=no,score=65)
Sponsor: 
Section: undecided
Subject: Linux 6.0 compat: Check for migratepage VFS
Review: The commit adds compatibility checks for the removed 'migratepage' VFS operation in Linux kernel 6.0, ensuring ZFS continues to function correctly on newer Linux kernels.
Body:

  The 6.0 kernel removes the 'migratepage' VFS op. Check for
  migratepage.

  Signed-off-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Rob Norris <robn@despairlabs.com>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org
  Closes #17217
  (cherry picked from commit ab9bb193f9937fef5277b18228b74a1de48e40d3)


   config/kernel-vfs-migratepage.m4 | 27 +++++++++++++++++++++++++++
   config/kernel.m4                 |  2 ++
   module/os/linux/zfs/zpl_file.c   |  2 +-
   3 files changed, 30 insertions(+), 1 deletion(-)

[commit 8d19d971bc69c9778ecf2d624123eb6011586c3d]
Date: 2024-11-03
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: Use simple folio migration function
Review: The commit addresses a kernel migration issue that could cause unnecessary writeback and a BUG in migrate_folio_extra, potentially affecting system stability during memory management operations.
Body:

  Avoids using fallback_migrate_folio, which starts unnecessary writeback
  (leading to BUG in migrate_folio_extra).

  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Brian Atkinson <batkinson@lanl.gov>
  Signed-off-by: tstabrawa <59430211+tstabrawa@users.noreply.github.com>
  Closes #16568
  Closes #16723
  (cherry picked from commit 7b6e9675daefcc94393293c46e4672e66490757d)


   config/kernel-vfs-migrate_folio.m4 | 27 +++++++++++++++++++++++++++
   config/kernel.m4                   |  2 ++
   module/os/linux/zfs/zpl_file.c     |  6 ++++++
   3 files changed, 35 insertions(+)

[commit 9631ecf8bd2c7e6b92b5fa0ef00318fe708ff678]
Date: 2025-03-25
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: 
Section: Storage.general
Subject: Linux: Fix zfs_prune panics v2
Review: Fixes a panic in the Linux kernel compatibility layer for ZFS when pruning snapshots.
Body:

  It turns out that approach taken in the original version of the patch
  was wrong. So now, we're taking approach in-line with how kernel
  actually does it - when sb is being torn down, access to it
  is serialized via sb->s_umount rwsem, only when that lock is taken
  is it okay to work with s_flags - and the other mistake I was doing
  was trying to make SB_ACTIVE work, but apparently the kernel checks
  the negative variant - not SB_DYING and not SB_BORN.

  Kernels pre-6.6 don't have SB_DYING, but check if sb is hashed
  instead.

  Signed-off-by: Pavel Snajdr <snajpa@snajpa.net>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Closes: #17121
  (cherry picked from commit a0e62718cfcffd149b797ff9094ae2f009752f43)


   config/kernel-sb-dying.m4       | 19 +++++++++++++++++++
   config/kernel.m4                |  2 ++
   module/os/linux/zfs/zpl_super.c | 26 +++++++++++++++++---------
   3 files changed, 38 insertions(+), 9 deletions(-)

[commit 8ff37c68d2ab2754577ebe6e473179e84a158414]
Date: 2025-03-12
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Hardware.virtualization
Subject: linux: zvols: correctly detect flush requests
Review: The commit fixes a regression in ZFS zvols where flush requests from Linux guests were not correctly detected, causing sync writes to be treated as async. This affects virtual machines using zvols as block devices, such as with Qemu, leading to incorrect performance reporting and potential data integrity issues.
Body:

  since 4.10, bio->bi_opf needs to be checked to determine all kinds of
  flush requests. this was the case prior to the commit referenced below,
  but the order of ifdefs was not the usual one (newest up top), which
  might have caused this to slip through.

  this fixes a regression when using zvols as Qemu block devices, but
  might have broken other use cases as well. the symptoms are that all
  sync writes from within a VM configured to use such a virtual block
  devices are ignored and treated as async writes by the host ZFS layer.

  this can be verified using fio in sync mode inside the VM, for example
  with

   fio \
   --filename=/dev/sda --ioengine=libaio --loops=1 --size=10G \
   --time_based --runtime=60 --group_reporting --stonewall --name=cc1 \
   --description="CC1" --rw=write --bs=4k --direct=1 --iodepth=1 \
   --numjobs=1 --sync=1

  which shows an IOPS number way above what the physical device underneath
  supports, with "zpool iostat -r 1" on the hypervisor side showing no
  sync IO occuring during the benchmark.

  with the regression fixed, both fio inside the VM and the IO stats on
  the host show the expected numbers.

  Fixes: 846b5985192467acabf5484ae610b4b37b7f8162
  "config: remove HAVE_REQ_OP_* and HAVE_REQ_*"

  Signed-off-by: Fabian-Gruenbichler <f.gruenbichler@proxmox.com>
  Co-authored-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Closes #17131
  (cherry picked from commit 41823a0ede88377c39ad218ddd1e60776ea5f466)


   include/os/linux/kernel/linux/blkdev_compat.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit aa6ceb7bd6f5ebd96ad85cfa91e75574f05d5fe2]
Date: 2025-02-05
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Linux 6.14: dops->d_revalidate now takes four args
Review: The commit adjusts the Linux compatibility layer for ZFS to support a new Linux kernel interface, but it does not introduce any user-visible changes in FreeBSD's behavior, features, or configuration.
Body:

  This is a convenience for filesystems that need the inode of their
  parent or their own name, as its often complicated to get that
  information. We don't need those things, so this is just detecting which
  prototype is expected and adjusting our callback to match.

  Sponsored-by: https://despairlabs.com/sponsor/
  Signed-off-by: Rob Norris <robn@despairlabs.com>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  (cherry picked from commit 7ef6b70e960a7cc504242952699057f0ee616449)


   config/kernel-automount.m4       | 41 ++++++++++++++++++++++++++++++++++++++--
   module/os/linux/zfs/zpl_ctldir.c |  6 ++++++
   2 files changed, 45 insertions(+), 2 deletions(-)

[commit 36225ba97998deadc505e4207fe598a88b2de214]
Date: 2025-05-12
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: linux/uio: remove "skip" offset for UIO_ITER
Review: The commit removes a skip offset handling for UIO_ITER in the Linux compatibility layer of ZFS, which could cause incorrect iterator positioning or memory access errors.
Body:

  For UIO_ITER, we are just wrapping a kernel iterator. It will take care
  of its own offsets if necessary. We don't need to do anything, and if we
  do try to do anything with it (like advancing the iterator by the skip
  in zfs_uio_advance) we're just confusing the kernel iterator, ending up
  at the wrong position or worse, off the end of the memory region.

  Sponsored-by: https://despairlabs.com/sponsor/
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Tino Reichardt <milky-zfs@mcmilk.de>
  Reviewed-by: Brian Atkinson <batkinson@lanl.gov>
  Signed-off-by: Rob Norris <robn@despairlabs.com>
  Closes #17298
  (cherry picked from commit 2ee5b51a57cb45992fb783ffa95c7fbea19153ed)


   include/os/linux/spl/sys/uio.h | 4 ++--
   module/os/linux/zfs/zfs_uio.c  | 3 ---
   module/os/linux/zfs/zpl_file.c | 3 ++-
   3 files changed, 4 insertions(+), 6 deletions(-)

[commit 9ccf7aeaa5dc5ceb3bf896d84ee50294b841043b]
Date: 2025-05-26
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: mark struct ieee80211_ht_cap __packed
Review: The LinuxKPI 802.11 compatibility layer now correctly handles HT capability information, preventing potential firmware crashes and incorrect MCS calculations for wireless drivers.
Body:

  In lkpi_sta_sync_ht_from_ni() we are casting the information element (IE)
  data to this struct as net80211 does not save the mcs/rx_mask.
  Not marking the structs packed results in the mcs information not being
  copied correctly and rx_nss calculations possibly being off.  Even worse,
  at a later stage iwlwifi mvm/rs.c would extract the mcs values from the
  same field to pass to the firmware which will than crash in an assert
  as we would want to do HT with an empty MCS set.

  Sponsored by:	The FreeBSD Foundation
  Discovered:	while testing other features on arm64.

  (cherry picked from commit 6cbf8a04b1864d933506301cabe213a9c918d968)


   sys/compat/linuxkpi/common/include/linux/ieee80211.h | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 9a4e5a8a714cf8f5497b7c9b8944a13e19be0eb7]
Date: 2025-05-18
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: pciconf(8): Dump the correct number of bytes
Review: The man:pciconf[8] utility now dumps the correct number of bytes for PCI configuration space, ensuring accurate hardware information display.
Body:

  The loop variable should be incremented by 1 and not the width.

  Reviewed by:	kib
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D50422

  (cherry picked from commit 9fb60477fe260da2db029baebe63331d0f584a3d)


   usr.sbin/pciconf/pciconf.c | 8 ++++----
   1 file changed, 4 insertions(+), 4 deletions(-)

[commit 3fb4073c4c8cd1f7f4706bc7750a7551f3ae08aa]
Date: 2025-05-18
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Chelsio Communications
Section: Userland.programs
Subject: pciconf(8): Fix the -x option and its documentation
Review: The man:pciconf[8] -x option now correctly displays extended configuration registers, and its documentation is updated to reflect the fix.
Body:

  Reviewed by:	kib
  Sponsored by:	Chelsio Communications
  Differential Revision:	https://reviews.freebsd.org/D50421

  (cherry picked from commit 79aba7a0ca8468da36551e66d24e0b3385d8e328)


   usr.sbin/pciconf/pciconf.8 | 4 ++--
   usr.sbin/pciconf/pciconf.c | 2 +-
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 30f092c40ad4eb592861839f4ffa9e9891abf1d3]
Date: 2025-05-27
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: MAC/do: Fix a too stringent debug assertion for a target of 'uid=*'
Review: The commit fixes a debug assertion in the MAC/do module that only affects INVARIANTS builds, with no user-visible impact on production systems.
Body:

  MDF_HAS_PRIMARY_CLAUSE only concerns groups, not users, and is thus not
  set in the latter case.

  This change only has an effect on INVARIANTS builds.

  PR:             287057
  MFC after:      10 minutes
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit b5c9889e369a801ce7c1115f2535ddacbd69800d)


   sys/security/mac_do/mac_do.c | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit 33624770a87df04ce4834b03601dd2bdbce8e5ed]
Date: 2025-04-04
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: net/if_bridgevar.h: add include guard
Review: Adds an include guard to the bridge interface header file, preventing potential compilation issues when the header is included multiple times.
Body:

  Reviewed by:	kp
  Approved by:	des (mentor)

  (cherry picked from commit f6aedb956ef154828c4bfaddaa5d5eb2dda5225c)


   sys/net/if_bridgevar.h | 5 +++++
   1 file changed, 5 insertions(+)

[commit c200e184cc3948ce9109e6b374a8e204676fb0bd]
Date: 2025-05-24
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: kern_fork.c: style
Review: Only style changes with no user-visible impact.
Body:

  (cherry picked from commit 9137de9a1b5fdbd77880344820d55e2f05883e53)


   sys/kern/kern_fork.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e57eeaf54cb83b3d38b5a16dd7e9e37e7adf13d6]
Date: 2025-05-16
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: pthread_signals_block_np(3): document
Review: Adds man: pthread_signals_block_np(3) manual page.
Body:

  (cherry picked from commit 1393f9a36b9c471d4af3518a3d3bb56c2a6adc58)


   share/man/man3/Makefile                   |  3 ++
   share/man/man3/pthread_np.3               |  6 +++
   share/man/man3/pthread_signals_block_np.3 | 81 +++++++++++++++++++++++++++++++
   3 files changed, 90 insertions(+)

[commit b3188948394e1fa5f2413857b5d1c5d4c449c13e]
Date: 2025-05-16
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.libraries
Subject: libthr: add stable user interface for sigfastblock(2)
Review: The libthr library now provides a stable user interface for the sigfastblock(2) system call, allowing applications to use this signal handling optimization.
Body:

  (cherry picked from commit 31760ee65ae3e79434fb257d93e17a6de6021f48)


   include/pthread_np.h        |  2 ++
   lib/libthr/pthread.map      |  2 ++
   lib/libthr/thread/thr_sig.c | 19 +++++++++++++++++++
   3 files changed, 23 insertions(+)

[commit 39f4425021678ee9069aa15946c4946e0bdd49e3]
Date: 2025-05-16
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Userland.deprecated
Subject: pthread_switch_add_np(3): remove
Review: The pthread_switch_add_np(3) function is removed from the system. This change affects applications that rely on this non-portable pthread extension.
Body:

  (cherry picked from commit c0fdd2bf944bb646116c6cd9879560579ebaa563)


   include/pthread_np.h                   |  7 ---
   lib/libthr/thread/thr_switch_np.c      |  5 +-
   share/man/man3/Makefile                |  2 -
   share/man/man3/pthread_np.3            | 10 ----
   share/man/man3/pthread_switch_add_np.3 | 86 ----------------------------------
   5 files changed, 4 insertions(+), 106 deletions(-)

[commit cab029073dc6cb5814df44556e585b8fdb1c9846]
Date: 2025-05-18
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: libc++: fix compiling <locale> with -fmodules
Review: Fixes a compilation error when building C++ code with -fmodules due to missing includes in libc++ locale headers.
Body:

  In /usr/include/c++/v1/__locale_dir/locale_base_api.h, xlocale.h is
  included without first including stdio.h and stdlib.h, which causes
  functions like strtoll_l() or sscanf_l() to not be declared.

  When compiling with -fmodules, locale_base_api.h is processed separately
  due to a declaration in /usr/include/c++/v1/module.modulemap, and this
  will cause errors due to the above undeclared symbols.

  Meanwhile, upstream has substantially reorganized this part of libc++'s
  headers, so apply a minimalistic workaround: specifically when compiling
  with -fmodules, add includes of stdio.h and stdlib.h.

  PR:		286342
  MFC after:	1 week

  (cherry picked from commit c809b0184d0a6543bc5327d4252fa56a07ce4689)


   .../llvm-project/libcxx/include/__locale_dir/locale_base_api.h    | 8 +++++++-
   1 file changed, 7 insertions(+), 1 deletion(-)

[commit 2013ad7490f2a80d3b3260d9811422bbd25a915e]
Date: 2025-05-17
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Storage.general
Subject: nullfs lookup: cn_flags is 64bit
Review: The nullfs file system now correctly handles 64-bit flags in lookups, which may affect compatibility with certain file system operations.
Body:

  (cherry picked from commit 89549c2348170921cc4270ac95bfabfd78d42739)


   sys/fs/nullfs/null_vnops.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 16ad4d77121dd117513c6044c0f076df144fa368]
Date: 2025-05-21
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Userland.contrib
Subject: zoneinfo: don't install version
Review: The version file is no longer installed in /usr/share/zoneinfo, which resolves a compatibility issue with third-party software like rubygem-tzinfo that expects zoneinfo files to be a minimum size.
Body:

  The commit teaching the build to install tzdata.zi for libcxx also
  instals version.  It turns out this makes at least one piece of third
  party software cry: rubygem-tzinfo expects any file in zoneinfo to be at
  least 44 bytes long.  Clearly this is a bug in rubygem-tzinfo but since
  nothing actually uses version, we may as well not install it ... as we
  did previously.

  Reported by:	delphij
  Fixes:		91506dba7f2e zoneinfo: also install tzdata.zi and version
  MFC after:	1 day

  (cherry picked from commit 23a0c88b037625745b88d1661b9552f1ebe97ebc)


   ObsoleteFiles.inc       | 3 +++
   share/zoneinfo/Makefile | 2 --
   2 files changed, 3 insertions(+), 2 deletions(-)

[commit 4e0a5fd7b608d823767ad239db68cb961455ba6b]
Date: 2025-05-09
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.programs
Subject: service(8): Allow for passing no arguments to the service script
Review: The man:service[8] utility now allows running an rc service script without arguments, displaying the script's usage message instead of the service(8) usage message.
Body:

  Currently, service(8) requires the user to provide a command to the
  rc service script. For example,

      service cron

  does not even run the cron rc service script but
  instead shows the usage message of service(8).

  This patch makes it so running the rc service script with no arguments
  via service(8) is closer to running the rc service script directly
  (e.g., /etc/rc.d/cron).

  Long story short, for most of the rc service scripts this change means
  that running "service FOO" now shows the usage message of FOO instead of
  the usage message of service(8).

  PR:		255115
  Reviewed by:	bnovkov, christos, imp, lme, markj
  Approved by:	bnovkov (mentor), christos (mentor), markj (mentor)
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D47328

  (cherry picked from commit 7ffedfe14ca85aa3474980092a732d4e49309c62)


   usr.sbin/service/service.8  | 4 ++--
   usr.sbin/service/service.sh | 2 +-
   2 files changed, 3 insertions(+), 3 deletions(-)

[commit 63b632417430a421d1950ac3c3753cba382fbfc7]
Date: 2025-02-22
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: newsyslog.conf.d/opensm.conf: remove leading blank line
Review: Removes a leading blank line from the newsyslog configuration for opensm.
Body:

  Reviewed by:	jlduran, ivy, kevans
  Approved by:	kevans (mentor)
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1603

  (cherry picked from commit 2d22d54fc4abc1b4901cf62ef3888172df6798cd)


   usr.sbin/newsyslog/newsyslog.conf.d/opensm.conf | 1 -
   1 file changed, 1 deletion(-)

[commit fb6b1a797349992d8f166a2724eab2caf59abe28]
Date: 2024-04-29
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Ports.packaging
Subject: package: fix dependency generation
Review: Package dependency generation is corrected, ensuring packages include all required dependencies.
Body:

  A bug in release/packages/generate-ucl.sh causes package dependencies
  (other than shlib depends) to not be generated correctly, meaning
  packages are missing their dependencies.

  generate-ucl.sh creates the UCL file by:

  1. copying ${uclsource} (template.ucl) to ${uclfile}
  2. appending dependencies to ${uclfile}
  3. calling generate-ucl.lua on ${uclsource} to create ${uclfile}

  This breaks because the dependencies added in step 2 are overwritten in
  step 3.

  Fix this by calling generate-ucl.lua with ${uclfile} as both the input
  and output file, so anything we added to ${uclfile} is preserved.

  PR:	286551
  Reviewed by:	des, imp
  Approved by:	kevans (mentor, stable/14 mfc)
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1203

  (cherry picked from commit e05b6502f9ca36860236644884f12eff8e3243c4)


   release/packages/generate-ucl.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 623ccbc4e4f2ea70b6be7734de7e214b0182b76c]
Date: 2025-05-21
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: sndctl(8): Fix dp->realtime
Review: The sndctl(8) utility now correctly sets the realtime flag for audio devices, fixing a regression where it was always reported as 0.
Body:

  Currently it's automatically set to 0 in read_dev() as a result of
  allocating dp with calloc().

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 day
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D50400

  (cherry picked from commit 30fd79b0c0a328536b166e7fa9170b059e711303)


   usr.sbin/sndctl/sndctl.c | 189 ++++++++++++++++++++++++-----------------------
   1 file changed, 98 insertions(+), 91 deletions(-)

[commit 2af8f2ad42654291ad1fcefba142bcc93976d7f4]
Date: 2025-05-21
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: sndctl(8): Allow read-only sysctls
Review: The man:sndctl[8] utility now allows read-only sysctls to be displayed, which may affect scripts or users relying on its output for monitoring sound system parameters.
Body:

  Needed by follow-up patch.

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 day
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D50398

  (cherry picked from commit 52c4263274031d599aebfaed2862ae85b482953a)


   usr.sbin/sndctl/sndctl.c | 56 +++++++++++++++++++++++++++++-------------------
   1 file changed, 34 insertions(+), 22 deletions(-)

[commit 0325cd325debb26b922c26425a3cc6bc4bcc3896]
Date: 2025-05-21
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sndctl(8): Remove unnecessary val variable from sysctl functions
Review: No user-visible change; internal code cleanup only.
Body:

  No functional change intended.

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 day
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D50397

  (cherry picked from commit ac86e65e0e25a3e3fd6f91b17d2db874cea83c3b)


   usr.sbin/sndctl/sndctl.c | 12 +++++-------
   1 file changed, 5 insertions(+), 7 deletions(-)

[commit 2919a487021a7785bca1c1b059413a26286fe620]
Date: 2025-05-04
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Hardware.virtualization
Subject: bhyve x86: when accessing non-backed gpa, emulate hw
Review: The bhyve hypervisor now emulates hardware behavior when accessing non-backed guest physical addresses, improving compatibility for certain guest operating systems.
Body:

  PR:	286467

  (cherry picked from commit d8c4c2ce68eec8bac4e5cd0d133b8342e7a7f05d)


   usr.sbin/bhyve/amd64/Makefile.inc |  2 +-
   usr.sbin/bhyve/amd64/mem_x86.c    | 82 +++++++++++++++++++++++++++++++++++++++
   2 files changed, 83 insertions(+), 1 deletion(-)

[commit e877ef51e2b3ff351d77e50810413983ec277785]
Date: 2025-05-01
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Hardware.virtualization
Subject: bhyve: make code to handle non-backed memory accesses MD
Review: The bhyve hypervisor now handles non-backed memory accesses in a machine-dependent manner, which may affect guest behavior or compatibility when accessing unmapped memory regions.
Body:

  PR:	286467

  (cherry picked from commit e8b9d839b1fae2913dc861341b9363d41cd45173)


   usr.sbin/bhyve/amd64/Makefile.inc |  1 +
   usr.sbin/bhyve/mem.c              | 26 ++++++++++++++++-------
   usr.sbin/bhyve/mem.h              |  2 ++
   usr.sbin/bhyve/mem_md.c           | 44 +++++++++++++++++++++++++++++++++++++++
   4 files changed, 66 insertions(+), 7 deletions(-)

[commit ded154a1df97e3340f129394cbcaa1a50439d1bf]
Date: 2025-05-19
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: ip17x.4: Initial manual page
Review: Adds a new manual page for the ip17x driver, documenting its inclusion, supported hardware, and availability timeline.
Body:

  Add a stub manual only saying what it is, how to include it, what is
  supported, and since when. This plugs the ip17x driver into the manual
  subsystem and the release hardware notes.

  MFC to:			14.3
  MFC after:		3 days
  Reviewed by:		adrian, carlavilla
  Approved by:		carlavilla (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50411

  (cherry picked from commit f750a114d2c50c4d25d304dbf1dabfd3ae3aa013)


   share/man/man4/Makefile |  1 +
   share/man/man4/ip17x.4  | 42 ++++++++++++++++++++++++++++++++++++++++++
   2 files changed, 43 insertions(+)

[commit f31ac06711e69aed7cb4b38d8eb2aba2d7149ed8]
Date: 2025-05-19
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Docs.manpages
Subject: mtkswitch.4: Initial manual page
Review: The commit adds a manual page for the mtkswitch driver, which documents the driver's purpose, how to include it, and supported hardware. This provides users with official documentation for the driver.
Body:

  Add a stub manual only saying what it is, how to include it, what is
  supported, and since when. This plugs the mtkswitch driver into the
  manual subsystem and the release hardware notes.

  MFC to:			14.3
  MFC after:		3 days
  Reviewed by:		adrian, carlavilla
  Approved by:		carlavilla (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50412

  (cherry picked from commit 37f00bc257d0e785fad1d0ffbd7dcbf09e863417)


   share/man/man4/Makefile    |  1 +
   share/man/man4/mtkswitch.4 | 45 +++++++++++++++++++++++++++++++++++++++++++++
   2 files changed, 46 insertions(+)

[commit 77521692f4c71213c5419268657e696532c28325]
Date: 2025-05-18
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Drivers.device
Subject: snd_hda: Add shutdown method
Review: The snd_hda driver now powers down the device on system shutdown, preventing potential attachment failures on the next boot.
Body:

  Power down the device on shutdown similar to what is done in the case
  of suspend. The device may fail to attach on next boot without this.

  PR:		286385
  Reviewed by:	christos, adrian
  Differential Revision:	https://reviews.freebsd.org/D50306

  (cherry picked from commit d9900b9ea2b27f7a0c2eda97841b9499e02e3ea7)


   sys/dev/sound/pci/hda/hdac.c | 30 ++++++++++++++++++++++++++++++
   1 file changed, 30 insertions(+)

[commit 5f636d1e9e2eb69c23a38be4375fbc8a1be16a29]
Date: 2025-05-14
Score: 5
Status: proposed(include=no,score=1)
Sponsor: Klara, Inc.
Section: undecided
Subject: mail: Add test cases for SIGHUP.
Review: Test-only change; no user-visible impact.
Body:

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	kevans
  Differential Revision:	https://reviews.freebsd.org/D50296

  (cherry picked from commit a6bac0a9efa15275ada0f0b0ef784837929fb5c6)


   usr.bin/mail/tests/Makefile                        |  2 +-
   .../{mail_sigint_test.c => mailx_signal_test.c}    | 58 ++++++++++++++++------
   2 files changed, 44 insertions(+), 16 deletions(-)

[commit b71d73af2f68d473eda5fd7547a2fd7ec92b70d5]
Date: 2025-05-14
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: Klara, Inc.
Section: Userland.programs
Subject: mail: exit with the correct exit status on SIGHUP in send mode
Review: The mailx(1) utility now exits with the correct status when receiving SIGHUP in send mode, improving POSIX conformance.
Body:

  Motivated by POSIX conformance requirements: mailx(1) is expected to
  take the default action for every signal except SIGINT in interactive
  mode.  We still handle other signals that we shouldn't based on the
  spec (e.g., SIGTSTP), but conforming there is not as straightforward as
  we do more than just cleanup in response.

  Note that when the spec says that we must take the default action, it
  does not mean so strictly.  Namely, we *can* do some sensible cleanup
  if we'd like, but we enter into nonconformant territory if we don't
  reflect the termination via signal in our exit status.  That is why
  this change doesn't actually remove the handler; we're still conformant
  as long as the end result is the same as if we took the default action.

  Reviewed by:	des
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50251

  (cherry picked from commit 964557fe9807d473ad11182a332b0d1da4f54ef0)


   usr.bin/mail/collect.c | 5 +++--
   1 file changed, 3 insertions(+), 2 deletions(-)

[commit a7a3eec3fc37044467551a7e2bb00d9a1388f6b7]
Date: 2025-05-14
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: Klara, Inc.
Section: Userland.programs
Subject: mail: remove the SIGHUP handler from lex.c
Review: The man:mail[1] utility no longer installs a SIGHUP handler, so it will not attempt any cleanup before exiting when it receives a hangup signal.
Body:

  If the command is simply going to exit without doing any cleanup, then
  an immediate exit(3) does not add any value and in-fact obscures that
  the program was terminated by a signal.

  This is motivated by POSIX conformance requirements, but it's also a
  little bit of a tidy-up.  Some investigation into the history of mail(1)
  shows that, at one point, hangup() would attempt to save messages into
  mbox before exiting.  It was later transformed into a simple exit() and
  likely could have been GC'd at that point.

  Reviewed by:	des, emaste, ivy
  Sponsored by:	Klara, Inc.
  Differential Revision:	https://reviews.freebsd.org/D50247

  (cherry picked from commit df16cbdcf1927200eb910c1874faee6f3d8b9a97)


   usr.bin/mail/extern.h |  1 -
   usr.bin/mail/lex.c    | 13 -------------
   2 files changed, 14 deletions(-)

[commit 12666df00a745c64d65c7248f278001b9dbfd937]
Date: 2025-04-27
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: Klara, Inc. | Klara, Inc. | Klara, Inc.
Section: Userland.programs
Subject: mail: Don't trap signals we shouldn't.
Review: The man:mail[1] utility now traps signals only in interactive mode, leaving signals untouched in non-interactive mode as required by POSIX. It also exits with a non-zero status when failing to collect mail.
Body:

  When in interactive mode, trap SIGINT, SIGHUP, and tty-related signals.
  Otherwise, leave signals untouched as required by POSIX.

  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	kevans
  Differential Revision:	https://reviews.freebsd.org/D50011

  (cherry picked from commit 59597032c948586257f123f57bbcfbad02a2cd1b)

  mail: Exit non-zero on failure to collect mail.

  While here, avoid non-portable `pipe2()` in the regression test.

  Fixes:		59597032c948
  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	kevans
  Differential Revision:	https://reviews.freebsd.org/D50069

  (cherry picked from commit 09bc6a5d5b3333bc91e5f9fdf1e7bb282c4aea5a)

  mail: Further refine the SIGINT test.

  * Wait at least 1-2 s before sending the second SIGINT.
  * If the child is still running after 15 s, send a SIGKILL.
  * Improve the exit status checks.

  Fixes:		59597032c948
  MFC after:	1 week
  Sponsored by:	Klara, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D50092

  (cherry picked from commit 42fd47ef81138ae53ba77add5a400f67af8e6263)


   etc/mtree/BSD.tests.dist              |   2 +
   usr.bin/mail/Makefile                 |   4 +
   usr.bin/mail/collect.c                |  34 +++++---
   usr.bin/mail/send.c                   |   4 +-
   usr.bin/mail/tests/Makefile           |   4 +
   usr.bin/mail/tests/mail_sigint_test.c | 157 ++++++++++++++++++++++++++++++++++
   6 files changed, 190 insertions(+), 15 deletions(-)

[commit 604c4840c6be709176412ba3bcb3ea53946923f3]
Date: 2025-05-05
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Network.general
Subject: sctp: ensure correct sctp_gather_internal_ifa_flags usage
Review: The commit fixes a function usage to ensure correct IPv6 address handling in SCTP, which may affect network behavior for SCTP connections.
Body:

  sctp_gather_internal_ifa_flags() expects an IPv6 address.

  (cherry picked from commit 4ca1395c5a311989fc02ceb7a2d44aa5eb1a7426)


   sys/netinet/sctp_bsd_addr.c | 3 +++
   1 file changed, 3 insertions(+)

[commit 5d4ef780ea9f81b6b5bdd23b9f442eae8c481edb]
Date: 2025-05-05
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: sctp: compute address flags only for IPv6 addresses
Review: The commit fixes a compilation issue for IPv4-only kernels by restricting address flag computation to IPv6 addresses. This resolves a build failure and ensures that kernels without IPv6 support can compile successfully.
Body:

  Only call sctp_gather_internal_ifa_flags() for IPv6 addresses and
  also compile this code only, when IPv6 is supported.
  This fixes the compilation of IPv4 only kernels.

  Reported by:	bz@
  Fixes:		6ab4b0c0df57 ("sctp: initilize local address flags correctly")

  (cherry picked from commit 99c58ad021b2f7dc0496e16d313c5e28a552f0d0)


   sys/netinet/sctp_pcb.c | 19 ++++++++++++++++---
   1 file changed, 16 insertions(+), 3 deletions(-)

[commit ab3daba43e8cef4cf529dd1a6d2a5db7de0a66a0]
Date: 2025-05-05
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sctp: clear the SCTP_ADDR_VALID flag when removing an address
Review: The commit fixes a bug in the SCTP address management that had no user-visible consequences because the flag is not used.
Body:

  This flag is currently not read, therefore the bug had no
  consequences.

  (cherry picked from commit 2013c4e0dc73a7c7b05f48726af1a4931686ccef)


   sys/netinet/sctp_pcb.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e6cb445098b156157f5b1926642ae6f86bf57f34]
Date: 2025-05-05
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Network.general
Subject: sctp: initilize local address flags correctly
Review: The commit fixes a bug in SCTP local address flag initialization, ensuring correct address handling for SCTP connections.
Body:

  Use the same routine for initilizing as for updating.

  (cherry picked from commit 6ab4b0c0df57775fd6c288a0b7d0f5d2cad73481)


   sys/netinet/sctp_pcb.c | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit 2b457fb62ca15f3ae46043c21a54a6d27da7d8e7]
Date: 2025-05-05
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Network.general
Subject: sctp: don't report unusable addresses via sysctl interface
Review: The man:sctp[4] sysctl interface no longer reports unusable local addresses for endpoints without a transport control block.
Body:

  When reporting the local addresses of an endpoint (inp without
  stcb), ignore unusable addresses.

  (cherry picked from commit 8f5f6680efa28135bf37f3def2aa71f35bd30333)


   sys/netinet/sctp_sysctl.c | 4 ++++
   1 file changed, 4 insertions(+)

[commit 2c2a8abcd8ed1a887c5a6d46ebcb09e73888b12b]
Date: 2025-05-05
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: sctp: report address unavailability consistently
Review: The SCTP implementation now consistently returns EADDRNOTAVAIL when binding to an unavailable address, improving error reporting consistency.
Body:

  When binding to an address, which is not available, use
  consistently EADDRNOTAVAIL.

  (cherry picked from commit 79952cd7649b63fa312ecafcffb719f5060929d4)


   sys/netinet/sctp_pcb.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 68bc635cc9b099fb03cfcd519046c385af0c5355]
Date: 2025-05-17
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: NetApp, Inc.
Section: Docs.manpages
Subject: namei: Update documentation.
Review: Updates the man:namei[9] manual page to reflect earlier changes that removed the thread argument from NDINIT() and retired the NDFREE macro and related flags.
Body:

  This should have been done 2+ years ago when the td argument was dropped
  from NDINIT() and the NDFREE() macro and the SAVENAME and SAVESTART
  flags were retired.

  MFC after:	3 days
  Fixes:		7e1d3eefd410 ("vfs: remove the unused thread argument from NDINIT*")
  Fixes:		269c564b90d3 ("vfs: retire NDFREE")
  Sponsored by:	NetApp, Inc.
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D50375

  (cherry picked from commit ee84b4e2fdf09f9a6dfa43e0931d8671cc15ebf9)


   ObsoleteFiles.inc       |  3 +++
   share/man/man9/Makefile |  3 ++-
   share/man/man9/namei.9  | 69 ++++++++++++++++++++++++++++++++-----------------
   3 files changed, 50 insertions(+), 25 deletions(-)

[commit 2f99190a9234b119bcec1e4645e87d4e6016e5a5]
Date: 2025-05-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: man: Exit cleanly on SIGPIPE.
Review: The man:man[1] utility now exits cleanly on SIGPIPE, preventing error messages when a pager is quit early and returning a zero exit code.
Body:

  The first attempt at addressing this simply suppressed SIGPIPE, which
  resulted in mandoc printing out error messages instead.  This was then
  reverted, but the pipefail was (correctly) left in, so man still
  returned a nonzero exit code if you quit a page before the end.

  PR:		223516, 279542
  Fixes:		14a5c1068d37, a85d870007e7
  MFC after:	1 week
  Reviewed by:	ziaee, kevans
  Differential Revision:	https://reviews.freebsd.org/D50302

  (cherry picked from commit fbaba7aa432257a9b787edc6bfdbfbde94f2e0d5)


   usr.bin/man/man.sh | 15 ++++++++++++++-
   1 file changed, 14 insertions(+), 1 deletion(-)

[commit a02915589dffa4b2eb93a686e430b35f7cbb10cc]
Date: 2025-05-14
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: 
Section: Docs.manpages
Subject: traceroute.8: improve the documentation of -P
Review: The man:man:traceroute[8] documentation is improved to clarify the -P argument syntax and packet generation details for udplite, SCTP, and GRE.
Body:

  1. -P didn't say what the argument is supposed to be; in the case of
     udplite(4), "-Pudp-lite" is not valid, one must use "-Pudplite".
  2. be more explicit about what sort of packets we generate, particularly
     for -Psctp and -Pgre.

  Reviewed by:	imp, tuexen, des
  Approved by:	des (mentor)
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1657

  (cherry picked from commit 0829839fd0cd6046fbb5c0b6c6432b5ffe0d91e8)


   usr.sbin/traceroute/traceroute.8 | 64 +++++++++++++++++++++++++++++++++++++++-
   1 file changed, 63 insertions(+), 1 deletion(-)

[commit 437569e7ac254314d3b89372b461fd1bb4641ec3]
Date: 2024-02-03
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: traceroute: remove configuration #defines
Review: The commit removes internal configuration #defines from traceroute, which does not affect user-visible behavior, features, or configuration.
Body:

  traceroute used a series of #defines to specify what features are
  available on the host platform.  As traceroute is now in source, these
  are unnecessary and complicate the code, so remove them.

  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1100

  (cherry picked from commit 6a6c5572c3411d3b4d5a423d3bb8d53026cb4355)


   usr.sbin/traceroute/Makefile           |  6 ---
   usr.sbin/traceroute/findsaddr-socket.c | 30 ---------------
   usr.sbin/traceroute/ifaddrlist.c       |  8 ----
   usr.sbin/traceroute/traceroute.c       | 67 ----------------------------------
   4 files changed, 111 deletions(-)

[commit 2ed058b54ee26820d5e59dddcf61c90f9c48e8ad]
Date: 2024-02-03
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: traceroute: remove rcsid tags
Review: Removes RCS ID tags from man:traceroute[8] source files, which has no user-visible impact.
Body:

  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1100

  (cherry picked from commit 3f0b108924428ff91f2640de5f01df0d0bf45253)


   usr.sbin/traceroute/findsaddr-socket.c |  5 -----
   usr.sbin/traceroute/ifaddrlist.c       |  5 -----
   usr.sbin/traceroute/traceroute.c       | 12 ------------
   3 files changed, 22 deletions(-)

[commit 4b147fd312d5b007bd15563fdaed74f5b9f74c56]
Date: 2025-05-11
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.config
Subject: jail: add allow.routing jail permission
Review: The jail(8) facility gains a new allow.routing permission, which permits a jail to modify the system routing table even when not configured as a VNET jail.
Body:

  if allow.routing is set, the jail can modify the system routing table
  even if it's not a VNET jail.

  Reviewed by:	kevans, des, adrian
  Approved by:	kevans (mentor), des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D49843

  (cherry picked from commit 3a53fe2cc4b7076003163376a7db65e432f6283e)


   sys/kern/kern_jail.c   | 13 +++++++++++++
   sys/netlink/route/rt.c |  2 ++
   sys/sys/jail.h         |  3 ++-
   usr.sbin/jail/jail.8   |  5 ++++-
   4 files changed, 21 insertions(+), 2 deletions(-)

[commit ff1980d569c8167d38cda5f2713664866d9802bc]
Date: 2025-05-05
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Network.general
Subject: bridge: allow IP addresses on members to be disabled
Review: Adds a new sysctl net.link.bridge.member_ifaddrs that controls whether IP addresses can be configured on bridge member interfaces. When disabled (set to 0), interfaces with IP addresses cannot be added to bridges, and the bridge no longer processes frames sent to member link-layer addresses, improving throughput by up to 22% in testing.
Body:

  add a new sysctl, net.link.bridge.member_ifaddrs, which defaults to 1.

  if it is set to 1, bridge behaviour is unchanged.

  if it is set to 0:

  - an interface which has AF_INET6 or AF_INET addresses assigned cannot
    be added to a bridge.
  - an interface in a bridge cannot have an AF_INET6 or AF_INET address
    assigned to it.
  - the bridge will no longer consider the lladdrs on bridge members to be
    local addresses, i.e. frames sent to member lladdrs will not be
    processed by the host.

  update bridge.4 to document this behaviour, as well as the existing
  recommendation that IP addresses should not be configured on bridge
  members anyway, even if it currently partially works.

  in testing, setting this to 0 on a bridge with 50 member interfaces
  improved throughput by 22% (4.61Gb/s -> 5.67Gb/s) across two member
  epairs due to eliding the bridge member list walk in GRAB_OUR_PACKETS.

  Reviewed by:	kp, des
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D49995

  (cherry picked from commit 0a1294f6c610948d7447ae276df74a6d5269b62e)


   share/man/man4/bridge.4         | 15 +++++++-
   sys/net/if_bridge.c             | 61 +++++++++++++++++++++++++++-----
   sys/net/if_bridgevar.h          |  1 +
   sys/net/if_ethersubr.c          |  1 +
   sys/netinet/in.c                |  8 +++++
   sys/netinet6/in6.c              |  8 +++++
   tests/sys/net/if_bridge_test.sh | 78 +++++++++++++++++++++++++++++++++++++++++
   7 files changed, 162 insertions(+), 10 deletions(-)

[commit b8771c2c9a5f6fda7ea3d101d6378e10f9c5fcc0]
Date: 2025-04-07
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: netinet6 tests: add a test for SIOCAIFADDRing an invalid IPv6 address
Review: Adds a test for SIOCAIFADDR with invalid IPv6 addresses, which does not directly affect user-visible behavior.
Body:

  Reviewed by:	kp

  (cherry picked from commit 50725e585de77c20f7c96b836dd68ba954756ce7)


   tests/sys/netinet6/Makefile |  5 ++++-
   tests/sys/netinet6/addr6.sh | 45 +++++++++++++++++++++++++++++++++++++++++++++
   2 files changed, 49 insertions(+), 1 deletion(-)

[commit 22fc5d7b222c815fe1a6c81780efd230c749ed1d]
Date: 2025-04-07
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Network.general
Subject: in6_control_ioctl: correctly report errors from SIOCAIFADDR_IN6
Review: The in6_control_ioctl function now correctly reports errors from SIOCAIFADDR_IN6 ioctl operations, ensuring proper error propagation to callers.
Body:

  we have to use 'goto out' here rather than 'break' because otherwise
  error is set to 0, which means the error is not propagated back to the
  caller.

  Reviewed by:	kp

  (cherry picked from commit 1408670c90ae38fd51ea6aaabe46757bc880608e)


   sys/netinet6/in6.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 37303e96528e3c4662a464cfc778ddaa5194a3d1]
Date: 2025-05-14
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.libraries
Subject: link_addr: be more strict about address formats
Review: The link_addr() function now only accepts ':', '.', and '-' as delimiters and permits a single delimiter in an Ethernet address. This prevents misinterpretation of IP addresses as link-layer addresses, which could inadvertently change an interface's MAC address when using ifconfig.
Body:

  instead of accepting any character as a delimiter, only accept ':', '.'
  and '-', and only permit a single delimiter in an address.

  this prevents accepting bizarre addresses like:

  	ifconfig epair2a link 10.1.2.200/28

  ... which is particularly problematic on an INET6-only system, in which
  case ifconfig defaults to the 'link' family, meaning that:

  	ifconfig epair2a 10.1.2.200/28

  ... changes the Ethernet address of the interface.

  bump __FreeBSD_version so link_addr() consumers can detect the change.

  Reviewed by:	kp, des
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D49936

  (cherry picked from commit a1215090416b8afb346fb2ff5b38f25ba0134a3a)


   lib/libc/net/linkaddr.3              |  34 +++---
   lib/libc/net/linkaddr.c              | 198 +++++++++++++++++++++++------------
   lib/libc/tests/net/link_addr_test.cc | 152 ++++++++++++++++++++++++++-
   sbin/ifconfig/af_link.c              |   3 +-
   sys/net/if_dl.h                      |   2 +-
   sys/sys/param.h                      |   2 +-
   6 files changed, 307 insertions(+), 84 deletions(-)

[commit 904876790cc5cf86cdce3a2ca11541bae244d73b]
Date: 2025-05-09
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: net/if_dl.h: add param names in prototypes
Review: The commit only adds parameter names to internal kernel function prototypes for consistency, with no user-visible impact.
Body:

  previously these _KERNEL functions were inconsistent, with some having
  parameter names and some not.  fix this by giving them all names, per
  style(9).

  Reviewed by:	thj, des
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50219

  (cherry picked from commit 8c7d193e3cbe3d1c9a7f7869f1748bebefabaccf)


   sys/net/if_dl.h | 5 +++--
   1 file changed, 3 insertions(+), 2 deletions(-)

[commit 02a07676c382836917b711d2b523b49b9a879183]
Date: 2025-05-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: libc: add link_ntoa_r()
Review: Adds a reentrant version of man:link_ntoa[3] called man:link_ntoa_r[3] for converting link-level addresses to strings. The new function uses an in-out parameter for buffer size, requiring at most two calls to determine needed buffer space.
Body:

  this is a re-entrant version of link_ntoa.  use an in-out parameter for
  the buffer size, so the user requires at most two calls to determine the
  needed size.

  reimplement link_ntoa using link_ntoa_r with a static buffer.

  Reviewed by:	des
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50202

  (cherry picked from commit da509c29089ab169b667ebdf82aa903987ba9c6d)


   lib/libc/net/Makefile.inc            |   7 ++-
   lib/libc/net/Symbol.map              |   4 ++
   lib/libc/net/linkaddr.3              |  45 +++++++++++++-
   lib/libc/net/linkaddr.c              | 110 ++++++++++++++++++++++++++--------
   lib/libc/tests/net/link_addr_test.cc | 111 +++++++++++++++++++++++++++++++++++
   sys/net/if_dl.h                      |   1 +
   6 files changed, 249 insertions(+), 29 deletions(-)

[commit 2f8ba2e5b93eec8b51e6bf18a8e480ee5e1769cf]
Date: 2025-05-05
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: libc tests: add tests for link_addr(3) and link_ntoa(3)
Review: Adds tests for link_addr(3) and link_ntoa(3) functions. This is a test-only change with no user-visible impact.
Body:

  for now, since link_addr() has no way to indicate an error, these are
  only positive tests which check the outcome of valid inputs.

  Reviewed by:	ngie, des, adrian
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50062

  (cherry picked from commit 757e973fb2112ea442aa8990d991f406d407b6f7)

  link_addr_test: use <cstddef>, not <sys/stddef.h>

  <cstddef> is the correct header; this fixes the GCC build.

  while here, sort the headers.

  Fixes:	757e973fb211 ("libc tests: add tests for link_addr(3) and link_ntoa(3)")
  Reviewed by:	des
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50189

  (cherry picked from commit bbffdfef3bf04b2f89027cb20e2019fdc74c4b1b)


   lib/libc/tests/net/Makefile          |   3 +
   lib/libc/tests/net/link_addr_test.cc | 271 +++++++++++++++++++++++++++++++++++
   2 files changed, 274 insertions(+)

[commit a6b05a35ce3c516cadfca49c310dffaabbe40440]
Date: 2025-05-12
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: vfs: vntblinit(): Raise default 'kern.maxvnodes' higher than 'kern.maxfiles'
Review: The default value of the kern.maxvnodes sysctl is raised to be higher than kern.maxfiles, mitigating a deadlock scenario where processes could exhaust all vnodes.
Body:

  Having 'kern.maxvnodes' higher than 'kern.maxfiles' mitigates a scenario
  where some processes can eat up all vnodes in the system, causing
  a deadlock, as long as the kernel itself does not create too many vnodes
  without creating some file descriptor in some process' FD table.  A very
  small percentage (~0.6%) of excess vnodes at infinity, coupled with
  a large difference near the origin, should cover basic cases more than
  enough.  Note however that this measure can be defeated, e.g., by using
  nullfs mounts with non-trivial file hierarchies.

  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50314

  (cherry picked from commit e9baf472a6d228a16be19a11150d41cff29affe8)


   sys/kern/vfs_subr.c | 9 ++++-----
   1 file changed, 4 insertions(+), 5 deletions(-)

[commit 5b07152f3ec3eea78958796b45594c5bd96c0bfb]
Date: 2025-05-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: vfs: vntblinit(): Rework comments on the computation of 'kern.maxvnodes'
Review: The commit only updates comments in vfs_subr.c to clarify the computation of kern.maxvnodes, with no user-visible changes to behavior, configuration, or functionality.
Body:

  Remove the parts that describe what is already in the code formula.  Add
  hints about which of 'physvnodes'/'virtvnodes' takes precedence, and
  when 'desiredvnodes' becomes smaller than 'maxfiles'.  These were both
  computed analytically and verified experimentally.

  Reviewed by:    kib (older version)
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50310

  (cherry picked from commit bf8890c84bacd8b1acebb2cb9a0944b1bb102b68)


   sys/kern/vfs_subr.c | 18 +++++++++---------
   1 file changed, 9 insertions(+), 9 deletions(-)

[commit e7d4e52eafb016707ef3dd3b778d76db280c06a4]
Date: 2025-05-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: Compute 'maxproc'/'maxfiles' from memory amount; Expand/fix comments
Review: The commit changes the formula for computing 'maxproc' and 'maxfiles' from memory pages to megabytes for clarity, with no functional change intended. It also fixes and expands comments about default values and limits for 'maxfiles'.
Body:

  Change the formulae so that 'maxproc' and 'maxfiles' are computed based
  on the physical memory amount, and not the corresponding number of
  pages.  Make sure that the practical results are unchanged for all
  architectures (which is possible since all have 4096 as their
  PAGE_SIZE).  Despite this, we do this change to make it clearer how many
  units of these values are computed per MB, which is easier on readers.

  Change the comments accordingly and expand them to indicate which parts
  of the computations are actually not used by default.  In passing, fix the
  comments about default values and limits for 'maxfiles' (they were off).

  No functional change (intended).

  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50124

  (cherry picked from commit 73f9251c0b52ac0bfb2f2baff27493d6bae216f6)


   sys/kern/subr_param.c | 44 +++++++++++++++++++++++++++-----------------
   1 file changed, 27 insertions(+), 17 deletions(-)

[commit ce6b7a5919da518715d6163baa42035d6d2c1bd0]
Date: 2025-05-13
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: The FreeBSD Foundation
Section: Storage.general
Subject: vfs: vn_alloc(): Stop always calling vn_alloc_hard() and direct reclaiming
Review: The commit fixes a regression that caused vnode allocation to always take the slow path, increasing lock contention and potentially causing livelocks under high vnode usage. This restores the fast path when the number of vnodes is below kern.maxvnodes, improving performance and stability for filesystem operations.
Body:

  Commit ab05a1cf321aca0f intended to revert commit 8733bc277a383cf5
  ("vfs: don't provoke recycling non-free vnodes without a good reason"),
  but due to intervening changes in commit 054f45e026d898bd ("vfs: further
  speed up continuous free vnode recycle"), it also had to revert part of
  it.  In particular, while removing the whole 'if (vn_alloc_cyclecount !=
  0)' block, it inadvertantly removed the code block resetting
  'vn_alloc_cyclecount' to 0 and skipping direct vnode reclamation (done
  further below through vnlru_free_locked_direct()), which had been
  outside the 'if' before the intervening commit.

  Removing this block instead of reinstating it in practice causes
  'vn_alloc_cyclecount' to (almost) never be 0, making vn_alloc() always
  call vn_alloc_hard(), which takes the 'vnode_list_mtx' mutex.  In other
  words, this disables the fast path.  [The reverted commit, which
  introduced the 'if (vn_alloc_cyclecount != 0)' guarding this block,
  actually never executed it because it also had the bug that
  'vn_alloc_cyclecount' would always stay at 0, hiding its usefulness.]

  Additionally, not skipping direct vnode reclamation even when there are
  less vnodes than 'kern.maxvnodes' not only causes unnecessary contention
  but also plain livelocks as vnlru_free_locked_direct() does not itself
  check whether there are actually "free" (not referenced) vnodes to be
  deallocated, and will blindly browse all the vnode list until it finds
  one (which it may not, or only a few ones at the end).  As the fast path
  was disabled, all threads in the system would soon be competing for the
  vnode list lock, outpacing the vnlru process that could never actually
  recycle vnodes in a more agressive manner (i.e., even if they have
  a non-zero hold count).  And we could more easily get into this
  situation, as each vnode allocation was reducing the count of "free"
  vnodes, even if entirely new vnodes could be allocated instead.  This
  part was mitigated by the vnlru process (before the tipping point
  described above), which explains why the mechanism would not always
  livelock.

  Not skipping direct vnode reclamation was arguably a bug introduced by
  the intervening commit (054f45e026d898bd), but was mitigated by
  vn_alloc_hard() not being called in the fast path.  The revert commit,
  by disabling the fast path, made it significantly annoying (to the point
  of getting a few livelocks a week in some of my workloads).

  Restore the reset of 'vn_alloc_cyclecount' to 0 and skip direct
  reclamation when the current number of vnodes is below the
  'kern.maxvnodes' limit, indicating we can start allocating a new 'struct
  vnode' right away.  While here, fix the comparison with the limit when
  'bumped' is true.

  Reviewed by:    kib (older version), avg
  Tested by:      avg, olce
  Fixes:          ab05a1cf321aca0f (revert of "vfs: don't provoke recycling non-free vnodes without a good reason")
  Fixes:          054f45e026d898bd ("vfs: further speed up continuous free vnode recycle")
  MFC after:      5 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50338

  (cherry picked from commit d90c9c24e2c3701949c47061b5ad198eedeebfb9)


   sys/kern/vfs_subr.c | 13 +++++++++++++
   1 file changed, 13 insertions(+)

[commit e9fe7b08eb2e33112187250795dc3cb0881bf71a]
Date: 2025-05-05
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Beckhoff Automation GmbH & Co. KG
Section: Drivers.device
Subject: sys/intpm: fix SMBus Read Block
Review: The SMBus Read Block function in the intpm driver now correctly stores data in the preallocated buffer, preventing it from returning garbage data.
Body:

  The Read Block function missed saving the data into the preallocated
  buffer. This causes it to return some garbage when called.

  Reviewed by:		avg
  MFC after:		1 week
  Sponsored by:		Beckhoff Automation GmbH & Co. KG
  Pull Request:		https://github.com/freebsd/freebsd-src/pull/1691

  (cherry picked from commit 691833ad3776c17ba3267049ac36bc3461c66799)


   sys/dev/intpm/intpm.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e5081477e6b3a7f9533c57b2bf68b6ee305614b2]
Date: 2025-05-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: column(1): add tests and -l flag
Review: The column(1) utility gains a new -l flag to limit the number of columns in -t mode, and includes bug fixes for empty field handling. This adds compatibility with a similar option in util-linux, though semantic differences remain.
Body:

  column(1): add tests

  Reviewed by:	des
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D49911

  (cherry picked from commit 6f2b1b56ac3dd154bd98f5a7ea075abcb4356560)

  column(1): add -l flag

  the '-l <tblcols>' flag limits the number of columns that column(1) will
  produce in -t mode.  this is syntax-compatible with the same option in
  util-linux's column(1), but due to existing differences between the two
  implementations, it's not semantically compatible.

  as a side-effect, fix a pre-existing bug where empty fields could cause
  incorrect output:

  	% echo ':' | column -ts:
  	(null)

  while here, also fix a couple of minor existing issues.

  Reviewed by:	des
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50290

  (cherry picked from commit 313713b24c6d2a3061972c4f431515c4f1b01c77)


   etc/mtree/BSD.tests.dist       |   2 +
   usr.bin/column/Makefile        |   4 +
   usr.bin/column/column.1        |  11 ++-
   usr.bin/column/column.c        |  45 +++++++---
   usr.bin/column/tests/Makefile  |   3 +
   usr.bin/column/tests/column.sh | 200 +++++++++++++++++++++++++++++++++++++++++
   6 files changed, 254 insertions(+), 11 deletions(-)

[commit 49d9f344f67efcce5aebe033577907e8230237f0]
Date: 2025-05-16
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: ng_sample: fix style nits
Review: Only style fixes with no user-visible impact.
Body:

  MFC after:	3 days
  Reviewed by:	ivy, kp, des
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50343

  (cherry picked from commit 95c414dd27c26285cdd6ed4288832b3db0ea6628)


   sys/netgraph/ng_sample.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 4ae64bd33f24cff90ff75efe67176a6df1c3af62]
Date: 2025-04-20
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: iwlwifi.4: Update modes for recent 802.11ac
Review: The commit updates the iwlwifi.4 and iwlwififw.4 man pages to reflect recent 802.11ac support, firmware changes, and tunables, improving documentation for users.
Body:

  By:			ziaee
  Reported by:		Pat Maddox <pat@patmaddox.com>
  Reviewed by:		bz (previous version), emaste, mhorne
  Differential Revision:	https://reviews.freebsd.org/D49937

  iwlwifi: update man pages for generations, firmware. and 11n/11ac

  Put Intel's iwlwifi better in context to iwm, iwx and iwn.
  Document the important tunables so users know where to go.
  Document the port/package for firmware where firmware is now
  maintained.
  Adjust wording and table for the firmware and a flavor column.
  Update History sections for 11n/11ac support as well as firmware
  module removal from base.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	ziaee, emaste (comments)
  Differential Revision: https://reviews.freebsd.org/D50319

  (cherry picked from commit c33945a112c84795c7bd87a8e94d0cf322ef5000)
  (cherry picked from commit a7e183c0c9a5579cdaa3e2ff9597e5e3d41dbdb4)


   share/man/man4/iwlwifi.4   |   96 ++-
   share/man/man4/iwlwififw.4 | 2029 ++++++++++++++++++++++----------------------
   2 files changed, 1106 insertions(+), 1019 deletions(-)

[commit 7dc0a9fa76a8df6dfaf26ff36a11aa9fe060a201]
Date: 2024-01-09
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: xen: improve man (4) page
Review: The man:xen[4] page is updated to reflect current support status.
Body:

  Update the xen(4) man page to reflect the current support status.

  Reported by: kevans
  Reviewed by: bcr kevans imp
  Differential revision: https://reviews.freebsd.org/D43373

  (cherry picked from commit 82126ef92fdb3c13a67ad44d33c0fe6ea479c01a)

   share/man/man4/xen.4 | 74 +++++++++++++++++++++++-----------------------------
   1 file changed, 33 insertions(+), 41 deletions(-)

[commit cf47e6d4e14ab97d42317cb653926a0b6f9a21e9]
Date: 2025-05-09
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: sys/cdefs.h: add __nodiscard annotation
Review: Adds a new __nodiscard annotation to sys/cdefs.h, which can be used to mark functions, types, or constructors to issue compiler warnings when their return values are discarded. This may affect developers compiling code that uses this macro, potentially generating new warnings.
Body:

  __nodiscard adds the [[nodiscard]] attribute to a function, type or
  constructor in C or C++, causing a value so marked to issue a compiler
  warning if it is discarded (i.e., not used or assigned) other than by
  casting it to void.

  this replaces the existing __result_use_or_ignore_check, which has a
  similar purpose but different semantics.  since __nodiscard provides
  more functionality (at least in GCC) and __result_use_or_ignore_check
  only had a single user, remove __result_use_or_ignore_check.

  [[nodiscard]] has been supported in C++ since C++17, but only in C since
  C23; however, both LLVM and GCC implement it even in older language
  versions, so it should always be available with a relatively modern
  compiler.

  for Clang, [[nodiscard]] in C is only available since LLVM 17, but we
  can fall back to __attribute__((__warn_unused_result__)) which has the
  same semantics and provides support back to (at least) LLVM 11.

  GCC supports [[nodiscard]] in both C and C++ since at least GCC 11.
  for GCC, we can't provide a fallback as the semantics of its
  warn_unused_result are different, but since __result_use_or_ignore_check
  isn't defined for GCC anyway, we don't lose anything here.

  MFC after:	2 weeks
  Reviewed by:	des, emaste
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50217

  (cherry picked from commit 7e0c5e0128c43bbae78190911aead8e1d9475ba5)


   sys/sys/cdefs.h | 38 ++++++++++++++++++++++++++++++++++++++
   1 file changed, 38 insertions(+)

[commit 33597164cd8b9c28afa44be725e164c660489c03]
Date: 2025-04-15
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: sys/net: add a new ether_vlanid_t type
Review: Adds a new ether_vlanid_t type for representing VLAN IDs in Ethernet headers, used by the bridge subsystem.
Body:

  ether_vlanid_t is a type to represent a VLAN ID, for example inside a
  .1q tag.  since this is specific to Ethernet, put it in net/ethernet.h.

  change bridge to use the new type instead of uint{16,32}_t.

  Reviewed by:	adrian, kp
  Differential Revision:	https://reviews.freebsd.org/D49836

  (cherry picked from commit 96f830456fd449c4cb5a7df8a2f6c3c96993b43e)


   sys/net/ethernet.h     |  5 +++++
   sys/net/if_bridge.c    | 28 ++++++++++++++++------------
   sys/net/if_bridgevar.h |  2 +-
   3 files changed, 22 insertions(+), 13 deletions(-)

[commit 802edf23079388447659136805d97b95b0f90899]
Date: 2025-05-16
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: qat.4: Cleanup
Review: The commit is a documentation cleanup for the man:qat[4] driver man page, with no user-visible functional changes.
Body:

  + copyright symbols do not belong in Nd's (apropos results)
  + move hardware to HARDWARE for inclusion in the hw release notes
  + improve sysctls
  + lines which say nothing removed
  + links moved to see also
  + spacing and markup corrections

  MFC after:		3 days
  Reviewed by:		markj, mhorne
  Differential Revision:	https://reviews.freebsd.org/D50381

  (cherry picked from commit c1d9b2c9b03cade19cb4f94d3e29fba7179ac11a)


   share/man/man4/qat.4 | 181 +++++++++++++++++++++++++--------------------------
   1 file changed, 89 insertions(+), 92 deletions(-)

[commit 6426b01310122c7563d982ec21c91b98f3f5bd3b]
Date: 2025-05-14
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: e6000sw.4: Add HISTORY
Review: The commit adds a HISTORY section to the man: e6000sw[4] man page, which is a documentation update with no user-visible functional change.
Body:

  MFC after:		3 days
  Reviewed by:		mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50358

  (cherry picked from commit c808bee35b1129abd9af137204ebd15559b90b5b)


   share/man/man4/e6000sw.4 | 5 +++++
   1 file changed, 5 insertions(+)

[commit 10d94b403add1454295fbcf554e3565791ce590d]
Date: 2025-05-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Kernel.general
Subject: sched: mark several kern.sched.* sysctls as CTLFLAG_RWTUN
Review: The sysctls kern.sched.interact, kern.sched.preempt_thresh, kern.sched.static_boost, kern.sched.idlespins, kern.sched.balance, kern.sched.steal_idle, kern.sched.steal_thresh, kern.sched.trysteal_limit, and kern.sched.always_steal can now be set as loader tunables.
Body:

  The following sysctls which are not touched during boot time
  initialization are marked as CTLFLAG_RWTUN so they can be set by loader
  tunables as well:
    - kern.sched.interact
    - kern.sched.preempt_thresh
    - kern.sched.static_boost
    - kern.sched.idlespins
    - kern.sched.balance
    - kern.sched.steal_idle
    - kern.sched.steal_thresh
    - kern.sched.trysteal_limit
    - kern.sched.always_steal

  MFC after:	1 week
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D50279

  (cherry picked from commit 62f55b34ec42750adb1833414de07e88e5148899)


   sys/kern/sched_ule.c | 21 +++++++++++----------
   1 file changed, 11 insertions(+), 10 deletions(-)

[commit 3f5262eb0b2230e68314b6a7368800110b6ce9f9]
Date: 2025-01-27
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: seq.1: Reset option list alignment + tag spdx
Review: The commit adjusts formatting in the man:seq[1] manual page to follow style guidelines, which may affect line breaks when viewing the man page at certain terminal widths.
Body:

  This option list was tabbed over 19 characters. style.mdoc(5) asks
  that lists are set to the longest item, or if that's too long then
  to use indent. Resetting it to indent buys us two lines at MANWIDTH
  80, and three at 59.

  MFC after:		3 days
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D48350

  (cherry picked from commit 2f893597fcc34456d5adfc3f1633b39c76d0764f)


   usr.bin/seq/seq.1 | 5 ++++-
   1 file changed, 4 insertions(+), 1 deletion(-)

[commit 64a8c1930b8b74d05736bd9c022d5943343efd43]
Date: 2025-02-24
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: style: Recomend SPDX licenses
Review: The commit updates man:style[9] to recommend SPDX licenses and corrects some mdoc errors, but these are minor documentation and style changes without significant user-visible impact.
Body:

  While here, take this opportunity to update the copyright and clean
  some mdoc errors.

  MFC after:		3 days
  Reviewed by:		carlavilla, mhorne, imp
  Approved by:		imp (srcmgr)
  Approved by:		carlavilla, mhorne (mentors)
  Differential Revision:	https://reviews.freebsd.org/D49051

  (cherry picked from commit b3de609802104234dca7449fc2b4f4106098d41b)


   share/man/man9/style.9 | 41 ++++++++++++++++-------------------------
   1 file changed, 16 insertions(+), 25 deletions(-)

[commit f526783367f9ffe00acf40d8a6ec56662cfbf323]
Date: 2025-05-03
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: 
Section: Docs.manpages
Subject: UPDATING: Strengthen recommendations
Review: The commit updates UPDATING with stronger recommendations for ports_modules and adds a note about backups, which is a user-visible documentation change.
Body:

  Strengthen recommendations for ports_modules by adding a separate note.
  Use the unused [2] to add a note about creating backups.

  MFC after:		3 days
  Reviewed by:		brooks, mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50126

  (cherry picked from commit ca9131b729757959cb0fd4721603466284cfc6fe)


   UPDATING | 15 +++++++++++----
   1 file changed, 11 insertions(+), 4 deletions(-)

[commit d93d6cccc90e4dc80c74e1b90a16358be62b0a8e]
Date: 2025-05-12
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: build.7: Document pkgbase PKG_FORMAT variable
Review: The man:build[7] manual page now documents the PKG_FORMAT variable used in pkgbase builds.
Body:

  MFC after:		3 days
  Reported by:		emaste
  Reviewed by:		emaste, mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50318

  (cherry picked from commit dd3d1a7694583362f5915ff5f1d9cdee64e2fe3e)


   share/man/man7/build.7 | 14 ++++++++++++++
   1 file changed, 14 insertions(+)

[commit 5e0e046d95a92aab8bea856fe0008870ee11bfc9]
Date: 2025-05-11
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Docs.manpages
Subject: e6060sw.4: Improve title and add HARDWARE
Review: The commit updates the man page title and adds a HARDWARE section for the e6060sw driver, improving documentation visibility and hardware release notes inclusion.
Body:

  For visibility in apropos and inclusion in the hardware release notes.

  MFC after:		3 days
  Reviewed by:		adrian, mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50321

  (cherry picked from commit bef89c155e77dd471af596a43f3914b754cc5155)


   share/man/man4/e6060sw.4 | 17 +++++++++++++++--
   1 file changed, 15 insertions(+), 2 deletions(-)

[commit 17e9eb1e0eb721e2400232c71f20bc490c416c60]
Date: 2025-05-11
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Docs.manpages
Subject: ar40xx.4: Initial manual page
Review: Adds man:ar40xx[4] manual page for the Atheros AR40xx Ethernet switch driver, enabling documentation in apropos and hardware release notes. Also updates cross-references in man:etherswitch[4].
Body:

  For inclusion in apropos and the hardware release notes. While here,
  add xrefs to this page and the previous e6000sw in etherswitch.4.

  MFC after:		3 days (but adjusted for 14.3)
  Reported by:		adrian
  Reviewed by:		adrian, mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50324

  (cherry picked from commit 91c9751c3913497db2fbad1fcf7491557bbd2a75)


   share/man/man4/etherswitch.4     |  8 ++++----
   share/man/man4/man4.arm/Makefile |  1 +
   share/man/man4/man4.arm/ar40xx.4 | 35 +++++++++++++++++++++++++++++++++++
   3 files changed, 40 insertions(+), 4 deletions(-)

[commit 1343a5b616ec4e11047c5024bb844e7275f84ddd]
Date: 2025-05-11
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: arswitch.4: Improve title and add HARDWARE
Review: The man:arswitch[4] page title is improved for better visibility in apropos and inclusion in hardware release notes.
Body:

  For visibility in apropos and inclusion in the hardware release notes.

  MFC after:		3 days
  Reviewed by:		adrian (previous), mhorne
  Approved by:		mhorne

  (cherry picked from commit 9692d5e15e9bd7e628b06d655522477ce8c5b6fe)


   share/man/man4/arswitch.4 | 35 +++++++++++++++++++++--------------
   1 file changed, 21 insertions(+), 14 deletions(-)

[commit d7837cac6f64a7ed3682050f6401a2a7032fc6d9]
Date: 2025-04-29
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: Future Crew, LLC
Section: Drivers.device
Subject: rtlbtfw(8): Fix incorrect chunk index overwrap in rtlbt_load_fwfile()
Review: The firmware loader man:rtlbtfw[8] now correctly handles large firmware files with more than 256 chunks, allowing such firmwares to load properly.
Body:

  It prevented large (>256 chunks) firmwares from loading.

  Fixes: 5036d9652a57 ("rtlbtfw: Firmware loader for Realtek 87XX/88XX")

  Sponsored by:	Future Crew, LLC
  MFC after:	1 week

  (cherry picked from commit a4fcbac5d891e3909474ffe7ed7064972a1a7577)


   usr.sbin/bluetooth/rtlbtfw/rtlbt_hw.c | 11 +++++------
   1 file changed, 5 insertions(+), 6 deletions(-)

[commit 718273db61a5d1888a266febf7f71718f76b5c51]
Date: 2025-04-29
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.contrib
Subject: rtlbtfw(8): Add Mercusys MA530 VID/PID for Realtek 8761BUV
Review: The rtlbtfw(8) utility now supports the Mercusys MA530 device by adding its VID/PID for the Realtek 8761BUV Bluetooth chipset.
Body:

  Tested by:	Yusuf Yaman <nxjoseph@protonmail.com>
  PR:		286369
  MFC after:	1 week

  (cherry picked from commit 7a7ab347fc6535a8c91d458dda76a61019163869)


   sys/netgraph/bluetooth/drivers/ubt/ng_ubt_rtl.c | 1 +
   usr.sbin/bluetooth/rtlbtfw/main.c               | 1 +
   usr.sbin/bluetooth/rtlbtfw/rtlbtfw.conf         | 8 ++++++++
   3 files changed, 10 insertions(+)

[commit 7798b72a90004cab0e6790060a18c00b87750341]
Date: 2025-04-29
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Drivers.device
Subject: iichid(4): Do not send packets read in interrupt handler to hidbus
Review: The iichid(4) driver no longer sends packets to hidbus before it is attached and opened, preventing a panic at boot time when no hidbus clients are present.
Body:

  if no hidbus and hidbus clients were attached and opened by users.

  iichid(4) enables interrupts before hidbus is attached and sending
  packets to it at this time leads to panic at boot time.

  Fixes: daa098cc37b9 ("Wait for RESET command response while attaching")

  Tested by:	dch
  PR:		286045
  MFC with:	daa098cc37b9

  (cherry picked from commit 2abdb305bd0c105226f6a71a8d3dc89698c9ef6b)


   sys/dev/iicbus/iichid.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 072e0b158004a2cc7870e81ba482805f7f60b7c3]
Date: 2025-03-07
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: Future Crew LLC
Section: Drivers.device
Subject: iichid(4): Wait for RESET command response while attaching
Review: The iichid(4) driver now waits for the RESET command response during attach, ensuring the parent device is fully functional before child initialization.
Body:

  before starting of children initialization to ensure that parent device
  is fully functional.

  Sponsored by:	Future Crew LLC
  MFC after:	2 month
  Differential Revision:	https://reviews.freebsd.org/D48958

  (cherry picked from commit daa098cc37b9db36281623c00558976aea4fa90e)


   sys/dev/iicbus/iichid.c | 55 ++++++++++++++++++++++++++++++++++++-------------
   1 file changed, 41 insertions(+), 14 deletions(-)

[commit 3bd684f0aafe046d07b241a76bbec7feacff88b5]
Date: 2025-03-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Future Crew LLC
Section: Drivers.device
Subject: iichid(4): Read wMaxInputLength bytes over I2C even if we discards data
Review: The iichid(4) driver now reads the full wMaxInputLength bytes over I2C for HID-over-I2C devices like the ITE5570. This prevents interrupt storms that could occur when only reading the header portion of RESET command responses.
Body:

  For some devices e.g. ITE5570 it is not enough to read HID-over-I2C
  input length header of RESET command response to acknowledge interrupt.
  Do a full-size read to avoid interrupt storm.

  Sponsored by:	Future Crew LLC
  MFC after:	2 month
  Differential Revision:	https://reviews.freebsd.org/D48957

  (cherry picked from commit 548d3aa856a97f4483554beceeb57fa9ba0ff913)


   sys/dev/iicbus/iichid.c | 47 ++++++++++++++++++++++++++++++++++++-----------
   1 file changed, 36 insertions(+), 11 deletions(-)

[commit c58c931e20045a6e254df5901e0321b537337440]
Date: 2025-03-07
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: Future Crew, LLC
Section: Drivers.device
Subject: ig4_iic: Allow sleeping if called from iichid interrupt handler.
Review: The ig4_iic driver now allows sleeping in the interrupt handler for iichid devices, replacing a busy loop with mtx_sleep. This reduces CPU usage when iichid is interrupt-driven.
Body:

  This replaces 50 ms busy loop with mtx_sleep for the same duration thus
  saving CPU time when iichid is driven with interrupts.

  Sponsored by:	Future Crew, LLC
  MFC after:	2 month
  Differential Revision:	https://reviews.freebsd.org/D48956

  (cherry picked from commit c7225a3ede3cf99c538158962f4d65dee435bbcd)


   sys/dev/ichiic/ig4_iic.c | 5 +----
   sys/dev/ichiic/ig4_var.h | 1 -
   sys/dev/iicbus/iichid.c  | 3 +++
   3 files changed, 4 insertions(+), 5 deletions(-)

[commit e0692e7bb6e8abcc55a2510dceea5f83e823a827]
Date: 2025-05-12
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: 802.11: make sure AUTH frames are not being sent if BSS changed
Review: The LinuxKPI 802.11 driver now prevents sending AUTH frames when the BSS has changed, which resolves an 'Invalid TXQ id' error in iwlwifi drivers during network scanning and authentication transitions.
Body:

  iwlwifi keeps logging 'Invalid TXQ id' even after previous changes to
  catch the BSS changed.  The reason for this is that we do not error in
  the SCAN -> AUTH path as otherwise we would not have the state machine
  get us back to SCAN to clear up firmware state before auth/assoc to the
  new BSS.

  If we are not in synch as net80211 just swapped the iv_bss from under us,
  disable the TX queue for the (old) lsta to prevent the AUTH frame sent
  from sta_newstate() reaching the driver.  After all we are not trying to
  authenticate to that node (sta) anymore.

  Sponsored by:	The FreeBSD Foundation
  PR:		274382

  (cherry picked from commit 16d987fe781780100a31df30b9edd79ebb54f957)


   sys/compat/linuxkpi/common/src/linux_80211.c | 24 ++++++++++++++----------
   1 file changed, 14 insertions(+), 10 deletions(-)

[commit 1d70da6aa294b9b3c0963e41667a4f74b3125615]
Date: 2025-04-24
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: LinuxKPI: add ktime_get_boottime_seconds()
Review: The commit adds a LinuxKPI function needed for an updated iwlwifi driver, which may affect users of that wireless driver.
Body:

  ktime_get_boottime_seconds() is needed by an updated iwlwifi driver.

  Sposored by:	The FreeBSD Foundation
  Reviewed by:	dumbbell
  Differential Revision: https://reviews.freebsd.org/D50005

  (cherry picked from commit 93b82146c43b8ecad4fd7694ec1daf6d79cca65c)


   sys/compat/linuxkpi/common/include/linux/ktime.h | 7 +++++++
   1 file changed, 7 insertions(+)

[commit ad937b02ed3803525b1fd579c6ddf64be43c9a92]
Date: 2025-04-24
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: add _devcd_free_sgtable() to devcoredump.h
Review: Adds a LinuxKPI function for freeing scatter-gather tables, which is needed by the updated iwlwifi driver.
Body:

  It may be that once we implement freeing of chained tables
  _devcd_free_sgtable() will become our _lkpi_dev_coredumpsg_free()
  but further investigations need to happen.  For now make an
  updated iwlwifi driver happy which should not need more.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	dumbbell
  Differential Revision: https://reviews.freebsd.org/D50006

  (cherry picked from commit 71576ed24b56143429a3b6774a7862965c2dea88)


   sys/compat/linuxkpi/common/include/linux/devcoredump.h | 9 ++++++++-
   1 file changed, 8 insertions(+), 1 deletion(-)

[commit c6c953fc43d86417bbf18a41a328c60f02a34c69]
Date: 2025-05-04
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: pci: fix two errors in lkpi_pci_get_device()
Review: Fixes reference counting and potential panics in the LinuxKPI PCI subsystem, improving stability for Linux driver compatibility.
Body:

  On any result we need to acquire a reference. pci_dev_get() deals with
  a NULL argument so we can simply pass what we "found" at the end.
  This will avoid reference count problems.

  If the iteration on the linux list in lkpi_pci_get_device() does
  not find a match pdev will still be defined at the end of the
  loop but not pointing to a valid pdev.
  Store the found entry in a 2nd variable which otherwise will be NULL.
  This will avoid random panics, usually in sysfs_remove_dir() when
  the reference gets released.

  Found during mt76 bringup.

  Sponsored by:	The FreeBSD Foundation
  Fixes:		8f61992d7cc11
  Reviewed by:	dumbbell
  Differential Revision: https://reviews.freebsd.org/D50153

  (cherry picked from commit 2c65f965146a7f822302715a439e17996d17453c)


   sys/compat/linuxkpi/common/src/linux_pci.c | 10 +++++++---
   1 file changed, 7 insertions(+), 3 deletions(-)

[commit 96ee4e56125de12280457c153f82868a7f2751e7]
Date: 2025-05-04
Score: 5
Status: proposed(include=no,score=30)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: pci: deal with kobject_add() being able to fail
Review: The commit fixes a potential failure in LinuxKPI PCI device initialization, which could affect the stability of Linux compatibility layer drivers.
Body:

  lkpifill_pci_dev() uses a sequene of kobject_init/set_name/add.
  The problem is that kobject_add could fail.

  Move the entire logic to the beginning of the function,
  switch to kobject_init_and_add() and check the return code.
  Make lkpifill_pci_dev() return the error and deal in the callers
  with a possible error accordingly.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	dumbbell
  Differential Revision: https://reviews.freebsd.org/D50154

  (cherry picked from commit 96e86aa6faa6fde4ff75fd757db55afe9e4be132)


   sys/compat/linuxkpi/common/src/linux_pci.c | 29 ++++++++++++++++++++++-------
   1 file changed, 22 insertions(+), 7 deletions(-)

[commit 1fcc3d6dd5c559ac6328f57d44ff11211d56088d]
Date: 2025-05-03
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: bnxt: add guards around struct_group macros
Review: The commit adds header guards to prevent macro redefinition in the bnxt driver, but this is an internal build fix with no user-visible impact.
Body:

  The header file might be included after linux/stddef.h or others are
  included and the macros would be re-defined.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	imp
  Differential Revision: https://reviews.freebsd.org/D50156

  (cherry picked from commit 152e6197615570e7a2f5f1c6c2ed00ecee9dd10c)


   sys/dev/bnxt/bnxt_en/bnxt_dcb.h | 4 ++++
   1 file changed, 4 insertions(+)

[commit 45d585ab7f222ca36988c406df528128a17f9884]
Date: 2025-05-12
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: powerpc: Always use BE tag in nexus_map_resource
Review: The commit fixes a regression on powerpc64le systems where resource mapping incorrectly used the build's endianness instead of always using big-endian, which restores correct operation on bare metal and in virtual machines.
Body:

  7b5a5e4e replaced nexus_activate_resource() with the bus generic
  equivalent, which uses bus_map_resource().  However, though not intended
  to have a functional change, nexus_map_resource() uses the bus tag of
  the build (BE vs LE), while nexus_activate_resource() always explicitly
  set a big-endian tag, leading to failures on powerpc64le now.  Using BE
  unless otherwise explicitly specified with the RF_LITTLEENDIAN fixes LE
  on bare metal, and doesn't hurt in a VM, which nexus_map_resource() was
  added for.

  Reported by:	pkubaj
  Tested by:	pkubaj
  Fixes:		7b5a5e4e("powerpc nexus: Use bus_generic_rman_*")
  MFC after:	1 day

  (cherry picked from commit c4921a0faaf1683f39347dd066000d929c39c8b9)


   sys/powerpc/powerpc/nexus.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit d0e29f92f7a252b382d76c1e6bac33d8424af5fa]
Date: 2025-05-11
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Docs.manpages
Subject: e6000sw.4: Initial manual page
Review: Adds the man:e6000sw[4] manual page for the e6000sw Ethernet switch driver.
Body:

  For inclusion in the HW relnotes.

  MFC after:		3 days, note removed entries which didn't mfc
  Reviewed by:		adrian, ivy, mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50293

  (cherry picked from commit 6da793a8caa15ee2cbb984ea39ac87c6cd2fdf63)


   share/man/man4/Makefile  |  1 +
   share/man/man4/e6000sw.4 | 39 +++++++++++++++++++++++++++++++++++++++
   2 files changed, 40 insertions(+)

[commit d659366cc62a70b4863bddf226f6209d13ab65c0]
Date: 2025-05-09
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: cdboot.8: Initial manual page
Review: The man:cdboot[8] manual page is added, documenting the previously undocumented cdboot utility.
Body:

  Add cdboot to the reference manual, fixing an undocumented bug where it
  is undocumented. There's almost nothing here, but that's better than
  "only imp and jhb know what this is".

  MFC after:		3 days
  Reported by:		jhb, imp
  Reviewed by:		mhorne
  Approved by:		mhorne (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50274

  (cherry picked from commit ecdb0b79bf93a2b8392694bd266c5930ca42bab5)


   stand/i386/cdboot/Makefile |  1 +
   stand/i386/cdboot/cdboot.8 | 21 +++++++++++++++++++++
   2 files changed, 22 insertions(+)

[commit 651102873e96174e4e799d4e06538e1d841e182a]
Date: 2025-03-29
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: stand/lua manuals: Describe better
Review: The man pages for the lua boot loader modules are reworded to improve search clarity for terms like 'boot', 'loader', and 'FreeBSD'.
Body:

  The lua boot loader module manuals were getting pulled into search
  results for FreeBSD, but not for "boot" or "loader". Reword them to
  increase clarity for boot or loader searches, as well as the FreeBSD
  search term which we've been scoping to system topic overview manuals.

  MFC after:	3 days
  Reviewed by:	imp, mhorne
  Approved by:	mhorne (mentor)
  Pull Request:	https://github.com/freebsd/freebsd-src/pulls/1628

  (cherry picked from commit 5d59c1b4f14e2fa6388b1d75ee3243085f1c69f2)


   stand/lua/cli.lua.8         | 4 ++--
   stand/lua/color.lua.8       | 4 ++--
   stand/lua/config.lua.8      | 4 ++--
   stand/lua/core.lua.8        | 4 ++--
   stand/lua/drawer.lua.8      | 4 ++--
   stand/lua/gfx.lua.8         | 4 ++--
   stand/lua/hook.lua.8        | 4 ++--
   stand/lua/loader.conf.lua.5 | 2 +-
   stand/lua/loader.lua.8      | 4 ++--
   stand/lua/menu.lua.8        | 4 ++--
   stand/lua/password.lua.8    | 4 ++--
   stand/lua/screen.lua.8      | 4 ++--
   12 files changed, 23 insertions(+), 23 deletions(-)

[commit eadda156a50d3487ec1e6fc78f6cfe2df42448fa]
Date: 2025-05-14
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: Amazon
Section: Hardware.virtualization
Subject: EC2: Remove old broken_txfifo workaround
Review: The hw.broken_txfifo workaround is removed from EC2 image configuration, eliminating console latency spikes and ena(4) driver warnings on modern EC2 instances. The tunable remains available for other environments where the Xen UART bug persists.
Body:

  Early versions of Xen, including those used in the early days of EC2,
  had a bug in their UART emulation whereby the TX FIFO wouldn't send the
  expected interrupt when emptying; as a result, FreeBSD would write 16
  characters to the serial console and then stop because we thought the
  FIFO was forever full.

  In 2013 (1c60b24baa50) I added a loader tunable "hw.broken_txfifo"
  which spinwaits for the FIFO TX rather than relying on the interrupt,
  and enabled this in loader.conf in EC2 images.

  A decade later, this workaround is almost certainly no longer needed in
  EC2 -- most instances don't run Xen, and the bug was long since fixed
  in Xen anyway -- but we've been holding on to the workaround "just in
  case".  Unfortunately, the spinwait behaviour is causing latency spikes
  and triggering warnings from the ena(4) driver.

  This commit removes the hw.broken_txfifo setting from loader.conf in
  EC2 images, but leaves the loader tunable and associated code, since it
  has been necessary in some other environments.  (It seems that the TX
  FIFO missing-interrupts bug has been independently written at least
  three times!)

  MFC after:	1 minute
  Sponsored by:	Amazon

  (cherry picked from commit 9a685c09f06a55b18589d75f9307563d84a17fa9)


   release/tools/ec2.conf | 5 -----
   1 file changed, 5 deletions(-)

[commit f7cd5c230849730dd03f942d7bf8f2e770643e7a]
Date: 2024-01-12
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: libusb(3): Fix link in comment
Review: Fixes a broken link in a comment within the libusb(3) header file.
Body:

  Event:		Advanced UNIX Programming Course (Fall23) at NTHU.
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1042

  (cherry picked from commit 2a3a8eb9fac66183e5af4852bbcb40824629f182)


   lib/libusb/libusb.h | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 09dcc8a75697233a683f1d8c105a4caa2b74e59c]
Date: 2025-05-11
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: random(9): bump removal to FreeBSD 16.0
Review: The man:random(9) manual page now indicates that the random(9) kernel interface will be removed in FreeBSD 16.0, notifying developers of the future change.
Body:

  It has not yet been removed, and still has some in-tree consumers.

  PR:		277655
  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 3a58c266e2e6201a3aebbb52311f38ccf3323e3b)


   share/man/man9/random.9 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 641bb44d8538c66446aea556baa22bbf5bd14255]
Date: 2025-05-06
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: FreeBSD Foundation
Section: Userland.contrib
Subject: libusb: Emit event after deregistering hotplug handler
Review: libusb now emits an event after deregistering a hotplug handler, preventing programs that dynamically manage hotplug callbacks from becoming stuck in wait loops.
Body:

  The original implementation did not emit an event when a hotplug handler
  was deregistered. This omission causes issues for programs that follow
  the best practices recommended by libusbparticularly those that use
  `libusb_hotplug_register_callback()` or similar functions in a loop
  while managing hotplug handlers dynamically.

  Without emitting an event after deregistration, these programs can
  become stuck waiting indefinitely for an event that will never come,
  as the condition to break out of the wait loop is never satisfied.

  See: https://github.com/libusb/libusb/blob/6c0ae1ab456da49e7805115e77ce0428ace4ea41/libusb/hotplug.c#L459

  Reviewed by:    bapt
  Sponsored By:   FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50170

  (cherry picked from commit d2852659180307475a8376ce86aa587cccbb10bf)


   lib/libusb/libusb10_hotplug.c | 1 +
   lib/libusb/libusb10_io.c      | 1 +
   2 files changed, 2 insertions(+)

[commit 3de66f369c1e8db46ae938d446a72f6ff3493356]
Date: 2025-05-14
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sound: Call PCM_RELEASE() if pcm_addchan() fails
Review: The commit fixes a locking issue in the sound subsystem that could lead to resource leaks or instability when channel addition fails, but it is a low-level internal fix without direct user-visible impact.
Body:

  Fixes:		fd906e47b18f ("sound: Simplify locking during device creation")
  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 day
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D50337

  (cherry picked from commit dbfe79bbe5d5ebe296fbff2d101e0994d7881d0d)


   sys/dev/sound/pcm/sound.c | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit 242b52ba3c38108f2c2af4194a031ed495b95dbc]
Date: 2025-05-11
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.programs
Subject: bsdinstall: Use a login shell for final configuration.
Review: The bsdinstall installer now uses a login shell for final configuration tasks, ensuring correct PATH and package installation capability.
Body:

  If the user accepts our offer of a shell to perform final configuration
  tasks before rebooting, start a login shell.  This ensures it will have
  the correct PATH and be able to install packages without issues.

  PR:		286722
  MFC after:	3 days
  Reviewed by:	jrtc27, allanjude, emaste
  Differential Revision:	https://reviews.freebsd.org/D50297

  (cherry picked from commit 5870d6a1ef4ec5d6fc91d0f1635bca59e09a040d)


   usr.sbin/bsdinstall/scripts/auto | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit cbc3efab49aaa69acd3ac1701bc11095a4373d0a]
Date: 2025-05-07
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: NetApp, Inc. | Klara, Inc.
Section: Kernel.general
Subject: mbuf: Allow clusters to fill an entire jumbo page.
Review: The mbuf cluster size can now fill an entire jumbo page, allowing for larger network packet buffers when MCLSHIFT is adjusted. This change restores support for configurations where clusters match jumbo page sizes, improving performance for high-throughput networking.
Body:

  The assumption that MCLBYTES == MJUMPAGESIZE can only happen if pages
  are small is incorrect: it can also happen if MCLSHIFT is adjusted to
  increase the size of clusters.  Restore the ability to have clusters
  fill a jumbo page, while still disallowing them from exceeding them.

  MFC after:	1 week
  Fixes:		840327e5ddf3, 9c3ad5ba932b
  Sponsored by:	NetApp, Inc.
  Sponsored by:	Klara, Inc.
  Reviewed by:	siderop1_netapp.com, kevans, brooks
  Differential Revision:	https://reviews.freebsd.org/D50242

  (cherry picked from commit 271128b0698653294acf0ed3457d5871af5b3ef1)


   sys/conf/NOTES          | 3 ++-
   sys/dev/cxgbe/adapter.h | 4 ++++
   sys/dev/cxgbe/t4_sge.c  | 8 ++++++++
   sys/kern/kern_mbuf.c    | 4 ++--
   sys/sys/mbuf.h          | 6 ++++++
   5 files changed, 22 insertions(+), 3 deletions(-)

[commit f0d1e002689130a8b34c91c80002cc1fce4dd8ae]
Date: 2025-05-09
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: Vdura
Section: Drivers.device
Subject: amdsmn(4), amdtemp(4): Add support for AMD Family 1Ah (Zen5) CPUs
Review: The man:amdsmn[4] and man:amdtemp[4] drivers now support AMD Family 1Ah (Zen5) CPUs, enabling temperature monitoring and system management for these processors.
Body:

  I found the '1AH_MxxH_ROOT' PCI device IDs in the Linux "AMD K8
  Northbridge" driver [1][5]. Since Family 19h (Zen3, Zen4) uses the same
  registers as Family 17h (Zen1, Zen2), I tried using those same registers
  for Family 1Ah (Zen5) as well, and they worked.

  I pulled the 1Ah model ranges from Linux as well [2][3][4][6].

  Added some additional logging under 'bootverbose', and used a local
  variable and macro for the stepping, rather than repeatedly using the
  mask directly.

  Consistently report the CPUID (family, model, stepping) using two,
  zero-padded, un-prefixed, uppercase nybbles, with an 'h' suffix. This is
  the format used in documentation and in Linux.

  My own testing with various models of Zen4 EPYC 9xx4 ("Genoa") shows
  that their CPUID models are in the range 0x10 .. 0x1f. Similar testing
  with various models of Zen5 EPYC 9xx5 ("Turin") shows that their CPUID
  models are in the range 0x00 ... 0x2f.

  [1] 2023-08-10: https://github.com/torvalds/linux/commit/c640166
  [2] 2024-01-23: https://github.com/torvalds/linux/commit/3e4147f
  [3] 2024-01-25: https://github.com/torvalds/linux/commit/b9328fd
  [4] 2024-04-24: https://github.com/torvalds/linux/commit/2718a7f
  [5] 2024-07-28: https://github.com/torvalds/linux/commit/59c3400
  [6] 2024-07-30: https://github.com/torvalds/linux/commit/bf5641e

  Sponsored by:	Vdura
  MFC after:	3 days
  Reviewed by:	delphij
  Differential Revision:	https://reviews.freebsd.org/D50278

  (cherry picked from commit 2a042fab4f91a525daa6255b69892fb434c62831)


   sys/dev/amdsmn/amdsmn.c   | 26 +++++++++++++++++++++++--
   sys/dev/amdtemp/amdtemp.c | 49 +++++++++++++++++++++++++++++++++--------------
   2 files changed, 59 insertions(+), 16 deletions(-)

[commit bd20de7d16c768f00419602a0eb2ed93b942bf0e]
Date: 2025-04-13
Score: 5
Status: proposed(include=no,score=65)
Sponsor: Innovate UK
Section: undecided
Subject: vm_fault: Defer marking COW pages valid
Review: The commit fixes a race condition in copy-on-write fault handling that could trigger a kernel assertion panic on systems with INVARIANTS enabled. This prevents a specific scenario where freeing a mapped page during object collapse could cause a system crash.
Body:

  Suppose an object O has two shadow objects S1, S2 mapped into processes
  P1, P2.  Suppose a page resident in O is mapped read-only into P1.  Now
  suppose that P1 writes to the page, triggering a COW fault: it allocates
  a new page in S1 and copies the page, then marks it valid.  If the page
  in O was busy when initially looked up, P1 would have to release the map
  lock and sleep first.  Then, after handling COW, P1 must re-check the
  map lookup because locks were dropped.  Suppose the map indeed changed,
  so P1 has to retry the fault.

  At this point, the mapped page in O is shadowed by a valid page in S1.
  If P2 exits, S2 will be deallocated, resulting in a collapse of O into
  S1.  In this case, because the mapped page is shadowed, P2 will free it,
  but that is illegal; this triggers a "freeing mapped page" assertion in
  invariants kernels.

  Fix the problem by deferring the vm_page_valid() call which marks the
  COW copy valid: only mark it once we know that the fault handler will
  succeed.  It's okay to leave an invalid page in the top-level object; it
  will be freed when the fault is retried, and vm_object_collapse_scan()
  will similarly free invalid pages in the shadow object.

  Reviewed by:	kib
  MFC after:	1 month
  Sponsored by:	Innovate UK
  Differential Revision:	https://reviews.freebsd.org/D49758

  (cherry picked from commit c98367641991019bac0e8cd55b70682171820534)


   sys/vm/vm_fault.c | 19 ++++++++++++++++---
   1 file changed, 16 insertions(+), 3 deletions(-)

[commit 6180a8eaba89e7dcb609aa89419b9629108a6b87]
Date: 2025-05-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: tests: Serialize kern_descrip_test
Review: The commit only adds a test serialization to avoid interference with other tests, which is an internal testing change without user-visible impact.
Body:

  It can trigger failures in unrelated tests when it modifies the maxfiles
  limit.

  MFC after:	1 week

  (cherry picked from commit 46adaf3642cff045b9ac87bd2e8b32124bd66ba2)


   tests/sys/kern/Makefile | 2 ++
   1 file changed, 2 insertions(+)

[commit df4d9abbcc04db5a195b98d5291ba15949fc03c5]
Date: 2025-05-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: aio: Fix opcode handling in aio_process_rw()
Review: The commit fixes a bug in asynchronous I/O opcode handling that could affect applications using aio_read() and aio_write() with offset operations.
Body:

  LIO_FOFFSET needs to be masked off, as it is in aio_aqueue().

  Reported by:	syzbot+b6e15476c91852bb2264@syzkaller.appspotmail.com
  Reviewed by:	kib, asomers
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D50118

  (cherry picked from commit ab01a5f5628eb0d334f491ff06462cff214d5f49)


   sys/kern/vfs_aio.c | 8 +++-----
   1 file changed, 3 insertions(+), 5 deletions(-)

[commit 33475cb18e9eb5568c6704c2b2b9a63a46ddd2ed]
Date: 2025-05-01
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: racct: Fix a typo in a comment
Review: This commit only fixes a typo in a comment, which has no user-visible impact.
Body:

  Reported by:	kib
  MFC after:	1 week

  (cherry picked from commit 5d1fba01ca07030a013815746c2c056b5c4a8a49)


   sys/kern/kern_racct.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 1ca993dd454445ad766f8b8b39103e09c1dccce9]
Date: 2025-05-09
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: sysctl.9: Constant integer example: Do not promote 'debug.sizeof'
Review: The man:sysctl[9] manual page example is updated to use a different constant, which may affect developers referencing the example.
Body:

  Replace it with another one, selected from current in-tree uses.

  MFC after:      1 day
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit 129a6cf886e108b67f637a271f003519c99b9abd)


   share/man/man9/sysctl.9 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit da6b04cd404341d494e2c89e3058ccaea5ca8a79]
Date: 2025-05-12
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: stress2: exlock2.sh: Fix impact of previous '-U' removal
Review: The commit fixes a test script in the stress2 suite by adding the '-x' flag to a ps(1) command, which is an internal test change with no direct user impact.
Body:

  In commit "stress2: exlock2.sh: Preserve behavior after ps(1)'s '-U'
  change" (1265d3b07eaa), I forgot that '-U' also has the side-effect of
  implying '-x' by default.  Now that '-U' has been removed, make '-x'
  explicit.

  Fixes:          1265d3b07eaa ("stress2: exlock2.sh: Preserve behavior after ps(1)'s '-U' change")
  MFC after:      1 hour
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit f6e826891760a34ef69e1122da0ee378f7caf454)


   tools/test/stress2/misc/exlock2.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 11716164c1fef0dd00522e64cc6b578e61bb620f]
Date: 2025-05-05
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: queue(3): Add a test for STAILQ_REVERSE()
Review: This commit adds a test for STAILQ_REVERSE() but does not introduce any user-visible changes; it is internal test code only.
Body:

  Reviewed by:    kib, markj
  MFC after:      1 week
  MFC with:       e8286eb29516 ("sys/queue.h: add STAILQ_REVERSE")
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50165

  (cherry picked from commit 0285c2428780cdb94bfb7d2dc1806a4bd129324e)


   tests/sys/sys/queue_test.c | 58 ++++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 58 insertions(+)

[commit 00988d12bc37b76197c774ef54a318f58999de2a]
Date: 2025-05-05
Score: 5
Status: added(include=yes,score=85)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: sndctl(8): Initial revision
Review: man:sndctl[8], a new utility has been added for listing and modifying audio device properties using a control-driven interface similar to man:mixer[8].
Body:

  sndctl(8) is a new program that lists and modifies audio device
  properties, using a control-driven interface, in similar fashion to
  mixer(8).

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 week
  Reviewed by:	adrian
  Differential Revision:	https://reviews.freebsd.org/D46227
  Differential Revision:	https://reviews.freebsd.org/D50167

  (cherry picked from commit 44e5a01508353cfa52e185a531cfb5a6b39b28f6)
  (cherry picked from commit 9a37f1024cebfb89dcfa15c23bb287a5d09a9ae7)


   usr.sbin/Makefile        |   1 +
   usr.sbin/sndctl/Makefile |   8 +
   usr.sbin/sndctl/sndctl.8 | 187 +++++++++
   usr.sbin/sndctl/sndctl.c | 987 +++++++++++++++++++++++++++++++++++++++++++++++
   4 files changed, 1183 insertions(+)

[commit 1ecfdc009172491a133d596332a9aaf6851a49c1]
Date: 2025-05-11
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: Amazon
Section: Ports.packaging
Subject: release: Don't put drm-kmod package onto DVD
Review: The drm-kmod package is no longer included on release DVDs, as the modules are not useful for the quarterly package set built on an older release.
Body:

  The X.Y-RELEASE DVDs use a quarterly package set which was built on
  X.(Y-1)-RELEASE, and those kernel modules are never going to be
  useful.

  MFC after:	30 seconds
  Sponsored by:	Amazon

  (cherry picked from commit 94e44a074e5212cc3459e360a9de55500f7c41d0)


   release/scripts/pkg-stage.sh | 3 ---
   1 file changed, 3 deletions(-)

[commit 1c2e947d272ea42dbf7416d867101fe5164ffc6d]
Date: 2025-02-19
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: Amazon
Section: Ports.packaging
Subject: pkg-stage.sh: kde5 -> kde
Review: The 'kde5' package is removed from the DVD image staging script as KDE transitions to version 6.
Body:

  The "kde5" package no longer exists; KDE goes to 6.

  Note: Depending on the size of 13.5-BETA3 DVD images, KDE might end
  up being removed from this list in the near future.

  With hat:	re@
  MFC after:	30 seconds
  Sponsored by:	Amazon

  (cherry picked from commit 0d7b98c06c5ec9638020844ee460af075cfc6e54)


   release/scripts/pkg-stage.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6fea961056180a95a72c463cdaf081492edb9395]
Date: 2025-05-06
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: service: Use explicit path for /usr/bin/env
Review: The man:service[8] script now uses an explicit path for /usr/bin/env to avoid conflicts when GNU coreutils utilities are installed without 'g' prefixes.
Body:

  A reddit thread[1] reported an error from env(1) invoked by service(8),
  wwhen GNU coreutils utilities were installed without `g` prefixes.

  [1] https://www.reddit.com/r/freebsd/comments/1kfzh78/service_command_changed_between_freebsd11_and/

  Reviewed by:	kevans
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50195

  (cherry picked from commit 81449fb2c044a85ecd9c5a15c6b470cdbcacacfc)


   usr.sbin/service/service.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit c02b45a75b73b2b4c31f7827920722659cb7b636]
Date: 2025-04-28
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: flua.1: Add xref to style.lua(9)
Review: Adds a cross-reference to style.lua(9) in the flua.1 manual page.
Body:

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit cbe50f7c20cf0ca484d29cf345864a18c29850e7)


   libexec/flua/flua.1 | 5 +++--
   1 file changed, 3 insertions(+), 2 deletions(-)

[commit d967c87d073d1307dfd51ab9335ead472a05e6bd]
Date: 2025-04-15
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: flua: Add minimal man page
Review: Adds a man page for the internal flua interpreter, documenting its purpose and available functionality.
Body:

  Flua is a minimal Lua interpreter integrated into the FreeBSD base
  system.  It is intended for internal use and is not designed for
  general-purpose scripting or use by third-party applications, and was
  originally intentionally undocumented.

  There have been questions about its purpose, and questions about the
  available functionality from internal users, so provide a minimal man
  page including these details.

  Reviewed by:	kevans, Isaac Freund <ifreund@freebsdfoundation.org>
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D49835

  (cherry picked from commit 550289771d5cb73befb6a1645fb9cdf0b9fb65a7)


   libexec/flua/Makefile |  1 -
   libexec/flua/flua.1   | 98 +++++++++++++++++++++++++++++++++++++++++++++++++++
   2 files changed, 98 insertions(+), 1 deletion(-)

[commit 70068b3030f95b3f83dd04515d58db2c7b2ad587]
Date: 2025-04-27
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.contrib
Subject: wpa_supplicant: Use PF_LOCAL instead of PF_INET*
Review: wpa_supplicant now uses a local socket (PF_LOCAL) instead of an Internet socket (PF_INET) for interface ioctls, eliminating the dependency on Internet protocol support in the system.
Body:

  Using a local socket circumvents the issue of needing any Internet
  protocol (PF_INET or PF_INET6) support.
  We only use interface ("i" group) ioctls on this socket so we can get
  away with using PF_LOCAL instead of requring any Internet protocol
  (PF_INET or PF_INET6) support on the system. This simplifies the
  patch from 8c7149c73f8f.

  PR:				286259
  Noted by:			kevans
  Fixes:				8c7149c73f8f
  Reviewed by:			kevans, philip,
  				zarychtam_plan-b.pwste.edu.pl (mzar)
  Differential revision:		https://reviews.freebsd.org/D50050

  (cherry picked from commit 6aeec6a741975143f53feabceb1726d5033aafd6)


   contrib/wpa/src/drivers/driver_bsd.c | 14 ++------------
   1 file changed, 2 insertions(+), 12 deletions(-)

[commit db9d0fad461a6d3a0beb79981c31026bc4ce0a48]
Date: 2025-04-27
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Network.wireless
Subject: wpa_supplicant: Handle systems without INET (legacy IP) support
Review: wpa_supplicant now works on systems with legacy IP (INET) support disabled, allowing wireless network connections when only IPv6 is available.
Body:

  Currently, wpa_supplicant fails when legacy IP support is disabled
  in FreeBSD (i.e., the world built with WITHOUT_INET and nooptions
  INET in the kernel config). The proposed patch allows running
  wpa_supplicant and connecting to wireless networks without INET
  support when INET6 is available.

  Reviewed by:		cy, adrian, philip, roy_marples.name
  Differential Revision:	https://reviews.freebsd.org/D49959

  (cherry picked from commit 8c7149c73f8f2301369f271c98470b72973b0c01)


   contrib/wpa/src/drivers/driver_bsd.c | 10 ++++++++++
   1 file changed, 10 insertions(+)

[commit 0e80536cfe46dbe6d1d430141c0cf3c69c5b84b0]
Date: 2025-04-26
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Userland.contrib
Subject: unbound: Update version strings
Review: Unbound updated to version 1.21.0.
Body:

  Fixes:		be771a7b7f45

  (cherry picked from commit 3bef9b313be73788cd3b77d9b514d292169c442e)


   lib/libunbound/config.h | 6 +++---
   1 file changed, 3 insertions(+), 3 deletions(-)

[commit e39b3eb12d67ad4a14c9d679190b72437972be94]
Date: 2025-03-26
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.contrib
Subject: heimdal: Add missing symbols to map
Review: Adds missing symbols to Heimdal's version map, which may affect ports that link against Heimdal libraries.
Body:

  Patch supplied by mi@ through a private email.

  Bump __FreeBSD_version for ports that might need this.

  PR:		280025

  (cherry picked from commit d5c804138845a1c8d81fbbce48de676806de32e6)


   crypto/heimdal/lib/krb5/version-script.map | 22 ++++++++++++++++++++++
   1 file changed, 22 insertions(+)

[commit 97312e0b46dedf1d31617a357b17fc416d5d268b]
Date: 2025-05-06
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Docs.manpages
Subject: rc.conf.5: document precious_machine
Review: The man:rc.conf[5] manual page now documents the precious_machine variable, which affects how rc.conf(5) variables are handled during upgrades.
Body:

  (cherry picked from commit a130a604a4fb0e9a6d767c7c3f0422396d61b2b1)


   share/man/man5/rc.conf.5 | 10 ++++++++++
   1 file changed, 10 insertions(+)

[commit 8cb3670fb90ebe14ea609cd576f5dc235814f8b1]
Date: 2025-05-04
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.programs
Subject: rc.d: Add precious_machine rc.conf knob to create /var/run/noshutdown
Review: The rc.d script man:noshutdown(8) now respects the rc.conf variable precious_machine. When set to YES, the script creates /var/run/noshutdown to prevent accidental shutdowns.
Body:

  (cherry picked from commit 384d976725a5c29734a9227fcdb6ef0807485c91)


   libexec/rc/rc.conf         |  2 ++
   libexec/rc/rc.d/Makefile   |  1 +
   libexec/rc/rc.d/noshutdown | 31 +++++++++++++++++++++++++++++++
   3 files changed, 34 insertions(+)

[commit 16f17042683bca6ae46d668bcc30e416f88cc42a]
Date: 2025-05-04
Score: 5
Status: proposed(include=yes,score=70)
Sponsor: 
Section: Userland.programs
Subject: shutdown(8): refuse to run if /var/run/noshutdown is present
Review: The man:shutdown(8) utility now checks for the presence of /var/run/noshutdown and refuses to run if the file exists, providing a mechanism to prevent system shutdowns.
Body:

  (cherry picked from commit 7fb88c20eccc3fd2118fda2ba58d7afe2b87f7e3)


   sbin/shutdown/shutdown.8 | 23 +++++++++++++++++++++--
   sbin/shutdown/shutdown.c | 18 +++++++++++++++---
   2 files changed, 36 insertions(+), 5 deletions(-)

[commit 29b28e380c14d4a21ce9457e445f5d98dce5cf74]
Date: 2025-05-04
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: include/paths.h: add _PATH_NOSHUTDOWN
Review: Adds _PATH_NOSHUTDOWN constant to include/paths.h for use by shutdown(8) and related utilities.
Body:

  (cherry picked from commit 5ab906195b35609c60e05080f7b82cf64437306e)


   include/paths.h | 1 +
   1 file changed, 1 insertion(+)

[commit 6d6fdcbdd87f9f8916b273a1974bbe520289a6a3]
Date: 2025-05-09
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: rtld: remove stray tabs
Review: The commit removes stray tabs in the dynamic linker source code, which is a style fix with no user-visible impact.
Body:

  (cherry picked from commit 33759fc7e823be533d4ab0611950f8264de06ecc)


   libexec/rtld-elf/rtld.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit eb8cf785e4416fd74fe082218328453d1913a812]
Date: 2025-05-03
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.libraries
Subject: libthr.so: mark as -z initfirst
Review: The libthr.so library is marked with the -z initfirst linker flag, which ensures it is initialized early in the dynamic linking process. This change may affect the startup order of threaded applications, particularly those with complex dependency chains.
Body:

  PR:	286537

  (cherry picked from commit 7c6a5272f1ded20e91b63fe3d1a016243641a37d)


   lib/libthr/Makefile | 1 +
   1 file changed, 1 insertion(+)

[commit f31acb9d5cb25678cb497cb28bc466442b99239f]
Date: 2025-05-03
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: rtld: add support for -z initfirst
Review: The dynamic linker man:ld-elf.so.1[1] now supports the -z initfirst flag, which forces the object to be initialized before any other objects in the process.
Body:

  (cherry picked from commit 78aaab9f1cf359f3b7325e4369653f6b50593393)


   libexec/rtld-elf/rtld.c | 138 +++++++++++++++++++++++++++++++++++-------------
   libexec/rtld-elf/rtld.h |   1 +
   2 files changed, 103 insertions(+), 36 deletions(-)

[commit eccd076e8e7131f4e19b260d8281b778a07dfbfb]
Date: 2025-05-03
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: sys/elf_common.h: add the DF_1_INITFIRST flag definition
Review: The DF_1_INITFIRST flag is defined for ELF binaries, which may affect dynamic linker behavior for certain shared objects.
Body:

  (cherry picked from commit 31a24831802389f52f3ebb7fdf670ee0e4dd608e)


   sys/sys/elf_common.h | 1 +
   1 file changed, 1 insertion(+)

[commit 7865d159c5e1b825286777ec236b502ec1261dc0]
Date: 2025-05-02
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Userland.libraries
Subject: thr_rtld: accept read lock requests while owning the lock for write
Review: The dynamic linker run-time lock now permits read lock requests while holding a write lock, which may improve performance in certain multi-threaded scenarios.
Body:

  PR:	286505

  (cherry picked from commit 812c4bf3f17024f192980bbb8a781676cb9cf6b6)


   lib/libthr/thread/thr_rtld.c | 26 +++++++++++++++++++++-----
   1 file changed, 21 insertions(+), 5 deletions(-)

[commit 5f195cb44beee2ee952252245937a9bb7a395e38]
Date: 2025-05-01
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Userland.libraries
Subject: rtld: do not call into ifunc resolvers with the bind lock write-locked
Review: The runtime linker no longer holds a write lock while calling ifunc resolvers, preventing potential deadlocks in programs using ifuncs.
Body:

  PR:	286502

  (cherry picked from commit c66c0a8479e62f3e3e085252839cddace4d4bbf5)


   libexec/rtld-elf/rtld.c | 10 ++++++++--
   1 file changed, 8 insertions(+), 2 deletions(-)

[commit c8f21c33fd46aac5cfbfddeee90c178b2b0279f7]
Date: 2025-05-01
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: rtld: add lockstate_wlocked()
Review: 
Body:

  (cherry picked from commit bcbc19335a702a05ed89369c1662a91b686324ce)


   libexec/rtld-elf/rtld_lock.c | 6 ++++++
   libexec/rtld-elf/rtld_lock.h | 1 +
   2 files changed, 7 insertions(+)

[commit 34aae073212270d36a4688e770930580b483480f]
Date: 2025-05-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: sys/queue.h: use reserved identifiers with the file scope for locals
Review: The commit changes internal macro naming in sys/queue.h to use reserved identifiers, which is a code style and compatibility fix with no direct user-visible impact.
Body:

  (cherry picked from commit c15cdaf505849509900b018a44d91eee3647fb13)


   sys/sys/queue.h | 94 ++++++++++++++++++++++++++++-----------------------------
   1 file changed, 47 insertions(+), 47 deletions(-)

[commit aa7487ee9537698f25792065fce47acda47081e2]
Date: 2025-05-04
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: queue.3: document STAILQ_REVERSE
Review: The man:queue[3] manual page now documents the STAILQ_REVERSE macro.
Body:

  (cherry picked from commit a5a186baf2c89ebfd795d74d9223d57acd8c0383)


   share/man/man3/Makefile | 1 +
   share/man/man3/queue.3  | 6 ++++++
   2 files changed, 7 insertions(+)

[commit 6286f5df3e4a667e51561d0d9ddb754930d50ef0]
Date: 2025-05-03
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.libraries
Subject: sys/queue.h: add STAILQ_REVERSE
Review: The commit adds a new macro STAILQ_REVERSE to sys/queue.h, which provides a user-visible API for reversing singly-linked tail queues. This can be used by developers writing kernel or userland code that utilizes STAILQ data structures.
Body:

  (cherry picked from commit e8286eb295165ea1852abe4ae355f85ad1ec3356)


   sys/sys/queue.h | 15 +++++++++++++++
   1 file changed, 15 insertions(+)

[commit e925d6c2e73934e631e5942522d80ef6b89cb8d2]
Date: 2025-04-25
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: depend-cleanup: ensure clang and llvm binaries are rebuilt
Review: The commit ensures that clang and llvm binaries are rebuilt after library changes, which may affect users who rely on these tools for development.
Body:

  In 2e47f35be5dc, libllvm, libclang and liblldb became shared libraries,
  so make sure the binaries that depend on these libraries get rebuilt.

  MFC after:	2 weeks

  (cherry picked from commit d4dab32448ce7aff01273ecf9965125f0cb8067a)


   tools/build/depend-cleanup.sh | 14 ++++++++++++++
   1 file changed, 14 insertions(+)

[commit a743b3f1a4c538c50236b5322d4c82db08a3d9f2]
Date: 2025-04-25
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: Convert libllvm, libclang and liblldb into private shared libraries
Review: libllvm, libclang, and liblldb are now private shared libraries, reducing binary size for clang, lld, and lldb tools. This change is internal and does not affect user-visible behavior or configuration.
Body:

  This allows clang, lld, lldb, and other llvm tools to be linked against
  these shared libraries, which makes them smaller and avoids duplication.

  Since these are not quite the same as the shared libraries shipped by
  the upstream llvm build system, and we do not want to expose the ABI to
  external programs such as ports, make them private libraries.

  Note that during the cross-tools stage they are still built as static
  libraries, so the cross compiler and linker are static binaries, as they
  have always been.

  This also requires a depend-cleanup.sh kludge which will be added in a
  follow-up commit, to ensure binaries are rebuilt against the shared
  libraries in case of incremental builds.

  MFC after:      2 weeks
  Differential Revision: https://reviews.freebsd.org/D49967

  (cherry picked from commit 2e47f35be5dc61945afdbd1a70e8fd505c032c94)


   lib/clang/libclang/Makefile              |  83 ++++++++++++-----
   lib/clang/liblldb/Makefile               |  23 ++++-
   lib/clang/libllvm/Makefile               | 152 +++++++++++++++++--------------
   tools/build/mk/OptionalObsoleteFiles.inc |  10 ++
   usr.bin/clang/Makefile.inc               |   2 +
   usr.bin/clang/clang.prog.mk              |  12 ++-
   usr.bin/clang/lld/Makefile               |  12 ++-
   usr.bin/clang/lldb-server/Makefile       |   7 +-
   usr.bin/clang/lldb/Makefile              |   7 +-
   usr.bin/clang/llvm.prog.mk               |   8 +-
   10 files changed, 211 insertions(+), 105 deletions(-)

[commit a9b30c92ab1c0dbed31eed94b8b975eb574d2a3f]
Date: 2025-05-08
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: bsddialog: Correct type for bsddialog_total_progview
Review: Fixes a type mismatch in bsddialog's progress view that could cause incorrect formatting of progress values.
Body:

  It was an int, but printed with %lli format.  Although it would be
  reasonable to use a 32-bit int here (i.e., changing the printf format
  instead) this matches what was done in bsddialog upstream (and now in
  main).

  PR:		286655
  Reviewed by:	asiciliano
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D50261


   contrib/bsddialog/lib/barbox.c                 | 4 ++--
   contrib/bsddialog/lib/bsddialog_progressview.h | 4 ++--
   2 files changed, 4 insertions(+), 4 deletions(-)

[commit 95528b6ff1aa630f98231fd907b79760f7346cd7]
Date: 2025-05-01
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: The FreeBSD Foundation
Section: Kernel.general
Subject: VFS cache: Fix initial sizing for non-default 'ncsizefactor'
Review: The VFS cache initial sizing is corrected for non-default 'ncsizefactor' values, affecting system performance and memory usage.
Body:

  Reviewed by:    markj
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50120

  (cherry picked from commit 811f6a0ae0230fb09b666276cbe93a8be4fe7c73)


   sys/kern/vfs_cache.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit e5baab94b0b096f772d40cf204875992d09a70c4]
Date: 2025-05-08
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: Revert "VFS cache: Fix initial sizing for non-default 'ncsizefactor'"
Review: This commit is a revert of a previous change that was committed without proper tags and is intended to be recommitted later. It does not introduce any user-visible changes.
Body:

  Because it unadvertently was committed without the proper tags.  Will be recommitted with them.

  This reverts commit 455203ec8885 (VFS cache: Fix initial sizing for non-default 'ncsizefactor', 2025-05-01).


   sys/kern/vfs_cache.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit eca0ce8afb15ef9f01703c4d15273eaf66eb63f5]
Date: 2025-05-05
Score: 5
Status: proposed(include=no,score=15)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: queue(3): Install *_SPLIT_AFTER() links to the main manual page
Review: The commit adds man page symlinks for new queue macros, which is a documentation update for the queue(3) API.
Body:

  Completes commit "queue(3): New *_SPLIT_AFTER(), *_ASSERT_EMPTY(),
  *_ASSERT_NONEMPTY()" (c02880233949b01f).

  MFC after:      1 day
  Sponsored by:   The FreeBSD Foundation

  (cherry picked from commit c071616b06aa0f51ac4314f989c472d0268c2ddb)


   share/man/man3/Makefile | 4 ++++
   1 file changed, 4 insertions(+)

[commit efce9f8a510b60736994e50288b78fc7b32b5d90]
Date: 2025-05-01
Score: 5
Status: proposed(include=no,score=30)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sysctl(9): Ease exporting struct sizes; Discourage doing that
Review: Adds sysctl helpers for exporting kernel structure sizes under 'debug.sizeof' and discourages new ad-hoc exports. Existing entries are converted to use the new helpers.
Body:

  Introduce two helpers, the more general SYSCTL_SIZEOF() and
  a struct-specific one SYSCTL_SIZEOF_STRUCT() which prepends 'struct' in
  the description and in the use of sizeof() but uses the raw structure
  name as the knob's name.  The size of the object/structure is exported
  under 'debug.sizeof'.

  Existing knobs under 'debug.sizeof' were all converted to use the
  helpers.

  Add a note before the helpers discouraging the introduction of new
  leaves for ad-hoc reasons.  List alternative means for developers to
  obtain the size of arbitrary kernel structures easily (thanks to markj@
  for providing these).

  No functional change (intended).

  Reviewed by:    kib, markj
  MFC after:      3 days
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50121

  (cherry picked from commit 713abc9880aabe0ff924ff644bceb6ff404ed3cd)


   .../openzfs/module/os/freebsd/zfs/zfs_znode_os.c    |  4 ++++
   sys/fs/devfs/devfs_devs.c                           |  7 ++-----
   sys/geom/geom_kern.c                                | 15 +++++----------
   sys/kern/kern_mib.c                                 | 18 ++++++------------
   sys/kern/subr_devstat.c                             |  3 +--
   sys/kern/vfs_cache.c                                |  3 +--
   sys/sys/sysctl.h                                    | 21 +++++++++++++++++++++
   7 files changed, 40 insertions(+), 31 deletions(-)

[commit 5af18707c155dca74071aa3bfb61160814f03bc3]
Date: 2025-05-06
Score: 5
Status: proposed(include=no,score=20)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: stress2: exlock2.sh: Preserve behavior after ps(1)'s '-U' change
Review: The test script stress2/exlock2.sh is updated to align with a change in ps(1) command behavior regarding user ID selection.
Body:

  Remove '-Uroot', as now '-U' selects processes based on their real user
  IDs, and since the program using them was launched as 'root', the
  equivalent now is just to remove it, as now ps(1) by default selects
  processes based on its effective UID (root) and their effective UIDs.

  It seems that matching on effective or real UID does not really matter
  in this test, but at least this change simplifies the command-line.

  MFC after:      1 day
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50200

  (cherry picked from commit 1265d3b07eaa418e9c60800db93f3482ddbb6ae2)


   tools/test/stress2/misc/exlock2.sh | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit a69fe62604021f120206e4064ca7463195aeb3a0]
Date: 2025-05-06
Score: 5
Status: proposed(include=no,score=20)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: rc/tests: Fix process flags checks using ps(1)
Review: Test suite for rc scripts is updated to use correct ps(1) flags, ensuring tests function as intended after a ps(1) bug fix.
Body:

  These checks use ps(1) with both the '-p' and '-a' flags, which worked
  so far as ps(1)'s '-a' option was buggy.  Since the fix in commit
  "ps(1): Make '-a' and '-A' always show all processes"
  (93a94ce731a89b56), such a command-line always selects all processes,
  making the specified '-p' useless and the test wrong.  Remove the
  useless '-a'.

  While here, remove the redundant '-x', as '-p' implies '-x' by default.

  MFC after:      1 day
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50201

  (cherry picked from commit 646375408742dd5ed9abb174a621a3f8f65a56ef)


   libexec/rc/tests/rc_subr_test.sh | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 1586fd84fbdab2e2ec205ca717c69946805f2ba0]
Date: 2025-05-06
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: ps.1: Remove ambiguity in description of option '-J'
Review: The man:ps[1] manual page clarifies that the '-J' option is a selection option, not a filter, removing potential ambiguity for users.
Body:

  As stated in the previous commit, option '-J' was introduced by commit
  "Add -J to filter by matching jail IDs and names."
  (13767130c7147ae7182a, r265229), which unfortunately talked about '-J'
  being a filter while actually implementing it as a regular selection
  option which adds to the processes to display.

  The manual page's formulation hinted more at '-J' being a filter, which
  it is not, or could be just considered ambiguous, because of the
  presence of the "only" word.  Consequently, remove it and reformulate.

  Reviewed by:    ziaee, dch
  MFC after:      1 day
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50194

  (cherry picked from commit cbda1aea6532697247bcca6e59d45775857c35e2)


   bin/ps/ps.1 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit f18a49a747f7641e93c24d50207d54e7e612f97d]
Date: 2025-05-06
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: RELNOTES: ps(1): Document change in behavior for '-a'/'-A'
Review: The ps(1) man page now documents that '-a' and '-A' show all processes regardless of other selection options, and clarifies the behavior of '-J'.
Body:

  Document the practical consequence of change "ps(1): Make '-a' and '-A'
  always show all processes" (93a94ce731a8) that specifying '-a'/'-A'
  leads to printing all processes regardless of the presence of other
  process selection options (except for '-x'/'-X', which command
  a filter).

  While here, mention a possible practical issue with '-J', as reported by
  dch@.  This option was introduced by commit "Add -J to filter by
  matching jail IDs and names." (13767130c7147ae7182a, r265229), which
  unfortunately talked about '-J' being a filter while actually
  implementing it as a regular selection option which adds to the
  processes to display.

  Reviewed by:    dch
  MFC after:      1 day
  Sponsored by:   The FreeBSD Foundation
  Differential Revision:  https://reviews.freebsd.org/D50193

  (cherry picked from commit 428200d2f0689aa801f5cab15d3066e2c77825f5)

  Commit hash edited on MFC.


   RELNOTES | 17 +++++++++++++++++
   1 file changed, 17 insertions(+)

[commit 455203ec88850dfc776b932666ffe34e6f6e5619]
Date: 2025-05-01
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Kernel.general
Subject: VFS cache: Fix initial sizing for non-default 'ncsizefactor'
Review: The VFS cache initial sizing for non-default 'ncsizefactor' values is corrected, which may affect system performance under certain configurations.
Body:


   sys/kern/vfs_cache.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 2fc0540469cb188d88b762ced19b1c059cb95ebb]
Date: 2025-05-05
Score: 5
Status: proposed(include=no,score=1)
Sponsor: 
Section: undecided
Subject: udf: Fix a typo in a source code comment
Review: Typo fix in a comment with no user-visible impact.
Body:

  - s/demostrates/demonstrates/

  (cherry picked from commit f6674f74fb299821d0f159b9f11cf7dd9b3e70ad)


   sys/fs/udf/udf_vfsops.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 22ebbdea3f33fdeae5ee83077ea9c25979705f2f]
Date: 2025-05-07
Score: 5
Status: proposed(include=no,score=10)
Sponsor: Netflix
Section: undecided
Subject: mpi3mr: Remove -g
Review: The commit removes a debugging flag (-g) from the mpi3mr module build, which reduces the kernel module size and may slightly improve performance, but does not change user-visible functionality.
Body:

  This -g was introduce when I didn't review all the cahnges to mpi3mr I
  was MFCing. Remove it. This is a direct commit.

  PR: 249068
  Fixes: 80b069913d496
  Sponsored by:		Netflix


   sys/modules/mpi3mr/Makefile | 2 --
   1 file changed, 2 deletions(-)

[commit 73b29b47f75b3a7565f7831ea020be3d51c4e542]
Date: 2025-04-15
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: sys/net: add DOT1Q_VID_{MIN,MAX}
Review: The commit adds constants DOT1Q_VID_MIN and DOT1Q_VID_MAX to define the valid VLAN ID range (1-4095) in the kernel's VLAN implementation. This provides clearer code but does not introduce user-visible behavior changes, new features, or configuration impacts.
Body:

  add a new typedef in if_vlan_var.h to represent the lowest (1) and
  highest (4095) valid VLAN IDs in a .1q tag.

  change if_vlan to use DOT1Q_VID_MAX instead of a magic number.

  Reviewed by:	kp
  Differential Revision:	https://reviews.freebsd.org/D49837

  (cherry picked from commit c59492025073bd57c7dc3bb5bd843ab0a1391c7a)


   sys/net/if_vlan.c     | 2 +-
   sys/net/if_vlan_var.h | 2 ++
   2 files changed, 3 insertions(+), 1 deletion(-)

[commit 4b0b2b5650ed2edeac00d3c6d1e1b402914ff032]
Date: 2025-05-06
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: net/if_dl.h: make self-contained
Review: The commit removes a cast and adds a header inclusion for internal type definitions, but these changes are internal refactoring with no user-visible impact. The LLADDR macro becomes const-correct, but this is a minor internal improvement that does not affect user applications or configurations.
Body:

  include <sys/_types.h> for u_char and u_short.

  to avoid including <sys/types.h>, remove the caddr_t cast from LLADDR.
  we are trying to get rid of caddr_t anyway, and since sdl_data is
  already an array of char, the cast is unnecessary.  this also makes
  LLADDR const-correct, i.e. passing a const sockaddr_dl will return a
  const pointer.

  Reviewed by:	des
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50065

  (cherry picked from commit 70b5c918571b6c79459ee6de66ceb4c83974d542)


   sys/net/if_dl.h | 6 ++++--
   1 file changed, 4 insertions(+), 2 deletions(-)

[commit 66a734854e10d8d88777215ccc696b8e973ed252]
Date: 2025-05-06
Score: 5
Status: proposed(include=no,score=20)
Sponsor: 
Section: undecided
Subject: net/if_dl.h: put kernel decls behind _KERNEL
Review: The change restricts kernel-only declarations in net/if_dl.h to kernel space, which may affect userland programs that incorrectly included these declarations.
Body:

  Reviewed by:	des
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50063

  (cherry picked from commit a5ba03f6e4f003022968b50161abac24c7ec1d38)


   sys/net/if_dl.h | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit a2070ebfaf0461ec57f78abe2704dc014a74e552]
Date: 2025-04-04
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: bridge: define VLANTAGOF correctly
Review: The commit fixes a macro definition to avoid precedence errors in conditional statements, which may affect code that uses VLANTAGOF in comparisons.
Body:

  to avoid strange precedence errors, enclose the macro body in
  parentheses.  this fixes constructs like: if (VLANTAGOF(m) == i)

  Reviewed by:	kp

  (cherry picked from commit f36292f010fcc6391605182f2973fdc12a3bd15f)


   sys/net/if_bridge.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 18d777f13e124cd6b4f0d49dc96793efbc6ad2aa]
Date: 2025-03-18
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: 
Section: Docs.manpages
Subject: tty.4: see also: cross-reference pts(4)
Review: Adds a cross-reference from man:tty[4] to man:pts[4] in the SEE ALSO section.
Body:

  pts(4) already refers to tty(4).

  Add a cross-reference.

  Reviewed by:	kevans
  Approved by:	kevans (mentor)
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1617

  (cherry picked from commit 6f4c4cfe4b138297957d80c0887f99a83d9facf7)


   share/man/man4/tty.4 | 1 +
   1 file changed, 1 insertion(+)

[commit 3de5e282e52c87bd2d17b6e17c483b6f5826922d]
Date: 2025-04-07
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Docs.manpages
Subject: netstat(1): add description for option -o and -O.
Review: The man:netstat[1] manual page now includes descriptions for the -o and -O options, which document route multipath and nexthop object display capabilities.
Body:

  Reviewed by: kevans, ziaee, ivy
  Approved by: kevans (mentor)
  Fixes: fedeb08b6a58 ("Introduce scalable route multipath.")
  Fixes: a666325282ea ("Introduce nexthop objects and new routing KPI.")
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1643

  (cherry picked from commit afa30c5dec5afc8496172a062c93e96d78f5b9b9)


   usr.bin/netstat/netstat.1 | 34 +++++++++++++++++++++++++++++++++-
   1 file changed, 33 insertions(+), 1 deletion(-)

[commit 2109eff098971a30c38384418bd019bcb7a6dc23]
Date: 2025-04-23
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Userland.config
Subject: etc: add config tag to /root/.k5login
Review: The /root/.k5login file is now tagged with a config flag to prevent it from being overwritten during FreeBSD-runtime upgrades.
Body:

  this prevents the file being overwritten every time FreeBSD-runtime is
  upgraded.

  Reviewed by:	des
  Approved by:	des (mentor)
  Differential Revision:	https://reviews.freebsd.org/D49907

  (cherry picked from commit eef0c78e435d5e38392c239d878784fda80b1fb8)


   etc/Makefile | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 6060830201d61a42c64612630a1e4c28ccb7c45e]
Date: 2025-05-07
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: rc.conf.5: add a missing word in the description of $ipv6_enable
Review: Fixes a typo in the man:rc.conf[5] man page description of the ipv6_enable variable.
Body:

  Reviewed by:	ziaee, kevans
  Approved by:	kevans (mentor)
  Differential Revision:	https://reviews.freebsd.org/D50113

  (cherry picked from commit dd2d270923884f0bb272da71cf76397ec5e8539c)


   share/man/man5/rc.conf.5 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 34cd36918652f07ea8a36a62115349781e457fc6]
Date: 2025-04-16
Score: 5
Status: proposed(include=yes,score=85)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: net80211: fix a race between ieee80211_sta_join and scan entries
Review: The commit fixes a race condition in the wireless stack that could cause kernel panics during association with access points. This improves stability when connecting to wireless networks.
Body:

  We were seeing panics during ieee80211_sta_join() which seemed that
  the ni->ni_chan was not valid anymore, which was true.
  We also saw errors indicating data put into ni_ies became inalid.

  The problem was that the ieee80211_scan_entry passed into
  ieee80211_sta_join() (in the observed case from setmlme_assoc_sta())
  became invalid during ieee80211_alloc_node().
  As a result for the ni_chan case the the rateset and len in rates[1]
  became invalid.  Similarly for the IEs.

  Make a (deep)copy of the scan entry in setmlme_assoc_sta() and return
  the copy as once we leave ieee80211_scan_iterate() we can no longer
  rely on the scan entry to be valid.

  Sponsored by:	The FreeBSD Foundation
  Reported by:	rm, ziaee, bz
  Tested by:	rm, ziaee, bz
  PR:		286063
  Reviewed by:	adrian (,emaste)
  Differential Revision: https://reviews.freebsd.org/D49865

  (cherry picked from commit aff56b4f0b25c44c9c2cae9a3f816c4277057a71)


   sys/net80211/ieee80211_ioctl.c | 26 +++++++++++++++++++++-----
   1 file changed, 21 insertions(+), 5 deletions(-)

[commit 707cfc54f8f3abcf04212960757a3f844773990e]
Date: 2025-05-03
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: LinuxKPI: add is_unicast_ether_addr()
Review: Adds is_unicast_ether_addr() to the LinuxKPI compatibility layer, enabling support for the mediatek/mt76 wireless driver.
Body:

  Needed by mediatek/mt76 wireless driver.

  While here adjust the way is_multicast_ether_addr() is implemented
  to not look weird. [1]

  Sponsored by:	The FreeBSD Foundation
  Suggested by:	emaste [1]
  Reviewed by:	emaste
  Differential Revision: https://reviews.freebsd.org/D50152

  (cherry picked from commit a4618caa43c16e6e672c27dac1943fd833f8bd8f)


   sys/compat/linuxkpi/common/include/linux/etherdevice.h | 8 +++++++-
   1 file changed, 7 insertions(+), 1 deletion(-)

[commit 033e97bababed3fc6b4f183d8a0969598fa52d05]
Date: 2025-05-04
Score: 5
Status: proposed(include=no,score=1)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: style
Review: This commit only makes style changes with no functional impact, so it is not suitable for release notes.
Body:

  Check results of non-bool to be != 0.

  No functional changes intended.

  Sponsored by:	The FreeBSD Foundation
  Reviewed by:	emaste
  Differential Revision: https://reviews.freebsd.org/D50158

  (cherry picked from commit 76b66ac45ea804f23ffb35712b0ceaa98864c06f)


   sys/compat/linuxkpi/common/src/linux_kobject.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 6a0dbc0a1246c9825f0892bb6dd957f5d081057a]
Date: 2025-05-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: 802.11: header updates for mt76
Review: LinuxKPI 802.11 headers are updated with new structs, fields, and definitions to support mt76 wireless driver compatibility.
Body:

  Add more structs, fields, flags, defines.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 675e6b1c68ba71af1853952f7df4d84399340009)


   .../linuxkpi/common/include/linux/ieee80211.h      |  6 ++
   sys/compat/linuxkpi/common/include/net/cfg80211.h  | 96 +++++++++++++++-------
   sys/compat/linuxkpi/common/include/net/mac80211.h  | 36 ++++++--
   3 files changed, 100 insertions(+), 38 deletions(-)

[commit 7b540fa547e7122c74d78dd427f262c8a8bd1a73]
Date: 2025-05-02
Score: 5
Status: proposed(include=no,score=10)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: dummy: add more dummy hreader files
Review: The commit adds dummy header files for LinuxKPI compatibility, which is an internal implementation detail for driver support and has no direct user-visible impact.
Body:

  These are needed for mt76.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit e8e2ed66f0978c439c7e93ff3d30a86ffad5bf56)


   sys/compat/linuxkpi/dummy/include/linux/regmap.h          | 0
   sys/compat/linuxkpi/dummy/include/net/page_pool/helpers.h | 0
   2 files changed, 0 insertions(+), 0 deletions(-)

[commit 5eb9006e6aa8eaecaeb8dbdd70bea6c605c19d50]
Date: 2025-05-05
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Userland.programs
Subject: fwget / mt76: update script to extra firmware and update fget(8)
Review: The fwget(8) utility now supports additional MediaTek wireless chipset IDs for firmware downloads, and the firmware extraction script has been updated to handle all compiled sub-drivers.
Body:

  Update the script to support all the sub-drivers we compile now.
  Some minor polishing as well.

  Update fwget(8) as more IDs were added.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 91f53f4e062715d869f2cb7e957707255390b704)


   sys/contrib/dev/mediatek/mt76/zzz_fw_ports_fwget.sh | 14 ++++++++------
   usr.sbin/fwget/pci/pci_network_mediatek             |  6 +++++-
   2 files changed, 13 insertions(+), 7 deletions(-)

[commit 1499bb2e77833df7f5b32bc09d62de66516b5c55]
Date: 2025-05-02
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: The FreeBSD Foundation
Section: Network.wireless
Subject: LinuxKPI: netdev: add NETIF_F_HW_TC
Review: The LinuxKPI subsystem adds the NETIF_F_HW_TC flag, which is required for the mt76 wireless driver to function correctly.
Body:

  Add a new flag needed by mt76.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 9c05d6320cc091ffb43002a149c04c122ccb798c)


   sys/compat/linuxkpi/common/include/linux/netdev_features.h | 3 ++-
   1 file changed, 2 insertions(+), 1 deletion(-)

[commit a21addc7a0137c5938414df322dbf5f929729834]
Date: 2025-05-02
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: LinuxKPI: 802.11: fix wiphy_info[_once]
Review: Fixes a minor internal bug in the LinuxKPI 802.11 compatibility layer; no user-visible impact.
Body:

  The dev field in wiphy is a pointer already; no need for &.

  Sponsored by:	The FreeBSD Foundation
  Fixes:		ac1d519c01ca8

  (cherry picked from commit 845b81cf908002b14ac08ce8c42246720a5b30d9)


   sys/compat/linuxkpi/common/include/net/cfg80211.h | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit b802c2f0a8a0c520a09e8ca5be79aac725af8918]
Date: 2025-04-24
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: pkg: update references to pkg.txz in man page
Review: The man: pkg[7] man page is updated to remove references to the deprecated pkg.txz bootstrap method, clarifying that only pkg.pkg is supported.
Body:

  Only pkg.pkg is supported since 0cd9513a5ba5b.

  Reviewed by:	emaste, ziaee
  Fixes: 0cd9513a5ba5 ("pkg: retire backwards compatibility bootstrap support")
  Sponsored by:	The FreeBSD Foundation
  Differential Revision: https://reviews.freebsd.org/D49994

  (cherry picked from commit 14704a7fdb77e92fdea11fc4b1e4e7479b0effbc)


   usr.sbin/pkg/pkg.7 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit e0c3bfb3f70b1db5e8a7581357ef9c1f3da23aa5]
Date: 2025-01-14
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: pkg: Fix two typos in visible error messages
Review: Fixes two typos in error messages displayed by man:pkg[8].
Body:

  No functional changes.

  (cherry picked from commit 49f4e3d297d26ce6b8e2a2b790bc6357edd064c4)


   usr.sbin/pkg/config.c | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 0906658c3409996b26518e67df48c01052ef934c]
Date: 2025-05-01
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: Netflix, Inc.
Section: Network.general
Subject: tcp: improve KASSERT in limited retransmit
Review: The TCP limited retransmit logic now allows up to 2 * MSS - 1 bytes when the Nagle algorithm is disabled, affecting retransmission behavior under specific conditions.
Body:

  When doing a limited retransmit, allow up to 2 * MSS - 1 if the
  Nagle algorithm has been disabled.

  PR:			282605
  Reviewed by:		cc, Peter Lei
  Sponsored by:		Netflix, Inc.
  Differential Revision:	https://reviews.freebsd.org/D49922

  (cherry picked from commit 934caaec3afc43638c2a1da8fbe3b672566db4fe)


   sys/netinet/tcp_input.c | 8 +++++---
   1 file changed, 5 insertions(+), 3 deletions(-)

[commit 48881a2680ab42ea1b06d1c9685df9d295991d16]
Date: 2025-05-03
Score: 5
Status: proposed(include=no,score=15)
Sponsor: 
Section: undecided
Subject: bpf: Make bpf.h self-contained
Review: The commit makes bpf.h self-contained, which may affect compilation of programs that include this header without other dependencies.
Body:

  PR:		286539
  MFC after:	3 days

  (cherry picked from commit 981af1192cfa5ecd7bee9fe47386ed9d45397828)


   sys/net/bpf.h                          | 1 +
   tools/build/test-includes/badfiles.inc | 1 -
   2 files changed, 1 insertion(+), 1 deletion(-)

[commit 02dde7c43fe76a5dcdc170de1c2740a31629e106]
Date: 2025-05-03
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: netinet: Make in_systm.h self-contained
Review: The commit makes the in_systm.h header self-contained by adding missing includes, which resolves build issues when the header is used in isolation.
Body:

  PR:		286539
  MFC after:	3 days

  (cherry picked from commit 75d173a84836d14b12a0f747ffed7d37766dd274)


   sys/netinet/in_systm.h                 | 2 ++
   tools/build/test-includes/badfiles.inc | 1 -
   2 files changed, 2 insertions(+), 1 deletion(-)

[commit 1fe14252227d594f5f7c8e924925a113ea487dd9]
Date: 2025-04-22
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Network.general
Subject: so_splice: Disallow splicing with KTLS-enabled sockets
Review: The splice(2) system call now disallows splicing with KTLS-enabled sockets to prevent a kernel panic. This ensures that attempts to splice data to or from a KTLS-enabled socket will fail with EINVAL, maintaining system stability.
Body:

  Suppose the sink socket in a splice has KTLS enabled.  When data is
  transmitted from the source socket, sosend_generic_locked() receives an
  mbuf rather than a UIO as it would if userspace were transferring data.
  In this case, ktls_frame() expects the mbuf to be unmapped, but in
  general this won't be the case.

  Simply disallow the combination for now.  Modify so_unsplice() to handle
  dismantling a partially initialized splice, in order to simplify error
  handling in so_splice().  Make sure that one can't enable KTLS on a
  spliced socket, or more specifically, that one can't enable RXTLS on the
  source side of a splice, or TXTLS on the sink side of a splice.

  Reported by:	syzbot+9cc248c4b0ca9b931ab4@syzkaller.appspotmail.com
  Reviewed by:	gallatin
  MFC after:	2 weeks
  Differential Revision:	https://reviews.freebsd.org/D49920

  (cherry picked from commit 1000cc4a0d39faeb3e681bb167ed38f164c56604)


   sys/kern/uipc_ktls.c   | 14 +++++++++++---
   sys/kern/uipc_socket.c | 42 ++++++++++++++++++++++++++----------------
   2 files changed, 37 insertions(+), 19 deletions(-)

[commit 4f3ce62ff7ef930eddaf3c7de59195092eee3e00]
Date: 2025-04-05
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Kernel.general
Subject: sysctl: Panic on OID reuse
Review: The sysctl subsystem now panics on OID reuse, making conflicts in the KERN_PROC OID space easier to detect. This does not affect OID_AUTO sysctl name collisions.
Body:

  In CheriBSD we had a conflict in the KERN_PROC OID space and didn't
  notice for some time.  Let's panic instead to make such conflicts easier
  to detect.  Note that this doesn't affect conflicts arising from name
  collisions in OID_AUTO sysctls, which happen sometimes due to driver
  bugs.

  Reviewed by:	brooks, kib, jhb
  MFC after:	1 month
  Differential Revision:	https://reviews.freebsd.org/D49351

  (cherry picked from commit d35c4cfad5800b15ab730af5246df0366f2be558)


   sys/kern/kern_sysctl.c | 2 +-
   1 file changed, 1 insertion(+), 1 deletion(-)

[commit 773ef40696c6335a1ed8ffaa6401777ac0ce716d]
Date: 2025-02-05
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: exec: Remove parameter 'segflg' from exec_copyin_args()
Review: The commit removes an unused parameter from an internal kernel function with no user-visible impact.
Body:

  In kern "copyin" means copy data from user address space to kernel
  address space. But in the function exec_copyin_args() there is a
  parameter 'segflg' that is used to specify the address space of the
  parameter 'fname'. In the source code there are two places where
  'segflg' are not UIO_USERSPACE. In both cases the 'fname' argument are
  NULL so the argument 'segflg' are not important there. So it is safe to
  remove the parameter 'segflg' from the function exec_copyin_args().

  Reviewed by:	markj, jhb
  MFC after:	2 weeks
  Pull Request:	https://github.com/freebsd/freebsd-src/pull/1590

  (cherry picked from commit 15581af7c2d30360313dcad74dc5dc83c02f9df0)


   sys/compat/freebsd32/freebsd32_misc.c | 11 +++++------
   sys/compat/freebsd32/freebsd32_util.h |  2 +-
   sys/compat/linux/linux_misc.c         |  8 ++++----
   sys/kern/kern_exec.c                  | 13 +++++--------
   sys/sys/imgact.h                      |  3 +--
   5 files changed, 16 insertions(+), 21 deletions(-)

[commit f5125f695aebbec4d03d8415a828b7d0b002407c]
Date: 2025-04-12
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: arch.7: Replace 13.x with 13.5
Review: Updates man:arch[7] to reflect that FreeBSD 13.5 is the final release of the 13.x series.
Body:

  13.5 is the final FreeBSD 13.x release.

  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 2cb892c0b6a525ed604f3abdb3fc62e05af4a60b)


   share/man/man7/arch.7 | 22 +++++++++++-----------
   1 file changed, 11 insertions(+), 11 deletions(-)

[commit 3ab24f211ae89cea051796f8fa2971947ddb55a5]
Date: 2025-04-30
Score: 5
Status: proposed(include=yes,score=15)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: src.conf.5: Correct LLVM_BINUTILS comment about strings(1)
Review: The commit corrects a comment in man:src.conf[5] regarding the strings(1) utility when using LLVM binutils. This ensures documentation accurately reflects the behavior of the build system.
Body:

  Reported by:	olivier
  Fixes: 81fa5c4a828b ("llvm-strings: Install as strings when WITH_LLVM_BINUTILS=YES")
  Sponsored by:	The FreeBSD Foundation

  (cherry picked from commit 7ca3db1999cd967f9d6d7b259aa7af54aae14a5f)


   share/man/man5/src.conf.5              | 4 +---
   tools/build/options/WITH_LLVM_BINUTILS | 2 --
   2 files changed, 1 insertion(+), 5 deletions(-)

[commit 4939a4a9cd14a2a746a689f7b26fc9fff615326d]
Date: 2025-04-21
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Use .pieo extension for WITH_PIE bsd.prog.mk output
Review: The commit changes the object file extension for programs built with WITH_PIE from .o to .pieo in bsd.prog.mk, ensuring consistency with bsd.lib.mk and correct propagation of PIE settings. This is an internal build system change with no direct user-visible impact.
Body:

  When object files for programs are built using bsd.prog.mk, and WITH_PIE
  is enabled, the extension used is still plain ".o". To be consistent
  with bsd.lib.mk, and to allow changes in WITH_PIE settings to propagate
  correctly, the extension should be ".pieo" instead.

  MFC after:	1 week
  Differential Revision: https://reviews.freebsd.org/D49966

  (cherry picked from commit 245bb0110639fe963086fb2903143dbd4e6ac48c)


   share/mk/bsd.prog.mk         | 15 ++++++++-------
   share/mk/bsd.progs.mk        |  2 +-
   tests/sys/fs/fusefs/Makefile |  8 +++++++-
   3 files changed, 16 insertions(+), 9 deletions(-)

[commit 37abcf06f2100eeca41dbd67f8ca8228903ce5e8]
Date: 2025-05-01
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Userland.programs
Subject: mountd: Fix updating the network/host(s) for an exports line
Review: mountd now properly updates network/host restrictions in exports(5) when they change during a SIGHUP reload, eliminating the need to restart mountd for such changes to take effect.
Body:

  Mountd reloads the exports(5) file(s) when it receives a SIGHUP
  and then compares the old and new exports, updating any ones that
  have changed in the kernel.

  Without this patch, mountd failed to recognize that a network/host(s)
  had changed, if there was no other change to the exports line.
  As such, the change of network/hosts(s) did not take effect until
  the mountd daemon was (re)started.

  This patch fixes the code so that it checks for changes in
  the network/host(s) list for an exports line.

  PR:	286260

  (cherry picked from commit 68daa781c1f12e1cfef768030eaff970c3d35543)


   usr.sbin/mountd/mountd.c | 44 +++++++++++++++++++++++++++++++++++++++++++-
   1 file changed, 43 insertions(+), 1 deletion(-)

[commit a75f920158c7f163ba1ebde1eb4ff42244d7a82d]
Date: 2025-04-28
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: net/sff8472.h: add double-include protection
Review: Adds double-include protection to sys/net/sff8472.h, preventing compilation errors if the header is included multiple times.
Body:

  (cherry picked from commit 6cb5f1629e6f89a468e34625fd4a35ce4585500f)


   sys/net/sff8472.h | 5 +++++
   1 file changed, 5 insertions(+)

[commit c5e3af9013efa1fe015eed0f580c6742f8a5ad8a]
Date: 2025-04-19
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Userland.programs
Subject: elfctl: add knowledge about the la57 bit
Review: The man:elfctl[1] utility now recognizes the LA57 bit for 5-level paging on x86-64 systems.
Body:

  (cherry picked from commit b989c1dd1e2edc8cf7597d276625b454b7b72e6d)


   usr.bin/elfctl/elfctl.1 | 14 ++++++++++++++
   usr.bin/elfctl/elfctl.c |  5 ++++-
   2 files changed, 18 insertions(+), 1 deletion(-)

[commit 64a8ac8c63d3b84b5da8042e5e314aa7938f5b10]
Date: 2025-04-19
Score: 5
Status: proposed(include=yes,score=75)
Sponsor: 
Section: Kernel.general
Subject: amd64: make LA57 mode for a process opt-in by default
Review: The LA57 mode (57-bit virtual address space) is now opt-in by default for processes on amd64. This change prevents potential compatibility issues with software that does not expect the larger address space. Users can enable LA57 via the kern.elf64.allow_la57 sysctl.
Body:

  (cherry picked from commit 7a8440bf0894f910f871e91a660a9f66dbb23f0b)


   sys/amd64/amd64/elf_machdep.c | 4 +++-
   sys/amd64/amd64/pmap.c        | 9 +++++++++
   sys/amd64/include/md_var.h    | 1 +
   3 files changed, 13 insertions(+), 1 deletion(-)

[commit 2a6ec58c6d92a774270533841397f72d35be2caf]
Date: 2025-04-19
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Kernel.general
Subject: amd64: add elfctl bit to enable LA57
Review: The elfctl bit for LA57 is now defined, enabling support for 57-bit linear addresses in 64-bit mode.
Body:

  (cherry picked from commit 5ad6c3d840a758b25a1b000c37f366be35fc7a95)


   sys/sys/elf_common.h | 1 +
   1 file changed, 1 insertion(+)

[commit 3637d81e8f6875c7f777ca3cf14a2fc3e601db60]
Date: 2024-10-24
Score: 5
Status: proposed(include=yes,score=45)
Sponsor: 
Section: Kernel.general
Subject: x86: add cpu_stdext_feature4
Review: The commit adds support for a new CPU feature flag (cpu_stdext_feature4) to the x86 CPU identification code. This allows userland applications to detect additional CPU capabilities via sysctl or CPUID.
Body:

  (cherry picked from commit 011a3493610cc69e9337c857d4947b0bbc462c0a)


   sys/x86/include/x86_var.h |  1 +
   sys/x86/x86/identcpu.c    | 21 ++++++++++++++++++++-
   2 files changed, 21 insertions(+), 1 deletion(-)

[commit 6b7c520b915e1df72dee494b8abbc5d0fefd30b0]
Date: 2025-04-18
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ptrace_test: add test for the PT_ATTACH behavior on sleeping thread
Review: Adds a test for the PT_ATTACH behavior on sleeping threads, which is internal testing infrastructure with no direct user-visible impact.
Body:

  (cherry picked from commit ed080d9915869708a9ab7badc217aff17ebbef6c)


   tests/sys/kern/ptrace_test.c | 61 ++++++++++++++++++++++++++++++++++++++++++++
   1 file changed, 61 insertions(+)

[commit 82ceed2dc7a560c6a718f75334546528d77ecb9d]
Date: 2025-04-16
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: ptrace_test PT_SC_REMOTE: fix a race
Review: The commit fixes a race condition in a kernel ptrace test, which is an internal test change without user-visible impact.
Body:

  (cherry picked from commit 1f8d845d1cdfeaefa539df5f6f33bec3da65152c)


   tests/sys/kern/ptrace_test.c | 5 ++++-
   1 file changed, 4 insertions(+), 1 deletion(-)

[commit f0ba6535d446ed79b628e3cd27a971131752ee44]
Date: 2025-04-23
Score: 5
Status: proposed(include=yes,score=40)
Sponsor: 
Section: Kernel.general
Subject: sig_handle_first_stop(): notify debugger
Review: The sig_handle_first_stop() function now notifies the debugger when a process stops due to a signal, improving debugging capabilities for processes under ptrace control.
Body:

  (cherry picked from commit 2f87445747430b4ca2e1d344550d9befb54226e7)
  (cherry picked from commit 4f32b298c679271243855083d20306563f815f17)


   sys/kern/kern_sig.c | 33 +++++++++++++++++++++++++++------
   1 file changed, 27 insertions(+), 6 deletions(-)

[commit 75c6434b17198116553685f56e0979176f6337da]
Date: 2025-04-21
Score: 5
Status: proposed(include=yes,score=60)
Sponsor: 
Section: Kernel.general
Subject: sig_handle_first_stop(): allow NULL leader thread
Review: The sig_handle_first_stop() function now allows a NULL leader thread, preventing potential kernel panics in certain signal handling scenarios.
Body:

  (cherry picked from commit f87811ca3bc110af29e3a0e341d241c292dc8424)


   sys/kern/kern_sig.c | 16 +++++++---------
   1 file changed, 7 insertions(+), 9 deletions(-)

[commit a86e21e2caaa9796308282a235bdb42bd3c71292]
Date: 2025-04-21
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: ptrace(): p_xthread could be NULL for P_STOPPED_TRACE
Review: The commit fixes a potential NULL pointer dereference in the ptrace() system call when handling P_STOPPED_TRACE processes. This prevents kernel panics in debugging scenarios.
Body:

  (cherry picked from commit b63281884e0e1530de999723532f2d536cb32477)


   sys/kern/sys_process.c | 23 ++++++++++++-----------
   1 file changed, 12 insertions(+), 11 deletions(-)

[commit 2b11b13b04bd4b5a0519850d35b334fe420502ca]
Date: 2025-04-17
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: kern_sig.c: add chicken bit for old way of SIGSTOP handling on PT_ATTACH
Review: Adds a sysctl knob kern.pt_attach_sigstop to revert to the old SIGSTOP behavior for PT_ATTACH, allowing users to restore previous debugging behavior if needed.
Body:

  (cherry picked from commit a6b7d5cddacd4aa14ee058195eedfe207a69029e)


   sys/kern/kern_sig.c | 10 ++++++++--
   1 file changed, 8 insertions(+), 2 deletions(-)

[commit 18e0f9ec54e83fae684d51fe08f8b2b7390da006]
Date: 2025-04-16
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Kernel.general
Subject: PT_ATTACH: do not interrupt interruptible sleeps
Review: The man:ptrace[2] PT_ATTACH operation no longer interrupts interruptible sleeps, which may affect debugging behavior for processes in certain sleep states.
Body:

  (cherry picked from commit ecc662c749b11434c63a0d3578fc40df6b4798ec)


   sys/kern/kern_sig.c | 12 +++++++++++-
   1 file changed, 11 insertions(+), 1 deletion(-)

[commit 4c989e2aba9956bac2a70438eb7a4116bc75c27d]
Date: 2025-04-17
Score: 5
Status: proposed(include=no,score=5)
Sponsor: 
Section: undecided
Subject: kern_sig.c: extract the first stop handling into a helper
Review: The commit is a code refactoring that extracts a helper function for signal handling. It does not introduce any user-visible changes in behavior, features, or configuration.
Body:

  (cherry picked from commit 4048ccc6ae374c015c31f7b35221d5da8fe7d63f)


   sys/kern/kern_sig.c | 43 ++++++++++++++++++++++++++-----------------
   1 file changed, 26 insertions(+), 17 deletions(-)

[commit 45ff300000d1f3b36df2bc353b656ca048757398]
Date: 2025-04-26
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: nvmecontrol(8): Fix two typos in command messages
Review: Fixes two typos in command output messages of man:nvmecontrol[8].
Body:

  Fix two typos in command messages:

  - s/identiy/identity/

  (cherry picked from commit 52cc1708f5afdb3208d7797b87b3059a780d613b)


   sbin/nvmecontrol/identify.c | 2 +-
   sbin/nvmecontrol/ns.c       | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit 0aca1d4e7c766fea577129fdae5796244998b7d6]
Date: 2024-11-09
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Kernel.general
Subject: arm: remove accidentally added -Map switch to linker
Review: The commit removes an incorrectly added linker flag that could affect kernel linking on ARM systems, potentially resolving build issues.
Body:

  Fixes: ba045ba49ded
  (cherry picked from commit 0283eebb4a54c7270f9ac03bb4ed2742cb959c28)


   sys/conf/Makefile.arm | 1 -
   1 file changed, 1 deletion(-)

[commit bec5167645b5d157a1c980099162362f115ccbfe]
Date: 2024-11-03
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: 
Section: Kernel.general
Subject: arm: Improve the creation of kernel.bin
Review: The kernel.bin creation method changes to preserve symbol offsets, keeping kernel.debug valid. The awk script now uses a neutral locale to ensure proper binary data handling.
Body:

  Instead of relinking the kernel without elf headers, replace them with
  a binary blob of the same length starting with a jump to the kernel's start
  address. This ensures that all symbols stay at the same offsets as in
  the original kernel, so kernel.debug remains valid also for kernel.bin.

  Also ensure that the awk script used runs with  the neutral locale defined.
  Awk 'write' is a locale compilant, and  script is used to write binary data
  to a file, so it needs to ensure that  bytes > 127 are written unchanged.

  While I'm on, set the neutral locale also for arm64, where the same script is
  used to generate the kernel booti image.

  Reviewed by:   emaste, imp
  Differential Revision:  https://reviews.freebsd.org/D47488

  (cherry picked from commit ba045ba49dedb068ba2f0e13fbb1c1a91fde8333)


   sys/conf/Makefile.arm   | 39 ++++++++++++++++++++-------------------
   sys/conf/Makefile.arm64 |  1 +
   2 files changed, 21 insertions(+), 19 deletions(-)

[commit 098e4ecd65492bd23f88f4358f0c6bde13a1e114]
Date: 2025-04-18
Score: 5
Status: proposed(include=yes,score=30)
Sponsor: 
Section: Kernel.general
Subject: vm_pageout: Disallow invalid values for act_scan_laundry_weight
Review: The vm_pageout system now rejects invalid values for the act_scan_laundry_weight sysctl, preventing potential misconfiguration that could affect memory management behavior.
Body:

  PR:		234167
  MFC after:	2 weeks

  (cherry picked from commit d8b03c5904faff84656d3a84a25c2b37bcbf8075)


   sys/vm/vm_pageout.c | 19 +++++++++++++++++--
   1 file changed, 17 insertions(+), 2 deletions(-)

[commit 03f0c1b181930c46d1839f20953a0168683fe9d4]
Date: 2025-04-18
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: pwait tests: Fix some exit annotations
Review: The commit fixes test annotations for pwait tests but does not introduce any user-visible changes to functionality, configuration, or behavior.
Body:

  A number of tests rely on timeout(1) to kill a pwait instance, and with
  --preserve-status the corresponding exit status is propagated to
  atf_check.  Update the checks to reflect this.

  MFC after:	2 weeks

  (cherry picked from commit 987ef153c28878c3968420663f6061d6e70540a8)


   bin/pwait/tests/pwait_test.sh | 12 ++++++------
   1 file changed, 6 insertions(+), 6 deletions(-)

[commit 2072a2276f6044d319837f2ef3ec37b7c4180859]
Date: 2024-05-22
Score: 5
Status: proposed(include=yes,score=10)
Sponsor: 
Section: Docs.manpages
Subject: Fix "version introduced" in two manual pages
Review: Corrects the 'version introduced' metadata in the man:exec[3] and man:posixmqcontrol[1] manual pages.
Body:

  Signed-off-by: Tom Hukins <tom@FreeBSD.org>
  Reviewed by: imp
  Pull Request: https://github.com/freebsd/freebsd-src/pull/1252
  (cherry picked from commit 2ce32ab21a5961dd9405cde8d985da9d0a664276)


   lib/libc/gen/exec.3                     | 2 +-
   usr.bin/posixmqcontrol/posixmqcontrol.1 | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit 2dd67e4f612e76426b7937025f6fc777d9dae6bc]
Date: 2025-05-02
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: The FreeBSD Foundation
Section: Drivers.device
Subject: snd_hda: Drain callout in hdac_detach()
Review: The commit fixes a kernel panic that could occur when hot-unloading the HDA audio driver by ensuring the callout is drained during detach.
Body:

  Because we do not drain the hdac callout during detach, hot-unloading
  can result in a panic if the callback fires after we have freed the
  resources it uses.

  pcm0: detached
  pcm1: detached
  hdaa0: detached
  hdacc0: detached
  Kernel page fault with the following non-sleepable locks held:
  exclusive sleep mutex hdac0 (HDA driver mutex) r = 0 (0xfffffe000212c820) locked @ /mnt/src/sys/dev/sound/pci/hda/hdac.c:400

  [...]

  db_trace_self_wrapper() at db_trace_self_wrapper+0xa5/frame 0xfffffe0046b04490
  kdb_backtrace() at kdb_backtrace+0xc6/frame 0xfffffe0046b045f0
  vpanic() at vpanic+0x226/frame 0xfffffe0046b04790
  panic() at panic+0xb5/frame 0xfffffe0046b04850
  trap_fatal() at trap_fatal+0x65b/frame 0xfffffe0046b04950
  trap_pfault() at trap_pfault+0x12b/frame 0xfffffe0046b04a70
  trap() at trap+0x54c/frame 0xfffffe0046b04c50
  calltrap() at calltrap+0x8/frame 0xfffffe0046b04c50
  --- trap 0xc, rip = 0xffffffff8412e7ec, rsp = 0xfffffe0046b04d20, rbp = 0xfffffe0046b04d40 ---
  hdacc_stream_intr() at hdacc_stream_intr+0x3c/frame 0xfffffe0046b04d40
  hdac_intr_handler() at hdac_intr_handler+0x15c/frame 0xfffffe0046b04d90
  ithread_loop() at ithread_loop+0x387/frame 0xfffffe0046b04ef0
  fork_exit() at fork_exit+0xa3/frame 0xfffffe0046b04f30
  fork_trampoline() at fork_trampoline+0xe/frame 0xfffffe0046b04f30
  --- trap 0xc, rip = 0x829cc531a, rsp = 0x82b8b7a88, rbp = 0x82b8b7aa0 ---
  KDB: enter: panic
  [ thread pid 12 tid 100211 ]
  Stopped at      kdb_enter+0x34: movq    $0,0x1f09af1(%rip)
  db>

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 day
  Reviewed by:	kib, adrian
  Differential Revision:	https://reviews.freebsd.org/D50087

  (cherry picked from commit c50c5a47a9d515a7dbf584c10c7f66e56b29b305)


   sys/dev/sound/pci/hda/hdac.c | 2 ++
   1 file changed, 2 insertions(+)

[commit d0e6b4305f47150d9f15295f884040b89952af93]
Date: 2025-04-29
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sound: Retire volch
Review: Internal variable removal and renaming in the sound driver with no user-visible impact.
Body:

  volch is a variable used internally in dsp_ioctl_channel() which
  corresponds to either priv->rdch or priv->wrch. As a result, priv->volch
  is also a pointer to one of those two channels, but is also not used
  anywhere outside dsp_ioctl_channel(). Since the operation of figuring
  out which channel we want to operate on inside dsp_ioctl_channel() is
  cheap enough, retire volch to avoid unnecessary complexity and
  confusion.

  While here, rename "volch" to just "ch".

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 week
  Reviewed by:	markj
  Differential Revision:	https://reviews.freebsd.org/D50022

  (cherry picked from commit 578cbd03f7a53eb23b71b560f8816f84f5a1461b)


   sys/dev/sound/pcm/dsp.c | 61 ++++++++++++++++++++++---------------------------
   1 file changed, 27 insertions(+), 34 deletions(-)

[commit d99692a8133959a7cb014a2fd3e3486139ee24ad]
Date: 2025-04-25
Score: 5
Status: proposed(include=no,score=5)
Sponsor: The FreeBSD Foundation
Section: undecided
Subject: sound: Retire SD_F_PRIO_*
Review: The commit removes internal flags and macros related to sound driver locking without any functional change or user-visible impact.
Body:

  The SD_F_* flags are supposed to be softc flags, but SD_F_PRIO_RD and
  SD_F_PRIO_WR are just generic flags and are only used with
  dsp_lock_chans() and dsp_unlock_chans(). Since we already have the
  DSP_F_READ() and DSP_F_WRITE() macros, we can re-use them instead.

  I am aware the FREAD and FWRITE flags are meant to be used with open(),
  but I think their use here is clear enough to not cause confusion.

  No functional change intended.

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D49978

  (cherry picked from commit abb5521bddc24581a1bcbe3e3f016504a4824c73)


   sys/dev/sound/pcm/dsp.c   | 34 +++++++++++++++++-----------------
   sys/dev/sound/pcm/sound.h |  7 +------
   2 files changed, 18 insertions(+), 23 deletions(-)

[commit a9221e5077478efb877a531d3cf4deb64240a42f]
Date: 2025-04-25
Score: 5
Status: proposed(include=yes,score=20)
Sponsor: The FreeBSD Foundation
Section: Docs.manpages
Subject: sndstat.4: Make sndstat nvlist channel names reflect new naming scheme
Review: The man:sndstat[4] manual page is updated to reflect the new channel naming scheme introduced by a previous change in the sound subsystem.
Body:

  Change introduced in c30f531ddb62 ("sound: Shorten channel names").

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D49981

  (cherry picked from commit ef411cae7e9a644564cd079fac02e23105403136)


   share/man/man4/sndstat.4 | 4 ++--
   1 file changed, 2 insertions(+), 2 deletions(-)

[commit 4a9c90d81e86ece27816e584835cd6f6ac97c8f5]
Date: 2025-04-25
Score: 5
Status: proposed(include=yes,score=35)
Sponsor: The FreeBSD Foundation | The FreeBSD Foundation
Section: Userland.programs
Subject: sound: Export hardware and software buffer sample rate in sndstat nvlist
Review: The man:sndstat[4] utility now exports hardware and software buffer sample rates in its nvlist output, providing additional diagnostic information for sound system monitoring.
Body:

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D49983

  (cherry picked from commit 19ec522d6dc1d4616e07f5668339fc637856f547)

  sound tests: Fetch HWBUF_RATE and SWBUF_RATE in sndstat_nv

  Introduced in 19ec522d6dc1 ("sound: Export hardware and software buffer
  sample rate in sndstat nvlist").

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 week

  (cherry picked from commit 52a0f967dcc5b78c5f2f7e49a96e9cec56472a4f)


   share/man/man4/sndstat.4    | 6 ++++++
   sys/dev/sound/pcm/sndstat.c | 4 ++++
   sys/sys/sndstat.h           | 2 ++
   tests/sys/sound/sndstat.c   | 2 ++
   4 files changed, 14 insertions(+)

[commit 3b0ff20f8d69447bbea205187f759edc1f3d8e2d]
Date: 2025-04-25
Score: 5
Status: proposed(include=yes,score=25)
Sponsor: The FreeBSD Foundation | The FreeBSD Foundation
Section: Drivers.device
Subject: sound: Make sndstat PVCHAN and RVCHAN nvlist parameters bool
Review: The sndstat(4) PVCHAN and RVCHAN nvlist parameters now report boolean values indicating whether play or record virtual channels are enabled, rather than channel counts.
Body:

  Prior to 02d4eeabfd73 ("sound: Allocate vchans on-demand"), the
  play.vchans and rec.vchans sysctls corresponded to the value of
  d->pvchancount and d->rvchancount respectively, which is also what we
  are exporting through SNDST_DSPS_SOUND4_PVCHAN and
  SNDST_DSPS_SOUND4_RVCHAN respectively. Since that commit, the sysctls
  mentioned have been modified to show whether play/rec vchans are enabled
  or not. Modify the sndstat nvlist parameters accordingly.

  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 week
  Differential Revision:	https://reviews.freebsd.org/D49980

  (cherry picked from commit 0c0bb4c1401c9696fbb8d0b1fe88990db0e706c8)

  sound tests: Fix PVCHAN and RVCHAN fetching in sndstat_nv

  Fixes:		0c0bb4c1401c ("sound: Make sndstat PVCHAN and RVCHAN nvlist parameters bool")
  Reported by:	CI
  Sponsored by:	The FreeBSD Foundation
  MFC after:	1 week

  (cherry picked from commit 6286b714f5e398cc2a87883d81aa087ee11ee310)


   share/man/man4/sndstat.4    | 8 ++++----
   sys/dev/sound/pcm/sndstat.c | 6 ++++--
   tests/sys/sound/sndstat.c   | 4 ++--
   3 files changed, 10 insertions(+), 8 deletions(-)

[commit 5835d34761a0b905a987986632222aa7de7fb083]
Date: 2025-04-25
Score: 5
Status: proposed(include=no,score=40)
Sponsor: 
Section: undecided
Subject: libthr: properly align struct pthreads
Review: The commit fixes alignment of struct pthreads, which may affect performance or correctness of threaded applications.
Body:

  PR:	285711

  (cherry picked from commit 22e564c74eb20e14bd93fd9fdde20e38a29cfcf1)


   lib/libthr/thread/thr_list.c | 4 +++-
   1 file changed, 3 insertions(+), 1 deletion(-)

[commit 85192b37a3f1af0dd6a7215b50cc6b6e2c5ccac4]
Date: 2025-04-25
Score: 5
Status: proposed(include=no,score=30)
Sponsor: 
Section: undecided
Subject: libthr: add __thr_aligned_alloc_offset()
Review: Adds __thr_aligned_alloc_offset() to the threading library, which may affect developers using aligned memory allocation in threaded applications.
Body:

  (cherry picked from commit 846229d60b4fd6def666ce32cfc475ed96aabaf3)


   lib/libthr/thread/thr_malloc.c  | 13 +++++++++++++
   lib/libthr/thread/thr_private.h |  1 +
   2 files changed, 14 insertions(+)

[commit 61bcd8183104bcae6fa9e3db460a15dc15c1600a]
Date: 2025-05-02
Score: 5
Status: proposed(include=yes,score=80)
Sponsor: Amazon
Section: Kernel.general
Subject: Post-14.3-branch updates
Review: The stable/14 branch is renamed to -STABLE and __FreeBSD_version is bumped.
Body:

  Rename stable/14 to -STABLE

  Bump __FreeBSD_version

  Approved by:	re (implicit)
  Sponsored by:	Amazon


   sys/conf/newvers.sh | 2 +-
   sys/sys/param.h     | 2 +-
   2 files changed, 2 insertions(+), 2 deletions(-)

[commit ff7d0514754490faa2a69bd06eb392c82587a521]
Date: 2024-12-19
Score: 5
Status: proposed(include=no,score=10)
Sponsor: 
Section: undecided
Subject: Fix compile-time warnings caused by duplicate struct typedefs (#16880)
Review: The commit addresses compile-time warnings by removing duplicate struct typedefs in ZFS headers, which may affect users building ZFS on Linux or using certain compilers that treat duplicate typedefs as errors.
Body:

  Some compiler/versions warn these typedefs according to #16660.

  The platform specific header sys/abd_os.h shouldn't define or use abd_t,
  as it's defined in its non-platform specific consumer sys/abd.h.
  Do the same as what FreeBSD header does.

  Original-patch-by: Tomohiro Kusumi <kusumi.tomohiro@gmail.com>
  Signed-off-by: Rob Norris <robn@despairlabs.com>
  (cherry picked from commit a9851ea3dd6af6f789e221f2ccd7ad43561eff81)

  Co-authored-by: Tomohiro Kusumi <kusumi.tomohiro@gmail.com>
  Reviewed-by: Alexander Motin <mav@FreeBSD.org>
  Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
  Reviewed-by: Tony Hutter <hutter2@llnl.gov>

   include/os/linux/spl/sys/taskq.h  |  1 +
   include/os/linux/zfs/sys/abd_os.h | 10 +++++-----
   2 files changed, 6 insertions(+), 5 deletions(-)

[commit 5c51f8fc2f12196de455938ae1b486cbabf82f0d]
Date: 2024-10-19
Score: 5
Status: proposed(include=yes,score=65)
Sponsor: 
Section: Hardware.virtualization
Subject: config: fix dequeue_signal check for kernels <4.20
Review: The commit fixes a build issue with Linux kernel compatibility in the SPL module, specifically for kernels older than 4.20. This resolves compilation failures when building on systems with older Linux kernels.
Body:

  Before 4.20, kernel_siginfo_t was just called siginfo_t. This was
  causing the kthread_dequeue_signal_3arg_task check, which uses
  kernel_siginfo_t, to fail on older kernels.

  In d6b8c17f1, we started checking for the "new" three-arg
  dequeue_signal() by testing for the "old" version. Because that test is
  explicitly using kernel_siginfo_t, it would fail, leading to the build
  trying to use the new three-arg version, which would then not comile.

  This commit fixes that by avoiding checking for the old 3-arg
  dequeue_signal entirely. Instead, we check for the new one, as well as
  the 4-arg form, and we use the old form as a fallback. This way, we
  never have to test for it explicitly, and once we're building
  HAVE_SIGINFO will make sure we get the right kernel_siginfo_t for it, so
  everything works out nice.

  Original-patch-by: Finix <yancw@info2soft.com>
  Signed-off-by: Rob Norris <robn@despairlabs.com>


   config/kernel-kthread.m4         | 37 ++++++++++++++++++++++---------------
   module/os/linux/spl/spl-thread.c |  6 +++---
   2 files changed, 25 insertions(+), 18 deletions(-)

